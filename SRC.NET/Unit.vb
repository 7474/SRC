Option Strict Off
Option Explicit On
Friend Class Unit
	
	' Copyright (C) 1997-2012 Kei Sakamoto / Inui Tetsuyuki
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Data As UnitData
	
	'Invalid_string_refer_to_original_code
	Public ID As String
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public BitmapID As Short
	
	'Invalid_string_refer_to_original_code
	Public x As Short
	'Invalid_string_refer_to_original_code
	Public y As Short
	
	'Invalid_string_refer_to_original_code
	Public Area As String
	
	'菴ｿ逕ｨ貂医∩陦悟虚謨ｰ
	Public UsedAction As Short
	
	'Invalid_string_refer_to_original_code
	Private strMode As String
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'UPGRADE_NOTE: Status は Status_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
	Public Status_Renamed As String
	
	'Invalid_string_refer_to_original_code
	Private colSpecialPowerInEffect As New Collection
	
	'Invalid_string_refer_to_original_code
	Public UsedSupportAttack As Short
	Public UsedSupportGuard As Short
	
	'Invalid_string_refer_to_original_code
	Public UsedSyncAttack As Short
	
	'Invalid_string_refer_to_original_code
	Public UsedCounterAttack As Short
	
	'繝ｦ繝九ャ繝亥錐遘ｰ
	Private strName As String
	'髯｣蝟ｶ
	Private strParty As String
	'繝ｦ繝九ャ繝医Λ繝ｳ繧ｯ
	Private intRank As Short
	'繝懊せ繝ｩ繝ｳ繧ｯ
	Private intBossRank As Short
	'Invalid_string_refer_to_original_code
	Private lngMaxHP As Integer
	Private lngHP As Integer
	'Invalid_string_refer_to_original_code
	Private intMaxEN As Short
	Private intEN As Short
	'Invalid_string_refer_to_original_code
	Private lngArmor As Integer
	'驕句虚諤ｧ
	Private intMobility As Short
	'遘ｻ蜍募鴨
	Private intSpeed As Short
	
	'Invalid_string_refer_to_original_code
	Private colPilot As New Collection
	
	'Invalid_string_refer_to_original_code
	Private colSupport As New Collection
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Private colOtherForm As New Collection
	
	'Invalid_string_refer_to_original_code
	Private colUnitOnBoard As New Collection
	
	'Invalid_string_refer_to_original_code
	Private colItem As New Collection
	
	'Invalid_string_refer_to_original_code
	Private colCondition As New Collection
	
	'Invalid_string_refer_to_original_code
	Private dblBullet() As Double
	
	'Invalid_string_refer_to_original_code
	Private dblStock() As Double
	
	'Invalid_string_refer_to_original_code
	Private colFeature As New Collection
	
	'Invalid_string_refer_to_original_code
	Private colAllFeature As New Collection
	
	'Invalid_string_refer_to_original_code
	Public AdditionalFeaturesNum As Short
	
	'Invalid_string_refer_to_original_code
	Private strAdaption As String
	
	'Invalid_string_refer_to_original_code
	Public strAbsorb As String
	Public strImmune As String
	Public strResist As String
	Public strWeakness As String
	Public strEffective As String
	Public strSpecialEffectImmune As String
	
	'Invalid_string_refer_to_original_code
	Private WData() As WeaponData
	Private lngWeaponPower() As Integer
	Private intWeaponMaxRange() As Short
	Private intWeaponPrecision() As Short
	Private intWeaponCritical() As Short
	Private strWeaponClass() As String
	Private intMaxBullet() As Short
	
	'Invalid_string_refer_to_original_code
	Private adata() As AbilityData
	
	'Invalid_string_refer_to_original_code
	Private SelectedMapAttackPower As Integer
	
	'Invalid_string_refer_to_original_code
	Private IsMapAttackCanceled As Boolean
	
	'Invalid_string_refer_to_original_code
	Private colServant As New Collection
	
	'Invalid_string_refer_to_original_code
	Private colSlave As New Collection
	
	'蜿ｬ蝟壻ｸｻ
	Public Summoner As Unit
	
	'Invalid_string_refer_to_original_code
	Public Master As Unit
	
	'Invalid_string_refer_to_original_code
	Public pltAdditionalPilot As Pilot
	
	'Invalid_string_refer_to_original_code
	Public pltAdditionalSupport As Pilot
	
	
	'Invalid_string_refer_to_original_code
	'UPGRADE_NOTE: Class_Initialize は Class_Initialize_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
	Private Sub Class_Initialize_Renamed()
		Status_Renamed = "Invalid_string_refer_to_original_code"
		intBossRank = -1
		'UPGRADE_NOTE: オブジェクト Summoner をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		Summoner = Nothing
		'UPGRADE_NOTE: オブジェクト Master をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		Master = Nothing
		ReDim WData(0)
		ReDim adata(0)
	End Sub
	Public Sub New()
		MyBase.New()
		Class_Initialize_Renamed()
	End Sub
	
	'繧ｯ繝ｩ繧ｹ縺ｮ隗｣謾ｾ
	'UPGRADE_NOTE: Class_Terminate は Class_Terminate_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
	Private Sub Class_Terminate_Renamed()
		Dim i As Short
		
		'UPGRADE_NOTE: オブジェクト Data をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		Data = Nothing
		
		With colPilot
			For i = 1 To .Count()
				.Remove(1)
			Next 
		End With
		'UPGRADE_NOTE: オブジェクト colPilot をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		colPilot = Nothing
		
		With colSupport
			For i = 1 To .Count()
				.Remove(1)
			Next 
		End With
		'UPGRADE_NOTE: オブジェクト colSupport をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		colSupport = Nothing
		
		With colOtherForm
			For i = 1 To .Count()
				.Remove(1)
			Next 
		End With
		'UPGRADE_NOTE: オブジェクト colOtherForm をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		colOtherForm = Nothing
		
		With colItem
			For i = 1 To .Count()
				.Remove(1)
			Next 
		End With
		'UPGRADE_NOTE: オブジェクト colItem をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		colItem = Nothing
		
		With colCondition
			For i = 1 To .Count()
				.Remove(1)
			Next 
		End With
		'UPGRADE_NOTE: オブジェクト colCondition をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		colCondition = Nothing
		
		With colFeature
			For i = 1 To .Count()
				.Remove(1)
			Next 
		End With
		'UPGRADE_NOTE: オブジェクト colFeature をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		colFeature = Nothing
		
		For i = 1 To UBound(WData)
			'UPGRADE_NOTE: オブジェクト WData() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			WData(i) = Nothing
		Next 
		
		For i = 1 To UBound(adata)
			'UPGRADE_NOTE: オブジェクト adata() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			adata(i) = Nothing
		Next 
		
		With colUnitOnBoard
			For i = 1 To .Count()
				.Remove(1)
			Next 
		End With
		'UPGRADE_NOTE: オブジェクト colUnitOnBoard をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		colUnitOnBoard = Nothing
		
		With colServant
			For i = 1 To .Count()
				.Remove(1)
			Next 
		End With
		'UPGRADE_NOTE: オブジェクト colServant をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		colServant = Nothing
		
		With colSlave
			For i = 1 To .Count()
				.Remove(1)
			Next 
		End With
		'UPGRADE_NOTE: オブジェクト colSlave をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		colSlave = Nothing
		
		'UPGRADE_NOTE: オブジェクト Summoner をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		Summoner = Nothing
		'UPGRADE_NOTE: オブジェクト Master をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		Master = Nothing
		'UPGRADE_NOTE: オブジェクト pltAdditionalPilot をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		pltAdditionalPilot = Nothing
		'UPGRADE_NOTE: オブジェクト pltAdditionalSupport をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		pltAdditionalSupport = Nothing
	End Sub
	Protected Overrides Sub Finalize()
		Class_Terminate_Renamed()
		MyBase.Finalize()
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	
	'繝ｦ繝九ャ繝亥錐遘ｰ
	
	Public Property Name() As String
		Get
			Name = strName
		End Get
		Set(ByVal Value As String)
			strName = Value
			Data = UDList.Item(Value)
			Update()
		End Set
	End Property
	
	'諢帷ｧｰ
	Public ReadOnly Property Nickname0() As String
		Get
			Dim idx As Short
			Dim u As Unit
			
			Nickname0 = Data.Nickname
			
			'諢帷ｧｰ螟画峩閭ｽ蜉帙↓繧医ｋ螟画峩
			If IsFeatureAvailable("諢帷ｧｰ螟画峩") Then
				Nickname0 = FeatureData("諢帷ｧｰ螟画峩")
				idx = InStr(Nickname0, "$(諢帷ｧｰ)")
				If idx > 0 Then
					Nickname0 = Left(Nickname0, idx - 1) & Data.Nickname & Mid(Nickname0, idx + 5)
				End If
				idx = InStr(Nickname0, "Invalid_string_refer_to_original_code")
				If idx > 0 Then
					If CountPilot > 0 Then
						Nickname0 = Left(Nickname0, idx - 1) & MainPilot.Nickname(True) & Mid(Nickname0, idx + 10)
					Else
						Nickname0 = Left(Nickname0, idx - 1) & "笳銀雷" & Mid(Nickname0, idx + 10)
					End If
				End If
			End If
			
			u = SelectedUnitForEvent
			SelectedUnitForEvent = Me
			ReplaceSubExpression(Nickname0)
			SelectedUnitForEvent = u
		End Get
	End Property
	
	'Invalid_string_refer_to_original_code
	Public ReadOnly Property Nickname() As String
		Get
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If CountPilot() > 0 Then
				With MainPilot
					If InStr(.Name, "(繧ｶ繧ｳ)") = 0 And InStr(.Name, "(豎守畑)") = 0 Then
						Nickname = MainPilot.Nickname
						Exit Property
					End If
				End With
			End If
			'End If
			Nickname = Nickname0
		End Get
	End Property
	
	'Invalid_string_refer_to_original_code
	Public ReadOnly Property KanaName() As String
		Get
			Dim idx As Short
			Dim u As Unit
			
			KanaName = Data.KanaName
			
			'隱ｭ縺ｿ莉ｮ蜷榊､画峩閭ｽ蜉帙↓繧医ｋ螟画峩
			If IsFeatureAvailable("隱ｭ縺ｿ莉ｮ蜷榊､画峩") Then
				KanaName = FeatureData("隱ｭ縺ｿ莉ｮ蜷榊､画峩")
				idx = InStr(KanaName, "Invalid_string_refer_to_original_code")
				If idx > 0 Then
					KanaName = Left(KanaName, idx - 1) & Data.KanaName & Mid(KanaName, idx + 5)
				End If
				idx = InStr(KanaName, "Invalid_string_refer_to_original_code")
				If idx > 0 Then
					If CountPilot > 0 Then
						KanaName = Left(KanaName, idx - 1) & MainPilot.KanaName & Mid(KanaName, idx + 10)
					Else
						KanaName = Left(KanaName, idx - 1) & "笳銀雷" & Mid(KanaName, idx + 10)
					End If
				End If
			ElseIf IsFeatureAvailable("諢帷ｧｰ螟画峩") Then 
				KanaName = FeatureData("諢帷ｧｰ螟画峩")
				idx = InStr(KanaName, "$(諢帷ｧｰ)")
				If idx > 0 Then
					KanaName = Left(KanaName, idx - 1) & Data.Nickname & Mid(KanaName, idx + 5)
				End If
				idx = InStr(KanaName, "Invalid_string_refer_to_original_code")
				If idx > 0 Then
					If CountPilot > 0 Then
						KanaName = Left(KanaName, idx - 1) & MainPilot.Nickname & Mid(KanaName, idx + 10)
					Else
						KanaName = Left(KanaName, idx - 1) & "笳銀雷" & Mid(KanaName, idx + 10)
					End If
				End If
				KanaName = StrToHiragana(KanaName)
			End If
			
			u = SelectedUnitForEvent
			SelectedUnitForEvent = Me
			ReplaceSubExpression(KanaName)
			SelectedUnitForEvent = u
		End Get
	End Property
	
	'繝ｦ繝九ャ繝医Λ繝ｳ繧ｯ
	
	Public Property Rank() As Short
		Get
			Rank = intRank
		End Get
		Set(ByVal Value As Short)
			Dim uname As String
			
			If intRank = Value Then
				Exit Property
			End If
			
			intRank = Value
			If intRank > 999 Then
				intRank = 999
			End If
			
			'繝代Λ繝｡繝ｼ繧ｿ繧呈峩譁ｰ
			Update()
		End Set
	End Property
	
	'繝懊せ繝ｩ繝ｳ繧ｯ
	
	Public Property BossRank() As Short
		Get
			BossRank = intBossRank
		End Get
		Set(ByVal Value As Short)
			If intBossRank = Value Then
				Exit Property
			End If
			
			intBossRank = Value
			
			'繝代Λ繝｡繝ｼ繧ｿ繧呈峩譁ｰ
			Update()
		End Set
	End Property
	
	'繝ｦ繝九ャ繝医け繝ｩ繧ｹ
	'UPGRADE_NOTE: Class は Class_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
	Public ReadOnly Property Class_Renamed() As String
		Get
			Class_Renamed = Data.Class_Renamed
		End Get
	End Property
	
	'Invalid_string_refer_to_original_code
	Public ReadOnly Property Class0() As String
		Get
			Dim i, n As Short
			
			Class0 = Data.Class_Renamed
			
			'莠ｺ髢薙Θ繝九ャ繝域欠螳壹ｒ蜑企勁
			If Left(Class0, 1) = "(" Then
				Class0 = Mid(Class0, 2, Len(Class0) - 2)
			End If
			
			'Invalid_string_refer_to_original_code
			If Right(Class0, 3) = "蟆ら畑)" Then
				n = 1
				i = Len(Class0) - 2
				Do 
					i = i - 1
					Select Case Mid(Class0, i, 1)
						Case "("
							n = n - 1
							If n = 0 Then
								Class0 = Left(Class0, i - 1)
								Exit Do
							End If
						Case ")"
							n = n + 1
					End Select
				Loop While i > 0
			End If
		End Get
	End Property
	
	
	'繝ｦ繝九ャ繝医し繧､繧ｺ
	Public ReadOnly Property Size() As String
		Get
			If IsFeatureAvailable("繧ｵ繧､繧ｺ螟画峩") Then
				Size = FeatureData("繧ｵ繧､繧ｺ螟画峩")
				Exit Property
			End If
			
			Size = Data.Size
		End Get
	End Property
	
	
	'Invalid_string_refer_to_original_code
	Public ReadOnly Property MaxHP() As Integer
		Get
			MaxHP = lngMaxHP
			
			'Invalid_string_refer_to_original_code
			If CountPilot > 0 Then
				'Invalid_string_refer_to_original_code
				If IsFeatureAvailable("髴雁鴨螟画鋤蝎ｨ") Then
					MaxHP = MaxHP + 10 * PlanaLevel()
				End If
				
				'Invalid_string_refer_to_original_code
				If IsFeatureAvailable("繧ｪ繝ｼ繝ｩ螟画鋤蝎ｨ") Then
					MaxHP = MaxHP + 100 * AuraLevel()
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			If MaxHP < 1 Then
				MaxHP = 1
			End If
		End Get
	End Property
	
	'Invalid_string_refer_to_original_code
	Public ReadOnly Property MaxEN() As Short
		Get
			MaxEN = intMaxEN
			
			'Invalid_string_refer_to_original_code
			If CountPilot > 0 Then
				'Invalid_string_refer_to_original_code
				If IsFeatureAvailable("髴雁鴨螟画鋤蝎ｨ") Then
					MaxEN = MaxEN + 0.5 * PlanaLevel()
				End If
				
				'Invalid_string_refer_to_original_code
				If IsFeatureAvailable("繧ｪ繝ｼ繝ｩ螟画鋤蝎ｨ") Then
					MaxEN = MaxEN + 10 * AuraLevel()
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			If MaxEN < 5 Then
				MaxEN = 5
			End If
		End Get
	End Property
	
	'Invalid_string_refer_to_original_code
	
	Public Property HP() As Integer
		Get
			HP = lngHP
		End Get
		Set(ByVal Value As Integer)
			lngHP = Value
			If lngHP > MaxHP Then
				lngHP = MaxHP
			ElseIf lngHP < 0 Then 
				lngHP = 0
			End If
		End Set
	End Property
	
	'Invalid_string_refer_to_original_code
	
	Public Property EN() As Integer
		Get
			EN = intEN
		End Get
		Set(ByVal Value As Integer)
			intEN = Value
			
			If intEN > MaxEN Then
				intEN = MaxEN
			ElseIf intEN < 0 Then 
				intEN = 0
			End If
		End Set
	End Property
	
	
	'遘ｻ蜍募鴨
	Public ReadOnly Property Speed0() As Short
		Get
			Speed0 = intSpeed
		End Get
	End Property
	
	Public ReadOnly Property Speed() As Short
		Get
			Speed = Speed0
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Property
			'End If
			
			'迚ｹ谿顔憾諷九↓繧医ｋ遘ｻ蜍募鴨菫ｮ豁｣
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			IsConditionSatisfied("Invalid_string_refer_to_original_code")
			If IsOptionDefined("Invalid_string_refer_to_original_code") Then
				Speed = Speed + 2
			Else
				Speed = Speed + 1
			End If
			'End If
			If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
				Speed = MaxLng(Speed \ 2, 1)
			End If
			
			'Invalid_string_refer_to_original_code
			If IsFeatureAvailable("髴雁鴨螟画鋤蝎ｨ") Then
				If CountPilot > 0 Then
					Speed = Speed + Int(0.01 * PlanaLevel())
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Speed = MaxLng(Speed \ 2, 1)
			'End If
			
			'Invalid_string_refer_to_original_code
			If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
				Speed = 0
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Select Case Area
				Case "遨ｺ荳ｭ", "Invalid_string_refer_to_original_code"
					If EN < 5 Then
						Speed = 0
					End If
				Case "蝨ｰ荳ｭ"
					If EN < 10 Then
						Speed = 0
					End If
			End Select
			'End If
		End Get
	End Property
	
	
	'Invalid_string_refer_to_original_code
	Public ReadOnly Property Transportation() As String
		Get
			Transportation = Data.Transportation
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStr(Transportation, "遨ｺ") = 0 Then
				Transportation = "遨ｺ" & Transportation
			End If
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStr(Transportation, "髯ｸ") = 0 Then
				Transportation = "髯ｸ" & Transportation
			End If
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStr(Transportation, "豌ｴ") = 0 Then
				Transportation = "豌ｴ" & Transportation
			End If
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStr(Transportation, "蝨ｰ荳ｭ") = 0 Then
				Transportation = Transportation & "蝨ｰ荳ｭ"
			End If
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If Transportation = "" Then
				Transportation = "Invalid_string_refer_to_original_code"
			End If
			'End If
		End Get
	End Property
	
	
	'Invalid_string_refer_to_original_code
	Public ReadOnly Property Adaption(ByVal idx As Short) As Short
		Get
			Dim uad, pad As Short
			
			'Invalid_string_refer_to_original_code
			Select Case Mid(strAdaption, idx, 1)
				Case "S"
					uad = 5
				Case "A"
					uad = 4
				Case "B"
					uad = 3
				Case "C"
					uad = 2
				Case "D"
					uad = 1
				Case "-"
					Adaption = 0
					Exit Property
			End Select
			
			'Invalid_string_refer_to_original_code
			If CountPilot > 0 Then
				Select Case Mid(MainPilot.Adaption, idx, 1)
					Case "S"
						pad = 5
					Case "A"
						pad = 4
					Case "B"
						pad = 3
					Case "C"
						pad = 2
					Case "D"
						pad = 1
					Case "-"
						Adaption = 0
						Exit Property
				End Select
			Else
				pad = 4
			End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			Select Case uad + pad
				Case 9, 10
					Adaption = 5
				Case 7, 8
					Adaption = 4
				Case 5, 6
					Adaption = 3
				Case 3, 4
					Adaption = 2
				Case 1, 2
					Adaption = 1
				Case Else
					Adaption = 0
			End Select
			'Invalid_string_refer_to_original_code
			If uad > pad Then
				Adaption = pad
			Else
				Adaption = uad
			End If
			'End If
		End Get
	End Property
	
	'蝨ｰ蠖｢驕ｩ蠢懊↓繧医ｋ菫ｮ豁｣蛟､
	Public ReadOnly Property AdaptionMod(ByVal idx As Short, Optional ByVal ad_mod As Short = 0) As Double
		Get
			Dim uad As Short
			
			uad = Adaption(idx)
			
			'Invalid_string_refer_to_original_code
			If uad = 5 Then
				uad = MinLng(uad + ad_mod, 5)
			Else
				uad = MinLng(uad + ad_mod, 4)
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If IsOptionDefined("蝨ｰ蠖｢驕ｩ蠢應ｿｮ豁｣郢ｰ繧贋ｸ九£") Then
				Select Case uad
					Case 5
						AdaptionMod = 1.1
					Case 4
						AdaptionMod = 1
					Case 3
						AdaptionMod = 0.9
					Case 2
						AdaptionMod = 0.8
					Case 1
						AdaptionMod = 0.7
					Case Else
						AdaptionMod = 0
				End Select
			Else
				Select Case uad
					Case 5
						AdaptionMod = 1.2
					Case 4
						AdaptionMod = 1.1
					Case 3
						AdaptionMod = 1
					Case 2
						AdaptionMod = 0.9
					Case 1
						AdaptionMod = 0.8
					Case Else
						AdaptionMod = 0
				End Select
			End If
			If IsOptionDefined("蝨ｰ蠖｢驕ｩ蠢應ｿｮ豁｣郢ｰ繧贋ｸ九£") Then
				Select Case uad
					Case 5
						AdaptionMod = 1.2
					Case 4
						AdaptionMod = 1
					Case 3
						AdaptionMod = 0.8
					Case 2
						AdaptionMod = 0.6
					Case 1
						AdaptionMod = 0.4
					Case Else
						AdaptionMod = 0
				End Select
			Else
				Select Case uad
					Case 5
						AdaptionMod = 1.4
					Case 4
						AdaptionMod = 1.2
					Case 3
						AdaptionMod = 1
					Case 2
						AdaptionMod = 0.8
					Case 1
						AdaptionMod = 0.6
					Case Else
						AdaptionMod = 0
				End Select
			End If
			'End If
		End Get
	End Property
	
	
	'Invalid_string_refer_to_original_code
	Public ReadOnly Property Armor(Optional ByVal ref_mode As String = "") As Integer
		Get
			Armor = lngArmor
			
			'Invalid_string_refer_to_original_code
			Select Case ref_mode
				Case "蝓ｺ譛ｬ蛟､"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Armor = Armor \ 2
					'End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Armor = 2 * Armor
					'End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Armor = Armor \ 2
					'End If
					Exit Property
				Case "菫ｮ豁｣蛟､"
					Armor = 0
			End Select
			
			'Invalid_string_refer_to_original_code
			If CountPilot > 0 Then
				'Invalid_string_refer_to_original_code
				If IsFeatureAvailable("髴雁鴨螟画鋤蝎ｨ") Then
					Armor = Armor + 5 * PlanaLevel()
				End If
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Armor = Armor + 100 * PsychicLevel()
			End If
			
			'Invalid_string_refer_to_original_code
			If IsFeatureAvailable("繧ｪ繝ｼ繝ｩ螟画鋤蝎ｨ") Then
				Armor = Armor + 50 * AuraLevel()
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Armor = Armor \ 2
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Armor = 2 * Armor
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Armor = Armor \ 2
			'End If
		End Get
	End Property
	
	'驕句虚諤ｧ
	Public ReadOnly Property Mobility(Optional ByVal ref_mode As String = "") As Short
		Get
			Mobility = intMobility
			
			Select Case ref_mode
				Case "蝓ｺ譛ｬ蛟､"
					Exit Property
				Case "菫ｮ豁｣蛟､"
					Mobility = 0
			End Select
			
			'Invalid_string_refer_to_original_code
			If CountPilot > 0 Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Mobility = Mobility + 5 * PsychicLevel()
			End If
			
			'Invalid_string_refer_to_original_code
			If IsFeatureAvailable("繧ｪ繝ｼ繝ｩ螟画鋤蝎ｨ") Then
				Mobility = Mobility + 2 * AuraLevel()
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If MainPilot.SynchroRate > 0 Then
				Mobility = Mobility + (SyncLevel() - 50) \ 2
			End If
			'End If
			'End If
		End Get
	End Property
	
	'Invalid_string_refer_to_original_code
	Public ReadOnly Property Bitmap(Optional ByVal use_orig As Boolean = False) As String
		Get
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Property
			'End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Property
			'End If
			
			If use_orig Then
				Bitmap = Data.Bitmap0
			Else
				Bitmap = Data.Bitmap
			End If
		End Get
	End Property
	
	'Invalid_string_refer_to_original_code
	Public ReadOnly Property Value() As Integer
		Get
			Value = Data.Value
			
			If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				Value = MaxLng(Value + 1000 * FeatureLevel("Invalid_string_refer_to_original_code"), 0)
			End If
			
			If BossRank > 0 Then
				Value = Value * (1 + 0.5 * BossRank + 0.05 * Rank)
			Else
				Value = Value * (1 + 0.05 * Rank)
			End If
		End Get
	End Property
	
	'邨碁ｨ灘､
	Public ReadOnly Property ExpValue() As Integer
		Get
			ExpValue = Data.ExpValue
			
			If IsFeatureAvailable("邨碁ｨ灘､菫ｮ豁｣") Then
				ExpValue = MaxLng(ExpValue + 10 * FeatureLevel("邨碁ｨ灘､菫ｮ豁｣"), 0)
			End If
			
			If BossRank > 0 Then
				ExpValue = ExpValue + 20 * BossRank
			End If
		End Get
	End Property
	
	'谿九ｊ陦悟虚謨ｰ
	Public ReadOnly Property Action() As Short
		Get
			If MaxAction > 0 Then
				Action = MaxLng(MaxAction - UsedAction, 0)
			Else
				Action = 0
			End If
		End Get
	End Property
	
	
	'Invalid_string_refer_to_original_code
	
	'髯｣蝟ｶ
	Public ReadOnly Property Party0() As String
		Get
			Party0 = strParty
		End Get
	End Property
	
	
	Public Property Party() As String
		Get
			Party = strParty
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Party = Master.Party
			If Party = "蜻ｳ譁ｹ" Then
				'Invalid_string_refer_to_original_code
				Party = "Invalid_string_refer_to_original_code"
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Party = Master.Party
			'End If
			
			'Invalid_string_refer_to_original_code
			If Party = "蜻ｳ譁ｹ" Then
				'Invalid_string_refer_to_original_code_
				'Or IsConditionSatisfied("雕翫ｊ") _
				'Or IsConditionSatisfied("迢よ姶螢ｫ") _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Party = "Invalid_string_refer_to_original_code"
			End If
			'End If
		End Get
		Set(ByVal Value As String)
			strParty = Value
		End Set
	End Property
	
	'Invalid_string_refer_to_original_code
	
	Public Property Mode() As String
		Get
			Dim i As Short
			
			If IsUnderSpecialPowerEffect("謖醍匱") Then
				'Invalid_string_refer_to_original_code
				For i = 1 To CountSpecialPower
					'UPGRADE_WARNING: オブジェクト SpecialPower(i).IsEffectAvailable(謖醍匱) の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
					If SpecialPower(i).IsEffectAvailable("謖醍匱") Then
						Mode = SpecialPowerData(i)
						Exit Property
					End If
				Next 
			End If
			
			'Invalid_string_refer_to_original_code_
			'Or IsConditionSatisfied("迢よ姶螢ｫ") _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			Mode = "騾壼ｸｸ"
			Exit Property
			'End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			Mode = "Invalid_string_refer_to_original_code"
			Exit Property
			'End If
			
			If IsConditionSatisfied("雕翫ｊ") Then
				'Invalid_string_refer_to_original_code
				Mode = "Invalid_string_refer_to_original_code"
				Exit Property
			End If
			
			Mode = strMode
		End Get
		Set(ByVal Value As String)
			strMode = Value
		End Set
	End Property
	
	'Invalid_string_refer_to_original_code
	Public Function IsTransAvailable(ByRef area_name As String) As Boolean
		'Invalid_string_refer_to_original_code
		If InStr(Transportation, area_name) > 0 Then
			IsTransAvailable = True
		Else
			IsTransAvailable = False
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		IsTransAvailable = True
		'End If
		'End If
	End Function
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Function CountFeature() As Short
		CountFeature = colFeature.Count()
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Feature(ByRef Index As Object) As String
		Dim fd As FeatureData
		
		fd = colFeature.Item(Index)
		Feature = fd.Name
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function FeatureName(ByRef Index As Object) As String
		FeatureName = FeatureNameInt(Index, colFeature)
	End Function
	
	Private Function FeatureNameInt(ByRef Index As Object, ByRef feature_list As Collection) As String
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		
		fd = feature_list.Item(Index)
		With fd
			'Invalid_string_refer_to_original_code
			Select Case .Name
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'"謾ｹ騾雋ｻ菫ｮ豁｣", "譛螟ｧ謾ｹ騾謨ｰ", _
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'"蜿ｬ蝟夊ｧ｣髯､繧ｳ繝槭Φ繝牙錐", "螟芽ｺｫ隗｣髯､繧ｳ繝槭Φ繝牙錐", _
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					FeatureNameInt = ""
					Exit Function
				Case "諢帷ｧｰ螟画峩", "隱ｭ縺ｿ莉ｮ蜷榊､画峩", "繧ｵ繧､繧ｺ螟画峩", "蝨ｰ蠖｢驕ｩ蠢懷､画峩", "蝨ｰ蠖｢驕ｩ蠢懷崋螳壼､画峩", "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					FeatureNameInt = ""
					Exit Function
			End Select
			
			' ADD START MARGE
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			FeatureNameInt = ""
			Exit Function
			'End If
			' ADD END MARGE
			
			If Len(.StrData) > 0 Then
				'Invalid_string_refer_to_original_code
				FeatureNameInt = ListIndex(.StrData, 1)
				If FeatureNameInt = "髱櫁｡ｨ遉ｺ" Or FeatureNameInt = "隗｣隱ｬ" Then
					FeatureNameInt = ""
				End If
			ElseIf .Level = DEFAULT_LEVEL Then 
				'Invalid_string_refer_to_original_code
				FeatureNameInt = .Name
			ElseIf .Level >= 0 Then 
				'Invalid_string_refer_to_original_code
				FeatureNameInt = .Name & "Lv" & VB6.Format(.Level)
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If CountPilot > 0 Then
					If MainPilot.HasMana() Then
						FeatureNameInt = "鬲泌鴨蠑ｷ蛹豊v" & VB6.Format(.Level)
					End If
				End If
			End If
			'Invalid_string_refer_to_original_code
			Select Case .Name
				Case "Invalid_string_refer_to_original_code"
					FeatureNameInt = "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Case "Invalid_string_refer_to_original_code"
					FeatureNameInt = "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If CountPilot > 0 Then
						If MainPilot.HasMana() Then
							FeatureNameInt = "鬲泌鴨菴惹ｸ記v" & VB6.Format(System.Math.Abs(.Level))
						End If
					End If
				Case "Invalid_string_refer_to_original_code"
					FeatureNameInt = "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Case "Invalid_string_refer_to_original_code"
					FeatureNameInt = "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Case "Invalid_string_refer_to_original_code"
					FeatureNameInt = "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Case "Invalid_string_refer_to_original_code"
					FeatureNameInt = "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Case Else
					FeatureNameInt = .Name & "Lv" & VB6.Format(.Level)
			End Select
			'End If
		End With
		Exit Function
		
ErrorHandler: 
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: オブジェクト Index の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
		FeatureNameInt = CStr(Index)
	End Function
	
	Public Function FeatureName0(ByRef Index As Object) As String
		FeatureName0 = FeatureName(Index)
		If InStr(FeatureName0, "Lv") > 0 Then
			FeatureName0 = Left(FeatureName0, InStr(FeatureName0, "Lv") - 1)
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function FeatureLevel(ByRef Index As Object) As Double
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		fd = colFeature.Item(Index)
		
		With fd
			FeatureLevel = .Level
			If .Level = DEFAULT_LEVEL Then
				FeatureLevel = 1
			End If
		End With
		Exit Function
		
ErrorHandler: 
		FeatureLevel = 0
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function FeatureData(ByRef Index As Object) As String
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		fd = colFeature.Item(Index)
		FeatureData = fd.StrData
		Exit Function
		
ErrorHandler: 
		FeatureData = ""
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function FeatureNecessarySkill(ByRef Index As Object) As String
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		fd = colFeature.Item(Index)
		FeatureNecessarySkill = fd.NecessarySkill
		Exit Function
		
ErrorHandler: 
		FeatureNecessarySkill = ""
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsFeatureAvailable(ByRef fname As String) As Boolean
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		fd = colFeature.Item(fname)
		IsFeatureAvailable = True
		Exit Function
		
ErrorHandler: 
		IsFeatureAvailable = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsFeatureLevelSpecified(ByRef Index As Object) As Boolean
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		fd = colFeature.Item(Index)
		
		If fd.Level = DEFAULT_LEVEL Then
			IsFeatureLevelSpecified = False
		Else
			IsFeatureLevelSpecified = True
		End If
		Exit Function
		
ErrorHandler: 
		IsFeatureLevelSpecified = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CountAllFeature() As Short
		CountAllFeature = colAllFeature.Count()
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AllFeature(ByRef Index As Object) As String
		Dim fd As FeatureData
		
		fd = colAllFeature.Item(Index)
		AllFeature = fd.Name
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AllFeatureName(ByRef Index As Object) As String
		AllFeatureName = FeatureNameInt(Index, colAllFeature)
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AllFeatureLevel(ByRef Index As Object) As Double
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		fd = colAllFeature.Item(Index)
		
		With fd
			AllFeatureLevel = .Level
			If .Level = DEFAULT_LEVEL Then
				AllFeatureLevel = 1
			End If
		End With
		Exit Function
		
ErrorHandler: 
		AllFeatureLevel = 0
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AllFeatureLevelSpecified(ByRef Index As Object) As Boolean
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		fd = colAllFeature.Item(Index)
		
		If fd.Level <> DEFAULT_LEVEL Then
			AllFeatureLevelSpecified = True
		End If
		Exit Function
		
ErrorHandler: 
		AllFeatureLevelSpecified = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AllFeatureData(ByRef Index As Object) As String
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		fd = colAllFeature.Item(Index)
		AllFeatureData = fd.StrData
		Exit Function
		
ErrorHandler: 
		AllFeatureData = ""
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAllFeatureLevelSpecified(ByRef Index As Object) As Boolean
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		fd = colAllFeature.Item(Index)
		
		If fd.Level = DEFAULT_LEVEL Then
			IsAllFeatureLevelSpecified = False
		Else
			IsAllFeatureLevelSpecified = True
		End If
		Exit Function
		
ErrorHandler: 
		IsAllFeatureLevelSpecified = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsFeatureActivated(ByRef Index As Object) As Boolean
		Dim fd, fd2 As FeatureData
		
		On Error GoTo ErrorHandler
		fd = colAllFeature.Item(Index)
		
		For	Each fd2 In colFeature
			If fd Is fd2 Then
				IsFeatureActivated = True
				Exit Function
			End If
		Next fd2
		
		IsFeatureActivated = False
		Exit Function
		
ErrorHandler: 
		IsFeatureActivated = False
	End Function
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Sub Update(Optional ByVal without_refresh As Boolean = False)
		Dim skipped As Object
		Dim prev_wdata() As WeaponData
		Dim prev_wbullets() As Double
		Dim prev_adata() As AbilityData
		Dim prev_astocks() As Double
		Dim l, j, i, k, num As Short
		Dim ch, buf As String
		Dim fd As FeatureData
		Dim itm As Item
		Dim stype, sdata As String
		Dim slevel As Double
		Dim stype2, sdata2 As String
		Dim slevel2 As Double
		Dim wname, wnickname As String
		Dim wnskill, wclass, wtype, sname As String
		Dim fdata As String
		Dim flen As Short
		Dim found, flag As Boolean
		Dim flags() As Boolean
		Dim with_not As Boolean
		Dim false_count As Short
		Dim uadaption(4) As Short
		Dim hp_ratio, en_ratio As Double
		Dim ubitmap As String
		Dim cnd As Condition
		Dim pmorale As Short
		Dim is_stable, is_uncontrollable, is_invisible As Boolean
		
		'Invalid_string_refer_to_original_code
		hp_ratio = 100 * HP / MaxHP
		en_ratio = 100 * EN / MaxEN
		
		'繝ｦ繝九ャ繝育畑逕ｻ蜒上ヵ繧｡繧､繝ｫ蜷阪ｒ險倬鹸縺励※縺翫￥
		ubitmap = Bitmap
		
		'Invalid_string_refer_to_original_code
		is_invisible = IsFeatureAvailable("髱櫁｡ｨ遉ｺ")
		
		'Invalid_string_refer_to_original_code
		is_uncontrollable = IsFeatureAvailable("蛻ｶ蠕｡荳榊庄")
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
TryAgain: 
		
		'Invalid_string_refer_to_original_code
		For	Each itm In colItem
			With itm
				.Activated = .IsAvailable(Me)
			End With
		Next itm
		
		'Invalid_string_refer_to_original_code
		Do While Data.IsFeatureAvailable("Invalid_string_refer_to_original_code")
			With Data
				If Rank < .FeatureLevel("Invalid_string_refer_to_original_code") Then
					Exit Do
				End If
				If Not IsNecessarySkillSatisfied(.FeatureNecessarySkill("Invalid_string_refer_to_original_code")) Then
					Exit Do
				End If
				fdata = .FeatureData("Invalid_string_refer_to_original_code")
			End With
			
			With UDList
				If Not .IsDefined(fdata) Then
					ErrorMessage(Name & "Invalid_string_refer_to_original_code")
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					TerminateSRC()
				End If
				
				Data = .Item(fdata)
			End With
		Loop 
		
		'Invalid_string_refer_to_original_code
		
		'Invalid_string_refer_to_original_code
		With colFeature
			For	Each fd In colFeature
				.Remove(1)
			Next fd
		End With
		
		'Invalid_string_refer_to_original_code
		For	Each cnd In colCondition
			With cnd
				If .Lifetime <> 0 Then
					If Right(.Name, 2) = "莉伜刈" Then
						fd = New FeatureData
						fd.Name = Left(.Name, Len(.Name) - 2)
						fd.Level = .Level
						fd.StrData = .StrData
						colFeature.Add(fd, fd.Name)
					End If
				End If
			End With
		Next cnd
		AdditionalFeaturesNum = colFeature.Count()
		
		'Invalid_string_refer_to_original_code
		AddFeatures((Data.colFeature))
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountItem
			With Item(i)
				If .Activated Then
					AddFeatures((.Data.colFeature), True)
				End If
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		If CountPilot > 0 Then
			If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				'Invalid_string_refer_to_original_code
				UpdateFeatures("Invalid_string_refer_to_original_code")
			End If
			AddFeatures((MainPilot.Data.colFeature))
			For i = 2 To CountPilot
				AddFeatures((Pilot(i).Data.colFeature))
			Next 
			For i = 1 To CountSupport
				AddFeatures((Support(i).Data.colFeature))
			Next 
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			UpdateFeatures("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			AddFeatures((AdditionalSupport.Data.colFeature))
		End If
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		i = 1
		Do While i <= CountCondition
			Select Case Right(Condition(i), 3)
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					DeleteCondition(i)
				Case Else
					i = i + 1
			End Select
		Loop 
		
		'Invalid_string_refer_to_original_code
		found = False
		flag = False
		ReDim flags(colFeature.Count())
AddSkills: 
		i = 1
		For	Each fd In colFeature
			If flags(i) Then
				GoTo NextFeature
			End If
			With fd
				Select Case .Name
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						If Not IsNecessarySkillSatisfied(.NecessarySkill) Then
							found = True
							GoTo NextFeature
						End If
						'Invalid_string_refer_to_original_code
						If Not IsNecessarySkillSatisfied(.NecessaryCondition) Then
							found = True
							GoTo NextFeature
						End If
						flags(i) = True
						
						'Invalid_string_refer_to_original_code
						If Asc(.StrData) = 34 Then '"
							buf = Mid(.StrData, 2, Len(.StrData) - 2)
						Else
							buf = .StrData
						End If
						
						'Invalid_string_refer_to_original_code
						If InStr(buf, "=") > 0 Then
							sdata = Mid(buf, InStr(buf, "=") + 1)
							buf = Left(buf, InStr(buf, "=") - 1)
							If InStr(buf, "Lv") > 0 Then
								stype = Left(buf, InStr(buf, "Lv") - 1)
								If IsNumeric(Mid(buf, InStr(buf, "Lv") + 2)) Then
									slevel = CDbl(Mid(buf, InStr(buf, "Lv") + 2))
								Else
									slevel = 1
								End If
							Else
								stype = buf
								slevel = DEFAULT_LEVEL
							End If
						Else
							sdata = ""
							If InStr(buf, "Lv") > 0 Then
								stype = Left(buf, InStr(buf, "Lv") - 1)
								If IsNumeric(Mid(buf, InStr(buf, "Lv") + 2)) Then
									slevel = CDbl(Mid(buf, InStr(buf, "Lv") + 2))
								Else
									slevel = 1
								End If
							Else
								stype = buf
								slevel = DEFAULT_LEVEL
							End If
						End If
						
						'Invalid_string_refer_to_original_code
						If ALDList.IsDefined(stype) Then
							With ALDList.Item(stype)
								For j = 1 To .Count
									'Invalid_string_refer_to_original_code
									stype2 = .AliasType(j)
									
									If LIndex(.AliasData(j), 1) = "隗｣隱ｬ" Then
										'Invalid_string_refer_to_original_code
										If sdata <> "" Then
											stype2 = LIndex(sdata, 1)
										End If
										slevel2 = DEFAULT_LEVEL
										sdata2 = .AliasData(j)
									Else
										'Invalid_string_refer_to_original_code
										If .AliasLevelIsPlusMod(j) Then
											If slevel = DEFAULT_LEVEL Then
												slevel = 1
											End If
											slevel2 = slevel + .AliasLevel(j)
										ElseIf .AliasLevelIsMultMod(j) Then 
											If slevel = DEFAULT_LEVEL Then
												slevel = 1
											End If
											slevel2 = slevel * .AliasLevel(j)
										ElseIf slevel <> DEFAULT_LEVEL Then 
											slevel2 = slevel
										Else
											slevel2 = .AliasLevel(j)
										End If
										
										sdata2 = .AliasData(j)
										If sdata <> "" Then
											If InStr(sdata2, "髱櫁｡ｨ遉ｺ") <> 1 Then
												sdata2 = sdata & " " & ListTail(sdata2, LLength(sdata) + 1)
											End If
										End If
										
										If .AliasLevelIsPlusMod(j) Or .AliasLevelIsMultMod(j) Then
											sdata2 = LIndex(sdata2, 1) & "Lv" & VB6.Format(slevel) & " " & ListTail(sdata2, 2)
											sdata2 = Trim(sdata2)
										End If
									End If
									
									'Invalid_string_refer_to_original_code
									If ConditionLifetime(stype2 & "Invalid_string_refer_to_original_code") > 0 Then
										GoTo NextFeature
									End If
									AddCondition(stype2 & "Invalid_string_refer_to_original_code")
								Next 
							End With
						Else
							'Invalid_string_refer_to_original_code
							If ConditionLifetime(stype & "Invalid_string_refer_to_original_code") > 0 Then
								GoTo NextFeature
							End If
							AddCondition(stype & "Invalid_string_refer_to_original_code")
						End If
						
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						If Not IsNecessarySkillSatisfied(.NecessarySkill) Then
							found = True
							GoTo NextFeature
						End If
						'Invalid_string_refer_to_original_code
						If Not IsNecessarySkillSatisfied(.NecessaryCondition) Then
							found = True
							GoTo NextFeature
						End If
						flags(i) = True
						
						'Invalid_string_refer_to_original_code
						If Asc(.StrData) = 34 Then '"
							buf = Mid(.StrData, 2, Len(.StrData) - 2)
						Else
							buf = .StrData
						End If
						
						'Invalid_string_refer_to_original_code
						If InStr(buf, "=") > 0 Then
							sdata = Mid(buf, InStr(buf, "=") + 1)
							buf = Left(buf, InStr(buf, "=") - 1)
							If InStr(buf, "Lv") > 0 Then
								stype = Left(buf, InStr(buf, "Lv") - 1)
								If IsNumeric(Mid(buf, InStr(buf, "Lv") + 2)) Then
									slevel = CDbl(Mid(buf, InStr(buf, "Lv") + 2))
								Else
									slevel = 1
								End If
							Else
								stype = buf
								slevel = 1
							End If
						Else
							sdata = ""
							If InStr(buf, "Lv") > 0 Then
								stype = Left(buf, InStr(buf, "Lv") - 1)
								If IsNumeric(Mid(buf, InStr(buf, "Lv") + 2)) Then
									slevel = CDbl(Mid(buf, InStr(buf, "Lv") + 2))
								Else
									slevel = 1
								End If
							Else
								stype = buf
								slevel = 1
							End If
						End If
						
						'Invalid_string_refer_to_original_code
						If ALDList.IsDefined(stype) Then
							With ALDList.Item(stype)
								For j = 1 To .Count
									'Invalid_string_refer_to_original_code
									stype2 = .AliasType(j)
									
									'Invalid_string_refer_to_original_code
									If ConditionLifetime(stype2 & "Invalid_string_refer_to_original_code") > 0 Then
										GoTo NextFeature
									End If
									If LIndex(.AliasData(j), 1) = "隗｣隱ｬ" Then
										'Invalid_string_refer_to_original_code
										If sdata <> "" Then
											stype2 = LIndex(sdata, 1)
										End If
										slevel2 = DEFAULT_LEVEL
										sdata2 = .AliasData(j)
										'Invalid_string_refer_to_original_code
										If ConditionLifetime(stype2 & "Invalid_string_refer_to_original_code") > 0 Then
											GoTo NextFeature
										End If
										AddCondition(stype2 & "Invalid_string_refer_to_original_code")
									Else
										'Invalid_string_refer_to_original_code
										If .AliasLevelIsMultMod(j) Then
											If slevel = DEFAULT_LEVEL Then
												slevel = 1
											End If
											slevel2 = slevel * .AliasLevel(j)
										ElseIf slevel <> DEFAULT_LEVEL Then 
											slevel2 = slevel
										Else
											slevel2 = .AliasLevel(j)
										End If
										
										sdata2 = .AliasData(j)
										If sdata <> "" Then
											If InStr(sdata2, "髱櫁｡ｨ遉ｺ") <> 1 Then
												sdata2 = sdata & " " & ListTail(sdata2, LLength(sdata) + 1)
											End If
										End If
										
										'Invalid_string_refer_to_original_code
										'Invalid_string_refer_to_original_code
										'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
										'Invalid_string_refer_to_original_code
										'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
										DeleteCondition(stype2 & "Invalid_string_refer_to_original_code")
									End If
									
									AddCondition(stype2 & "Invalid_string_refer_to_original_code")
								Next 
							End With
						End If
				End Select
			End With
		Next fd
		'End With
		Dim hidden_attr As String
		'UPGRADE_NOTE: rate は rate_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
		Dim rate_Renamed As Double
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		DeleteCondition(stype & "Invalid_string_refer_to_original_code")
		'End If
		
		AddCondition(stype & "Invalid_string_refer_to_original_code")
		'End If
		'End Select
		'End With
NextFeature: 
		i = i + 1
		'Next
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If Not flag And found Then
			flag = True
			GoTo AddSkills
		End If
		
		'Invalid_string_refer_to_original_code
		UpdateFeatures()
		
		'Invalid_string_refer_to_original_code
		found = False
		For	Each itm In colItem
			With itm
				If .Activated <> .IsAvailable(Me) Then
					found = True
					Exit For
				End If
			End With
		Next itm
		If found Then
			'Invalid_string_refer_to_original_code
			GoTo TryAgain
		End If
		
		'Invalid_string_refer_to_original_code
		With Data
			If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				If Rank >= .FeatureLevel("Invalid_string_refer_to_original_code") Then
					If IsNecessarySkillSatisfied(.FeatureNecessarySkill("Invalid_string_refer_to_original_code")) Then
						'Invalid_string_refer_to_original_code
						GoTo TryAgain
					End If
				End If
			End If
		End With
		
		If CountPilot > 0 Then
			'Invalid_string_refer_to_original_code
			For i = 2 To CountPilot
				Pilot(i).Update()
			Next 
			For i = 1 To CountSupport
				Support(i).Update()
			Next 
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			Pilot(1).Update()
			If Not MainPilot Is Pilot(1) Then
				MainPilot.Update()
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If BitmapID <> 0 Then
			If ubitmap <> Bitmap Then
				BitmapID = MakeUnitBitmap(Me)
				For i = 1 To CountOtherForm
					OtherForm(i).BitmapID = 0
				Next 
				If Not without_refresh Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If Not IsPictureVisible And MapFileName <> "" Then
						PaintUnitBitmap(Me)
					End If
				End If
			End If
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If is_invisible <> IsFeatureAvailable("髱櫁｡ｨ遉ｺ") Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If Not IsPictureVisible And MapFileName <> "" Then
				BitmapID = MakeUnitBitmap(Me)
				If IsFeatureAvailable("髱櫁｡ｨ遉ｺ") Then
					EraseUnitBitmap(x, y, Not without_refresh)
				Else
					If Not without_refresh Then
						PaintUnitBitmap(Me)
					End If
				End If
			End If
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		With Data
			lngMaxHP = .HP + 200 * CInt(Rank)
			intMaxEN = .EN + 10 * Rank
			lngArmor = .Armor + 100 * CInt(Rank)
			intMobility = .Mobility + 5 * Rank
			intSpeed = .Speed
		End With
		
		'繝懊せ繝ｩ繝ｳ繧ｯ縺ｫ繧医ｋ菫ｮ豁｣
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Select Case BossRank
			Case 1
				lngMaxHP = lngMaxHP + Data.HP
			Case 2
				lngMaxHP = lngMaxHP + Data.HP + 10000
			Case 3
				lngMaxHP = lngMaxHP + Data.HP + 20000
			Case 4
				lngMaxHP = lngMaxHP + Data.HP + 40000
			Case 5
				lngMaxHP = lngMaxHP + Data.HP + 80000
		End Select
		
		If BossRank > 0 Then
			lngArmor = lngArmor + 200 * BossRank
		End If
		Select Case BossRank
			Case 1
				lngMaxHP = lngMaxHP + 0.5 * Data.HP
			Case 2
				lngMaxHP = lngMaxHP + Data.HP
			Case 3
				lngMaxHP = lngMaxHP + Data.HP + 10000
			Case 4
				lngMaxHP = lngMaxHP + Data.HP + 20000
			Case 5
				lngMaxHP = lngMaxHP + Data.HP + 40000
		End Select
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If BossRank > 0 Then
			lngArmor = lngArmor + 300 * BossRank
		End If
		Select Case BossRank
			Case 1
				lngArmor = lngArmor + 300
			Case 2
				lngArmor = lngArmor + 600
			Case 3
				lngArmor = lngArmor + 1000
			Case 4
				lngArmor = lngArmor + 1500
			Case 5
				lngArmor = lngArmor + 2500
		End Select
		'End If
		'End If
		If BossRank > 0 Then
			intMaxEN = intMaxEN + 20 * BossRank
			intMobility = intMobility + 5 * BossRank
		End If
		
		'Invalid_string_refer_to_original_code
		If IsOptionDefined("Invalid_string_refer_to_original_code") Then
			If CountPilot > 0 Then
				lngMaxHP = MinLng((lngMaxHP / 100) * (100 + MainPilot.Level), 9999999)
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If IsOptionDefined("Invalid_string_refer_to_original_code") Then
			If CountPilot > 0 Then
				intMaxEN = MinLng((intMaxEN / 100) * (100 + MainPilot.Level), 9999)
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If CountPilot > 0 Then
			pmorale = MainPilot.Morale
		Else
			pmorale = 100
		End If
		For	Each fd In colFeature
			With fd
				Select Case .Name
					'Invalid_string_refer_to_original_code
					Case "Invalid_string_refer_to_original_code"
						If pmorale >= StrToLng(LIndex(.StrData, 2)) Then
							lngMaxHP = lngMaxHP + 200 * .Level
						End If
					Case "Invalid_string_refer_to_original_code"
						If pmorale >= StrToLng(LIndex(.StrData, 2)) Then
							intMaxEN = intMaxEN + 10 * .Level
						End If
					Case "Invalid_string_refer_to_original_code"
						If pmorale >= StrToLng(LIndex(.StrData, 2)) Then
							lngArmor = lngArmor + 100 * .Level
						End If
					Case "Invalid_string_refer_to_original_code"
						If pmorale >= StrToLng(LIndex(.StrData, 2)) Then
							intMobility = intMobility + 5 * .Level
						End If
					Case "Invalid_string_refer_to_original_code"
						If pmorale >= StrToLng(LIndex(.StrData, 2)) Then
							intSpeed = intSpeed + .Level
						End If
						'Invalid_string_refer_to_original_code
					Case "Invalid_string_refer_to_original_code"
						If pmorale >= StrToLng(LIndex(.StrData, 2)) Then
							lngMaxHP = lngMaxHP + Data.HP * .Level \ 20
						End If
					Case "Invalid_string_refer_to_original_code"
						If pmorale >= StrToLng(LIndex(.StrData, 2)) Then
							intMaxEN = intMaxEN + Data.EN * .Level \ 20
						End If
					Case "Invalid_string_refer_to_original_code"
						If pmorale >= StrToLng(LIndex(.StrData, 2)) Then
							lngArmor = lngArmor + Data.Armor * .Level \ 20
						End If
					Case "Invalid_string_refer_to_original_code"
						If pmorale >= StrToLng(LIndex(.StrData, 2)) Then
							intMobility = intMobility + Data.Mobility * .Level \ 20
						End If
				End Select
			End With
		Next fd
		
		'Invalid_string_refer_to_original_code
		For	Each itm In colItem
			With itm
				If .Activated Then
					lngMaxHP = lngMaxHP + .HP
					intMaxEN = intMaxEN + .EN
					lngArmor = lngArmor + .Armor
					intMobility = intMobility + .Mobility
					intSpeed = intSpeed + .Speed
				End If
			End With
		Next itm
		
		'Invalid_string_refer_to_original_code
		num = 0
		If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
			Select Case FeatureData("Invalid_string_refer_to_original_code")
				Case "蜈ｨ", "Invalid_string_refer_to_original_code"
					num = num + 1
			End Select
		End If
		For	Each itm In colItem
			With itm
				If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
					Select Case .FeatureData("Invalid_string_refer_to_original_code")
						Case "蜈ｨ", "Invalid_string_refer_to_original_code"
							num = num + 1
					End Select
				End If
			End With
		Next itm
		If CountPilot > 0 Then
			With MainPilot.Data
				If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
					Select Case .FeatureData("Invalid_string_refer_to_original_code")
						Case "蜈ｨ", "Invalid_string_refer_to_original_code"
							num = num + 1
					End Select
				End If
			End With
		End If
		If num > 0 Then
			With Data
				lngMaxHP = lngMaxHP + 100 * num * (.ItemNum + 1)
				intMaxEN = intMaxEN + 20 * num * .ItemNum
				lngArmor = lngArmor + 50 * num * .ItemNum
				intMobility = intMobility + 5 * num * .ItemNum
			End With
		End If
		
		'霑ｽ蜉遘ｻ蜍募鴨
		If IsFeatureAvailable("霑ｽ蜉遘ｻ蜍募鴨") Then
			For	Each fd In colFeature
				With fd
					If .Name = "霑ｽ蜉遘ｻ蜍募鴨" Then
						If Area = LIndex(.StrData, 2) Then
							intSpeed = intSpeed + .Level
						End If
					End If
				End With
			Next fd
			intSpeed = MaxLng(intSpeed, 0)
		End If
		
		'Invalid_string_refer_to_original_code
		lngMaxHP = MinLng(lngMaxHP, 9999999)
		intMaxEN = MinLng(intMaxEN, 9999)
		lngArmor = MinLng(lngArmor, 99999)
		intMobility = MinLng(intMobility, 9999)
		intSpeed = MinLng(intSpeed, 99)
		
		'Invalid_string_refer_to_original_code
		HP = MaxHP * hp_ratio / 100
		EN = MaxEN * en_ratio / 100
		
		'Invalid_string_refer_to_original_code
		If hp_ratio > 0 Then
			If HP = 0 Then
				HP = 1
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To 4
			Select Case Mid(Data.Adaption, i, 1)
				Case "S"
					uadaption(i) = 5
				Case "A"
					uadaption(i) = 4
				Case "B"
					uadaption(i) = 3
				Case "C"
					uadaption(i) = 2
				Case "D"
					uadaption(i) = 1
				Case "E", "-"
					uadaption(i) = 0
			End Select
		Next 
		
		'遘ｻ蜍輔ち繧､繝苓ｿｽ蜉縺ｫ繧医ｋ蝨ｰ蠖｢驕ｩ蠢應ｿｮ豁｣
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		uadaption(1) = MaxLng(uadaption(1), 4)
		'End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		uadaption(2) = MaxLng(uadaption(2), 4)
		'End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		uadaption(3) = MaxLng(uadaption(3), 4)
		'End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		uadaption(4) = MaxLng(uadaption(4), 4)
		'End If
		
		'蝨ｰ蠖｢驕ｩ蠢懷､画峩閭ｽ蜉帙↓繧医ｋ菫ｮ豁｣
		For	Each fd In colFeature
			With fd
				Select Case .Name
					Case "蝨ｰ蠖｢驕ｩ蠢懷､画峩"
						For i = 1 To 4
							num = StrToLng(LIndex(.StrData, i))
							If num > 0 Then
								If uadaption(i) < 4 Then
									uadaption(i) = uadaption(i) + num
									'Invalid_string_refer_to_original_code
									If uadaption(i) > 4 Then
										uadaption(i) = 4
									End If
								End If
							Else
								uadaption(i) = uadaption(i) + num
							End If
						Next 
					Case "蝨ｰ蠖｢驕ｩ蠢懷崋螳壼､画峩"
						For i = 1 To 4
							num = StrToLng(LIndex(.StrData, i))
							If LIndex(.StrData, 5) = "蠑ｷ蛻ｶ" Then
								'Invalid_string_refer_to_original_code
								If num >= 0 And num <= 5 Then
									uadaption(i) = num
								End If
							Else
								'Invalid_string_refer_to_original_code
								If num > uadaption(i) And num <= 5 Then
									uadaption(i) = num
								End If
							End If
						Next 
				End Select
			End With
		Next fd
		strAdaption = ""
		For i = 1 To 4
			Select Case uadaption(i)
				Case Is >= 5
					strAdaption = strAdaption & "S"
				Case 4
					strAdaption = strAdaption & "A"
				Case 3
					strAdaption = strAdaption & "B"
				Case 2
					strAdaption = strAdaption & "C"
				Case 1
					strAdaption = strAdaption & "D"
				Case Is <= 0
					strAdaption = strAdaption & "-"
			End Select
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		Select Case TerrainClass(x, y)
			Case "髯ｸ", "Invalid_string_refer_to_original_code"
				Area = "Invalid_string_refer_to_original_code"
			Case "豌ｴ", "豺ｱ豌ｴ"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Area = "Invalid_string_refer_to_original_code"
				Area = "豌ｴ荳ｭ"
				'End If
		End Select
		If Not without_refresh Then
			If Not IsPictureVisible And MapFileName <> "" Then
				PaintUnitBitmap(Me)
			End If
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		strAbsorb = ""
		strImmune = ""
		strResist = ""
		strWeakness = ""
		strEffective = ""
		strSpecialEffectImmune = ""
		'Invalid_string_refer_to_original_code
		For	Each fd In colFeature
			With fd
				Select Case .Name
					Case "Invalid_string_refer_to_original_code"
						strAbsorb = strAbsorb & .StrData
					Case "Invalid_string_refer_to_original_code"
						strImmune = strImmune & .StrData
					Case "閠先ｧ"
						strResist = strResist & .StrData
					Case "蠑ｱ轤ｹ"
						strWeakness = strWeakness & .StrData
					Case "譛牙柑"
						strEffective = strEffective & .StrData
					Case "Invalid_string_refer_to_original_code"
						strSpecialEffectImmune = strSpecialEffectImmune & .StrData
				End Select
			End With
		Next fd
		'Invalid_string_refer_to_original_code
		For i = 1 To CountCondition
			If ConditionLifetime(i) <> 0 Then
				ch = Condition(i)
				Select Case Right(ch, 6)
					Case "螻樊ｧ蠑ｱ轤ｹ莉伜刈"
						strWeakness = strWeakness & Left(ch, Len(ch) - 6)
					Case "螻樊ｧ譛牙柑莉伜刈"
						strEffective = strEffective & Left(ch, Len(ch) - 6)
				End Select
			End If
		Next 
		'螻樊ｧ縺ｮ繝繝悶ｊ繧偵↑縺上☆
		buf = ""
		For i = 1 To Len(strAbsorb)
			ch = GetClassBundle(strAbsorb, i)
			If InStrNotNest(buf, ch) = 0 Then
				buf = buf & ch
			End If
		Next 
		strAbsorb = buf
		buf = ""
		For i = 1 To Len(strImmune)
			ch = GetClassBundle(strImmune, i)
			If InStrNotNest(buf, ch) = 0 Then
				buf = buf & ch
			End If
		Next 
		strImmune = buf
		buf = ""
		For i = 1 To Len(strResist)
			ch = GetClassBundle(strResist, i)
			If InStrNotNest(buf, ch) = 0 Then
				buf = buf & ch
			End If
		Next 
		strResist = buf
		buf = ""
		For i = 1 To Len(strWeakness)
			ch = GetClassBundle(strWeakness, i)
			If InStrNotNest(buf, ch) = 0 Then
				buf = buf & ch
			End If
		Next 
		strWeakness = buf
		buf = ""
		For i = 1 To Len(strEffective)
			ch = GetClassBundle(strEffective, i)
			If InStrNotNest(buf, ch) = 0 Then
				buf = buf & ch
			End If
		Next 
		strEffective = buf
		buf = ""
		For i = 1 To Len(strSpecialEffectImmune)
			ch = GetClassBundle(strSpecialEffectImmune, i)
			If InStrNotNest(buf, ch) = 0 Then
				buf = buf & ch
			End If
		Next 
		strSpecialEffectImmune = buf
		
		'Invalid_string_refer_to_original_code
		ReDim prev_wdata(UBound(WData))
		ReDim prev_wbullets(UBound(WData))
		For i = 1 To UBound(WData)
			prev_wdata(i) = WData(i)
			prev_wbullets(i) = dblBullet(i)
		Next 
		With Data
			ReDim WData(.CountWeapon)
			For i = 1 To .CountWeapon
				WData(i) = .Weapon(i)
			Next 
		End With
		If CountPilot > 0 Then
			With MainPilot.Data
				For i = 1 To .CountWeapon
					ReDim Preserve WData(UBound(WData) + 1)
					WData(UBound(WData)) = .Weapon(i)
				Next 
			End With
			For i = 2 To CountPilot
				With Pilot(i).Data
					For j = 1 To .CountWeapon
						ReDim Preserve WData(UBound(WData) + 1)
						WData(UBound(WData)) = .Weapon(j)
					Next 
				End With
			Next 
			For i = 1 To CountSupport
				With Support(i).Data
					For j = 1 To .CountWeapon
						ReDim Preserve WData(UBound(WData) + 1)
						WData(UBound(WData)) = .Weapon(j)
					Next 
				End With
			Next 
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			With AdditionalSupport.Data
				For i = 1 To .CountWeapon
					ReDim Preserve WData(UBound(WData) + 1)
					WData(UBound(WData)) = .Weapon(i)
				Next 
			End With
		End If
		'End If
		For	Each itm In colItem
			With itm
				If .Activated Then
					For i = 1 To .CountWeapon
						ReDim Preserve WData(UBound(WData) + 1)
						WData(UBound(WData)) = .Weapon(i)
					Next 
				End If
			End With
		Next itm
		
		'豁ｦ蝎ｨ螻樊ｧ繧呈峩譁ｰ
		ReDim strWeaponClass(CountWeapon)
		For i = 1 To CountWeapon
			strWeaponClass(i) = Weapon(i).Class_Renamed
		Next 
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			For i = 1 To CountWeapon
				With Weapon(i)
					wname = .Name
					wnickname = WeaponNickname(i)
					wnskill = .NecessarySkill
				End With
				wclass = strWeaponClass(i)
				
				'Invalid_string_refer_to_original_code
				If InStrNotNest(wclass, "|") > 0 Then
					strWeaponClass(i) = Left(wclass, InStrNotNest(wclass, "|") - 1)
					hidden_attr = Mid(wclass, InStrNotNest(wclass, "|") + 1)
				Else
					hidden_attr = ""
				End If
				
				For j = 1 To CountFeature
					If Feature(j) = "Invalid_string_refer_to_original_code" Then
						fdata = FeatureData(j)
						
						'Invalid_string_refer_to_original_code
						If Left(fdata, 1) = """" Then
							fdata = Mid(fdata, 2, Len(fdata) - 2)
						End If
						
						flen = LLength(fdata)
						
						If flen = 1 Then
							'Invalid_string_refer_to_original_code
							flag = True
							k = 2
						ElseIf LIndex(fdata, 1) = "髱櫁｡ｨ遉ｺ" Then 
							'Invalid_string_refer_to_original_code
							If flen = 2 Then
								'Invalid_string_refer_to_original_code
								flag = True
							Else
								'Invalid_string_refer_to_original_code
								flag = False
							End If
							k = 3
						Else
							'Invalid_string_refer_to_original_code
							flag = False
							k = 2
						End If
						
						'Invalid_string_refer_to_original_code
						false_count = 0
						Do While k <= flen
							wtype = LIndex(fdata, k)
							
							If Left(wtype, 1) = "!" Then
								wtype = Mid(wtype, 2)
								with_not = True
							Else
								with_not = False
							End If
							
							found = False
							Select Case wtype
								Case "蜈ｨ"
									found = True
								Case "迚ｩ"
									'Invalid_string_refer_to_original_code_
									'Or InStrNotNest(wclass, "鬲疲ｭｦ") > 0 _
									'Invalid_string_refer_to_original_code_
									'Or InStrNotNest(wclass, "鬲疲磁") > 0 _
									'Or InStrNotNest(wclass, "鬲秘潟") > 0 _
									'Invalid_string_refer_to_original_code_
									'Then
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									found = True
							End Select
						Loop 
					End If
					'UPGRADE_WARNING: Update に変換されていないステートメントがあります。ソース コードを確認してください。
				Next 
			Next 
		End If
		'End If
		'End If
		'Next
		
		'髱櫁｡ｨ遉ｺ縺ｮ螻樊ｧ繧定ｿｽ蜉
		If Len(hidden_attr) > 0 Then
			strWeaponClass(i) = strWeaponClass(i) & "|" & hidden_attr
		End If
		'Next
		'End If
		
		'Invalid_string_refer_to_original_code
		ReDim lngWeaponPower(CountWeapon)
		
		'Invalid_string_refer_to_original_code
		num = 0
		If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
			Select Case FeatureData("Invalid_string_refer_to_original_code")
				Case "蜈ｨ", "豁ｦ蝎ｨ"
					num = num + 1
			End Select
		End If
		For	Each itm In colItem
			With itm
				If .Activated Then
					If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						Select Case .FeatureData("Invalid_string_refer_to_original_code")
							Case "蜈ｨ", "豁ｦ蝎ｨ"
								num = num + 1
						End Select
					End If
				End If
			End With
		Next itm
		If CountPilot > 0 Then
			With MainPilot.Data
				If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
					Select Case .FeatureData("Invalid_string_refer_to_original_code")
						Case "蜈ｨ", "豁ｦ蝎ｨ"
							num = num + 1
					End Select
				End If
			End With
		End If
		num = num * Data.ItemNum
		
		For i = 1 To CountWeapon
			lngWeaponPower(i) = Weapon(i).Power
			
			'Invalid_string_refer_to_original_code
			If lngWeaponPower(i) = 0 Then
				GoTo NextWeapon
			End If
			
			'豁ｦ蝎ｨ蠑ｷ蛹悶↓繧医ｋ菫ｮ豁｣
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			With Weapon(i)
				wname = .Name
				wnickname = WeaponNickname(i)
				wnskill = .NecessarySkill
			End With
			wclass = strWeaponClass(i)
			
			For j = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				fdata = FeatureData(j)
				
				'Invalid_string_refer_to_original_code
				If Left(fdata, 1) = """" Then
					fdata = Mid(fdata, 2, Len(fdata) - 2)
				End If
				
				flen = LLength(fdata)
				flag = False
				
				'Invalid_string_refer_to_original_code
				If flen = 0 Then
					flag = True
				End If
				
				'Invalid_string_refer_to_original_code
				false_count = 0
				For k = 1 To flen
					wtype = LIndex(fdata, k)
					
					If Left(wtype, 1) = "!" Then
						wtype = Mid(wtype, 2)
						with_not = True
					Else
						with_not = False
					End If
					
					found = False
					If IsWeaponClassifiedAs(i, "蝗ｺ") Then
						'Invalid_string_refer_to_original_code
						'Invalid_string_refer_to_original_code
						If wtype = "蝗ｺ" Or wname = wtype Or wnickname = wtype Then
							found = True
						End If
					Else
						Select Case wtype
							Case "蜈ｨ"
								found = True
							Case "迚ｩ"
								'Invalid_string_refer_to_original_code_
								'Or InStrNotNest(wclass, "鬲疲ｭｦ") > 0 _
								'Invalid_string_refer_to_original_code_
								'Or InStrNotNest(wclass, "鬲疲磁") > 0 _
								'Or InStrNotNest(wclass, "鬲秘潟") > 0 _
								'Invalid_string_refer_to_original_code_
								'Then
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								found = True
						End Select
					End If
					'UPGRADE_WARNING: Update に変換されていないステートメントがあります。ソース コードを確認してください。
				Next 
				
				If flag Or false_count = 0 Then
					lngWeaponPower(i) = lngWeaponPower(i) + 100 * FeatureLevel(j)
				End If
				'End If
			Next 
			'End If
			
			' ADD START MARGE
			'豁ｦ蝎ｨ蜑ｲ蜷亥ｼｷ蛹悶↓繧医ｋ菫ｮ豁｣
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			With Weapon(i)
				wname = .Name
				wnickname = WeaponNickname(i)
				wnskill = .NecessarySkill
			End With
			wclass = strWeaponClass(i)
			
			For j = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				fdata = FeatureData(j)
				
				'Invalid_string_refer_to_original_code
				If Left(fdata, 1) = """" Then
					fdata = Mid(fdata, 2, Len(fdata) - 2)
				End If
				
				flen = LLength(fdata)
				flag = False
				
				'Invalid_string_refer_to_original_code
				If flen = 0 Then
					flag = True
				End If
				
				'Invalid_string_refer_to_original_code
				false_count = 0
				For k = 1 To flen
					wtype = LIndex(fdata, k)
					
					If Left(wtype, 1) = "!" Then
						wtype = Mid(wtype, 2)
						with_not = True
					Else
						with_not = False
					End If
					
					found = False
					If IsWeaponClassifiedAs(i, "蝗ｺ") Then
						'Invalid_string_refer_to_original_code
						'Invalid_string_refer_to_original_code
						If wtype = "蝗ｺ" Or wname = wtype Or wnickname = wtype Then
							found = True
						End If
					Else
						Select Case wtype
							Case "蜈ｨ"
								found = True
							Case "迚ｩ"
								'Invalid_string_refer_to_original_code_
								'Or InStrNotNest(wclass, "鬲疲ｭｦ") > 0 _
								'Invalid_string_refer_to_original_code_
								'Or InStrNotNest(wclass, "鬲疲磁") > 0 _
								'Or InStrNotNest(wclass, "鬲秘潟") > 0 _
								'Invalid_string_refer_to_original_code_
								'Then
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								found = True
						End Select
					End If
					'UPGRADE_WARNING: Update に変換されていないステートメントがあります。ソース コードを確認してください。
				Next 
				
				If flag Or false_count = 0 Then
					lngWeaponPower(i) = lngWeaponPower(i) + Weapon(i).Power * FeatureLevel(j) \ 20
				End If
				'End If
			Next 
			'End If
			' ADD END MARGE
			
			'繝繝｡繝ｼ繧ｸ蝗ｺ螳壽ｭｦ蝎ｨ
			If IsWeaponClassifiedAs(i, "蝗ｺ") Then
				GoTo NextWeapon
			End If
			
			If IsWeaponClassifiedAs(i, "Invalid_string_refer_to_original_code") Then
				'Invalid_string_refer_to_original_code
				If IsWeaponLevelSpecified(i, "Invalid_string_refer_to_original_code") Then
					'Invalid_string_refer_to_original_code
					lngWeaponPower(i) = lngWeaponPower(i) + 10 * WeaponLevel(i, "Invalid_string_refer_to_original_code") * CInt(Rank + num)
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code_
					'Or IsWeaponClassifiedAs(i, "繧ｷ") _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					lngWeaponPower(i) = lngWeaponPower(i) + 10 * (10 - WeaponLevel(i, "Invalid_string_refer_to_original_code")) * CInt(Rank + num)
					
					'繧ｪ繝ｼ繝ｩ謚
					If IsWeaponClassifiedAs(i, "繧ｪ") Then
						lngWeaponPower(i) = lngWeaponPower(i) + 10 * WeaponLevel(i, "Invalid_string_refer_to_original_code") * AuraLevel()
					End If
					
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					lngWeaponPower(i) = lngWeaponPower(i) + 10 * WeaponLevel(i, "Invalid_string_refer_to_original_code") * PsychicLevel()
				End If
				
				'Invalid_string_refer_to_original_code
				If IsWeaponClassifiedAs(i, "繧ｷ") Then
					If CountPilot() > 0 Then
						If MainPilot.SynchroRate > 0 Then
							lngWeaponPower(i) = lngWeaponPower(i) + 15 * WeaponLevel(i, "Invalid_string_refer_to_original_code") * (SyncLevel() - 50) \ 10
						End If
					End If
				End If
			End If
			'Invalid_string_refer_to_original_code
			lngWeaponPower(i) = lngWeaponPower(i) + 50 * CInt(Rank + num)
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Or IsWeaponClassifiedAs(i, "繧ｷ") _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			lngWeaponPower(i) = lngWeaponPower(i) + 50 * CInt(Rank + num)
			
			'繧ｪ繝ｼ繝ｩ謚
			If IsWeaponClassifiedAs(i, "繧ｪ") Then
				lngWeaponPower(i) = lngWeaponPower(i) + 50 * AuraLevel()
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			lngWeaponPower(i) = lngWeaponPower(i) + 50 * PsychicLevel()
			'End If
			
			'Invalid_string_refer_to_original_code
			If IsWeaponClassifiedAs(i, "繧ｷ") Then
				If CountPilot() > 0 Then
					If MainPilot.SynchroRate > 0 Then
						lngWeaponPower(i) = lngWeaponPower(i) + 15 * (SyncLevel() - 50) \ 2
					End If
				End If
			End If
			'End If
			'End If
			IsWeaponClassifiedAs(i, "謾ｹ")
			'Invalid_string_refer_to_original_code
			If IsWeaponLevelSpecified(i, "謾ｹ") Then
				'Invalid_string_refer_to_original_code
				lngWeaponPower(i) = lngWeaponPower(i) + 10 * WeaponLevel(i, "謾ｹ") * (Rank + num)
			Else
				'Invalid_string_refer_to_original_code
				lngWeaponPower(i) = lngWeaponPower(i) + 50 * CInt(Rank + num)
			End If
			
			'繧ｪ繝ｼ繝ｩ謚
			If IsWeaponClassifiedAs(i, "繧ｪ") Then
				lngWeaponPower(i) = lngWeaponPower(i) + 100 * AuraLevel()
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			lngWeaponPower(i) = lngWeaponPower(i) + 100 * PsychicLevel()
			'End If
			
			'Invalid_string_refer_to_original_code
			If IsWeaponClassifiedAs(i, "繧ｷ") Then
				If CountPilot() > 0 Then
					If MainPilot.SynchroRate > 0 Then
						lngWeaponPower(i) = lngWeaponPower(i) + 15 * (SyncLevel() - 50)
					End If
				End If
			End If
			'Invalid_string_refer_to_original_code
			lngWeaponPower(i) = lngWeaponPower(i) + 100 * CInt(Rank + num)
			
			'繧ｪ繝ｼ繝ｩ謚
			If IsWeaponClassifiedAs(i, "繧ｪ") Then
				lngWeaponPower(i) = lngWeaponPower(i) + 100 * AuraLevel()
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			lngWeaponPower(i) = lngWeaponPower(i) + 100 * PsychicLevel()
			'End If
			
			'Invalid_string_refer_to_original_code
			If IsWeaponClassifiedAs(i, "繧ｷ") Then
				If CountPilot() > 0 Then
					If MainPilot.SynchroRate > 0 Then
						lngWeaponPower(i) = lngWeaponPower(i) + 15 * (SyncLevel() - 50)
					End If
				End If
			End If
			'End If
			
			'繝懊せ繝ｩ繝ｳ繧ｯ縺ｫ繧医ｋ菫ｮ豁｣
			If BossRank > 0 Then
				lngWeaponPower(i) = lngWeaponPower(i) + MinLng(100 * BossRank, 300)
			End If
			
			'Invalid_string_refer_to_original_code
			If lngWeaponPower(i) > 99999 Then
				lngWeaponPower(i) = 99999
			End If
			
			'譛菴主､縺ｯ1
			If lngWeaponPower(i) <= 0 Then
				lngWeaponPower(i) = 1
			End If
NextWeapon: 
		Next 
		
		'Invalid_string_refer_to_original_code
		ReDim intWeaponMaxRange(CountWeapon)
		For i = 1 To CountWeapon
			intWeaponMaxRange(i) = Weapon(i).MaxRange
			
			'Invalid_string_refer_to_original_code
			If intWeaponMaxRange(i) = 1 Then
				GoTo NextWeapon2
			End If
			
			'Invalid_string_refer_to_original_code
			If InStrNotNest(strWeaponClass(i), "繧ｵ") > 0 Then
				If CountPilot() > 0 Then
					With MainPilot
						'Invalid_string_refer_to_original_code_
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					End With
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			If InStrNotNest(strWeaponClass(i), "Invalid_string_refer_to_original_code") > 0 Then
				GoTo NextWeapon2
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Or InStrNotNest(strWeaponClass(i), "謗･") > 0 _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			GoTo NextWeapon2
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			GoTo NextWeapon2
			'End If
			
			'Invalid_string_refer_to_original_code
			If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				With Weapon(i)
					wname = .Name
					wnickname = WeaponNickname(i)
					wnskill = .NecessarySkill
				End With
				wclass = strWeaponClass(i)
				
				For j = 1 To CountFeature
					If Feature(j) = "Invalid_string_refer_to_original_code" Then
						fdata = FeatureData(j)
						
						'Invalid_string_refer_to_original_code
						If Left(fdata, 1) = """" Then
							fdata = Mid(fdata, 2, Len(fdata) - 2)
						End If
						
						flen = LLength(fdata)
						flag = False
						
						'Invalid_string_refer_to_original_code
						If flen = 0 Then
							flag = True
						End If
						
						'Invalid_string_refer_to_original_code
						false_count = 0
						For k = 1 To flen
							wtype = LIndex(fdata, k)
							
							If Left(wtype, 1) = "!" Then
								wtype = Mid(wtype, 2)
								with_not = True
							Else
								with_not = False
							End If
							
							found = False
							Select Case wtype
								Case "蜈ｨ"
									found = True
								Case "迚ｩ"
									'Invalid_string_refer_to_original_code_
									'Or InStrNotNest(wclass, "鬲疲ｭｦ") > 0 _
									'Invalid_string_refer_to_original_code_
									'Or InStrNotNest(wclass, "鬲疲磁") > 0 _
									'Or InStrNotNest(wclass, "鬲秘潟") > 0 _
									'Invalid_string_refer_to_original_code_
									'Then
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									found = True
							End Select
						Next 
					End If
					'UPGRADE_WARNING: Update に変換されていないステートメントがあります。ソース コードを確認してください。
				Next 
				
				If flag Or false_count = 0 Then
					intWeaponMaxRange(i) = intWeaponMaxRange(i) + FeatureLevel(j)
				End If
			End If
		Next 
		'End If
		
		'譛菴主､縺ｯ1
		If intWeaponMaxRange(i) <= 0 Then
			intWeaponMaxRange(i) = 1
		End If
NextWeapon2: 
		'Next
		
		'Invalid_string_refer_to_original_code
		ReDim intWeaponPrecision(CountWeapon)
		For i = 1 To CountWeapon
			intWeaponPrecision(i) = Weapon(i).Precision
			
			'豁ｦ蝎ｨ蠑ｷ蛹悶↓繧医ｋ菫ｮ豁｣
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			With Weapon(i)
				wname = .Name
				wnickname = WeaponNickname(i)
				wnskill = .NecessarySkill
			End With
			wclass = strWeaponClass(i)
			
			For j = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				fdata = FeatureData(j)
				
				'Invalid_string_refer_to_original_code
				If Left(fdata, 1) = """" Then
					fdata = Mid(fdata, 2, Len(fdata) - 2)
				End If
				
				flen = LLength(fdata)
				flag = False
				
				'Invalid_string_refer_to_original_code
				If flen = 0 Then
					flag = True
				End If
				
				'Invalid_string_refer_to_original_code
				false_count = 0
				For k = 1 To flen
					wtype = LIndex(fdata, k)
					
					If Left(wtype, 1) = "!" Then
						wtype = Mid(wtype, 2)
						with_not = True
					Else
						with_not = False
					End If
					
					found = False
					Select Case wtype
						Case "蜈ｨ"
							found = True
						Case "迚ｩ"
							'Invalid_string_refer_to_original_code_
							'Or InStrNotNest(wclass, "鬲疲ｭｦ") > 0 _
							'Invalid_string_refer_to_original_code_
							'Or InStrNotNest(wclass, "鬲疲磁") > 0 _
							'Or InStrNotNest(wclass, "鬲秘潟") > 0 _
							'Invalid_string_refer_to_original_code_
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							found = True
							'End If
						Case Else
							If InStrNotNest(wclass, wtype) > 0 Or wname = wtype Or wnickname = wtype Then
								found = True
							Else
								For l = 1 To LLength(wnskill)
									sname = LIndex(wnskill, l)
									If InStr(sname, "Lv") > 0 Then
										sname = Left(sname, InStr(sname, "Lv") - 1)
									End If
									If sname = wtype Then
										found = True
										Exit For
									End If
								Next 
							End If
					End Select
					
					If with_not Then
						'Invalid_string_refer_to_original_code
						If found Then
							'Invalid_string_refer_to_original_code
							flag = False
							false_count = false_count + 1
						End If
					ElseIf found Then 
						'Invalid_string_refer_to_original_code
						flag = True
					Else
						'Invalid_string_refer_to_original_code
						false_count = false_count + 1
					End If
				Next 
				
				If flag Or false_count = 0 Then
					intWeaponPrecision(i) = intWeaponPrecision(i) + 5 * FeatureLevel(j)
				End If
				'End If
			Next 
			'End If
		Next 
		
		'Invalid_string_refer_to_original_code
		ReDim intWeaponCritical(CountWeapon)
		For i = 1 To CountWeapon
			intWeaponCritical(i) = Weapon(i).Critical
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			With Weapon(i)
				wname = .Name
				wnickname = WeaponNickname(i)
				wnskill = .NecessarySkill
			End With
			wclass = strWeaponClass(i)
			
			For j = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				fdata = FeatureData(j)
				
				'Invalid_string_refer_to_original_code
				If Left(fdata, 1) = """" Then
					fdata = Mid(fdata, 2, Len(fdata) - 2)
				End If
				
				flen = LLength(fdata)
				flag = False
				
				'Invalid_string_refer_to_original_code
				If flen = 0 Then
					flag = True
				End If
				
				'Invalid_string_refer_to_original_code
				false_count = 0
				For k = 1 To flen
					wtype = LIndex(fdata, k)
					
					If Left(wtype, 1) = "!" Then
						wtype = Mid(wtype, 2)
						with_not = True
					Else
						with_not = False
					End If
					
					found = False
					Select Case wtype
						Case "蜈ｨ"
							found = True
						Case "迚ｩ"
							'Invalid_string_refer_to_original_code_
							'Or InStrNotNest(wclass, "鬲疲ｭｦ") > 0 _
							'Invalid_string_refer_to_original_code_
							'Or InStrNotNest(wclass, "鬲疲磁") > 0 _
							'Or InStrNotNest(wclass, "鬲秘潟") > 0 _
							'Invalid_string_refer_to_original_code_
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							found = Not with_not
							'End If
						Case Else
							If InStrNotNest(wclass, wtype) > 0 Or wname = wtype Or wnickname = wtype Then
								found = True
							Else
								For l = 1 To LLength(wnskill)
									sname = LIndex(wnskill, l)
									If InStr(sname, "Lv") > 0 Then
										sname = Left(sname, InStr(sname, "Lv") - 1)
									End If
									If sname = wtype Then
										found = True
										Exit For
									End If
								Next 
							End If
					End Select
					
					If with_not Then
						'Invalid_string_refer_to_original_code
						If found Then
							'Invalid_string_refer_to_original_code
							flag = False
							false_count = false_count + 1
						End If
					ElseIf found Then 
						'Invalid_string_refer_to_original_code
						flag = True
					Else
						'Invalid_string_refer_to_original_code
						false_count = false_count + 1
					End If
				Next 
				
				If flag Or false_count = 0 Then
					intWeaponCritical(i) = intWeaponCritical(i) + 5 * FeatureLevel(j)
				End If
				'End If
			Next 
			'End If
			
			'迚ｹ谿雁柑譫懃匱蜍慕紫蠑ｷ蛹悶↓繧医ｋ菫ｮ豁｣
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			With Weapon(i)
				wname = .Name
				wnickname = WeaponNickname(i)
				wnskill = .NecessarySkill
			End With
			wclass = strWeaponClass(i)
			
			For j = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				fdata = FeatureData(j)
				
				'Invalid_string_refer_to_original_code
				If Left(fdata, 1) = """" Then
					fdata = Mid(fdata, 2, Len(fdata) - 2)
				End If
				
				flen = LLength(fdata)
				flag = False
				
				'Invalid_string_refer_to_original_code
				If flen = 0 Then
					flag = True
				End If
				
				'Invalid_string_refer_to_original_code
				false_count = 0
				For k = 1 To flen
					wtype = LIndex(fdata, k)
					
					If Left(wtype, 1) = "!" Then
						wtype = Mid(wtype, 2)
						with_not = True
					Else
						with_not = False
					End If
					
					found = False
					Select Case wtype
						Case "蜈ｨ"
							found = True
						Case "迚ｩ"
							'Invalid_string_refer_to_original_code_
							'Or InStrNotNest(wclass, "鬲疲ｭｦ") > 0 _
							'Invalid_string_refer_to_original_code_
							'Or InStrNotNest(wclass, "鬲疲磁") > 0 _
							'Or InStrNotNest(wclass, "鬲秘潟") > 0 _
							'Invalid_string_refer_to_original_code_
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							found = True
							'End If
						Case Else
							If InStrNotNest(wclass, wtype) > 0 Or wname = wtype Or wnickname = wtype Then
								found = True
							Else
								For l = 1 To LLength(wnskill)
									buf = LIndex(wnskill, l)
									If InStr(buf, "Lv") > 0 Then
										buf = Left(buf, InStr(buf, "Lv") - 1)
									End If
									If buf = wtype Then
										found = True
										Exit For
									End If
								Next 
							End If
					End Select
					
					If with_not Then
						'Invalid_string_refer_to_original_code
						If found Then
							'Invalid_string_refer_to_original_code
							flag = False
							false_count = false_count + 1
						End If
					ElseIf found Then 
						'Invalid_string_refer_to_original_code
						flag = True
					Else
						'Invalid_string_refer_to_original_code
						false_count = false_count + 1
					End If
				Next 
				
				If flag Or false_count = 0 Then
					intWeaponCritical(i) = intWeaponCritical(i) + 5 * FeatureLevel(j)
				End If
				'End If
			Next 
			'End If
		Next 
		
		'譛螟ｧ蠑ｾ謨ｰ繧呈峩譁ｰ
		ReDim intMaxBullet(CountWeapon)
		For i = 1 To CountWeapon
			
			intMaxBullet(i) = Weapon(i).Bullet
			
			'Invalid_string_refer_to_original_code
			rate_Renamed = 0
			
			'繝懊せ繝ｩ繝ｳ繧ｯ縺ｫ繧医ｋ菫ｮ豁｣
			If intBossRank > 0 Then
				rate_Renamed = 0.2 * BossRank
			End If
			
			'譛螟ｧ蠑ｾ謨ｰ蠅怜刈縺ｫ繧医ｋ菫ｮ豁｣
			If IsFeatureAvailable("譛螟ｧ蠑ｾ謨ｰ蠅怜刈") Then
				With Weapon(i)
					wname = .Name
					wnickname = WeaponNickname(i)
					wnskill = .NecessarySkill
				End With
				wclass = strWeaponClass(i)
				
				For j = 1 To CountFeature
					If Feature(j) = "譛螟ｧ蠑ｾ謨ｰ蠅怜刈" Then
						fdata = FeatureData(j)
						
						'Invalid_string_refer_to_original_code
						If Left(fdata, 1) = """" Then
							fdata = Mid(fdata, 2, Len(fdata) - 2)
						End If
						
						flen = LLength(fdata)
						flag = False
						
						'Invalid_string_refer_to_original_code
						If flen = 0 Then
							flag = True
						End If
						
						'Invalid_string_refer_to_original_code
						false_count = 0
						For k = 1 To flen
							wtype = LIndex(fdata, k)
							
							If Left(wtype, 1) = "!" Then
								wtype = Mid(wtype, 2)
								with_not = True
							Else
								with_not = False
							End If
							
							found = False
							Select Case wtype
								Case "蜈ｨ"
									found = True
								Case "迚ｩ"
									'Invalid_string_refer_to_original_code_
									'Or InStrNotNest(wclass, "鬲疲ｭｦ") > 0 _
									'Invalid_string_refer_to_original_code_
									'Or InStrNotNest(wclass, "鬲疲磁") > 0 _
									'Or InStrNotNest(wclass, "鬲秘潟") > 0 _
									'Invalid_string_refer_to_original_code_
									'Then
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									found = True
							End Select
						Next 
					End If
					'UPGRADE_WARNING: Update に変換されていないステートメントがあります。ソース コードを確認してください。
				Next 
				
				If flag Or false_count = 0 Then
					rate_Renamed = rate_Renamed + 0.5 * FeatureLevel(j)
				End If
			End If
		Next 
		'End If
		
		'Invalid_string_refer_to_original_code
		intMaxBullet(i) = (1 + rate_Renamed) * intMaxBullet(i)
		
		'譛螟ｧ蛟､縺ｯ99
		If intMaxBullet(i) > 99 Then
			intMaxBullet(i) = 99
		End If
		'譛菴主､縺ｯ0
		If intMaxBullet(i) < 0 Then
			intMaxBullet(i) = 0
		End If
		'Next
		
		'蠑ｾ謨ｰ繧呈峩譁ｰ
		ReDim Preserve dblBullet(CountWeapon)
		ReDim flags(UBound(prev_wdata))
		For i = 1 To CountWeapon
			dblBullet(i) = 1
			For j = 1 To UBound(prev_wdata)
				If WData(i) Is prev_wdata(j) And Not flags(j) Then
					dblBullet(i) = prev_wbullets(j)
					flags(j) = True
					Exit For
				End If
			Next 
		Next 
		
		'Invalid_string_refer_to_original_code
		ReDim prev_adata(UBound(adata))
		ReDim prev_astocks(UBound(adata))
		For i = 1 To UBound(adata)
			prev_adata(i) = adata(i)
			prev_astocks(i) = dblStock(i)
		Next 
		With Data
			ReDim adata(.CountAbility)
			For i = 1 To .CountAbility
				adata(i) = .Ability(i)
			Next 
		End With
		If CountPilot > 0 Then
			With MainPilot.Data
				For i = 1 To .CountAbility
					ReDim Preserve adata(UBound(adata) + 1)
					adata(UBound(adata)) = .Ability(i)
				Next 
			End With
			For i = 2 To CountPilot
				With Pilot(i).Data
					For j = 1 To .CountAbility
						ReDim Preserve adata(UBound(adata) + 1)
						adata(UBound(adata)) = .Ability(j)
					Next 
				End With
			Next 
			For i = 1 To CountSupport
				With Support(i).Data
					For j = 1 To .CountAbility
						ReDim Preserve adata(UBound(adata) + 1)
						adata(UBound(adata)) = .Ability(j)
					Next 
				End With
			Next 
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			With AdditionalSupport.Data
				For i = 1 To .CountAbility
					ReDim Preserve adata(UBound(adata) + 1)
					adata(UBound(adata)) = .Ability(i)
				Next 
			End With
		End If
		'End If
		For	Each itm In colItem
			With itm
				If .Activated Then
					For i = 1 To .CountAbility
						ReDim Preserve adata(UBound(adata) + 1)
						adata(UBound(adata)) = .Ability(i)
					Next 
				End If
			End With
		Next itm
		
		'菴ｿ逕ｨ蝗樊焚繧呈峩譁ｰ
		ReDim Preserve dblStock(CountAbility)
		ReDim flags(UBound(prev_adata))
		For i = 1 To CountAbility
			dblStock(i) = 1
			For j = 1 To UBound(prev_adata)
				If adata(i) Is prev_adata(j) And Not flags(j) Then
					dblStock(i) = prev_astocks(j)
					flags(j) = True
					Exit For
				End If
			Next 
		Next 
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Sub
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("蛻ｶ蠕｡荳榊庄") Then
			If Not is_uncontrollable Then
				AddCondition("證ｴ襍ｰ", -1)
			End If
		Else
			If is_uncontrollable Then
				If IsConditionSatisfied("證ｴ襍ｰ") Then
					DeleteCondition("證ｴ襍ｰ")
				End If
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If Not is_stable Then
			If HP <= MaxHP \ 4 Then
				AddCondition("證ｴ襍ｰ", -1)
			End If
		End If
		If is_stable Then
			If IsConditionSatisfied("證ｴ襍ｰ") Then
				DeleteCondition("證ｴ襍ｰ")
			End If
		End If
		'End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Private Sub AddFeatures(ByRef fdc As Collection, Optional ByVal is_item As Boolean = False)
		Dim fd As FeatureData
		
		If fdc Is Nothing Then
			Exit Sub
		End If
		
		For	Each fd In fdc
			With fd
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				If is_item Then
					Select Case .Name
						Case "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code", "陦ｨ遉ｺ", "髱櫁｡ｨ遉ｺ", "Invalid_string_refer_to_original_code"
							GoTo NextFeature
					End Select
				End If
				
				'Invalid_string_refer_to_original_code
				If IsDisabled(.Name) Or IsDisabled(LIndex(.StrData, 1)) Then
					GoTo NextFeature
				End If
				
				'Invalid_string_refer_to_original_code
				If Not IsFeatureRegistered(.Name) Then
					colFeature.Add(fd, .Name)
				Else
					colFeature.Add(fd, .Name & ":" & VB6.Format(colFeature.Count()))
				End If
			End With
NextFeature: 
		Next fd
	End Sub
	
	'Invalid_string_refer_to_original_code
	Private Function IsFeatureRegistered(ByRef fname As String) As Boolean
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		
		fd = colFeature.Item(fname)
		IsFeatureRegistered = True
		Exit Function
		
ErrorHandler: 
		IsFeatureRegistered = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Private Function IsAllFeatureRegistered(ByRef fname As String) As Boolean
		Dim fd As FeatureData
		
		On Error GoTo ErrorHandler
		
		fd = colAllFeature.Item(fname)
		IsAllFeatureRegistered = True
		Exit Function
		
ErrorHandler: 
		IsAllFeatureRegistered = False
	End Function
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Private Sub UpdateFeatures(Optional ByVal fname As String = "")
		Dim fd As FeatureData
		Dim farray() As FeatureData
		Dim i As Short
		Dim found As Boolean
		
		If fname <> "" Then
			'Invalid_string_refer_to_original_code
			found = False
			i = 1
			With colFeature
				Do While i <= .Count()
					'Invalid_string_refer_to_original_code
					'UPGRADE_WARNING: オブジェクト colFeature.Item(i).Name の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
					If fname = .Item(i).Name Then
						'UPGRADE_WARNING: オブジェクト colFeature.Item().NecessaryCondition の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
						'UPGRADE_WARNING: オブジェクト colFeature.Item().NecessarySkill の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
						If Not IsNecessarySkillSatisfied(.Item(i).NecessarySkill) Or Not IsNecessarySkillSatisfied(.Item(i).NecessaryCondition) Then
							'Invalid_string_refer_to_original_code
							.Remove(i)
							found = True
						Else
							i = i + 1
						End If
					Else
						i = i + 1
					End If
				Loop 
			End With
		Else
			'Invalid_string_refer_to_original_code
			found = False
			i = 1
			With colFeature
				Do While i <= .Count()
					'Invalid_string_refer_to_original_code
					'UPGRADE_WARNING: オブジェクト colFeature.Item().NecessarySkill の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
					If Not IsNecessarySkillSatisfied(.Item(i).NecessarySkill) Then
						'Invalid_string_refer_to_original_code
						.Remove(i)
						found = True
					Else
						i = i + 1
					End If
				Loop 
			End With
			
			'Invalid_string_refer_to_original_code
			With colAllFeature
				For	Each fd In colAllFeature
					.Remove(1)
				Next fd
				For	Each fd In colFeature
					If Not IsAllFeatureRegistered((fd.Name)) Then
						.Add(fd, fd.Name)
					Else
						.Add(fd, fd.Name & ":" & VB6.Format(.Count() + 1))
					End If
				Next fd
			End With
			
			'Invalid_string_refer_to_original_code
			i = 1
			With colFeature
				Do While i <= .Count()
					'Invalid_string_refer_to_original_code
					'UPGRADE_WARNING: オブジェクト colFeature.Item().NecessaryCondition の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
					If Not IsNecessarySkillSatisfied(.Item(i).NecessaryCondition) Then
						'Invalid_string_refer_to_original_code
						.Remove(i)
						found = True
					Else
						i = i + 1
					End If
				Loop 
			End With
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If found Then
			With colFeature
				ReDim farray(.Count())
				For i = 1 To .Count()
					farray(i) = .Item(i)
				Next 
				For i = 1 To .Count()
					.Remove(1)
				Next 
				For i = 1 To UBound(farray)
					If Not IsFeatureRegistered((farray(i).Name)) Then
						.Add(farray(i), farray(i).Name)
					Else
						.Add(farray(i), farray(i).Name & ":" & VB6.Format(i))
					End If
				Next 
			End With
		End If
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	
	'莉門ｽ｢諷九ｒ逋ｻ骭ｲ
	Public Sub AddOtherForm(ByRef u As Unit)
		colOtherForm.Add(u, u.ID)
	End Sub
	
	'莉門ｽ｢諷九ｒ蜑企勁
	Public Sub DeleteOtherForm(ByRef Index As Object)
		Dim i As Short
		
		On Error GoTo ErrorHandler
		colOtherForm.Remove(Index)
		Exit Sub
		
ErrorHandler: 
		'隕九▽縺九ｉ縺ｪ縺代ｌ縺ｰ繝ｦ繝九ャ繝亥錐遘ｰ縺ｧ讀懃ｴ｢
		For i = 1 To colOtherForm.Count()
			'UPGRADE_WARNING: オブジェクト colOtherForm(i).Name の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			If colOtherForm.Item(i).Name = Index Then
				colOtherForm.Remove(i)
				Exit Sub
			End If
		Next 
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function CountOtherForm() As Short
		CountOtherForm = colOtherForm.Count()
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function OtherForm(ByRef Index As Object) As Unit
		Dim u As Unit
		Dim uname As String
		Dim i As Short
		
		On Error GoTo ErrorHandler
		OtherForm = colOtherForm.Item(Index)
		Exit Function
		
ErrorHandler: 
		'隕九▽縺九ｉ縺ｪ縺代ｌ縺ｰ繝ｦ繝九ャ繝亥錐遘ｰ縺ｧ讀懃ｴ｢
		'UPGRADE_WARNING: オブジェクト Index の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
		uname = CStr(Index)
		
		For	Each u In colOtherForm
			If u.Name = uname Then
				OtherForm = u
				Exit Function
			End If
		Next u
		
		'Invalid_string_refer_to_original_code
		If UDList.IsDefined(uname) Then
			u = New Unit
			With u
				.Name = UDList.Item(uname).Name
				.Rank = Rank
				.BossRank = BossRank
				.Party = Party0
				.ID = UList.CreateID(uname)
				.Status_Renamed = "Invalid_string_refer_to_original_code"
				.x = x
				.y = y
				For i = 1 To CountOtherForm
					.AddOtherForm(OtherForm(i))
					OtherForm(i).AddOtherForm(u)
				Next 
				.AddOtherForm(Me)
				AddOtherForm(u)
			End With
			UList.Add2(u)
			OtherForm = u
		Else
			ErrorMessage("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsOtherFormDefined(ByRef uname As String) As Boolean
		Dim u As Unit
		
		For	Each u In colOtherForm
			If u.Name = uname Then
				IsOtherFormDefined = True
				Exit Function
			End If
		Next u
		
		IsOtherFormDefined = False
	End Function
	
	'荳崎ｦ√↑蠖｢諷九ｒ蜑企勁
	Public Sub DeleteTemporaryOtherForm()
		Dim uarray() As String
		Dim fname, fdata As String
		Dim k, i, j, n As Short
		
		'Invalid_string_refer_to_original_code
		n = 1
		ReDim uarray(1)
		uarray(1) = Name
		For i = 1 To CountFeature
			fname = Feature(i)
			Select Case fname
				Case "螟牙ｽ｢"
					fdata = FeatureData(fname)
					n = n + LLength(fdata) - 1
					ReDim Preserve uarray(n)
					For j = 1 To LLength(fdata) - 1
						uarray(n - j + 1) = LIndex(fdata, j + 1)
					Next 
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					fdata = FeatureData(fname)
					n = n + LLength(fdata)
					ReDim Preserve uarray(n)
					For j = 1 To LLength(fdata)
						uarray(n - j + 1) = LIndex(fdata, j)
					Next 
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					fdata = FeatureData(fname)
					n = n + 1
					ReDim Preserve uarray(n)
					uarray(n) = LIndex(fdata, 2)
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					fdata = FeatureData(fname)
					n = n + 1
					ReDim Preserve uarray(n)
					uarray(n) = LIndex(fdata, 1)
			End Select
		Next 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountOtherForm
			With OtherForm(i)
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				j = 1
				Do While j <= .CountOtherForm
					With .OtherForm(j)
						For k = 1 To n
							If .Name = uarray(k) Then
								Exit For
							End If
						Next 
					End With
					If k > n Then
						.DeleteOtherForm(j)
					Else
						j = j + 1
					End If
				Loop 
				'End If
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		i = 1
		Do While i <= CountOtherForm
			With OtherForm(i)
				For j = 1 To n
					If .Name = uarray(j) Then
						Exit For
					End If
				Next 
			End With
			If j > n Then
				OtherForm(i).Status_Renamed = "Invalid_string_refer_to_original_code"
				DeleteOtherForm(i)
			Else
				i = i + 1
			End If
		Loop 
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Sub AddPilot(ByRef p As Pilot)
		colPilot.Add(p, p.ID)
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub DeletePilot(ByRef Index As Object)
		colPilot.Remove(Index)
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub ReplacePilot(ByRef p As Pilot, ByRef Index As Object)
		Dim i As Short
		Dim prev_p As Pilot
		Dim pilot_list() As Pilot
		
		p.Unit_Renamed = Me
		
		prev_p = colPilot.Item(Index)
		
		ReDim pilot_list(colPilot.Count())
		
		For i = 1 To UBound(pilot_list)
			pilot_list(i) = colPilot.Item(i)
		Next 
		For i = 1 To UBound(pilot_list)
			colPilot.Remove(1)
		Next 
		For i = 1 To UBound(pilot_list)
			If pilot_list(i) Is prev_p Then
				colPilot.Add(p, p.ID)
			Else
				colPilot.Add(pilot_list(i), pilot_list(i).ID)
			End If
		Next 
		'UPGRADE_NOTE: オブジェクト prev_p.Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		prev_p.Unit_Renamed = Nothing
		prev_p.Alive = False
	End Sub
	
	'謳ｭ荵怜藤謨ｰ
	Public Function CountPilot() As Short
		CountPilot = colPilot.Count()
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Pilot(ByRef Index As Object) As Pilot
		Pilot = colPilot.Item(Index)
	End Function
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Function MainPilot(Optional ByVal without_update As Boolean = False) As Pilot
		Dim pname As String
		Dim p As Pilot
		Dim i As Short
		Dim need_update As Boolean
		
		'Invalid_string_refer_to_original_code
		If CountPilot = 0 Then
			If Not IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				ErrorMessage("Invalid_string_refer_to_original_code")
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				TerminateSRC()
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		MainPilot = colPilot.Item(1)
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
			MainPilot = colPilot.Item(1)
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("證ｴ襍ｰ") Then
			If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				pname = FeatureData("Invalid_string_refer_to_original_code")
				
				If PDList.IsDefined(pname) Then
					pname = PDList.Item(pname).Name
				Else
					ErrorMessage("Invalid_string_refer_to_original_code")
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				End If
				
				If PList.IsDefined(pname) Then
					'Invalid_string_refer_to_original_code
					MainPilot = PList.Item(pname)
					With MainPilot
						.Unit_Renamed = Me
						.Morale = Pilot(1).Morale
						.Level = Pilot(1).Level
						.Exp = Pilot(1).Exp
						If Not without_update Then
							If Not .Unit_Renamed Is Me Then
								.Unit_Renamed = Me
								.Update()
								.UpdateSupportMod()
							End If
						End If
					End With
					Exit Function
				Else
					'Invalid_string_refer_to_original_code
					MainPilot = PList.Add(pname, Pilot(1).Level, Party0)
					With MainPilot
						.Morale = Pilot(1).Morale
						.Exp = Pilot(1).Exp
						.Unit_Renamed = Me
						.Update()
						.UpdateSupportMod()
					End With
					Exit Function
				End If
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			pname = FeatureData("Invalid_string_refer_to_original_code")
			
			If PDList.IsDefined(pname) Then
				pname = PDList.Item(pname).Name
			Else
				ErrorMessage("Invalid_string_refer_to_original_code")
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			End If
			
			'Invalid_string_refer_to_original_code
			If Not pltAdditionalPilot Is Nothing Then
				If pltAdditionalPilot.Name = pname Then
					MainPilot = pltAdditionalPilot
					With pltAdditionalPilot
						If .IsAdditionalPilot And Not .Unit_Renamed Is Me Then
							.Unit_Renamed = Me
							.Party = Party0
							.Exp = Pilot(1).Exp
							If .Personality <> "讖滓｢ｰ" Then
								.Morale = Pilot(1).Morale
							End If
							If .Level <> Pilot(1).Level Then
								.Level = Pilot(1).Level
								.Update()
							End If
						End If
					End With
					Exit Function
				End If
			End If
			For i = 1 To CountOtherForm
				If Not OtherForm(i).pltAdditionalPilot Is Nothing Then
					With OtherForm(i).pltAdditionalPilot
						If .Name = pname Then
							pltAdditionalPilot = OtherForm(i).pltAdditionalPilot
							.Party = Party0
							.Unit_Renamed = Me
							If .IsAdditionalPilot And Not .Unit_Renamed Is Me Then
								.Level = Pilot(1).Level
								.Exp = Pilot(1).Exp
								If .Personality <> "讖滓｢ｰ" Then
									.Morale = Pilot(1).Morale
								End If
								.Update()
								.UpdateSupportMod()
							End If
							MainPilot = pltAdditionalPilot
							Exit Function
						End If
					End With
				End If
			Next 
			
			'Invalid_string_refer_to_original_code
			If CountPilot > 0 Then
				'Invalid_string_refer_to_original_code
				For i = 1 To CountPilot
					If Pilot(i).Name = pname Then
						pltAdditionalPilot = Pilot(i)
						MainPilot = pltAdditionalPilot
						Exit Function
					End If
				Next 
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			If PList.IsDefined(pname) Then
				p = PList.Item(pname)
				If Not p.IsAdditionalPilot Or (InStr(pname, "(繧ｶ繧ｳ)") = 0 And InStr(pname, "(豎守畑)") = 0) Then
					pltAdditionalPilot = p
					With pltAdditionalPilot
						.IsAdditionalPilot = True
						.Party = Party0
						.Level = Pilot(1).Level
						.Exp = Pilot(1).Exp
						If .Personality <> "讖滓｢ｰ" Then
							.Morale = Pilot(1).Morale
						End If
						If Not without_update Then
							If Not .Unit_Renamed Is Me Then
								.Unit_Renamed = Me
								.Update()
								.UpdateSupportMod()
							End If
						Else
							.Unit_Renamed = Me
						End If
					End With
					MainPilot = pltAdditionalPilot
					Exit Function
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			If CountPilot > 0 Then
				pltAdditionalPilot = PList.Add(pname, Pilot(1).Level, Party0)
				With pltAdditionalPilot
					.IsAdditionalPilot = True
					.Exp = Pilot(1).Exp
					If .Personality <> "讖滓｢ｰ" Then
						.Morale = Pilot(1).Morale
					End If
				End With
			Else
				pltAdditionalPilot = PList.Add(pname, 1, Party0)
				pltAdditionalPilot.IsAdditionalPilot = True
			End If
			With pltAdditionalPilot
				.Unit_Renamed = Me
				If Not without_update Then
					.Update()
					.UpdateSupportMod()
				End If
			End With
			MainPilot = pltAdditionalPilot
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		MainPilot = colPilot.Item(1)
	End Function
	
	
	'Invalid_string_refer_to_original_code
	Public Sub AddSupport(ByRef p As Pilot)
		colSupport.Add(p, p.Name)
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub DeleteSupport(ByRef Index As Object)
		colSupport.Remove(Index)
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub ReplaceSupport(ByRef p As Pilot, ByRef Index As Object)
		Dim i As Short
		Dim prev_p As Pilot
		Dim support_list() As Pilot
		
		p.Unit_Renamed = Me
		
		prev_p = colSupport.Item(Index)
		
		ReDim support_list(colSupport.Count())
		
		For i = 1 To UBound(support_list)
			support_list(i) = colSupport.Item(i)
		Next 
		For i = 1 To UBound(support_list)
			colSupport.Remove(1)
		Next 
		For i = 1 To UBound(support_list)
			If support_list(i).ID = prev_p.ID Then
				colSupport.Add(p, p.ID)
			Else
				colSupport.Add(support_list(i), support_list(i).ID)
			End If
		Next 
		'UPGRADE_NOTE: オブジェクト prev_p.Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		prev_p.Unit_Renamed = Nothing
		prev_p.Alive = False
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function CountSupport() As Short
		CountSupport = colSupport.Count()
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Support(ByRef Index As Object) As Pilot
		Support = colSupport.Item(Index)
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AdditionalSupport() As Pilot
		Dim pname As String
		Dim p As Pilot
		Dim i As Short
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		'Invalid_string_refer_to_original_code
		If pname = "" Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If CountPilot = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Not pltAdditionalSupport Is Nothing Then
			If pltAdditionalSupport.Name = pname Then
				AdditionalSupport = pltAdditionalSupport
				pltAdditionalSupport.Unit_Renamed = Me
				Exit Function
			End If
		End If
		For i = 1 To CountOtherForm
			With OtherForm(i)
				If Not .pltAdditionalSupport Is Nothing Then
					If .pltAdditionalSupport.Name = pname Then
						.pltAdditionalSupport.Unit_Renamed = Me
						AdditionalSupport = .pltAdditionalSupport
						Exit Function
					End If
				End If
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If PList.IsDefined(pname) Then
			p = PList.Item(pname)
			If Not p.IsAdditionalSupport Or (InStr(pname, "(繧ｶ繧ｳ)") = 0 And InStr(pname, "(豎守畑)") = 0) Then
				pltAdditionalSupport = p
				With pltAdditionalSupport
					.IsAdditionalSupport = True
					.Party = Party0
					.Unit_Renamed = Me
					.Level = Pilot(1).Level
					.Exp = Pilot(1).Exp
					If .Personality <> "讖滓｢ｰ" Then
						.Morale = Pilot(1).Morale
					End If
				End With
				AdditionalSupport = pltAdditionalSupport
				Exit Function
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If Not PDList.IsDefined(pname) Then
			ErrorMessage("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		pltAdditionalSupport = PList.Add(pname, Pilot(1).Level, Party0)
		With pltAdditionalSupport
			.IsAdditionalSupport = True
			.Unit_Renamed = Me
			.Exp = Pilot(1).Exp
			If .Personality <> "讖滓｢ｰ" Then
				.Morale = Pilot(1).Morale
			End If
		End With
		AdditionalSupport = pltAdditionalSupport
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsSkillAvailable(ByRef sname As String) As Boolean
		Dim i As Short
		
		If CountPilot = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If MainPilot.IsSkillAvailable(sname) Then
			IsSkillAvailable = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Data.PilotNum > 0 Then
			For i = 2 To CountPilot
				If Pilot(i).IsSkillAvailable(sname) Then
					IsSkillAvailable = True
					Exit Function
				End If
			Next 
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountSupport
			If Support(i).IsSkillAvailable(sname) Then
				IsSkillAvailable = True
				Exit Function
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If AdditionalSupport.IsSkillAvailable(sname) Then
			IsSkillAvailable = True
			Exit Function
		End If
		'End If
		
		IsSkillAvailable = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function SkillLevel(ByVal sname As String, Optional ByVal default_slevel As Double = 1) As Double
		
		If CountPilot = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If ALDList.IsDefined(sname) Then
			sname = ALDList.Item(sname).AliasType(1)
		End If
		
		Select Case sname
			Case "Invalid_string_refer_to_original_code"
				SkillLevel = SyncLevel
			Case "髴雁鴨"
				SkillLevel = PlanaLevel
			Case "繧ｪ繝ｼ繝ｩ"
				SkillLevel = AuraLevel
			Case "Invalid_string_refer_to_original_code"
				SkillLevel = PsychicLevel
			Case "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code"
				SkillLevel = MainPilot.SkillLevel(sname, CStr(1))
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'End If
			Case Else
				SkillLevel = MaxSkillLevel(sname, default_slevel)
		End Select
	End Function
	
	'Invalid_string_refer_to_original_code
	Private Function MaxSkillLevel(ByRef sname As String, ByVal default_slevel As Double) As Double
		Dim slevel As Double
		Dim i As Short
		
		If CountPilot = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		With MainPilot
			If .IsSkillLevelSpecified(sname) Then
				MaxSkillLevel = .SkillLevel(sname)
			ElseIf .IsSkillAvailable(sname) Then 
				MaxSkillLevel = default_slevel
			Else
				MaxSkillLevel = 0
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		If Data.PilotNum > 0 Then
			For i = 2 To CountPilot
				With Pilot(i)
					If .IsSkillLevelSpecified(sname) Then
						slevel = .SkillLevel(sname)
					ElseIf .IsSkillAvailable(sname) Then 
						slevel = default_slevel
					Else
						slevel = 0
					End If
					If slevel > MaxSkillLevel Then
						MaxSkillLevel = slevel
					End If
				End With
			Next 
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountSupport
			With Support(i)
				If .IsSkillLevelSpecified(sname) Then
					slevel = .SkillLevel(sname)
				ElseIf .IsSkillAvailable(sname) Then 
					slevel = default_slevel
				Else
					slevel = 0
				End If
				If slevel > MaxSkillLevel Then
					MaxSkillLevel = slevel
				End If
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		With AdditionalSupport
			If .IsSkillLevelSpecified(sname) Then
				slevel = .SkillLevel(sname)
			ElseIf .IsSkillAvailable(sname) Then 
				slevel = default_slevel
			Else
				slevel = 0
			End If
			If slevel > MaxSkillLevel Then
				MaxSkillLevel = slevel
			End If
		End With
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AuraLevel(Optional ByVal no_limit As Boolean = False) As Double
		Select Case CountPilot
			Case 0
				Exit Function
			Case 1
				AuraLevel = MainPilot.SkillLevel("繧ｪ繝ｼ繝ｩ")
			Case Else
				'Invalid_string_refer_to_original_code
				AuraLevel = MainPilot.SkillLevel("繧ｪ繝ｼ繝ｩ") + Pilot(2).SkillLevel("繧ｪ繝ｼ繝ｩ") / 2
		End Select
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		AuraLevel = AuraLevel + AdditionalSupport.SkillLevel("繧ｪ繝ｼ繝ｩ") / 2
		'UPGRADE_WARNING: AuraLevel に変換されていないステートメントがあります。ソース コードを確認してください。
		AuraLevel = AuraLevel + Support(1).SkillLevel("繧ｪ繝ｼ繝ｩ") / 2
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("繧ｪ繝ｼ繝ｩ螟画鋤蝎ｨ") And Not no_limit Then
			If IsFeatureLevelSpecified("繧ｪ繝ｼ繝ｩ螟画鋤蝎ｨ") Then
				AuraLevel = MinDbl(AuraLevel, FeatureLevel("繧ｪ繝ｼ繝ｩ螟画鋤蝎ｨ"))
			End If
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function PsychicLevel(Optional ByVal no_limit As Boolean = False) As Double
		Select Case CountPilot
			Case 0
				Exit Function
			Case 1
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Case Else
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		End Select
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'UPGRADE_WARNING: PsychicLevel に変換されていないステートメントがあります。ソース コードを確認してください。
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function SyncLevel(Optional ByVal no_limit As Boolean = False) As Double
		If CountPilot = 0 Then
			Exit Function
		End If
		
		SyncLevel = MainPilot.SynchroRate
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function PlanaLevel(Optional ByVal no_limit As Boolean = False) As Double
		If CountPilot = 0 Then
			Exit Function
		End If
		
		PlanaLevel = MainPilot.Plana
		
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("髴雁鴨螟画鋤蝎ｨ") And Not no_limit Then
			If IsFeatureLevelSpecified("髴雁鴨螟画鋤蝎ｨ") Then
				PlanaLevel = MinDbl(PlanaLevel, FeatureLevel("髴雁鴨螟画鋤蝎ｨ"))
			End If
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function SkillName0(ByVal sname As String) As String
		Dim i As Short
		
		If ALDList.IsDefined(sname) Then
			sname = ALDList.Item(sname).AliasType(1)
		End If
		
		If CountPilot = 0 Then
			SkillName0 = sname
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		SkillName0 = MainPilot.SkillName0(sname)
		If SkillName0 <> sname Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Data.PilotNum > 0 Then
			For i = 2 To CountPilot
				SkillName0 = Pilot(i).SkillName0(sname)
				If SkillName0 <> sname Then
					Exit Function
				End If
			Next 
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountSupport
			SkillName0 = Support(i).SkillName0(sname)
			If SkillName0 <> sname Then
				Exit Function
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		SkillName0 = AdditionalSupport.SkillName0(sname)
		'End If
	End Function
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Function MaxAction(Optional ByVal ignore_en As Boolean = False) As Short
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Or IsConditionSatisfied("逹｡逵") _
		'Or IsConditionSatisfied("繝√Ε繝ｼ繧ｸ") _
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If Not ignore_en Then
			If EN = 0 Then
				If Not IsOptionDefined("Invalid_string_refer_to_original_code") Then
					Exit Function
				End If
			End If
		End If
		
		If CountPilot = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If IsOptionDefined("Invalid_string_refer_to_original_code") Then
			If MainPilot.IsSkillAvailable("Invalid_string_refer_to_original_code") Then
				MaxAction = 2
			Else
				MaxAction = 1
			End If
		Else
			If MainPilot.Intuition >= 200 Then
				MaxAction = 2
			Else
				MaxAction = 1
			End If
		End If
	End Function
	
	'陦悟虚謨ｰ繧呈ｶ郁ｲｻ
	Public Sub UseAction()
		Dim max_action As Short
		
		'Invalid_string_refer_to_original_code
		If CountPilot = 0 Then
			max_action = 1
		ElseIf IsOptionDefined("Invalid_string_refer_to_original_code") Then 
			If MainPilot.IsSkillAvailable("Invalid_string_refer_to_original_code") Then
				max_action = 2
			Else
				max_action = 1
			End If
		Else
			If MainPilot.Intuition >= 200 Then
				max_action = 2
			Else
				max_action = 1
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		UsedAction = MinLng(UsedAction + 1, max_action)
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	
	'蠖ｱ髻ｿ荳九↓縺ゅｋ繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ荳隕ｧ
	Public Function SpecialPowerInEffect() As String
		Dim cnd As Condition
		
		For	Each cnd In colSpecialPowerInEffect
			With SPDList.Item((cnd.Name))
				If .ShortName = "髱櫁｡ｨ遉ｺ" Then
					'繧､繝吶Φ繝亥ｰら畑
					GoTo NextSpecialPower
				End If
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				GoTo NextSpecialPower
				'End If
				
				SpecialPowerInEffect = SpecialPowerInEffect & .ShortName
			End With
NextSpecialPower: 
		Next cnd
		
		'Invalid_string_refer_to_original_code
		For	Each cnd In colSpecialPowerInEffect
			With SPDList.Item((cnd.Name))
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If PList.IsDefined((cnd.StrData)) Then
					SpecialPowerInEffect = SpecialPowerInEffect & .ShortName & "(" & PList.Item((cnd.StrData)).Nickname & ")"
				End If
				Exit Function
				'End If
			End With
		Next cnd
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsSpecialPowerInEffect(ByRef sname As String) As Boolean
		Dim cnd As Condition
		
		If colSpecialPowerInEffect.Count() = 0 Then
			Exit Function
		End If
		
		On Error GoTo ErrorHandler
		cnd = colSpecialPowerInEffect.Item(sname)
		IsSpecialPowerInEffect = True
		Exit Function
ErrorHandler: 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsUnderSpecialPowerEffect(ByRef sptype As String) As Boolean
		Dim cnd As Condition
		Dim i As Short
		
		For	Each cnd In colSpecialPowerInEffect
			With SPDList.Item((cnd.Name))
				For i = 1 To .CountEffect
					If .EffectType(i) = sptype Then
						IsUnderSpecialPowerEffect = True
						Exit Function
					End If
				Next 
			End With
		Next cnd
		IsUnderSpecialPowerEffect = False
	End Function
	
	'蠖ｱ髻ｿ荳九↓縺ゅｋ繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ縺ｮ邱乗焚
	Public Function CountSpecialPower() As Short
		CountSpecialPower = colSpecialPowerInEffect.Count()
	End Function
	
	'蠖ｱ髻ｿ荳九↓縺ゅｋ繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ
	Public Function SpecialPower(ByRef Index As Object) As SpecialPowerData
		Dim cnd As Condition
		
		On Error GoTo ErrorHandler
		
		cnd = colSpecialPowerInEffect.Item(Index)
		SpecialPower = SPDList.Item((cnd.Name))
		
		Exit Function
		
ErrorHandler: 
		'UPGRADE_NOTE: オブジェクト SpecialPower をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SpecialPower = Nothing
	End Function
	
	'繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ mname 縺ｮ蜉ｹ譫懊Ξ繝吶Ν
	Public Function SpecialPowerEffectLevel(ByRef sname As String) As Double
		Dim cnd As Condition
		Dim i As Short
		Dim lv As Double
		
		lv = DEFAULT_LEVEL
		For	Each cnd In colSpecialPowerInEffect
			With SPDList.Item((cnd.Name))
				For i = 1 To .CountEffect
					If .EffectType(i) = sname Then
						If .EffectLevel(i) > lv Then
							lv = .EffectLevel(i)
						End If
						Exit For
					End If
				Next 
			End With
		Next cnd
		
		If lv <> DEFAULT_LEVEL Then
			SpecialPowerEffectLevel = lv
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function SpecialPowerData(ByRef Index As Object) As String
		Dim cnd As Condition
		
		On Error GoTo ErrorHandler
		cnd = colSpecialPowerInEffect.Item(Index)
		SpecialPowerData = cnd.StrData
		Exit Function
		
ErrorHandler: 
	End Function
	
	'繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ sname 縺ｮ蜉ｹ譫懊ｒ驕ｩ逕ｨ
	Public Sub MakeSpecialPowerInEffect(ByRef sname As String, Optional ByRef sdata As String = "")
		Dim cnd As New Condition
		
		'Invalid_string_refer_to_original_code
		If IsSpecialPowerInEffect(sname) Then
			Exit Sub
		End If
		
		With cnd
			.Name = sname
			.StrData = sdata
		End With
		
		colSpecialPowerInEffect.Add(cnd, sname)
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub RemoveSpecialPowerInEffect(ByRef stype As String)
		Dim sd As SpecialPowerData
		Dim i As Short
		Dim is_message_form_visible As Boolean
		Dim pid As String
		
		'Invalid_string_refer_to_original_code
		is_message_form_visible = frmMessage.Visible
		
		i = 1
		Do While i <= CurrentForm.CountSpecialPower
			sd = SpecialPower(i)
			
			'Invalid_string_refer_to_original_code
			If stype <> sd.Duration Then
				i = i + 1
				GoTo NextSP
			End If
			
			'謖∫ｶ壽悄髢薙′謨ｵ繧ｿ繝ｼ繝ｳ縺ｮ蝣ｴ蜷医√せ繝壹す繝｣繝ｫ繝代Ρ繝ｼ繧偵°縺代※縺阪◆謨ｵ縺ｮ繝輔ぉ繧､繧ｺ
			'Invalid_string_refer_to_original_code
			If stype = "謨ｵ繧ｿ繝ｼ繝ｳ" Then
				If PList.IsDefined(SpecialPowerData((sd.Name))) Then
					With PList.Item(SpecialPowerData((sd.Name)))
						If Not .Unit_Renamed Is Nothing Then
							If .Unit_Renamed.CurrentForm.Party <> Stage Then
								i = i + 1
								GoTo NextSP
							End If
						End If
					End With
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			sd.Apply(CurrentForm.MainPilot, CurrentForm, False, True)
			'End If
			
			'繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ縺ｮ蜉ｹ譫懊ｒ蜑企勁
			CurrentForm.RemoveSpecialPowerInEffect2(i)
NextSP: 
		Loop 
		
		'Invalid_string_refer_to_original_code
		If Not is_message_form_visible And frmMessage.Visible Then
			CloseMessageForm()
		End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub RemoveSpecialPowerInEffect2(ByRef Index As Object)
		On Error GoTo ErrorHandler
		colSpecialPowerInEffect.Remove(Index)
		Exit Sub
ErrorHandler: 
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub RemoveAllSpecialPowerInEffect()
		Dim i As Short
		
		With colSpecialPowerInEffect
			For i = 1 To .Count()
				.Remove(1)
			Next 
		End With
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub CopySpecialPowerInEffect(ByRef u As Unit)
		Dim cnd As Condition
		
		For	Each cnd In colSpecialPowerInEffect
			With cnd
				u.MakeSpecialPowerInEffect(.Name, .StrData)
			End With
		Next cnd
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	
	'迚ｹ谿顔憾諷九ｒ莉伜刈
	Public Sub AddCondition(ByRef cname As String, ByVal ltime As Short, Optional ByVal clevel As Double = DEFAULT_LEVEL, Optional ByRef cdata As String = "")
		Dim cnd As Condition
		Dim new_condition As New Condition
		
		'Invalid_string_refer_to_original_code
		For	Each cnd In colCondition
			With cnd
				If .Name = cname Then
					If .Lifetime < 0 Or ltime < 0 Then
						.Lifetime = -1
					Else
						.Lifetime = MaxLng(.Lifetime, ltime)
					End If
					.Name = cname
					.Level = clevel
					.StrData = cdata
					Exit Sub
				End If
			End With
		Next cnd
		
		'迚ｹ谿顔憾諷九ｒ莉伜刈
		With new_condition
			.Name = cname
			.Lifetime = ltime
			.Level = clevel
			.StrData = cdata
		End With
		
		colCondition.Add(new_condition, cname)
	End Sub
	
	'迚ｹ谿顔憾諷九ｒ蜑企勁
	Public Sub DeleteCondition(ByRef Index As Object)
		With colCondition.Item(Index)
			colCondition.Remove(Index)
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_WARNING: オブジェクト colCondition.Item().StrData の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			'UPGRADE_WARNING: オブジェクト colCondition.Item().Name の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			If Right(.Name, 2) = "莉伜刈" And InStr(.StrData, "Invalid_string_refer_to_original_code") = 0 Then
				Update()
			End If
		End With
	End Sub
	
	Public Sub DeleteCondition0(ByRef Index As Object)
		colCondition.Remove(Index)
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function CountCondition() As Short
		CountCondition = colCondition.Count()
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Condition(ByRef Index As Object) As String
		'UPGRADE_WARNING: オブジェクト colCondition.Item().Name の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
		Condition = colCondition.Item(Index).Name
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function ConditionLifetime(ByRef Index As Object) As Short
		On Error GoTo ErrorHandler
		'UPGRADE_WARNING: オブジェクト colCondition.Item().Lifetime の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
		ConditionLifetime = colCondition.Item(Index).Lifetime
		Exit Function
		
ErrorHandler: 
		ConditionLifetime = -1
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsConditionSatisfied(ByRef Index As Object) As Boolean
		Dim ltime As Short
		
		On Error GoTo ErrorHandler
		'UPGRADE_WARNING: オブジェクト colCondition.Item().Lifetime の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
		ltime = colCondition.Item(Index).Lifetime
		IsConditionSatisfied = True
		Exit Function
		
ErrorHandler: 
		IsConditionSatisfied = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function ConditionLevel(ByRef Index As Object) As Double
		On Error GoTo ErrorHandler
		'UPGRADE_WARNING: オブジェクト colCondition.Item().Level の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
		ConditionLevel = colCondition.Item(Index).Level
		Exit Function
		
ErrorHandler: 
		ConditionLevel = 0
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub SetConditionLevel(ByRef Index As Object, ByVal lv As Double)
		On Error GoTo ErrorHandler
		'UPGRADE_WARNING: オブジェクト colCondition.Item().Level の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
		colCondition.Item(Index).Level = lv
ErrorHandler: 
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function ConditionData(ByRef Index As Object) As String
		On Error GoTo ErrorHandler
		'UPGRADE_WARNING: オブジェクト colCondition.Item().StrData の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
		ConditionData = colCondition.Item(Index).StrData
		Exit Function
		
ErrorHandler: 
		ConditionData = ""
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub UpdateCondition(Optional ByVal decrement_lifetime As Boolean = False)
		Dim cnd As Condition
		Dim update_is_necessary As Boolean
		Dim charge_complete As Boolean
		
		For	Each cnd In colCondition
			With cnd
				If decrement_lifetime Then
					'Invalid_string_refer_to_original_code
					If .Lifetime > 0 Then
						.Lifetime = .Lifetime - 1
					End If
				End If
				
				If .Lifetime = 0 Then
					'Invalid_string_refer_to_original_code
					colCondition.Remove(.Name)
					
					Select Case .Name
						Case "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
							If Not Master Is Nothing Then
								Master.CurrentForm.DeleteSlave(ID)
								'UPGRADE_NOTE: オブジェクト Master をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
								Master = Nothing
							End If
							Mode = "騾壼ｸｸ"
						Case "繝√Ε繝ｼ繧ｸ"
							'Invalid_string_refer_to_original_code
							charge_complete = True
						Case "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
							Center(x, y)
							Escape()
							OpenMessageForm()
							DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
							CloseMessageForm()
							HandleEvent("Invalid_string_refer_to_original_code")
						Case Else
							'Invalid_string_refer_to_original_code
							'Invalid_string_refer_to_original_code_
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							update_is_necessary = True
					End Select
				End If
				'End Select
				'End If
			End With
		Next cnd
		
		'Invalid_string_refer_to_original_code
		If charge_complete Then
			AddCondition("Invalid_string_refer_to_original_code")
		End If
		
		'Invalid_string_refer_to_original_code
		If update_is_necessary Then
			Update()
		End If
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	
	'豁ｦ蝎ｨ
	Public Function Weapon(ByVal w As Short) As WeaponData
		Weapon = WData(w)
	End Function
	
	'豁ｦ蝎ｨ縺ｮ邱乗焚
	Public Function CountWeapon() As Short
		CountWeapon = UBound(WData)
	End Function
	
	'豁ｦ蝎ｨ縺ｮ諢帷ｧｰ
	Public Function WeaponNickname(ByVal w As Short) As String
		Dim u As Unit
		
		'Invalid_string_refer_to_original_code
		u = SelectedUnitForEvent
		SelectedUnitForEvent = Me
		WeaponNickname = WData(w).Nickname
		SelectedUnitForEvent = u
	End Function
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Function WeaponPower(ByVal w As Short, ByRef tarea As String) As Integer
		Dim pat As Integer
		'Invalid_string_refer_to_original_code
		Dim ed_atk As Double
		
		WeaponPower = lngWeaponPower(w)
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "蟆ｽ") Then
			If EN >= WeaponENConsumption(w) Then
				WeaponPower = WeaponPower + (EN - WeaponENConsumption(w)) * WeaponLevel(w, "蟆ｽ")
			End If
		End If
		
		'繝繝｡繝ｼ繧ｸ蝗ｺ螳壽ｭｦ蝎ｨ
		Dim wad As Double
		If IsWeaponClassifiedAs(w, "蝗ｺ") Then
			
			'Invalid_string_refer_to_original_code
			If tarea = "" Then
				Exit Function
			End If
			
			'Invalid_string_refer_to_original_code
			If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
				If SelectedMapAttackPower > 0 Then
					WeaponPower = SelectedMapAttackPower
				End If
			End If
			
			'蝨ｰ蠖｢驕ｩ蠢懊↓繧医ｋ菫ｮ豁｣縺ｮ縺ｿ繧帝←逕ｨ
			wad = WeaponAdaption(w, tarea)
			
			'Invalid_string_refer_to_original_code
			If IsOptionDefined("蝨ｰ蠖｢驕ｩ蠢應ｿｮ豁｣郢ｰ繧贋ｸ九£") Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				wad = wad + 0.1
			Else
				wad = wad + 0.2
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		wad = wad - 0.1
		wad = wad - 0.2
		'End If
		
		If wad > 0 Then
			WeaponPower = WeaponPower * wad
		Else
			WeaponPower = 0
		End If
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		WeaponPower = WeaponPower * (50 + 50 * HP / MaxHP) \ 100
		'End If
		
		'Invalid_string_refer_to_original_code
		If tarea = "" Then
			Exit Function
		End If
		
		With MainPilot
			If BCList.IsDefined("Invalid_string_refer_to_original_code") Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				pat = (.Infight + .Shooting) \ 2
			ElseIf IsWeaponClassifiedAs(w, "譬ｼ髣倡ｳｻ") Then 
				pat = .Infight
			Else
				pat = .Shooting
			End If
			
			'Invalid_string_refer_to_original_code
			BCVariable.DataReset()
			BCVariable.MeUnit = Me
			BCVariable.AtkUnit = Me
			'UPGRADE_NOTE: オブジェクト BCVariable.DefUnit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			BCVariable.DefUnit = Nothing
			BCVariable.WeaponNumber = w
			BCVariable.AttackExp = pat
			BCVariable.WeaponPower = WeaponPower
			WeaponPower = BCList.Item("Invalid_string_refer_to_original_code").Calculate()
			'Invalid_string_refer_to_original_code
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			WeaponPower = WeaponPower * (.Infight + .Shooting) \ 200
			IsWeaponClassifiedAs(w, "譬ｼ髣倡ｳｻ")
			WeaponPower = WeaponPower * .Infight \ 100
			WeaponPower = WeaponPower * .Shooting \ 100
			'End If
			
			'豌怜鴨縺ｫ繧医ｋ菫ｮ豁｣
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			WeaponPower = WeaponPower * (50 + (.Morale + .MoraleMod) \ 2) \ 100
			WeaponPower = WeaponPower * (.Morale + .MoraleMod) \ 100
			'End If
			
			'End If
			
			'隕壽ぁ
			If HP <= MaxHP \ 4 Then
				If .IsSkillAvailable("隕壽ぁ") Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					WeaponPower = 1.1 * WeaponPower
				Else
					WeaponPower = 1.2 * WeaponPower
				End If
			End If
			'End If
		End With
		
		'Invalid_string_refer_to_original_code
		If tarea = "蛻晄悄蛟､" Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
			If SelectedMapAttackPower > 0 Then
				WeaponPower = SelectedMapAttackPower
			End If
		End If
		
		'蝨ｰ蠖｢陬懈ｭ｣
		If BCList.IsDefined("Invalid_string_refer_to_original_code") Then
			'Invalid_string_refer_to_original_code
			BCVariable.DataReset()
			BCVariable.MeUnit = Me
			BCVariable.AtkUnit = Me
			'UPGRADE_NOTE: オブジェクト BCVariable.DefUnit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			BCVariable.DefUnit = Nothing
			BCVariable.WeaponNumber = w
			BCVariable.AttackExp = WeaponPower
			BCVariable.TerrainAdaption = WeaponAdaption(w, tarea)
			WeaponPower = BCList.Item("Invalid_string_refer_to_original_code").Calculate()
		Else
			WeaponPower = WeaponPower * WeaponAdaption(w, tarea)
		End If
	End Function
	
	'豁ｦ蝎ｨ w 縺ｮ蝨ｰ蠖｢ tarea 縺ｫ縺翫¢繧九ム繝｡繝ｼ繧ｸ菫ｮ豁｣蛟､
	Public Function WeaponAdaption(ByVal w As Short, ByRef tarea As String) As Double
		Dim wad, uad, xad As Short
		Dim ind As Short
		
		'Invalid_string_refer_to_original_code
		Select Case tarea
			Case "遨ｺ荳ｭ"
				ind = 1
			Case "Invalid_string_refer_to_original_code"
				If TerrainClass(x, y) = "譛磯擇" Then
					ind = 4
				Else
					ind = 2
				End If
			Case "Invalid_string_refer_to_original_code"
				If Mid(Weapon(w).Adaption, 3, 1) = "A" Then
					ind = 3
				Else
					ind = 2
				End If
			Case "豌ｴ荳ｭ"
				ind = 3
			Case "Invalid_string_refer_to_original_code"
				ind = 4
			Case "蝨ｰ荳ｭ"
				WeaponAdaption = 0
				Exit Function
			Case Else
				xad = 4
				GoTo CalcAdaption
		End Select
		
		'豁ｦ蝎ｨ縺ｮ蝨ｰ蠖｢驕ｩ蠢懷､
		Select Case Mid(Weapon(w).Adaption, ind, 1)
			Case "S"
				wad = 5
			Case "A"
				wad = 4
			Case "B"
				wad = 3
			Case "C"
				wad = 2
			Case "D"
				wad = 1
			Case "-"
				WeaponAdaption = 0
				Exit Function
		End Select
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'And Not IsWeaponClassifiedAs(w, "謗･") _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		Select Case Area
			Case "遨ｺ荳ｭ"
				ind = 1
			Case "Invalid_string_refer_to_original_code"
				If TerrainClass(x, y) = "譛磯擇" Then
					ind = 4
				Else
					ind = 2
				End If
			Case "Invalid_string_refer_to_original_code"
				ind = 2
			Case "豌ｴ荳ｭ"
				ind = 3
			Case "Invalid_string_refer_to_original_code"
				ind = 4
			Case "蝨ｰ荳ｭ"
				WeaponAdaption = 0
				Exit Function
		End Select
		'Invalid_string_refer_to_original_code
		uad = Adaption(ind)
		'Invalid_string_refer_to_original_code
		Select Case tarea
			Case "遨ｺ荳ｭ"
				uad = Adaption(1)
				'Invalid_string_refer_to_original_code
				If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
					uad = uad + WeaponLevel(w, "Invalid_string_refer_to_original_code")
				End If
			Case "Invalid_string_refer_to_original_code"
				If Adaption(2) > 0 Then
					uad = Adaption(2)
				Else
					'Invalid_string_refer_to_original_code
					uad = MaxLng(Adaption(1) - 1, 0)
				End If
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				uad = MaxDbl(Adaption(2), Adaption(3))
				If uad <= 0 Then
					'Invalid_string_refer_to_original_code
					uad = MaxLng(Adaption(1) - 1, 0)
				End If
			Case "豌ｴ荳ｭ"
				uad = Adaption(3)
			Case "Invalid_string_refer_to_original_code"
				uad = Adaption(4)
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
					uad = uad + WeaponLevel(w, "Invalid_string_refer_to_original_code")
				End If
				'End If
			Case Else
				uad = Adaption(ind)
		End Select
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsOptionDefined("Invalid_string_refer_to_original_code") Then
			If uad > 0 Then
				xad = wad
				GoTo CalcAdaption
			Else
				WeaponAdaption = 0
				Exit Function
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If uad > wad Then
			xad = wad
		Else
			xad = uad
		End If
		
CalcAdaption: 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If IsOptionDefined("蝨ｰ蠖｢驕ｩ蠢應ｿｮ豁｣郢ｰ繧贋ｸ九£") Then
			Select Case xad
				Case 5
					WeaponAdaption = 1.1
				Case 4
					WeaponAdaption = 1
				Case 3
					WeaponAdaption = 0.9
				Case 2
					WeaponAdaption = 0.8
				Case 1
					WeaponAdaption = 0.7
				Case Else
					WeaponAdaption = 0
			End Select
		Else
			Select Case xad
				Case 5
					WeaponAdaption = 1.2
				Case 4
					WeaponAdaption = 1.1
				Case 3
					WeaponAdaption = 1
				Case 2
					WeaponAdaption = 0.9
				Case 1
					WeaponAdaption = 0.8
				Case Else
					WeaponAdaption = 0
			End Select
		End If
		If IsOptionDefined("蝨ｰ蠖｢驕ｩ蠢應ｿｮ豁｣郢ｰ繧贋ｸ九£") Then
			Select Case xad
				Case 5
					WeaponAdaption = 1.2
				Case 4
					WeaponAdaption = 1
				Case 3
					WeaponAdaption = 0.8
				Case 2
					WeaponAdaption = 0.6
				Case 1
					WeaponAdaption = 0.4
				Case Else
					WeaponAdaption = 0
			End Select
		Else
			Select Case xad
				Case 5
					WeaponAdaption = 1.4
				Case 4
					WeaponAdaption = 1.2
				Case 3
					WeaponAdaption = 1
				Case 2
					WeaponAdaption = 0.8
				Case 1
					WeaponAdaption = 0.6
				Case Else
					WeaponAdaption = 0
			End Select
		End If
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function WeaponMaxRange(ByVal w As Short) As Short
		WeaponMaxRange = intWeaponMaxRange(w)
		
		'Invalid_string_refer_to_original_code
		If WeaponMaxRange = 1 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Or IsWeaponClassifiedAs(w, "謗･") _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsUnderSpecialPowerEffect("Invalid_string_refer_to_original_code") Then
			WeaponMaxRange = WeaponMaxRange + SpecialPowerEffectLevel("Invalid_string_refer_to_original_code")
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function WeaponENConsumption(ByVal w As Short) As Short
		'UPGRADE_NOTE: rate は rate_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
		Dim rate_Renamed As Double
		Dim i As Short
		
		With Weapon(w)
			WeaponENConsumption = .ENConsumption
			
			'Invalid_string_refer_to_original_code
			If CountPilot > 0 Then
				'Invalid_string_refer_to_original_code
				If IsSpellWeapon(w) Then
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'UPGRADE_WARNING: WeaponENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case 1
						''UPGRADE_WARNING: WeaponENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case 2
							'WeaponENConsumption = 0.9 * WeaponENConsumption
							''UPGRADE_WARNING: WeaponENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
							'Case 3
								'WeaponENConsumption = 0.8 * WeaponENConsumption
								''UPGRADE_WARNING: WeaponENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
								'Case 4
									'WeaponENConsumption = 0.7 * WeaponENConsumption
									''UPGRADE_WARNING: WeaponENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
									'Case 5
										'WeaponENConsumption = 0.6 * WeaponENConsumption
										''UPGRADE_WARNING: WeaponENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
										'Case 6
											'WeaponENConsumption = 0.5 * WeaponENConsumption
											''UPGRADE_WARNING: WeaponENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
											'Case 7
												'WeaponENConsumption = 0.45 * WeaponENConsumption
												''UPGRADE_WARNING: WeaponENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
												'Case 8
													'WeaponENConsumption = 0.4 * WeaponENConsumption
													''UPGRADE_WARNING: WeaponENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
													'Case 9
														'WeaponENConsumption = 0.35 * WeaponENConsumption
														''UPGRADE_WARNING: WeaponENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
				End If
				
				'Invalid_string_refer_to_original_code
				If IsFeatWeapon(w) Then
					'Invalid_string_refer_to_original_code
					Select Case MainPilot.SkillLevel("謚")
						Case 1
						Case 2
							WeaponENConsumption = 0.9 * WeaponENConsumption
						Case 3
							WeaponENConsumption = 0.8 * WeaponENConsumption
						Case 4
							WeaponENConsumption = 0.7 * WeaponENConsumption
						Case 5
							WeaponENConsumption = 0.6 * WeaponENConsumption
						Case 6
							WeaponENConsumption = 0.5 * WeaponENConsumption
						Case 7
							WeaponENConsumption = 0.45 * WeaponENConsumption
						Case 8
							WeaponENConsumption = 0.4 * WeaponENConsumption
						Case 9
							WeaponENConsumption = 0.35 * WeaponENConsumption
						Case Is >= 10
							WeaponENConsumption = 0.3 * WeaponENConsumption
					End Select
					WeaponENConsumption = MinLng(MaxLng(WeaponENConsumption, 5), .ENConsumption)
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			rate_Renamed = 1
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			For i = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				rate_Renamed = rate_Renamed - 0.1 * FeatureLevel(i)
				'End If
			Next 
			'End If
			
			If rate_Renamed < 0.1 Then
				rate_Renamed = 0.1
			End If
			WeaponENConsumption = rate_Renamed * WeaponENConsumption
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function WeaponPrecision(ByVal w As Short) As Short
		WeaponPrecision = intWeaponPrecision(w)
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function WeaponCritical(ByVal w As Short) As Short
		WeaponCritical = intWeaponCritical(w)
	End Function
	
	'豁ｦ蝎ｨ w 縺ｮ螻樊ｧ
	Public Function WeaponClass(ByVal w As Short) As String
		WeaponClass = strWeaponClass(w)
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsWeaponClassifiedAs(ByVal w As Short, ByRef attr As String) As Boolean
		Dim wclass As String
		
		wclass = strWeaponClass(w)
		
		'Invalid_string_refer_to_original_code
		If Len(attr) <= 2 Then
			If InStrNotNest(wclass, attr) > 0 Then
				IsWeaponClassifiedAs = True
			Else
				IsWeaponClassifiedAs = False
			End If
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If InStrNotNest(wclass, attr) > 0 Then
			IsWeaponClassifiedAs = True
		Else
			IsWeaponClassifiedAs = False
		End If
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		Select Case attr
			Case "譬ｼ髣倡ｳｻ"
				If InStrNotNest(wclass, "譬ｼ") > 0 Then
					IsWeaponClassifiedAs = True
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					IsWeaponClassifiedAs = False
				ElseIf Weapon(w).MaxRange = 1 Then 
					IsWeaponClassifiedAs = True
				Else
					IsWeaponClassifiedAs = False
				End If
				Exit Function
			Case "Invalid_string_refer_to_original_code"
				If InStrNotNest(wclass, "譬ｼ") > 0 Then
					IsWeaponClassifiedAs = False
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					IsWeaponClassifiedAs = True
				ElseIf Weapon(w).MaxRange = 1 Then 
					IsWeaponClassifiedAs = False
				Else
					IsWeaponClassifiedAs = True
				End If
			Case "Invalid_string_refer_to_original_code"
				If IsUnderSpecialPowerEffect("蜈ｨ豁ｦ蝎ｨ遘ｻ蜍募ｾ御ｽｿ逕ｨ蜿ｯ閭ｽ") And InStrNotNest(wclass, "Invalid_string_refer_to_original_code") = 0 And InStrNotNest(wclass, "Invalid_string_refer_to_original_code") = 0 Then
					IsWeaponClassifiedAs = True
				ElseIf Weapon(w).MaxRange = 1 Then 
					If InStrNotNest(wclass, "Invalid_string_refer_to_original_code") = 0 Then
						IsWeaponClassifiedAs = True
					Else
						IsWeaponClassifiedAs = False
					End If
				ElseIf InStrNotNest(wclass, "Invalid_string_refer_to_original_code") > 0 Then 
					IsWeaponClassifiedAs = True
				End If
		End Select
	End Function
	
	'豁ｦ蝎ｨ w 縺ｮ螻樊ｧ attr 縺ｫ縺翫¢繧九Ξ繝吶Ν
	Public Function WeaponLevel(ByVal w As Short, ByRef attr As String) As Double
		Dim attrlv, wclass As String
		Dim start_idx, i As Short
		Dim c As String
		
		On Error GoTo ErrorHandler
		
		attrlv = attr & "L"
		
		'Invalid_string_refer_to_original_code
		wclass = strWeaponClass(w)
		
		'Invalid_string_refer_to_original_code
		start_idx = InStrNotNest(wclass, attrlv)
		If start_idx = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		start_idx = start_idx + Len(attrlv)
		i = start_idx
		Do While True
			c = Mid(wclass, i, 1)
			
			If c = "" Then
				Exit Do
			End If
			
			Select Case Asc(c)
				Case 45 To 46, 48 To 57 '"-", ".", 0-9
				Case Else
					Exit Do
			End Select
			
			i = i + 1
		Loop 
		
		WeaponLevel = CDbl(Mid(wclass, start_idx, i - start_idx))
		Exit Function
		
ErrorHandler: 
		ErrorMessage(Name & "縺ｮ" & "Invalid_string_refer_to_original_code")
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsWeaponLevelSpecified(ByVal w As Short, ByRef attr As String) As Boolean
		If InStr(strWeaponClass(w), attr & "L") > 0 Then
			IsWeaponLevelSpecified = True
			Exit Function
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsNormalWeapon(ByVal w As Short) As Boolean
		Dim i As Short
		Dim wclass As String
		Dim ret As Short
		
		'Invalid_string_refer_to_original_code
		wclass = strWeaponClass(w)
		For i = 1 To Len(wclass)
			'Invalid_string_refer_to_original_code_
			'Mid$(wclass, i, 1))
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If ret > 0 Then
				Exit Function
			End If
		Next 
		
		IsNormalWeapon = True
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CountWeaponEffect(ByVal w As Short) As Short
		Dim wclass, wattr As String
		Dim i, ret As Short
		
		wclass = strWeaponClass(w)
		For i = 1 To Len(wclass)
			'Invalid_string_refer_to_original_code
			wattr = GetClassBundle(wclass, i, 1)
			
			'Invalid_string_refer_to_original_code
			If wattr = "|" Then
				Exit For
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'wattr)
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If ret > 0 Then
				CountWeaponEffect = CountWeaponEffect + 1
			End If
			
			'Invalid_string_refer_to_original_code
			ret = InStr("Invalid_string_refer_to_original_code", wattr)
			If ret > 0 Then
				CountWeaponEffect = CountWeaponEffect + 1
			End If
		Next 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsSpellWeapon(ByVal w As Short) As Boolean
		Dim i As Short
		Dim nskill As String
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		IsSpellWeapon = True
		Exit Function
		'End If
		
		With MainPilot
			For i = 1 To LLength((Weapon(w).NecessarySkill))
				nskill = LIndex((Weapon(w).NecessarySkill), i)
				If InStr(nskill, "Lv") > 0 Then
					nskill = Left(nskill, InStr(nskill, "Lv") - 1)
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsSpellWeapon = True
				Exit Function
				'End If
			Next 
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsFeatWeapon(ByVal w As Short) As Boolean
		Dim i As Short
		Dim nskill As String
		
		If IsWeaponClassifiedAs(w, "謚") Then
			IsFeatWeapon = True
			Exit Function
		End If
		
		With MainPilot
			For i = 1 To LLength((Weapon(w).NecessarySkill))
				nskill = LIndex((Weapon(w).NecessarySkill), i)
				If InStr(nskill, "Lv") > 0 Then
					nskill = Left(nskill, InStr(nskill, "Lv") - 1)
				End If
				If .SkillType(nskill) = "謚" Then
					IsFeatWeapon = True
					Exit Function
				End If
			Next 
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Function IsWeaponAvailable(ByVal w As Short, ByRef ref_mode As String) As Boolean
		Dim i As Short
		Dim wd As WeaponData
		Dim wclass As String
		
		IsWeaponAvailable = False
		
		' ADD START MARGE
		'Invalid_string_refer_to_original_code
		If Not (w > 0) Then
			Exit Function
		End If
		' ADD END MARGE
		
		wd = Weapon(w)
		wclass = WeaponClass(w)
		
		'Invalid_string_refer_to_original_code
		If IsDisabled((wd.Name)) Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If CountPilot = 0 Then
			IsWeaponAvailable = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If Not IsWeaponMastered(w) Then
			Exit Function
		End If
		
		If Not IsWeaponEnabled(w) Then
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If ref_mode = "繧､繝ｳ繧ｿ繝ｼ繝溘ャ繧ｷ繝ｧ繝ｳ" Or ref_mode = "" Then
			IsWeaponAvailable = True
			Exit Function
		End If
		
		With MainPilot
			'Invalid_string_refer_to_original_code
			If wd.NecessaryMorale > 0 Then
				If .Morale < wd.NecessaryMorale Then
					Exit Function
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
			'End If
			'End If
		End With
		
		'Invalid_string_refer_to_original_code
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			If IsWeaponClassifiedAs(w, "繧ｪ") Then
				Exit Function
			End If
		End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		'End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			If IsWeaponClassifiedAs(w, "繧ｷ") Then
				Exit Function
			End If
		End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			If IsWeaponClassifiedAs(w, "繧ｵ") Then
				Exit Function
			End If
		End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			If IsWeaponClassifiedAs(w, "繧ｵ") Then
				Exit Function
			End If
		End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		'End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		'End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			If IsWeaponClassifiedAs(w, "謚") Then
				Exit Function
			End If
		End If
		For i = 1 To CountCondition
			If Len(Condition(i)) > 6 Then
				If Right(Condition(i), 6) = "Invalid_string_refer_to_original_code" Then
					If InStrNotNest(WeaponClass(w), Left(Condition(i), Len(Condition(i)) - 6)) > 0 Then
						Exit Function
					End If
				End If
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		If wd.Bullet > 0 Then
			If Bullet(w) < 1 Then
				Exit Function
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If wd.ENConsumption > 0 Then
			If EN < WeaponENConsumption(w) Then
				Exit Function
			End If
		End If
		
		'縺企≡縺瑚ｶｳ繧翫ｋ縺銀ｦ窶ｦ
		If Party = "蜻ｳ譁ｹ" Then
			If InStrNotNest(wclass, "驫ｭ") > 0 Then
				If Money < MaxLng(WeaponLevel(w, "驫ｭ"), 1) * Value \ 10 Then
					Exit Function
				End If
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If ref_mode <> "Invalid_string_refer_to_original_code" Then
			If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
				Exit Function
			End If
		End If
		If Area = "蝨ｰ荳ｭ" Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
			If InStrNotNest(wclass, "Invalid_string_refer_to_original_code") > 0 Then
				Exit Function
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If IsSpellWeapon(w) Or InStrNotNest(wclass, "髻ｳ") > 0 Then
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If Not IsCombinationAttackAvailable(w) Then
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If IsFeatureAvailable("螟牙ｽ｢謚") Then
			For i = 1 To CountFeature
				If Feature(i) = "螟牙ｽ｢謚" And LIndex(FeatureData(i), 1) = wd.Name Then
					If Not OtherForm(LIndex(FeatureData(i), 2)).IsAbleToEnter(x, y) Then
						Exit Function
					End If
				End If
			Next 
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		'End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If HP > MaxHP \ 4 Then
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied(WeaponNickname(w) & "Invalid_string_refer_to_original_code") Then
			Exit Function
		End If
		'Invalid_string_refer_to_original_code
		Dim lv As Short
		If InStrNotNest(wclass, "蜈ｱ") > 0 Then
			lv = WeaponLevel(w, "蜈ｱ")
			For i = 1 To CountWeapon
				If IsWeaponClassifiedAs(i, "蜈ｱ") Then
					If lv = WeaponLevel(i, "蜈ｱ") Then
						If IsConditionSatisfied(WeaponNickname(i) & "Invalid_string_refer_to_original_code") Then
							Exit Function
						End If
					End If
				End If
			Next 
			For i = 1 To CountAbility
				If IsAbilityClassifiedAs(i, "蜈ｱ") Then
					If lv = AbilityLevel(i, "蜈ｱ") Then
						If IsConditionSatisfied(AbilityNickname(i) & "Invalid_string_refer_to_original_code") Then
							Exit Function
						End If
					End If
				End If
			Next 
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		Exit Function
		'End If
		'End If
		
		'菴ｿ逕ｨ遖∵ｭ｢
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If ref_mode = "繝√Ε繝ｼ繧ｸ" Then
			IsWeaponAvailable = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If InStrNotNest(wclass, "Invalid_string_refer_to_original_code") > 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		'End If
		
		If ref_mode = "Invalid_string_refer_to_original_code" Then
			IsWeaponAvailable = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If Party <> Stage Then
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If InStrNotNest(wclass, "謾ｻ") > 0 Then
			For i = 1 To Len(wclass)
				If Mid(wclass, i, 1) = "謾ｻ" Then
					If i = 1 Then
						Exit Function
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Exit Function
				End If
			Next 
		End If
		'Next
		'End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		'End If
		
		'遘ｻ蜍募燕縺句ｾ後°窶ｦ窶ｦ
		'Invalid_string_refer_to_original_code_
		'Or Not SelectedUnit Is Me _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		IsWeaponAvailable = True
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsUnderSpecialPowerEffect("蜈ｨ豁ｦ蝎ｨ遘ｻ蜍募ｾ御ｽｿ逕ｨ蜿ｯ閭ｽ") And Not InStrNotNest(wclass, "Invalid_string_refer_to_original_code") > 0 Then
			IsWeaponAvailable = True
		ElseIf WeaponMaxRange(w) > 1 Then 
			If InStrNotNest(wclass, "Invalid_string_refer_to_original_code") > 0 Then
				IsWeaponAvailable = True
			Else
				IsWeaponAvailable = False
			End If
		Else
			If InStrNotNest(wclass, "Invalid_string_refer_to_original_code") > 0 Then
				IsWeaponAvailable = False
			Else
				IsWeaponAvailable = True
			End If
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsWeaponMastered(ByVal w As Short) As Boolean
		IsWeaponMastered = IsNecessarySkillSatisfied((Weapon(w).NecessarySkill))
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsWeaponEnabled(ByVal w As Short) As Boolean
		IsWeaponEnabled = IsNecessarySkillSatisfied((Weapon(w).NecessaryCondition))
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsWeaponUseful(ByVal w As Short, ByRef ref_mode As String) As Boolean
		Dim i, j As Short
		Dim u As Unit
		Dim max_range As Short
		
		'Invalid_string_refer_to_original_code
		If Not IsWeaponAvailable(w, ref_mode) Then
			IsWeaponUseful = False
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		IsWeaponUseful = True
		Exit Function
		'End If
		
		max_range = WeaponMaxRange(w)
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		'Invalid_string_refer_to_original_code
		For i = MaxLng(x - max_range, 1) To MinLng(x + max_range, MapWidth)
			For j = MaxLng(y - max_range, 1) To MinLng(y + max_range, MapHeight)
				u = MapDataForUnit(i, j)
				If u Is Nothing Then
					GoTo NextUnit
				End If
				With u
					Select Case Party
						Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
							Select Case .Party
								Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
									'Invalid_string_refer_to_original_code
									'Invalid_string_refer_to_original_code_
									'Invalid_string_refer_to_original_code_
									'And Not .IsConditionSatisfied("逹｡逵") _
									'Then
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									GoTo NextUnit
									'End If
							End Select
						Case Else
							If Party = .Party Then
								'Invalid_string_refer_to_original_code
								'Invalid_string_refer_to_original_code_
								'Invalid_string_refer_to_original_code_
								'Then
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								GoTo NextUnit
							End If
							'End If
					End Select
				End With
				
				If IsTargetWithinRange(w, u) Then
					If Weapon(w).Power > 0 Then
						If Damage(w, u, True) <> 0 Then
							IsWeaponUseful = True
							Exit Function
						End If
					Else
						If CriticalProbability(w, u) > 0 Then
							IsWeaponUseful = True
							Exit Function
						End If
					End If
				End If
NextUnit: 
			Next 
		Next 
		
		'Invalid_string_refer_to_original_code
		IsWeaponUseful = False
	End Function
	
	
	'Invalid_string_refer_to_original_code
	Public Function IsTargetWithinRange(ByVal w As Short, ByRef t As Unit) As Boolean
		Dim max_range, distance, range_mod As Short
		Dim lv As Short
		
		IsTargetWithinRange = True
		
		Dim partners() As Unit
		With t
			'Invalid_string_refer_to_original_code
			distance = System.Math.Abs(x - .x) + System.Math.Abs(y - .y)
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			
			'Invalid_string_refer_to_original_code
			max_range = WeaponMaxRange(w)
			If distance > max_range + range_mod Then
				IsTargetWithinRange = False
				Exit Function
			End If
			
			'Invalid_string_refer_to_original_code
			If distance < Weapon(w).MinRange - range_mod Then
				IsTargetWithinRange = False
				Exit Function
			End If
			
			'Invalid_string_refer_to_original_code
			If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				If .IsFeatureLevelSpecified("Invalid_string_refer_to_original_code") Then
					lv = .FeatureLevel("Invalid_string_refer_to_original_code")
				Else
					lv = 3
				End If
				'Invalid_string_refer_to_original_code_
				'And distance > lv _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsTargetWithinRange = False
				Exit Function
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If .IsUnderSpecialPowerEffect("髫繧瑚ｺｫ") Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsTargetWithinRange = False
				Exit Function
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If WeaponAdaption(w, .Area) = 0 Then
				IsTargetWithinRange = False
				Exit Function
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'And max_range = 1 _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			CombinationPartner("Invalid_string_refer_to_original_code")
			If UBound(partners) = 0 Then
				IsTargetWithinRange = False
				Exit Function
			End If
			'End If
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsTargetReachable(ByVal w As Short, ByRef t As Unit) As Boolean
		Dim i, j As Short
		Dim max_range, min_range As Short
		
		Dim partners() As Unit
		With t
			'Invalid_string_refer_to_original_code
			If WeaponAdaption(w, .Area) = 0 Then
				IsTargetReachable = False
				Exit Function
			End If
			
			'Invalid_string_refer_to_original_code
			If .IsUnderSpecialPowerEffect("髫繧瑚ｺｫ") Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsTargetReachable = False
				Exit Function
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			min_range = Weapon(w).MinRange
			max_range = WeaponMaxRange(w)
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If .IsFeatureLevelSpecified("Invalid_string_refer_to_original_code") Then
				max_range = MinLng(max_range, .FeatureLevel("Invalid_string_refer_to_original_code") + 1)
			Else
				max_range = MinLng(max_range, 4)
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If min_range = 1 And System.Math.Abs(x - .x) + System.Math.Abs(y - .y) = 1 Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'And WeaponMaxRange(w) = 1 _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				CombinationPartner("Invalid_string_refer_to_original_code")
				If UBound(partners) = 0 Then
					IsTargetReachable = False
					Exit Function
				End If
			End If
			IsTargetReachable = True
			Exit Function
			'End If
			
			'Invalid_string_refer_to_original_code
			For i = MaxLng(.x - max_range, 1) To MinLng(.x + max_range, MapWidth)
				For j = MaxLng(.y - (max_range - System.Math.Abs(.x - i)), 1) To MinLng(.y + (max_range - System.Math.Abs(.x - i)), MapHeight)
					If min_range <= System.Math.Abs(.x - i) + System.Math.Abs(.y - i) Then
						If Not MaskData(i, j) Then
							IsTargetReachable = True
							Exit Function
						End If
					End If
				Next 
			Next 
		End With
		
		IsTargetReachable = False
	End Function
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Function HitProbability(ByVal w As Short, ByRef t As Unit, ByVal is_true_value As Boolean) As Short
		Dim prob As Integer
		Dim mpskill As Short
		Dim i, j As Short
		Dim u As Unit
		Dim wclass As String
		Dim ecm_lv, eccm_lv As Double
		Dim buf As String
		Dim fdata As String
		Dim flevel, prob_mod As Double
		Dim nmorale As Short
		'蜻ｽ荳ｭ縲∝屓驕ｿ縲∝慍蠖｢陬懈ｭ｣縲√し繧､繧ｺ陬懈ｭ｣縺ｮ謨ｰ蛟､繧貞ｮ夂ｾｩ
		Dim ed_hit, ed_avd As Integer
		Dim ed_aradap, ed_size As Double
		
		'蛻晄悄蛟､
		ed_aradap = 1
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		HitProbability = 100
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		mpskill = MainPilot.TacticalTechnique
		
		'繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ縺ｫ繧医ｋ蠖ｱ髻ｿ
		If is_true_value Or mpskill >= 160 Then
			If t.IsUnderSpecialPowerEffect("邨ｶ蟇ｾ蝗樣∩") Then
				HitProbability = 0
				Exit Function
			End If
			If IsUnderSpecialPowerEffect("邨ｶ蟇ｾ蜻ｽ荳ｭ") Then
				HitProbability = 1000
				Exit Function
			End If
		End If
		
		'閾ｪ繝ｦ繝九ャ繝医↓繧医ｋ菫ｮ豁｣
		With MainPilot
			If BCList.IsDefined("蜻ｽ荳ｭ陬懈ｭ｣") Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				BCVariable.DataReset()
				BCVariable.MeUnit = Me
				BCVariable.AtkUnit = Me
				BCVariable.DefUnit = t
				BCVariable.WeaponNumber = w
				BCVariable.AttackExp = WeaponPrecision(w)
				ed_hit = BCList.Item("蜻ｽ荳ｭ陬懈ｭ｣").Calculate()
			Else
				'Invalid_string_refer_to_original_code
				ed_hit = 100 + .Hit + .Intuition + Mobility() + WeaponPrecision(w)
			End If
		End With
		
		'謨ｵ繝ｦ繝九ャ繝医↓繧医ｋ菫ｮ豁｣
		With t.MainPilot
			If BCList.IsDefined("蝗樣∩陬懈ｭ｣") Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				BCVariable.DataReset()
				BCVariable.MeUnit = t
				BCVariable.AtkUnit = Me
				BCVariable.DefUnit = t
				BCVariable.WeaponNumber = w
				ed_avd = BCList.Item("蝗樣∩陬懈ｭ｣").Calculate()
			Else
				'Invalid_string_refer_to_original_code
				ed_avd = .Dodge + .Intuition + t.Mobility()
			End If
		End With
		
		'蝨ｰ蠖｢驕ｩ蠢懊√し繧､繧ｺ菫ｮ豁｣縺ｮ菴咲ｽｮ繧貞､画峩
		Dim uadaption As Double
		Dim tarea As String
		Dim tx, ty As Short
		With t
			'蝨ｰ蠖｢菫ｮ豁｣
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			ed_aradap = ed_aradap * (100 - TerrainEffectForHit(.x, .y)) / 100
			'End If
			
			'蝨ｰ蠖｢驕ｩ蠢應ｿｮ豁｣
			If IsOptionDefined("Invalid_string_refer_to_original_code") Then
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Or IsWeaponClassifiedAs(w, "謗･") _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				tarea = .Area
				tx = .x
				ty = .y
			Else
				tarea = Area
				tx = x
				ty = y
			End If
			
			Select Case tarea
				Case "遨ｺ荳ｭ"
					uadaption = AdaptionMod(1)
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'And Not IsTransAvailable("遨ｺ") _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code_
					'Or InStrNotNest(wclass, "謗･") _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					uadaption = AdaptionMod(1, WeaponLevel(w, "Invalid_string_refer_to_original_code"))
					'End If
					'End If
				Case "Invalid_string_refer_to_original_code"
					If TerrainClass(tx, ty) = "譛磯擇" Then
						uadaption = AdaptionMod(4)
					Else
						uadaption = AdaptionMod(2)
					End If
				Case "Invalid_string_refer_to_original_code"
					uadaption = AdaptionMod(2)
				Case "豌ｴ荳ｭ"
					uadaption = AdaptionMod(3)
				Case "Invalid_string_refer_to_original_code"
					uadaption = AdaptionMod(4)
				Case "蝨ｰ荳ｭ"
					HitProbability = 0
					Exit Function
			End Select
			
			'Invalid_string_refer_to_original_code
			ed_aradap = ed_aradap * uadaption
			'End If
			
			'繧ｵ繧､繧ｺ陬懈ｭ｣
			Select Case .Size
				Case "M"
					ed_size = 1
				Case "L"
					ed_size = 1.2
				Case "S"
					ed_size = 0.8
				Case "LL"
					ed_size = 1.4
				Case "SS"
					ed_size = 0.5
				Case "XL"
					ed_size = 2
			End Select
		End With
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		BCVariable.DataReset()
		BCVariable.MeUnit = Me
		BCVariable.AtkUnit = Me
		BCVariable.DefUnit = t
		BCVariable.WeaponNumber = w
		BCVariable.AttackVariable = ed_hit
		BCVariable.DffenceVariable = ed_avd
		BCVariable.TerrainAdaption = ed_aradap
		BCVariable.SizeMod = ed_size
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Dim uad As Short
		prob = (ed_hit - ed_avd) * ed_aradap * ed_size
		'End If
		
		'荳肴э謇薙■
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = prob + 20
		'End If
		
		wclass = WeaponClass(w)
		
		With t
			'Invalid_string_refer_to_original_code
			If InStrNotNest(wclass, "謨｣") > 0 Then
				Select Case System.Math.Abs(x - .x) + System.Math.Abs(y - .y)
					Case 1
						'Invalid_string_refer_to_original_code
					Case 2
						prob = prob + 5
					Case 3
						prob = prob + 10
					Case 4
						prob = prob + 15
					Case Else
						prob = prob + 20
				End Select
			End If
			
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'And InStrNotNest(wclass, "霑ｽ") = 0 _
			'And InStrNotNest(wclass, "豁ｦ") = 0 _
			'Invalid_string_refer_to_original_code_
			'And InStrNotNest(wclass, "謗･") = 0 _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'霍晞屬菫ｮ豁｣
			If IsOptionDefined("霍晞屬菫ｮ豁｣") Then
				If InStrNotNest(wclass, "Invalid_string_refer_to_original_code") = 0 And InStrNotNest(wclass, "Invalid_string_refer_to_original_code") = 0 Then
					If IsOptionDefined("Invalid_string_refer_to_original_code") Then
						Select Case System.Math.Abs(x - .x) + System.Math.Abs(y - .y)
							Case 1 To 4
								'Invalid_string_refer_to_original_code
							Case 5, 6
								prob = 0.9 * prob
							Case 7, 8
								prob = 0.8 * prob
							Case 9, 10
								prob = 0.7 * prob
							Case Else
								prob = 0.6 * prob
						End Select
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						Select Case System.Math.Abs(x - .x) + System.Math.Abs(y - .y)
							Case 1
								'Invalid_string_refer_to_original_code
							Case 2
								prob = 0.9 * prob
							Case 3
								prob = 0.8 * prob
							Case 4
								prob = 0.75 * prob
							Case 5
								prob = 0.7 * prob
							Case 6
								prob = 0.65 * prob
							Case Else
								prob = 0.6 * prob
						End Select
					Else
						Select Case System.Math.Abs(x - .x) + System.Math.Abs(y - .y)
							Case 1 To 3
								'Invalid_string_refer_to_original_code
							Case 4
								prob = 0.9 * prob
							Case 5
								prob = 0.8 * prob
							Case 6
								prob = 0.7 * prob
							Case Else
								prob = 0.6 * prob
						End Select
					End If
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			For i = MaxLng(.x - 2, 1) To MinLng(.x + 2, MapWidth)
				For j = MaxLng(.y - 2, 1) To MinLng(.y + 2, MapHeight)
					If System.Math.Abs(.x - i) + System.Math.Abs(.y - j) <= 3 Then
						u = MapDataForUnit(i, j)
						If Not u Is Nothing Then
							With u
								If .IsAlly(t) Then
									ecm_lv = MaxDbl(ecm_lv, .FeatureLevel("Invalid_string_refer_to_original_code"))
								ElseIf .IsAlly(Me) Then 
									eccm_lv = MaxDbl(eccm_lv, .FeatureLevel("Invalid_string_refer_to_original_code"))
								End If
							End With
						End If
					End If
				Next 
			Next 
			'Invalid_string_refer_to_original_code
			If InStrNotNest(wclass, "Invalid_string_refer_to_original_code") > 0 Then
				prob = prob * (100 - 10 * MaxDbl(ecm_lv - eccm_lv, 0)) \ 100
			Else
				prob = prob * (100 - 5 * MaxDbl(ecm_lv - eccm_lv, 0)) \ 100
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If .IsFeatureLevelSpecified("Invalid_string_refer_to_original_code") Then
				If System.Math.Abs(x - .x) + System.Math.Abs(y - .y) > .FeatureLevel("Invalid_string_refer_to_original_code") Then
					prob = prob * 0.8
				End If
			Else
				If System.Math.Abs(x - .x) + System.Math.Abs(y - .y) > 3 Then
					prob = prob * 0.8
				End If
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code_
			'Or InStrNotNest(wclass, "謗･") _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			If Not IsOptionDefined("Invalid_string_refer_to_original_code") Then
				If Not IsTransAvailable("遨ｺ") Then
					uad = Adaption(1)
					If InStrNotNest(wclass, "Invalid_string_refer_to_original_code") > 0 Then
						uad = MinLng(uad + WeaponLevel(w, "Invalid_string_refer_to_original_code"), 4)
					End If
					uad = MinLng(uad, 4)
					prob = (uad + 6) * prob \ 10
				End If
			End If
			'Invalid_string_refer_to_original_code
			If IsOptionDefined("鬮伜ｺｦ菫ｮ豁｣") Then
				If InStrNotNest(wclass, "遨ｺ") = 0 Then
					prob = 0.7 * prob
				End If
			End If
			'End If
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			For i = 1 To .CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				buf = .FeatureData(i)
				For j = 2 To LLength(buf)
					If TerrainName(.x, .y) = LIndex(buf, j) Then
						prob = prob - 10
						Exit For
					End If
				Next 
				'End If
			Next 
			'End If
			
			'Invalid_string_refer_to_original_code
			If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				prob_mod = 0
				For i = 1 To .CountFeature
					If .Feature(i) = "Invalid_string_refer_to_original_code" Then
						fdata = .FeatureData(i)
						flevel = .FeatureLevel(i)
						
						'Invalid_string_refer_to_original_code
						If IsNumeric(LIndex(fdata, 3)) Then
							nmorale = CShort(LIndex(fdata, 3))
						Else
							nmorale = 0
						End If
						
						'Invalid_string_refer_to_original_code
						If .MainPilot.Morale >= nmorale And .IsAttributeClassified(LIndex(fdata, 2), wclass) Then
							'Invalid_string_refer_to_original_code
							prob_mod = prob_mod + flevel
						End If
					End If
				Next 
				prob = prob * (10 - prob_mod) \ 10
			End If
			
			'蜍輔¢縺ｪ縺代ｌ縺ｰ邨ｶ蟇ｾ縺ｫ蜻ｽ荳ｭ
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			HitProbability = 1000
			Exit Function
			'End If
			
			'Invalid_string_refer_to_original_code
			If InStrNotNest(wclass, "Invalid_string_refer_to_original_code") = 0 And InStrNotNest(wclass, "霑ｽ") = 0 Then
				If IsConditionSatisfied("謦ｹ荵ｱ") Then
					prob = prob \ 2
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				prob = prob \ 2
			End If
			If IsConditionSatisfied("逶ｲ逶ｮ") Then
				prob = prob \ 2
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If .IsConditionSatisfied("逶ｲ逶ｮ") Then
				prob = 1.5 * prob
			End If
			If .IsConditionSatisfied("繝√Ε繝ｼ繧ｸ") Then
				prob = 1.5 * prob
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = 1.5 * prob
			'End If
			If .IsConditionSatisfied("迢よ姶螢ｫ") Then
				prob = 1.5 * prob
			End If
			If .IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
				prob = 1.5 * prob
			End If
			
			'蠎募鴨
			If HP <= MaxHP \ 4 Then
				With MainPilot
					If .IsSkillAvailable("Invalid_string_refer_to_original_code") Then
						prob = prob + 50
					ElseIf .IsSkillAvailable("蠎募鴨") Then 
						prob = prob + 30
					End If
				End With
			End If
			If .HP <= .MaxHP \ 4 Then
				With .MainPilot
					If .IsSkillAvailable("Invalid_string_refer_to_original_code") Then
						prob = prob - 50
					ElseIf .IsSkillAvailable("蠎募鴨") Then 
						prob = prob - 30
					End If
				End With
			End If
			
			'Invalid_string_refer_to_original_code
			If is_true_value Or mpskill >= 160 Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			ElseIf IsConditionSatisfied("Invalid_string_refer_to_original_code") Then 
				prob = prob + 15
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			.IsConditionSatisfied("Invalid_string_refer_to_original_code")
			prob = prob - 15
			'End If
			
			If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
				prob = prob - 15
			End If
			If .IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
				prob = prob + 15
			End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'End If
			'End If
		End With
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		BCVariable.DataReset()
		BCVariable.MeUnit = Me
		BCVariable.AtkUnit = Me
		BCVariable.DefUnit = t
		BCVariable.WeaponNumber = w
		BCVariable.LastVariable = prob
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		
		If prob < 0 Then
			HitProbability = 0
		Else
			HitProbability = prob
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Function Damage(ByVal w As Short, ByRef t As Unit, ByVal is_true_value As Boolean, Optional ByVal is_support_attack As Boolean = False) As Integer
		Dim arm, arm_mod As Integer
		Dim j, i, idx As Short
		Dim ch, wclass, buf As String
		Dim mpskill As Short
		Dim fname, fdata As String
		Dim flevel As Double
		Dim slevel As Double
		Dim sdata As String
		Dim nmorale As Short
		Dim neautralize As Boolean
		Dim lv_mod As Double
		Dim opt As String
		Dim tname As String
		Dim dmg_mod, uadaption As Double
		'Invalid_string_refer_to_original_code
		Dim ed_amr As Double
		Dim ed_amr_fix As Double
		
		wclass = WeaponClass(w)
		
		'Invalid_string_refer_to_original_code
		mpskill = MainPilot.TacticalTechnique
		
		With t
			'Invalid_string_refer_to_original_code
			Damage = WeaponPower(w, .Area)
			'Invalid_string_refer_to_original_code
			If Damage = 0 Then
				Exit Function
			End If
			
			'Invalid_string_refer_to_original_code
			arm = .Armor
			
			'Invalid_string_refer_to_original_code
			If Not .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				GoTo SkipArmor
			End If
			'Invalid_string_refer_to_original_code
			If Not is_true_value And mpskill < 150 Then
				GoTo SkipArmor
			End If
			arm_mod = 0
			For i = 1 To .CountFeature
				If .Feature(i) = "Invalid_string_refer_to_original_code" Then
					fname = .FeatureName0(i)
					fdata = .FeatureData(i)
					flevel = .FeatureLevel(i)
					
					'Invalid_string_refer_to_original_code
					If IsNumeric(LIndex(fdata, 3)) Then
						nmorale = CShort(LIndex(fdata, 3))
					Else
						nmorale = 0
					End If
					
					'繧ｪ繝励す繝ｧ繝ｳ
					neautralize = False
					slevel = 0
					For j = 4 To LLength(fdata)
						opt = LIndex(fdata, j)
						idx = InStr(opt, "*")
						If idx > 0 Then
							lv_mod = StrToDbl(Mid(opt, idx + 1))
							opt = Left(opt, idx - 1)
						Else
							lv_mod = -1
						End If
						
						Select Case opt
							Case "Invalid_string_refer_to_original_code"
								'Invalid_string_refer_to_original_code
							Case "Invalid_string_refer_to_original_code"
								If lv_mod = -1 Then
									lv_mod = 5
								End If
								slevel = lv_mod * (.MainPilot.SynchroRate - 30)
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								If slevel = -30 * lv_mod Then
									neautralize = True
								End If
						End Select
					Next 
				Else
					If slevel = -30 * lv_mod Then
						slevel = 0
					End If
				End If
				'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case "髴雁鴨"
					'If lv_mod = -1 Then
						'lv_mod = 2
					'End If
					'slevel = lv_mod * .MainPilot.Plana
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'If slevel = 0 Then
						'neautralize = True
					'End If
					'End If
					''UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case "繧ｪ繝ｼ繝ｩ"
						'If lv_mod = -1 Then
							'lv_mod = 50
						'End If
						'slevel = lv_mod * .AuraLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'If slevel = 0 Then
							'neautralize = True
						'End If
						'End If
						''UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case "Invalid_string_refer_to_original_code"
							'If lv_mod = -1 Then
								'lv_mod = 50
							'End If
							'slevel = lv_mod * .PsychicLevel
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'If slevel = 0 Then
								'neautralize = True
							'End If
							'End If
							''UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
							'Case "Invalid_string_refer_to_original_code"
								'If lv_mod = -1 Then
									'lv_mod = 50
								'End If
								'Invalid_string_refer_to_original_code_
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								'If slevel = 0 Then
									'neautralize = True
								'End If
								'End If
								''UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
			Next 
			
			'Invalid_string_refer_to_original_code
			If .MainPilot.Morale >= nmorale And .IsAttributeClassified(LIndex(fdata, 2), wclass) And Not neautralize Then
				'Invalid_string_refer_to_original_code
				arm_mod = arm_mod + 100 * flevel + slevel
			End If
			'End If
			'Next
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			arm_mod = arm_mod \ 2
			'End If
			
			arm = arm + arm_mod
			
SkipArmor: 
			
			'Invalid_string_refer_to_original_code
			If Not IsOptionDefined("Invalid_string_refer_to_original_code") Then
				Select Case .Area
					Case "遨ｺ荳ｭ"
						uadaption = .AdaptionMod(1)
					Case "Invalid_string_refer_to_original_code"
						If TerrainClass(.x, .y) = "譛磯擇" Then
							uadaption = .AdaptionMod(4)
						Else
							uadaption = .AdaptionMod(2)
						End If
					Case "Invalid_string_refer_to_original_code"
						uadaption = .AdaptionMod(2)
					Case "豌ｴ荳ｭ"
						uadaption = .AdaptionMod(3)
					Case "Invalid_string_refer_to_original_code"
						uadaption = .AdaptionMod(4)
					Case "蝨ｰ荳ｭ"
						Damage = 0
						Exit Function
				End Select
				If uadaption = 0 Then
					uadaption = 0.6
				End If
			Else
				If .Area = "蝨ｰ荳ｭ" Then
					Damage = 0
					Exit Function
				Else
					uadaption = 1
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If .HP <= .MaxHP \ 8 Then
				arm = 1.15 * arm
			ElseIf .HP <= .MaxHP \ 4 Then 
				arm = 1.1 * arm
			ElseIf .HP <= .MaxHP \ 2 Then 
				arm = 1.05 * arm
			End If
			If .HP <= .MaxHP \ 8 Then
				arm = 1.3 * arm
			ElseIf .HP <= .MaxHP \ 4 Then 
				arm = 1.2 * arm
			ElseIf .HP <= .MaxHP \ 2 Then 
				arm = 1.1 * arm
			End If
			'End If
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			arm = 0
			'End If
			
			If is_true_value Or mpskill >= 160 Then
				'繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ縺ｫ繧医ｋ菫ｮ豁｣
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
			ElseIf .IsConditionSatisfied("Invalid_string_refer_to_original_code") Then 
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				arm = 1.25 * arm
			Else
				arm = 1.5 * arm
			End If
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			.IsConditionSatisfied("Invalid_string_refer_to_original_code")
			arm = 0.75 * arm
			'End If
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			arm = arm \ 2
			IsWeaponClassifiedAs(w, "雋ｫ")
			If IsWeaponLevelSpecified(w, "雋ｫ") Then
				arm = arm * (10 - WeaponLevel(w, "雋ｫ")) \ 10
			Else
				arm = arm \ 2
			End If
			'End If
			If is_true_value Or mpskill >= 140 Then
				'蠑ｱ轤ｹ
				If .Weakness(wclass) Then
					arm = arm \ 2
					'Invalid_string_refer_to_original_code
				ElseIf Not .Effective(wclass) And .Absorb(wclass) Then 
					arm = 0
				End If
			End If
			
			If BCList.IsDefined("髦ｲ蠕｡陬懈ｭ｣") Then
				'Invalid_string_refer_to_original_code
				BCVariable.DataReset()
				BCVariable.MeUnit = t
				BCVariable.AtkUnit = Me
				BCVariable.DefUnit = t
				BCVariable.WeaponNumber = w
				BCVariable.Armor = arm
				BCVariable.TerrainAdaption = uadaption
				arm = BCList.Item("髦ｲ蠕｡陬懈ｭ｣").Calculate()
			End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_WARNING: オブジェクト t.Defense の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			arm = arm * .Defense \ 100
		End With
		
		'Invalid_string_refer_to_original_code
		arm = arm * uadaption
		'End If
		
		'Invalid_string_refer_to_original_code
		If InStrNotNest(wclass, "蝗ｺ") > 0 Then
			GoTo SkipDamageMod
		End If
		
		If BCList.IsDefined("繝繝｡繝ｼ繧ｸ") Then
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			BCVariable.DataReset()
			BCVariable.MeUnit = Me
			BCVariable.AtkUnit = Me
			BCVariable.DefUnit = t
			BCVariable.WeaponNumber = w
			BCVariable.AttackVariable = Damage
			BCVariable.DffenceVariable = arm
			'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		Else
			BCVariable.TerrainAdaption = 1
		End If
		Damage = BCList.Item("繝繝｡繝ｼ繧ｸ").Calculate()
		'Invalid_string_refer_to_original_code
		Damage = Damage - arm
		
		'蝨ｰ蠖｢陬懈ｭ｣
		'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		'End If
		'End If
		
		'謨｣螻樊ｧ豁ｦ蝎ｨ縺ｯ髮｢繧後ｋ縺ｻ縺ｩ繝繝｡繝ｼ繧ｸ繝繧ｦ繝ｳ
		If InStrNotNest(wclass, "謨｣") > 0 Then
			'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		End If
		
		'霍晞屬菫ｮ豁｣
		If IsOptionDefined("霍晞屬菫ｮ豁｣") Then
			'Invalid_string_refer_to_original_code_
			'And InStrNotNest(wclass, "豁ｦ") = 0 _
			'Invalid_string_refer_to_original_code_
			'And InStrNotNest(wclass, "謗･") = 0 _
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If IsOptionDefined("Invalid_string_refer_to_original_code") Then
				'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
			Else
				'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
			End If
		End If
		'End If
		
SkipDamageMod: 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		For i = 1 To Len(buf)
			'Invalid_string_refer_to_original_code
			ch = GetClassBundle(buf, i)
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStrNotNest(wclass, ch) > 0 Then
				Exit For
			End If
			'End If
		Next 
		If i > Len(buf) Then
			Damage = 0
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If idx > 0 Then
			'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
			For i = 1 To Len(buf)
				'Invalid_string_refer_to_original_code
				ch = GetClassBundle(buf, i)
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If InStrNotNest(wclass, ch) > idx Then
					Exit For
				End If
			Next 
		End If
		'Next
		If i > Len(buf) Then
			Damage = 0
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If WeaponLevel(w, "蟇ｾ") > 0 Then
			'UPGRADE_WARNING: Mod に新しい動作が指定されています。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"' をクリックしてください。
			If t.MainPilot.Level Mod WeaponLevel(w, "蟇ｾ") <> 0 Then
				Damage = 0
				Exit Function
			End If
		End If
		
		If is_true_value Or mpskill >= 140 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		End If
		
		'Invalid_string_refer_to_original_code
		If is_true_value Or mpskill >= 140 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If is_true_value Or mpskill >= 140 Then
			If InStrNotNest(wclass, "邊ｾ") > 0 Then
				'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
			End If
		End If
		
		'諤ｧ蛻･髯仙ｮ壽ｭｦ蝎ｨ
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		'End If
		If InStrNotNest(wclass, "笙") > 0 Then
			'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		
		With MainPilot
			'Invalid_string_refer_to_original_code
			If .Morale >= 130 Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If .IsSkillAvailable("貎懷惠蜉幃幕謾ｾ") Then
					Damage = 1.2 * Damage
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Damage = 1.2 * Damage
			End If
			If .IsSkillAvailable("貎懷惠蜉幃幕謾ｾ") Then
				Damage = 1.25 * Damage
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Damage = 1.25 * Damage
			'End If
			'End If
			'End If
			
			'蠕玲э謚
			If .IsSkillAvailable("蠕玲э謚") Then
				sdata = .SkillData("蠕玲э謚")
				For i = 1 To Len(sdata)
					If InStrNotNest(wclass, Mid(sdata, i, 1)) > 0 Then
						Damage = 1.2 * Damage
						Exit For
					End If
				Next 
			End If
			
			'荳榊ｾ玲焔
			If .IsSkillAvailable("荳榊ｾ玲焔") Then
				sdata = .SkillData("荳榊ｾ玲焔")
				For i = 1 To Len(sdata)
					If InStrNotNest(wclass, Mid(sdata, i, 1)) > 0 Then
						Damage = 0.8 * Damage
						Exit For
					End If
				Next 
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If MainPilot.IsSkillAvailable("繝上Φ繧ｿ繝ｼ") Then
			For i = 1 To MainPilot.CountSkill
				If MainPilot.Skill(i) = "繝上Φ繧ｿ繝ｼ" Then
					sdata = MainPilot.SkillData(i)
					For j = 2 To LLength(sdata)
						tname = LIndex(sdata, j)
						'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
					Next 
					If j <= LLength(sdata) Then
						Damage = (10 + MainPilot.SkillLevel(i)) * Damage \ 10
						Exit For
					End If
				End If
			Next 
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			sdata = MainPilot.SkillData("繝上Φ繧ｿ繝ｼ")
			For i = 2 To LLength(sdata)
				tname = LIndex(sdata, i)
				'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
			Next 
			If i <= LLength(sdata) Then
				Damage = (10 + MainPilot.SkillLevel("繝上Φ繧ｿ繝ｼ")) * Damage \ 10
			End If
		End If
		'End If
		
		'繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ縲∫音谿顔憾諷九↓繧医ｋ繝繝｡繝ｼ繧ｸ蠅怜刈
		dmg_mod = 1
		If IsConditionSatisfied("Invalid_string_refer_to_original_code") Or IsConditionSatisfied("迢よ姶螢ｫ") Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			dmg_mod = 1.2
		Else
			dmg_mod = 1.25
		End If
		'End If
		'Invalid_string_refer_to_original_code
		If Not is_support_attack Then
			If is_true_value Or mpskill >= 160 Then
				'Invalid_string_refer_to_original_code
				dmg_mod = MaxDbl(dmg_mod, 1 + 0.1 * SpecialPowerEffectLevel("繝繝｡繝ｼ繧ｸ蠅怜刈"))
				'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
			End If
		End If
		Damage = dmg_mod * Damage
		
		'Invalid_string_refer_to_original_code
		If is_true_value Or mpskill >= 160 Then
			dmg_mod = 1
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Damage = dmg_mod * Damage
		End If
		If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
			Damage = 0.75 * Damage
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Damage = 0.8 * Damage
		'End If
		If is_support_attack Then
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Damage = 0.7 * Damage
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		dmg_mod = 0
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		GoTo SkipResist
		'End If
		'Invalid_string_refer_to_original_code
		If Not is_true_value And mpskill < 150 Then
			GoTo SkipResist
		End If
		'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		
		Damage = Damage * (100 - dmg_mod) \ 100
		
SkipResist: 
		
		If BCList.IsDefined("譛邨ゅム繝｡繝ｼ繧ｸ") Then
			'Invalid_string_refer_to_original_code
			BCVariable.DataReset()
			BCVariable.MeUnit = Me
			BCVariable.AtkUnit = Me
			BCVariable.DefUnit = t
			BCVariable.WeaponNumber = w
			BCVariable.LastVariable = Damage
			Damage = BCList.Item("譛邨ゅム繝｡繝ｼ繧ｸ").Calculate()
		End If
		
		'譛菴弱ム繝｡繝ｼ繧ｸ縺ｯ10
		If dmg_mod < 100 Then
			If Damage < 10 Then
				' MOD START MARGE
				'                Damage = 10
				If IsOptionDefined("繝繝｡繝ｼ繧ｸ荳矩剞隗｣髯､") Then
					Damage = MaxLng(Damage, 0)
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Damage = MaxLng(Damage, 1)
				Else
					Damage = 10
				End If
				' MOD END MARGE
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If is_true_value Or mpskill >= 140 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_WARNING: Damage に変換されていないステートメントがあります。ソース コードを確認してください。
		End If
		'End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CriticalProbability(ByVal w As Short, ByRef t As Unit, Optional ByVal def_mode As String = "") As Short
		Dim i, prob, idx As Short
		Dim wclass As String
		Dim buf, c As String
		Dim is_special As Boolean
		'Invalid_string_refer_to_original_code
		Dim ed_crtatk, ed_crtdfe As Short
		
		With t
			If IsNormalWeapon(w) Then
				'Invalid_string_refer_to_original_code
				
				'Invalid_string_refer_to_original_code
				If IsOptionDefined("Invalid_string_refer_to_original_code") Or IsOptionDefined("Invalid_string_refer_to_original_code") Then
					If IsUnderSpecialPowerEffect("繝繝｡繝ｼ繧ｸ蠅怜刈") Then
						Exit Function
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				If BCList.IsDefined("Invalid_string_refer_to_original_code") Then
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					BCVariable.DataReset()
					BCVariable.MeUnit = Me
					BCVariable.AtkUnit = Me
					BCVariable.DefUnit = t
					BCVariable.WeaponNumber = w
					BCVariable.AttackExp = WeaponCritical(w)
					ed_crtatk = BCList.Item("Invalid_string_refer_to_original_code").Calculate()
				Else
					'Invalid_string_refer_to_original_code
					ed_crtatk = WeaponCritical(w) + MainPilot.Technique
				End If
				
				'髦ｲ蠕｡蛛ｴ縺ｫ繧医ｋ陬懈ｭ｣
				If BCList.IsDefined("Invalid_string_refer_to_original_code") Then
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					BCVariable.DataReset()
					BCVariable.MeUnit = t
					BCVariable.AtkUnit = Me
					BCVariable.DefUnit = t
					BCVariable.WeaponNumber = w
					ed_crtdfe = BCList.Item("Invalid_string_refer_to_original_code").Calculate()
				Else
					'Invalid_string_refer_to_original_code
					ed_crtdfe = .MainPilot.Technique
				End If
				
				'Invalid_string_refer_to_original_code
				If BCList.IsDefined("Invalid_string_refer_to_original_code") Then
					'Invalid_string_refer_to_original_code
					BCVariable.DataReset()
					BCVariable.MeUnit = Me
					BCVariable.AtkUnit = Me
					BCVariable.DefUnit = t
					BCVariable.WeaponNumber = w
					BCVariable.AttackVariable = ed_crtatk
					BCVariable.DffenceVariable = ed_crtdfe
					prob = BCList.Item("Invalid_string_refer_to_original_code").Calculate()
				Else
					prob = ed_crtatk - ed_crtdfe
				End If
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				prob = prob + 5
			End If
			
			'Invalid_string_refer_to_original_code
			If HP <= MaxHP \ 4 Then
				If MainPilot.IsSkillAvailable("蠎募鴨") Or MainPilot.IsSkillAvailable("Invalid_string_refer_to_original_code") Or MainPilot.IsSkillAvailable("隕壽ぁ") Then
					prob = prob + 50
				End If
			End If
			
			'繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ縺ｫ繧倶ｿｮ豁｣
			prob = prob + 10 * SpecialPowerEffectLevel("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			is_special = True
			
			'Invalid_string_refer_to_original_code
			If BCList.IsDefined("Invalid_string_refer_to_original_code") Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				BCVariable.DataReset()
				BCVariable.MeUnit = Me
				BCVariable.AtkUnit = Me
				BCVariable.DefUnit = t
				BCVariable.WeaponNumber = w
				BCVariable.AttackExp = WeaponCritical(w)
				ed_crtatk = BCList.Item("Invalid_string_refer_to_original_code").Calculate()
			Else
				'Invalid_string_refer_to_original_code
				ed_crtatk = WeaponCritical(w) + MainPilot.Technique \ 2
			End If
			
			'髦ｲ蠕｡蛛ｴ縺ｫ繧医ｋ陬懈ｭ｣
			If BCList.IsDefined("迚ｹ谿雁柑譫憺亟蠕｡陬懈ｭ｣") Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				BCVariable.DataReset()
				BCVariable.MeUnit = t
				BCVariable.AtkUnit = Me
				BCVariable.DefUnit = t
				BCVariable.WeaponNumber = w
				'Invalid_string_refer_to_original_code
				If InStr(.MainPilot.Name, "(繧ｶ繧ｳ)") > 0 Then
					BCVariable.CommonEnemy = 30
				End If
				ed_crtdfe = BCList.Item("迚ｹ谿雁柑譫憺亟蠕｡陬懈ｭ｣").Calculate()
			Else
				'Invalid_string_refer_to_original_code
				ed_crtdfe = .MainPilot.Technique \ 2
				
				'Invalid_string_refer_to_original_code
				If InStr(.MainPilot.Name, "(繧ｶ繧ｳ)") > 0 Then
					'Invalid_string_refer_to_original_code
					ed_crtdfe = ed_crtdfe - 30
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			If BCList.IsDefined("迚ｹ谿雁柑譫懃匱逕溽紫") Then
				'Invalid_string_refer_to_original_code
				BCVariable.DataReset()
				BCVariable.MeUnit = Me
				BCVariable.AtkUnit = Me
				BCVariable.DefUnit = t
				BCVariable.WeaponNumber = w
				BCVariable.AttackVariable = ed_crtatk
				BCVariable.DffenceVariable = ed_crtdfe
				prob = BCList.Item("迚ｹ谿雁柑譫懃匱逕溽紫").Calculate()
			Else
				prob = ed_crtatk - ed_crtdfe
			End If
			
			'謚ｵ謚怜鴨縺ｫ繧医ｋ菫ｮ豁｣
			prob = prob - 10 * .FeatureLevel("謚ｵ謚怜鴨")
			'End If
			
			'荳肴э謇薙■
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = prob + 10
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Or .IsConditionSatisfied("鮗ｻ逞ｺ") _
			'Or .IsConditionSatisfied("逹｡逵") _
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = prob + 10
			'End If
			
			'Invalid_string_refer_to_original_code
			If is_special Then
				wclass = WeaponClass(w)
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				buf = .strWeakness & .strEffective
				For i = 1 To Len(buf)
					'Invalid_string_refer_to_original_code
					c = GetClassBundle(buf, i)
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If InStrNotNest(wclass, c) > 0 Then
						Exit For
					End If
				Next 
			End If
			'Next
			If i > Len(buf) Then
				CriticalProbability = 0
				Exit Function
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If idx > 0 Then
				buf = .strWeakness & .strEffective
				For i = 1 To Len(buf)
					'Invalid_string_refer_to_original_code
					c = GetClassBundle(buf, i)
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If InStrNotNest(wclass, c) > idx Then
						Exit For
					End If
				Next 
			End If
			'Next
			If i > Len(buf) Then
				CriticalProbability = 0
				Exit Function
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If InStrNotNest(wclass, "蟇ｾ") > 0 Then
				'UPGRADE_WARNING: Mod に新しい動作が指定されています。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"' をクリックしてください。
				If t.MainPilot.Level Mod WeaponLevel(w, "蟇ｾ") <> 0 Then
					CriticalProbability = 0
					Exit Function
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			buf = ""
			i = InStrNotNest(wclass, "蠑ｱ")
			Do While i > 0
				buf = buf & Mid(GetClassBundle(wclass, i), 2)
				i = InStrNotNest(wclass, "蠑ｱ", i + 1)
			Loop 
			i = InStrNotNest(wclass, "蜉ｹ")
			Do While i > 0
				buf = buf & Mid(GetClassBundle(wclass, i), 2)
				i = InStrNotNest(wclass, "蜉ｹ", i + 1)
			Loop 
			buf = buf & wclass
			
			'蠑ｱ轤ｹ
			If .Weakness(buf) Then
				prob = prob + 10
				'譛牙柑
			ElseIf .Effective(buf) Then 
				'Invalid_string_refer_to_original_code
				'蟆∝魂謚
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				CriticalProbability = 0
				Exit Function
				'髯仙ｮ壽橿
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				CriticalProbability = 0
				Exit Function
				'Invalid_string_refer_to_original_code
			ElseIf .Absorb(buf) Then 
				CriticalProbability = 0
				Exit Function
				'Invalid_string_refer_to_original_code
			ElseIf .Immune(buf) Then 
				CriticalProbability = 0
				Exit Function
				'閠先ｧ
			ElseIf .Resist(buf) Then 
				prob = prob \ 2
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If .IsConditionSatisfied("逶ｲ逶ｮ") Then
				CriticalProbability = 0
				Exit Function
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If InStrNotNest(wclass, "邊ｾ") > 0 Then
				If .MainPilot.Personality = "讖滓｢ｰ" Then
					CriticalProbability = 0
					Exit Function
				End If
			End If
			
			'諤ｧ蛻･髯仙ｮ壽ｭｦ蝎ｨ
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If .MainPilot.Sex <> "逕ｷ諤ｧ" Then
				CriticalProbability = 0
				Exit Function
			End If
			'End If
			If InStrNotNest(wclass, "笙") > 0 Then
				If .MainPilot.Sex <> "螂ｳ諤ｧ" Then
					CriticalProbability = 0
					Exit Function
				End If
			End If
			'End If
		End With
		
		'Invalid_string_refer_to_original_code
		If def_mode = "髦ｲ蠕｡" Then
			prob = prob \ 2
		End If
		
		'Invalid_string_refer_to_original_code
		If IsNormalWeapon(w) Then
			'Invalid_string_refer_to_original_code
			If BCList.IsDefined("Invalid_string_refer_to_original_code") Then
				'Invalid_string_refer_to_original_code
				BCVariable.DataReset()
				BCVariable.MeUnit = Me
				BCVariable.AtkUnit = Me
				BCVariable.DefUnit = t
				BCVariable.WeaponNumber = w
				BCVariable.LastVariable = prob
				prob = BCList.Item("Invalid_string_refer_to_original_code").Calculate()
			End If
		Else
			'Invalid_string_refer_to_original_code
			If BCList.IsDefined("譛邨ら音谿雁柑譫懃匱逕溽紫") Then
				'Invalid_string_refer_to_original_code
				BCVariable.DataReset()
				BCVariable.MeUnit = Me
				BCVariable.AtkUnit = Me
				BCVariable.DefUnit = t
				BCVariable.WeaponNumber = w
				BCVariable.LastVariable = prob
				prob = BCList.Item("譛邨ら音谿雁柑譫懃匱逕溽紫").Calculate()
			End If
		End If
		
		If prob > 100 Then
			CriticalProbability = 100
		ElseIf prob < 1 Then 
			CriticalProbability = 1
		Else
			CriticalProbability = prob
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function ExpDamage(ByVal w As Short, ByRef t As Unit, ByVal is_true_value As Boolean, Optional ByVal dmg_mod As Double = 0) As Integer
		Dim dmg As Integer
		Dim j, i, idx As Short
		Dim slevel As Double
		Dim wclass As String
		Dim fname, fdata As String
		Dim flevel As Double
		Dim ecost, nmorale As Integer
		Dim neautralize As Boolean
		Dim lv_mod As Double
		Dim opt As String
		
		wclass = WeaponClass(w)
		
		'Invalid_string_refer_to_original_code
		If WeaponPower(w, "") <= 0 Then
			Exit Function
		End If
		
		'繝繝｡繝ｼ繧ｸ
		dmg = Damage(w, t, is_true_value)
		
		'Invalid_string_refer_to_original_code
		If dmg_mod > 0 Then
			If InStrNotNest(wclass, "谿ｺ") = 0 Then
				dmg = dmg * dmg_mod
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If InStrNotNest(wclass, "谿ｺ") > 0 Then
			If t.HP > dmg Then
				Exit Function
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If dmg <= 0 Then
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Or InStrNotNest(wclass, "笙") > 0 _
			'Or t.Immune(wclass) _
			'Or t.Absorb(wclass) _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		ExpDamage = w
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		If InStrNotNest(wclass, "谿ｺ") > 0 Then
			If t.HP > dmg Then
				Exit Function
			End If
		End If
		ExpDamage = dmg
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		With MainPilot
			If Not is_true_value And .TacticalTechnique < 150 Then
				'Invalid_string_refer_to_original_code
				If InStrNotNest(wclass, "谿ｺ") > 0 Then
					If t.HP > dmg Then
						Exit Function
					End If
				End If
				ExpDamage = dmg
				Exit Function
			End If
		End With
		
		With t
			'Invalid_string_refer_to_original_code
			For i = 1 To .CountFeature
				If .Feature(i) = "繝舌Μ繧｢" Then
					fname = .FeatureName0(i)
					fdata = .FeatureData(i)
					flevel = .FeatureLevel(i)
					
					'Invalid_string_refer_to_original_code
					If IsNumeric(LIndex(fdata, 3)) Then
						ecost = CShort(LIndex(fdata, 3))
					Else
						ecost = 10
					End If
					If IsNumeric(LIndex(fdata, 4)) Then
						nmorale = CShort(LIndex(fdata, 4))
					Else
						nmorale = 0
					End If
					
					'繧ｪ繝励す繝ｧ繝ｳ
					neautralize = False
					slevel = 0
					For j = 5 To LLength(fdata)
						opt = LIndex(fdata, j)
						idx = InStr(opt, "*")
						If idx > 0 Then
							lv_mod = StrToDbl(Mid(opt, idx + 1))
							opt = Left(opt, idx - 1)
						Else
							lv_mod = -1
						End If
						Select Case opt
							Case "逶ｸ谿ｺ"
								If IsSameCategory(fdata, FeatureData("繝舌Μ繧｢")) And System.Math.Abs(x - .x) + System.Math.Abs(y - .y) = 1 Then
									neautralize = True
								End If
							Case "Invalid_string_refer_to_original_code"
								If IsSameCategory(fdata, FeatureData("繝舌Μ繧｢")) And System.Math.Abs(x - .x) + System.Math.Abs(y - .y) = 1 Then
									flevel = flevel - FeatureLevel("繝舌Μ繧｢")
									If flevel <= 0 Then
										neautralize = True
									End If
								End If
							Case "霑第磁辟｡蜉ｹ"
								'Invalid_string_refer_to_original_code_
								'Or InStrNotNest(wclass, "謗･") > 0 _
								'Then
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								neautralize = True
						End Select
					Next 
				End If
				'UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case "謇句虚"
					'neautralize = True
					''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case "Invalid_string_refer_to_original_code"
							'If lv_mod = -1 Then
								'lv_mod = 20
							'End If
							'slevel = lv_mod * (.SyncLevel - 30)
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'If slevel = -30 * lv_mod Then
								'neautralize = True
							'End If
							'If slevel = -30 * lv_mod Then
								'slevel = 0
							'End If
							'End If
							''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
							'Case "髴雁鴨"
								'If lv_mod = -1 Then
									'lv_mod = 10
								'End If
								'slevel = lv_mod * .PlanaLevel
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								'If slevel = 0 Then
									'neautralize = True
								'End If
								'End If
								''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
								'Case "繧ｪ繝ｼ繝ｩ"
									'If lv_mod = -1 Then
										'lv_mod = 200
									'End If
									'slevel = lv_mod * .AuraLevel
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									'If slevel = 0 Then
										'neautralize = True
									'End If
									'End If
									''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
									'Case "Invalid_string_refer_to_original_code"
										'If lv_mod = -1 Then
											'lv_mod = 200
										'End If
										'slevel = lv_mod * .PsychicLevel
										'Invalid_string_refer_to_original_code
										'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
										'If slevel = 0 Then
											'neautralize = True
										'End If
										'End If
										''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
			Next 
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStr(fdata, "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then
				neautralize = True
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If .EN >= ecost And .MainPilot.Morale >= nmorale And .IsAttributeClassified(LIndex(fdata, 2), wclass) And Not neautralize Then
				'Invalid_string_refer_to_original_code
				If dmg <= 1000 * flevel + slevel Then
					ExpDamage = w
					Exit Function
				End If
			End If
			'End If
			'Next
			
			'Invalid_string_refer_to_original_code
			For i = 1 To .CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				fname = .FeatureName0(i)
				fdata = .FeatureData(i)
				flevel = .FeatureLevel(i)
				
				'Invalid_string_refer_to_original_code
				If IsNumeric(LIndex(fdata, 3)) Then
					ecost = CShort(LIndex(fdata, 3))
				Else
					ecost = 0
				End If
				If IsNumeric(LIndex(fdata, 4)) Then
					nmorale = CShort(LIndex(fdata, 4))
				Else
					nmorale = 0
				End If
				
				'繧ｪ繝励す繝ｧ繝ｳ
				neautralize = False
				slevel = 0
				For j = 5 To LLength(fdata)
					opt = LIndex(fdata, j)
					idx = InStr(opt, "*")
					If idx > 0 Then
						lv_mod = StrToDbl(Mid(opt, idx + 1))
						opt = Left(opt, idx - 1)
					Else
						lv_mod = -1
					End If
					Select Case opt
						Case "逶ｸ谿ｺ"
							'Invalid_string_refer_to_original_code_
							'And Abs(x - .x) + Abs(y - .y) = 1 _
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							neautralize = True
							'End If
						Case "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code_
							'And Abs(x - .x) + Abs(y - .y) = 1 _
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If flevel <= 0 Then
								neautralize = True
							End If
							'End If
						Case "霑第磁辟｡蜉ｹ"
							'Invalid_string_refer_to_original_code_
							'Or InStrNotNest(wclass, "謗･") > 0 _
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							neautralize = True
							'End If
						Case "謇句虚"
							neautralize = True
						Case "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
						Case "Invalid_string_refer_to_original_code"
							If lv_mod = -1 Then
								lv_mod = 20
							End If
							slevel = lv_mod * (.SyncLevel - 30)
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If slevel = -30 * lv_mod Then
								neautralize = True
							End If
							If slevel = -30 * lv_mod Then
								slevel = 0
							End If
							'End If
						Case "髴雁鴨"
							If lv_mod = -1 Then
								lv_mod = 10
							End If
							slevel = lv_mod * .PlanaLevel
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If slevel = 0 Then
								neautralize = True
							End If
							'End If
						Case "繧ｪ繝ｼ繝ｩ"
							If lv_mod = -1 Then
								lv_mod = 200
							End If
							slevel = lv_mod * .AuraLevel
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If slevel = 0 Then
								neautralize = True
							End If
							'End If
						Case "Invalid_string_refer_to_original_code"
							If lv_mod = -1 Then
								lv_mod = 200
							End If
							slevel = lv_mod * .PsychicLevel
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If slevel = 0 Then
								neautralize = True
							End If
							'End If
						Case Else
							If lv_mod = -1 Then
								lv_mod = 200
							End If
							slevel = lv_mod * .SkillLevel(opt)
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If slevel = 0 Then
								neautralize = True
							End If
							'End If
					End Select
				Next 
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If InStr(fdata, "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then
					neautralize = True
				End If
				'End If
				
				'Invalid_string_refer_to_original_code
				If .EN >= ecost And .MainPilot.Morale >= nmorale And .IsAttributeClassified(LIndex(fdata, 2), wclass) And Not neautralize Then
					'Invalid_string_refer_to_original_code
					If dmg <= 500 * flevel + slevel Then
						ExpDamage = w
						Exit Function
					ElseIf flevel > 0 Or slevel > 0 Then 
						dmg = dmg - 500 * flevel - slevel
					End If
				End If
				'End If
			Next 
			
			'Invalid_string_refer_to_original_code
			For i = 1 To .CountFeature
				If .Feature(i) = "Invalid_string_refer_to_original_code" Then
					fname = .FeatureName0(i)
					fdata = .FeatureData(i)
					flevel = .FeatureLevel(i)
					
					'Invalid_string_refer_to_original_code
					If IsNumeric(LIndex(fdata, 3)) Then
						ecost = CShort(LIndex(fdata, 3))
					Else
						ecost = 10
					End If
					If IsNumeric(LIndex(fdata, 4)) Then
						nmorale = CShort(LIndex(fdata, 4))
					Else
						nmorale = 0
					End If
					
					'繧ｪ繝励す繝ｧ繝ｳ
					neautralize = False
					slevel = 0
					For j = 5 To LLength(fdata)
						opt = LIndex(fdata, j)
						idx = InStr(opt, "*")
						If idx > 0 Then
							lv_mod = StrToDbl(Mid(opt, idx + 1))
							opt = Left(opt, idx - 1)
						Else
							lv_mod = -1
						End If
						Select Case opt
							Case "逶ｸ谿ｺ"
								If IsSameCategory(fdata, FeatureData("Invalid_string_refer_to_original_code")) And System.Math.Abs(x - .x) + System.Math.Abs(y - .y) = 1 Then
									neautralize = True
								End If
							Case "Invalid_string_refer_to_original_code"
								If IsSameCategory(fdata, FeatureData("Invalid_string_refer_to_original_code")) And System.Math.Abs(x - .x) + System.Math.Abs(y - .y) = 1 Then
									flevel = flevel - FeatureLevel("Invalid_string_refer_to_original_code")
									If flevel <= 0 Then
										neautralize = True
									End If
								End If
							Case "霑第磁辟｡蜉ｹ"
								'Invalid_string_refer_to_original_code_
								'Or InStrNotNest(wclass, "謗･") > 0 _
								'Then
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								neautralize = True
						End Select
					Next 
				End If
				'UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case "謇句虚"
					'neautralize = True
					''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case "Invalid_string_refer_to_original_code"
							'If lv_mod = -1 Then
								'lv_mod = 0.5
							'End If
							'slevel = lv_mod * (.SyncLevel - 30)
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'If slevel = -30 * lv_mod Then
								'neautralize = True
							'End If
							'If slevel = -30 * lv_mod Then
								'slevel = 0
							'End If
							'End If
							''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
							'Case "髴雁鴨"
								'If lv_mod = -1 Then
									'lv_mod = 0.2
								'End If
								'slevel = lv_mod * .PlanaLevel
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								'If slevel = 0 Then
									'neautralize = True
								'End If
								'End If
								''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
								'Case "繧ｪ繝ｼ繝ｩ"
									'If lv_mod = -1 Then
										'lv_mod = 5
									'End If
									'slevel = lv_mod * .AuraLevel
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									'If slevel = 0 Then
										'neautralize = True
									'End If
									'End If
									''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
									'Case "Invalid_string_refer_to_original_code"
										'If lv_mod = -1 Then
											'lv_mod = 5
										'End If
										'slevel = lv_mod * .PsychicLevel
										'Invalid_string_refer_to_original_code
										'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
										'If slevel = 0 Then
											'neautralize = True
										'End If
										'End If
										''UPGRADE_WARNING: ExpDamage に変換されていないステートメントがあります。ソース コードを確認してください。
			Next 
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStr(fdata, "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then
				neautralize = True
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If .EN >= ecost And .MainPilot.Morale >= nmorale And .IsAttributeClassified(LIndex(fdata, 2), wclass) And Not neautralize Then
				'Invalid_string_refer_to_original_code
				dmg = dmg * (100 - 10 * flevel - slevel) \ 100
				If dmg <= 0 Then
					ExpDamage = w
					Exit Function
				End If
			End If
			'End If
			'Next
			
			'Invalid_string_refer_to_original_code
			If InStrNotNest(wclass, "Invalid_string_refer_to_original_code") > 0 Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				ExpDamage = w
				Exit Function
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If InStrNotNest(wclass, "谿ｺ") > 0 Then
				If dmg < .HP Then
					dmg = 0
				End If
			End If
			
			'逶ｾ髦ｲ蠕｡
			If .IsFeatureAvailable("逶ｾ") And .MainPilot.IsSkillAvailable("Invalid_string_refer_to_original_code") And .MaxAction > 0 And Not IsWeaponClassifiedAs(w, "邊ｾ") And Not IsWeaponClassifiedAs(w, "豬ｸ") And Not IsWeaponClassifiedAs(w, "谿ｺ") And (.IsConditionSatisfied("逶ｾ莉伜刈") Or .FeatureLevel("逶ｾ") > .ConditionLevel("逶ｾ繝繝｡繝ｼ繧ｸ")) Then
				If IsWeaponClassifiedAs(w, "遐ｴ") Then
					dmg = dmg - 50 * (.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") + 4)
				Else
					dmg = dmg - 100 * (.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") + 4)
				End If
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		If dmg <= 0 Then
			dmg = 1
		End If
		
		'Invalid_string_refer_to_original_code
		If InStr(CStr(w), "谿ｺ") > 0 Then
			If t.HP > dmg Then
				Exit Function
			End If
		End If
		
		ExpDamage = dmg
	End Function
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Function Absorb(ByRef aname As String) As Boolean
		Dim c As String
		Dim i As Short
		Dim slen As Short
		
		'Invalid_string_refer_to_original_code
		If InStrNotNest(strAbsorb, "蜈ｨ") > 0 Then
			Absorb = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Len(aname) = 0 Then
			If InStrNotNest(strAbsorb, "迚ｩ") > 0 Then
				Absorb = True
			End If
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		i = 1
		slen = Len(strAbsorb)
		Do While i <= slen
			'Invalid_string_refer_to_original_code
			c = GetClassBundle(strAbsorb, i)
			Select Case c
				Case "迚ｩ"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Absorb = True
					Exit Do
					'End If
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code_
					'And InStrNotNest(aname, "鬲疲磁") = 0 _
					'And InStrNotNest(aname, "鬲秘潟") = 0 _
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Absorb = True
					Exit Do
					'End If
					'End If
				Case Else
					If InStrNotNest(aname, c) > 0 Then
						Absorb = True
						Exit Do
					End If
			End Select
			i = i + 1
		Loop 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Immune(ByRef aname As String) As Boolean
		Dim c As String
		Dim i As Short
		Dim slen As Short
		
		'Invalid_string_refer_to_original_code
		If InStrNotNest(strImmune, "蜈ｨ") > 0 Then
			Immune = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Len(aname) = 0 Then
			If InStrNotNest(strImmune, "迚ｩ") > 0 Then
				Immune = True
			End If
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		i = 1
		slen = Len(strImmune)
		Do While i <= slen
			'Invalid_string_refer_to_original_code
			c = GetClassBundle(strImmune, i)
			Select Case c
				Case "迚ｩ"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Immune = True
					Exit Do
					'End If
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code_
					'And InStrNotNest(aname, "鬲疲ｭｦ") = 0 _
					'Invalid_string_refer_to_original_code_
					'And InStrNotNest(aname, "鬲疲磁") = 0 _
					'And InStrNotNest(aname, "鬲秘潟") = 0 _
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Immune = True
					Exit Do
					'End If
				Case Else
					If InStrNotNest(aname, c) > 0 Then
						Immune = True
						Exit Do
					End If
			End Select
			i = i + 1
		Loop 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Resist(ByRef aname As String) As Boolean
		Dim c As String
		Dim i As Short
		Dim slen As Short
		
		'Invalid_string_refer_to_original_code
		If InStrNotNest(strResist, "蜈ｨ") > 0 Then
			Resist = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Len(aname) = 0 Then
			If InStrNotNest(strResist, "迚ｩ") > 0 Then
				Resist = True
			End If
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		i = 1
		slen = Len(strResist)
		Do While i <= slen
			'Invalid_string_refer_to_original_code
			c = GetClassBundle(strResist, i)
			Select Case c
				Case "迚ｩ"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Resist = True
					Exit Do
					'End If
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code_
					'And InStrNotNest(aname, "鬲疲ｭｦ") = 0 _
					'Invalid_string_refer_to_original_code_
					'And InStrNotNest(aname, "鬲疲磁") = 0 _
					'And InStrNotNest(aname, "鬲秘潟") = 0 _
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Resist = True
					Exit Do
					'End If
				Case Else
					If InStrNotNest(aname, c) > 0 Then
						Resist = True
						Exit Do
					End If
			End Select
			i = i + 1
		Loop 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Weakness(ByRef aname As String) As Boolean
		Dim c As String
		Dim i As Short
		Dim slen As Short
		
		'Invalid_string_refer_to_original_code
		If InStrNotNest(strWeakness, "蜈ｨ") > 0 Then
			Weakness = True
			Exit Function
		End If
		
		If Len(aname) = 0 Then
			If InStrNotNest(strWeakness, "迚ｩ") > 0 Then
				Weakness = True
			End If
			Exit Function
		End If
		
		i = 1
		slen = Len(strWeakness)
		Do While i <= slen
			'Invalid_string_refer_to_original_code
			c = GetClassBundle(strWeakness, i)
			Select Case c
				Case "迚ｩ"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Weakness = True
					Exit Do
					'End If
				Case Else
					If InStrNotNest(aname, c) > 0 Then
						Weakness = True
						Exit Do
					End If
			End Select
			i = i + 1
		Loop 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Effective(ByRef aname As String) As Boolean
		Dim c As String
		Dim i As Short
		Dim slen As Short
		
		'Invalid_string_refer_to_original_code
		If InStrNotNest(strEffective, "蜈ｨ") > 0 Then
			Effective = True
			Exit Function
		End If
		
		If Len(aname) = 0 Then
			If InStrNotNest(strEffective, "迚ｩ") > 0 Then
				Effective = True
			End If
			Exit Function
		End If
		
		i = 1
		slen = Len(strEffective)
		Do While i <= slen
			'Invalid_string_refer_to_original_code
			c = GetClassBundle(strEffective, i)
			Select Case c
				Case "迚ｩ"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Effective = True
					Exit Do
					'End If
				Case Else
					If InStrNotNest(aname, c) > 0 Then
						Effective = True
						Exit Do
					End If
			End Select
			i = i + 1
		Loop 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function SpecialEffectImmune(ByRef aname As String) As Boolean
		'Invalid_string_refer_to_original_code
		If InStrNotNest(strSpecialEffectImmune, "蜈ｨ") > 0 Then
			SpecialEffectImmune = True
			Exit Function
		End If
		
		If Len(aname) = 0 Then
			Exit Function
		End If
		
		If InStrNotNest(strSpecialEffectImmune, aname) > 0 Then
			SpecialEffectImmune = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If Left(aname, 1) = "蠑ｱ" Or Left(aname, 1) = "蜉ｹ" Then
			If InStrNotNest(strSpecialEffectImmune, aname) > 0 Then
				SpecialEffectImmune = True
				Exit Function
			End If
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	' aclass1 縺碁亟蠕｡螻樊ｧ縲‖class2 縺梧ｭｦ蝎ｨ螻樊ｧ
	Public Function IsAttributeClassified(ByRef aclass1 As String, ByRef aclass2 As String) As Boolean
		Dim attr As String
		Dim alen, i As Short
		Dim with_not As Boolean
		
		If Len(aclass1) = 0 Then
			IsAttributeClassified = True
			Exit Function
		End If
		If aclass1 = "蜈ｨ" Then
			IsAttributeClassified = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Len(aclass2) = 0 Then
			If InStrNotNest(aclass1, "迚ｩ") > 0 Then
				IsAttributeClassified = True
			End If
			If InStrNotNest(aclass1, "!") > 0 Then
				IsAttributeClassified = Not IsAttributeClassified
			End If
			GoTo EndOfFunction
		End If
		
		i = 1
		alen = Len(aclass1)
		Do While i <= alen
			attr = GetClassBundle(aclass1, i)
			Select Case attr
				Case "迚ｩ"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					IsAttributeClassified = True
					Exit Do
					'End If
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code_
					'And InStrNotNest(aclass2, "鬲疲磁") = 0 _
					'And InStrNotNest(aclass2, "鬲秘潟") = 0 _
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					IsAttributeClassified = True
					'UPGRADE_WARNING: IsAttributeClassified に変換されていないステートメントがあります。ソース コードを確認してください。
					IsAttributeClassified = True
					'End If
					Exit Do
					'End If
				Case "!"
					with_not = True
				Case Else
					If InStrNotNest(aclass2, attr) > 0 Then
						IsAttributeClassified = True
						Exit Do
					End If
			End Select
			i = i + 1
		Loop 
		
EndOfFunction: 
		If with_not Then
			IsAttributeClassified = Not IsAttributeClassified
		End If
	End Function
	
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Sub Attack(ByVal w As Short, ByVal t As Unit, ByVal attack_mode As String, ByVal def_mode As String, Optional ByVal is_event As Boolean = False)
		Dim prob As Short
		Dim dmg, prev_hp As Integer
		Dim is_hit, is_critical As Boolean
		Dim critical_type As String
		Dim use_shield, use_shield_msg As Boolean
		Dim is_penetrated As Boolean
		Dim use_protect_msg As Boolean
		Dim use_support_guard As Boolean
		Dim wname, wnickname As String
		Dim fname, uname As String
		Dim msg, buf As String
		Dim k, i, j, num As Short
		Dim p As Pilot
		Dim su, orig_t As Unit
		Dim partners() As Unit
		Dim tx, ty As Short
		Dim tarea As String
		Dim prev_x, prev_y As Short
		Dim prev_area As String
		Dim second_attack As Boolean
		Dim be_quiet As Boolean
		Dim attack_num, hit_count As Integer
		Dim slevel As Short
		Dim saved_selected_unit As Unit
		Dim hp_ratio, en_ratio As Double
		Dim separate_parts As Boolean
		Dim orig_w As Short
		Dim itm As Item
		' ADD START MARGE
		Dim is_ext_anime_defined As Boolean
		' ADD END MARGE
		
		wname = Weapon(w).Name
		wnickname = WeaponNickname(w)
		
		'Invalid_string_refer_to_original_code
		SaveSelections()
		saved_selected_unit = SelectedUnit
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		SelectedUnit = SelectedTarget
		SelectedTarget = Me
		SelectedUnitForEvent = SelectedTargetForEvent
		SelectedTargetForEvent = Me
		SelectedWeapon = w
		SelectedWeaponName = wname
		Dim spower As Integer
		Dim prev_en As Short
		Dim morale_mod As Short
		Dim sx, sy As Short
		If SelectedUnit Is t Then
			SelectedTWeapon = SelectedWeapon
			SelectedTWeaponName = SelectedWeaponName
		End If
		SelectedWeapon = w
		SelectedWeaponName = wname
		SelectedUnit = Me
		SelectedTarget = t
		SelectedUnitForEvent = Me
		SelectedTargetForEvent = t
		'End If
		
		'Invalid_string_refer_to_original_code
		If Not IsDefense() Then
			'UPGRADE_NOTE: オブジェクト SupportGuardUnit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			SupportGuardUnit = Nothing
			'UPGRADE_NOTE: オブジェクト SupportGuardUnit2 をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			SupportGuardUnit2 = Nothing
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Or attack_mode = "蠖薙※霄ｫ謚" _
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		be_quiet = True
		be_quiet = False
		'End If
		
		'Invalid_string_refer_to_original_code
		If BattleAnimation Then
			If MainWidth <> 15 Then
				ClearUnitStatus()
			End If
			If Not IsOptionDefined("謌ｦ髣倅ｸｭ逕ｻ髱｢蛻晄悄蛹也┌蜉ｹ") Then
				RedrawScreen()
			End If
		End If
		
		orig_t = t
		
		'Invalid_string_refer_to_original_code
		tx = t.x
		ty = t.y
		tarea = t.Area
		
begin: 
		
		'Invalid_string_refer_to_original_code
		Update()
		MainPilot.UpdateSupportMod()
		t.Update()
		t.MainPilot.UpdateSupportMod()
		
		'Invalid_string_refer_to_original_code
		prev_hp = t.HP
		
		'Invalid_string_refer_to_original_code
		msg = ""
		is_critical = False
		critical_type = ""
		use_shield = False
		use_shield_msg = False
		use_protect_msg = False
		use_support_guard = False
		is_penetrated = False
		
		'Invalid_string_refer_to_original_code
		prob = HitProbability(w, t, True)
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		'Invalid_string_refer_to_original_code
		If IsNormalWeapon(w) And dmg > 0 Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			is_critical = True
		End If
		'End If
		
		ReDim partners(0)
		ReDim SelectedPartners(0)
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		If WeaponMaxRange(w) = 1 Then
			CombinationPartner("Invalid_string_refer_to_original_code")
		Else
			CombinationPartner("Invalid_string_refer_to_original_code")
		End If
		For i = 1 To UBound(partners)
			With partners(i)
				MaskData(.x, .y) = False
			End With
		Next 
		If Not BattleAnimation Then
			MaskScreen()
		End If
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If Weapon(w).MaxRange > 1 Then
			su = LookForAttackHelp(x, y)
		Else
			su = LookForAttackHelp(tx, ty)
		End If
		If Not su Is Nothing Then
			'Invalid_string_refer_to_original_code
			MaskData(su.x, su.y) = False
			If Not BattleAnimation Then
				MaskScreen()
			End If
			If IsMessageDefined("Invalid_string_refer_to_original_code" & su.MainPilot.Name & ")", True) Then
				PilotMessage("Invalid_string_refer_to_original_code" & su.MainPilot.Name & ")")
			Else
				PilotMessage("Invalid_string_refer_to_original_code" & su.MainPilot.Nickname & ")")
			End If
			is_critical = True
			'UPGRADE_NOTE: オブジェクト su をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			su = Nothing
		End If
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If is_critical Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			dmg = 1.2 * dmg
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		dmg = 1.5 * dmg
		'End If
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If BattleAnimation Then
			Select Case attack_mode
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					ShowAnimation("Invalid_string_refer_to_original_code")
				Case "繧ｫ繧ｦ繝ｳ繧ｿ繝ｼ"
					ShowAnimation("Invalid_string_refer_to_original_code")
			End Select
		End If
		
		'Invalid_string_refer_to_original_code
		If Not be_quiet Then
			'Invalid_string_refer_to_original_code
			If IsAnimationDefined(wname & "(貅門ｙ)") Then
				PlayAnimation(wname & "(貅門ｙ)")
			ElseIf IsAnimationDefined(wname) And Not IsOptionDefined("豁ｦ蝎ｨ貅門ｙ繧｢繝九Γ髱櫁｡ｨ遉ｺ") And WeaponAnimation Then 
				PlayAnimation(wname & "(貅門ｙ)")
			ElseIf IsSpecialEffectDefined(wname & "(貅門ｙ)") Then 
				SpecialEffect(wname & "(貅門ｙ)")
			Else
				PrepareWeaponEffect(Me, w)
			End If
			
			'Invalid_string_refer_to_original_code
			If second_attack Then
				PilotMessage("Invalid_string_refer_to_original_code")
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				With AttackUnit.CurrentForm.MainPilot
					If IsMessageDefined("Invalid_string_refer_to_original_code" & .Name & ")") Then
						PilotMessage("Invalid_string_refer_to_original_code" & .Name & ")")
					ElseIf IsMessageDefined("Invalid_string_refer_to_original_code" & .Nickname & ")") Then 
						PilotMessage("Invalid_string_refer_to_original_code" & .Nickname & ")")
					ElseIf IsMessageDefined("Invalid_string_refer_to_original_code") Then 
						PilotMessage("Invalid_string_refer_to_original_code")
					End If
				End With
			ElseIf attack_mode = "繧ｫ繧ｦ繝ｳ繧ｿ繝ｼ" Then 
				PilotMessage("繧ｫ繧ｦ繝ｳ繧ｿ繝ｼ")
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If IsMessageDefined("縺九¢螢ｰ(" & wname & ")") Then
					PilotMessage("縺九¢螢ｰ(" & wname & ")")
				ElseIf IsDefense() Then 
					PilotMessage("縺九¢螢ｰ(蜿肴茶)")
				Else
					PilotMessage("縺九¢螢ｰ")
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			IsWavePlayed = False
			If Not second_attack Then
				If attack_mode = "繧ｫ繧ｦ繝ｳ繧ｿ繝ｼ" Then
					PilotMessage(wname, "繧ｫ繧ｦ繝ｳ繧ｿ繝ｼ")
				Else
					PilotMessage(wname, "Invalid_string_refer_to_original_code")
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			If IsDefense() And IsAnimationDefined(wname & "(蜿肴茶)") Then
				PlayAnimation(wname & "(蜿肴茶)")
			ElseIf IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Or IsAnimationDefined(wname) Then 
				PlayAnimation(wname & "Invalid_string_refer_to_original_code")
			ElseIf IsSpecialEffectDefined(wname) Then 
				SpecialEffect(wname)
			ElseIf Not IsWavePlayed Then 
				AttackEffect(Me, w)
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			If IsDefense() And IsAnimationDefined(wname & "(蜿肴茶)") Then
				PlayAnimation(wname & "(蜿肴茶)")
			ElseIf IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Or IsAnimationDefined(wname) Then 
				PlayAnimation(wname & "Invalid_string_refer_to_original_code")
			ElseIf IsSpecialEffectDefined(wname) Then 
				SpecialEffect(wname)
			ElseIf Not IsWavePlayed Then 
				AttackEffect(Me, w)
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		UseWeapon(w)
		'Invalid_string_refer_to_original_code
		UpdateMessageForm(Me, t)
		'End If
		
		'Invalid_string_refer_to_original_code
		If def_mode = "蝗樣∩" Then
			'Invalid_string_refer_to_original_code_
			'And Not t.IsFeatureAvailable("蝗樣∩荳榊庄") _
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = prob \ 2
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = prob \ 2
		'End If
		
		'Invalid_string_refer_to_original_code
		If Not be_quiet Then
			Select Case UBound(partners)
				Case 0
					'Invalid_string_refer_to_original_code
					msg = Nickname & "縺ｯ"
				Case 1
					'Invalid_string_refer_to_original_code
					If Nickname <> partners(1).Nickname Then
						msg = Nickname & "縺ｯ[" & partners(1).Nickname & "]縺ｨ蜈ｱ縺ｫ"
					ElseIf MainPilot.Nickname <> partners(1).MainPilot.Nickname Then 
						msg = MainPilot.Nickname & "縺ｨ[" & partners(1).MainPilot.Nickname & "]縺ｯ"
					Else
						msg = Nickname & "Invalid_string_refer_to_original_code"
					End If
				Case 2
					'Invalid_string_refer_to_original_code
					If Nickname <> partners(1).Nickname Then
						msg = Nickname & "縺ｯ[" & partners(1).Nickname & "]縲ー" & partners(2).Nickname & "]縺ｨ蜈ｱ縺ｫ"
					ElseIf MainPilot.Nickname <> partners(1).MainPilot.Nickname Then 
						msg = MainPilot.Nickname & "縺ｯ[" & partners(1).MainPilot.Nickname & "]縲ー" & partners(2).MainPilot.Nickname & "]縺ｨ蜈ｱ縺ｫ"
					Else
						msg = Nickname & "Invalid_string_refer_to_original_code"
					End If
				Case Else
					'Invalid_string_refer_to_original_code
					msg = Nickname & "Invalid_string_refer_to_original_code"
			End Select
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Or IsWeaponClassifiedAs(w, "謗･")) _
			'And Not IsTransAvailable("遨ｺ") _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "Invalid_string_refer_to_original_code"
		End If
		
		If second_attack Then
			msg = msg & "蜀榊ｺｦ"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = "Invalid_string_refer_to_original_code" & msg & "Invalid_string_refer_to_original_code"
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Or wnickname = "遯∵茶" _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		IsSpellWeapon(w)
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & Left(wnickname, Len(wnickname) - 2) & "Invalid_string_refer_to_original_code"
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		'End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
		'Invalid_string_refer_to_original_code_
		'And (InStr(wnickname, "繝溘し繧､繝ｫ") > 0 _
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Or Right$(wnickname, 4) = "繝ｬ繝ｼ繧ｶ繝ｼ" _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		'End If
		
		'Invalid_string_refer_to_original_code
		If is_event Then
			'Invalid_string_refer_to_original_code
			If def_mode = "蝗樣∩" Then
				buf = "Invalid_string_refer_to_original_code" & MinLng(HitProbability(w, t, False) \ 2, 100) & "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				buf = "Invalid_string_refer_to_original_code" & MinLng(HitProbability(w, t, False), 100) & "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			End If
		Else
			buf = "Invalid_string_refer_to_original_code" & MinLng(prob, 100) & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		End If
		
		'Invalid_string_refer_to_original_code
		If IsSysMessageDefined(wname) Then
			'Invalid_string_refer_to_original_code
			SysMessage(wname, "", buf)
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			SysMessage("Invalid_string_refer_to_original_code")
		Else
			DisplaySysMessage(msg & buf, BattleAnimation)
		End If
		'End If
		
		msg = ""
		
		'髦ｲ蠕｡譁ｹ豕輔ｒ陦ｨ遉ｺ
		Select Case def_mode
			Case "蝗樣∩"
				If t.IsConditionSatisfied("雕翫ｊ") Then
					msg = t.Nickname & "Invalid_string_refer_to_original_code"
				Else
					msg = t.Nickname & "Invalid_string_refer_to_original_code"
				End If
			Case "髦ｲ蠕｡"
				msg = t.Nickname & "Invalid_string_refer_to_original_code"
		End Select
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If Not be_quiet Then
			PilotMessage(wname & "(蜻ｽ荳ｭ)")
		End If
		
		If IsAnimationDefined(wname & "(蜻ｽ荳ｭ)") Or IsAnimationDefined(wname) Then
			PlayAnimation(wname & "(蜻ｽ荳ｭ)")
		ElseIf IsSpecialEffectDefined(wname & "(蜻ｽ荳ｭ)") Then 
			SpecialEffect(wname & "(蜻ｽ荳ｭ)")
		ElseIf Not IsWavePlayed Then 
			HitEffect(Me, w, t)
		End If
		
		If IsUnderSpecialPowerEffect("邨ｶ蟇ｾ轢墓ｭｻ") Then
			' MOD START MARGE
			'            If t.HP > 10 Then
			'                dmg = t.HP - 10
			'            Else
			'                dmg = 0
			'            End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If t.HP > 1 Then
				dmg = t.HP - 1
			Else
				dmg = 0
			End If
		Else
			If t.HP > 10 Then
				dmg = t.HP - 10
			Else
				dmg = 0
			End If
		End If
		' MOD END MARGE
		
		dmg = t.HP
		'End If
		GoTo ApplyDamage
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob > 0 Then
			If CheckDodgeFeature(w, t, tx, ty, attack_mode, def_mode, dmg, be_quiet) Then
				dmg = 0
				GoTo EndAttack
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "騾｣") Then
			attack_num = WeaponLevel(w, "騾｣")
		Else
			attack_num = 1
		End If
		
		'Invalid_string_refer_to_original_code
		hit_count = 0
		For i = 1 To attack_num
			If Dice(100) <= prob Then
				hit_count = hit_count + 1
			End If
		Next 
		'Invalid_string_refer_to_original_code
		dmg = dmg * hit_count \ attack_num
		
		'Invalid_string_refer_to_original_code
		If hit_count = 0 Then
			If IsAnimationDefined(wname & "(蝗樣∩)") Then
				PlayAnimation(wname & "(蝗樣∩)")
			ElseIf IsSpecialEffectDefined(wname & "(蝗樣∩)") Then 
				SpecialEffect(wname & "(蝗樣∩)")
			ElseIf t.IsAnimationDefined("蝗樣∩") Then 
				t.PlayAnimation("蝗樣∩")
			ElseIf t.IsSpecialEffectDefined("蝗樣∩") Then 
				t.SpecialEffect("蝗樣∩")
			Else
				DodgeEffect(Me, w)
			End If
			
			If Not be_quiet Then
				t.PilotMessage("蝗樣∩")
				PilotMessage(wname & "(蝗樣∩)")
			End If
			
			If t.IsSysMessageDefined("蝗樣∩") Then
				t.SysMessage("蝗樣∩")
			Else
				Select Case def_mode
					Case "蝗樣∩"
						If t.IsConditionSatisfied("雕翫ｊ") Then
							DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
						Else
							DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
						End If
					Case "髦ｲ蠕｡"
						DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
					Case Else
						DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
				End Select
			End If
			GoTo EndAttack
		End If
		
		'Invalid_string_refer_to_original_code
		If su Is Nothing Then
			use_support_guard = False
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			i = 1
			Do While i <= t.CountSpecialPower
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If PList.IsDefined(t.SpecialPowerData(i)) Then
					su = PList.Item(t.SpecialPowerData(i)).Unit_Renamed
					t.RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
					i = i - 1
					If Not su Is Nothing Then
						su = su.CurrentForm
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'UPGRADE_NOTE: オブジェクト su をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
						su = Nothing
					End If
				End If
			Loop 
		End If
		'End If
		i = i + 1
		'Loop
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If t.IsDefense() Then
			'Invalid_string_refer_to_original_code
			If UseSupportGuard Then
				su = t.LookForSupportGuard(Me, w)
				If Not su Is Nothing Then
					use_support_guard = True
					'Invalid_string_refer_to_original_code
					su.UsedSupportGuard = su.UsedSupportGuard + 1
				End If
			End If
		End If
		If su Is Nothing Then
			'Invalid_string_refer_to_original_code
			su = t.LookForGuardHelp(Me, w, is_critical)
		End If
		'End If
		
		If Not su Is Nothing Then
			su.Update()
			
			'Invalid_string_refer_to_original_code
			If Party = "蜻ｳ譁ｹ" Or Party = "Invalid_string_refer_to_original_code" Then
				UpdateMessageForm(su, Me)
			Else
				UpdateMessageForm(Me, su)
			End If
			
			If Not BattleAnimation Then
				'霄ｫ莉｣繧上ｊ縺ｫ縺ｪ繧九Θ繝九ャ繝医ｒ繝上う繝ｩ繧､繝郁｡ｨ遉ｺ
				If MaskData(su.x, su.y) Then
					MaskData(su.x, su.y) = False
					MaskScreen()
					MaskData(su.x, su.y) = True
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			If use_support_guard Then
				If su.IsMessageDefined("Invalid_string_refer_to_original_code" & t.MainPilot.Name & ")") Then
					su.PilotMessage("Invalid_string_refer_to_original_code" & t.MainPilot.Name & ")")
				ElseIf su.IsMessageDefined("Invalid_string_refer_to_original_code" & t.MainPilot.Nickname & ")") Then 
					su.PilotMessage("Invalid_string_refer_to_original_code" & t.MainPilot.Nickname & ")")
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					su.PilotMessage("Invalid_string_refer_to_original_code")
				End If
			ElseIf su.IsMessageDefined("Invalid_string_refer_to_original_code" & t.MainPilot.Name & ")") Then 
				su.PilotMessage("Invalid_string_refer_to_original_code" & t.MainPilot.Name & ")")
				use_protect_msg = True
			ElseIf su.IsMessageDefined("Invalid_string_refer_to_original_code" & t.MainPilot.Nickname & ")") Then 
				su.PilotMessage("Invalid_string_refer_to_original_code" & t.MainPilot.Nickname & ")")
				use_protect_msg = True
			End If
			msg = su.MainPilot.Nickname & "縺ｯ[" & t.MainPilot.Nickname & "Invalid_string_refer_to_original_code"
			
			'Invalid_string_refer_to_original_code
			With su
				'繧｢繝九Γ陦ｨ遉ｺ
				If BattleAnimation Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					su.PlayAnimation("Invalid_string_refer_to_original_code")
				Else
					If Not IsRButtonPressed() Then
						If use_support_guard Then
							MoveUnitBitmap(su, .x, .y, tx, ty, 80, 4)
						Else
							MoveUnitBitmap(su, .x, .y, tx, ty, 50)
						End If
					End If
				End If
			End With
		End If
		
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'End With
		
		'Invalid_string_refer_to_original_code
		t = su
		SelectedTarget = t
		SelectedTargetForEvent = t
		'End If
		'End If
		If Not su Is Nothing Then
			'Invalid_string_refer_to_original_code
			With t
				prev_hp = .HP
				dmg = Damage(w, t, True)
				If is_critical Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Else
					dmg = 1.2 * dmg
				End If
			End With
		End If
		'End If
		'End If
		'End With
		
		'Invalid_string_refer_to_original_code
		hit_count = attack_num
		
		'Invalid_string_refer_to_original_code
		def_mode = "髦ｲ蠕｡"
		
		'Invalid_string_refer_to_original_code
		If IsDefense() Then
			SupportGuardUnit2 = su
			SupportGuardUnitHPRatio2 = su.HP / su.MaxHP
		Else
			SupportGuardUnit = su
			SupportGuardUnitHPRatio = su.HP / su.MaxHP
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If CheckParryFeature(w, t, tx, ty, attack_mode, def_mode, dmg, msg, be_quiet Or use_protect_msg) Then
			dmg = 0
			GoTo EndAttack
		End If
		
		'Invalid_string_refer_to_original_code
		If Not IsWeaponClassifiedAs(w, "谿ｺ") Then
			'Invalid_string_refer_to_original_code_
			'And Not t.IsFeatureAvailable("髦ｲ蠕｡荳榊庄") _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			dmg = dmg \ 2
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If CheckDummyFeature(w, t, be_quiet) Then
			dmg = 0
			GoTo EndAttack
		End If
		
		'Invalid_string_refer_to_original_code
		
		is_hit = True
		
		'Invalid_string_refer_to_original_code
		CheckShieldFeature(w, t, dmg, be_quiet, use_shield, use_shield_msg)
		
		'Invalid_string_refer_to_original_code
		If CheckDefenseFeature(w, t, tx, ty, attack_mode, def_mode, dmg, msg, be_quiet Or use_protect_msg, is_penetrated) Then
			If Not be_quiet Then
				PilotMessage(wname & "Invalid_string_refer_to_original_code")
			End If
			dmg = 0
			GoTo EndAttack
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		IsWavePlayed = False
		If Not be_quiet Then
			PilotMessage(wname & "(蜻ｽ荳ｭ)")
		End If
		If IsAnimationDefined(wname & "(蜻ｽ荳ｭ)") Or IsAnimationDefined(wname) Then
			PlayAnimation(wname & "(蜻ｽ荳ｭ)")
		ElseIf IsSpecialEffectDefined(wname & "(蜻ｽ荳ｭ)") Then 
			SpecialEffect(wname & "(蜻ｽ荳ｭ)")
		ElseIf Not IsWavePlayed Then 
			HitEffect(Me, w, t, hit_count)
		End If
		SysMessage(wname & "(蜻ｽ荳ｭ)")
		
		'Invalid_string_refer_to_original_code
		If t.IsConditionSatisfied("辟｡謨ｵ") Then
			If Not be_quiet Then
				t.PilotMessage("Invalid_string_refer_to_original_code")
				PilotMessage(wname & "Invalid_string_refer_to_original_code")
			End If
			DisplaySysMessage(msg & t.Nickname & "縺ｯ[" & wnickname & "Invalid_string_refer_to_original_code")
			dmg = 0
			GoTo EndAttack
		End If
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "谿ｺ") Then
			If t.HP > dmg Then
				DisplaySysMessage(msg & t.Nickname & "Invalid_string_refer_to_original_code")
				GoTo EndAttack
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If su Is Nothing And def_mode <> "謠ｴ隴ｷ髦ｲ蠕｡" Then
			'Invalid_string_refer_to_original_code
			If IsWeaponClassifiedAs(w, "蜷ｹ") Or IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
				CheckBlowAttack(w, t, dmg, msg, attack_mode, def_mode, critical_type)
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			CheckDrawAttack(w, t, msg, def_mode, critical_type)
		End If
		
		'蠑ｷ蛻ｶ霆｢遘ｻ
		If IsWeaponClassifiedAs(w, "霆｢") Then
			CheckTeleportAwayAttack(w, t, msg, def_mode, critical_type)
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If is_critical Then
			msg = msg & "Invalid_string_refer_to_original_code"
		End If
		
		'繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡縺ｮ蜉ｹ譫憺←逕ｨ
		If use_shield Then
			If IsWeaponClassifiedAs(w, "遐ｴ") Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				dmg = (5 * dmg) \ 6
			Else
				dmg = 3 * dmg \ 4
			End If
		End If
		'End If
		
		'Invalid_string_refer_to_original_code_
		'And Not IsWeaponClassifiedAs(w, "辟｡") _
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		t.EN = t.EN - 5
		
		If IsWeaponClassifiedAs(w, "遐ｴ") Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		End If
		
		If dmg <= spower Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			UpdateMessageForm(Me, t)
		Else
			UpdateMessageForm(Me, Nothing)
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If Not be_quiet Then
			If t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
				t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
			Else
				t.PilotMessage("Invalid_string_refer_to_original_code")
			End If
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.PlayAnimation("Invalid_string_refer_to_original_code")
		t.SpecialEffect("Invalid_string_refer_to_original_code")
		'End If
		
		DisplaySysMessage(msg & fname & "Invalid_string_refer_to_original_code")
		GoTo EndAttack
		'End If
		
		dmg = dmg - spower
		'End If
		'End If
		
		'譛菴弱ム繝｡繝ｼ繧ｸ縺ｯ10
		If dmg > 0 And dmg < 10 Then
			dmg = 10
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'And MainPilot.Technique > t.MainPilot.Technique _
		'Invalid_string_refer_to_original_code_
		'Or t.IsConditionSatisfied("荳肴ｭｻ霄ｫ") _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If t.HP <= 10 Then
			dmg = 0
		ElseIf t.HP - dmg < 10 Then 
			dmg = t.HP - 10
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		CauseEffect(w, t, msg, critical_type, def_mode, dmg >= t.HP)
		
		If InStr(critical_type, "蜊ｳ豁ｻ") > 0 And Not use_support_guard And Not use_protect_msg Then
			If t.IsHero() Then
				msg = msg & WeaponNickname(w) & "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				msg = msg & WeaponNickname(w) & "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			End If
			dmg = t.HP
		Else
			If t.HP - dmg < 0 Then
				dmg = t.HP
			End If
		End If
		
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & wnickname & "縺啓" & t.Nickname & "]縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code"
		t.EN = MaxLng(t.EN - t.MaxEN * (dmg / t.MaxHP), 0)
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		msg = msg & Nickname & "縺ｯ[" & t.Nickname & "]縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code"
		prev_en = t.EN
		t.EN = MaxLng(t.EN - t.MaxEN * (dmg / t.MaxHP), 0)
		EN = EN + (prev_en - t.EN) \ 2
		'End If
		
		'Invalid_string_refer_to_original_code
		If is_critical Or Len(critical_type) > 0 Then
			If Not be_quiet Then
				PilotMessage(wname & "Invalid_string_refer_to_original_code")
			End If
			If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Then
				PlayAnimation(wname & "Invalid_string_refer_to_original_code")
			ElseIf IsSpecialEffectDefined(wname & "Invalid_string_refer_to_original_code") Then 
				SpecialEffect(wname & "Invalid_string_refer_to_original_code")
			Else
				CriticalEffect(critical_type, w, use_support_guard Or use_protect_msg)
			End If
		End If
		
ApplyDamage: 
		'繝繝｡繝ｼ繧ｸ縺ｮ驕ｩ逕ｨ
		t.HP = t.HP - dmg
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "蜷ｸ") And Not t.SpecialEffectImmune("蜷ｸ") Then
			If HP < MaxHP Then
				msg = msg & Nickname & "縺ｯ[" & t.Nickname & "]縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code"
				HP = HP + (prev_hp - t.HP) \ 4
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Sleep(150)
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		UpdateMessageForm(Me, t)
		UpdateMessageForm(Me, Nothing)
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If IsPictureVisible Then
			ClearPicture()
			'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
			MainForm.picMain(0).Refresh()
		End If
		'End If
		
		'繝繝｡繝ｼ繧ｸ驥上ｒ繝槭ャ繝励え繧｣繝ｳ繝峨え縺ｫ陦ｨ遉ｺ
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If IsAnimationDefined(wname & "(繝繝｡繝ｼ繧ｸ陦ｨ遉ｺ)") Then
			PlayAnimation(wname & "(繝繝｡繝ｼ繧ｸ陦ｨ遉ｺ)")
		ElseIf IsAnimationDefined("繝繝｡繝ｼ繧ｸ陦ｨ遉ｺ") Then 
			PlayAnimation("繝繝｡繝ｼ繧ｸ陦ｨ遉ｺ")
		Else
			If Not BattleAnimation Or WeaponPower(w, "") > 0 Or dmg > 0 Then
				If Not BattleAnimation And Not su Is Nothing Then
					DrawSysString(prev_x, prev_y, VB6.Format(dmg))
				Else
					DrawSysString(t.x, t.y, VB6.Format(dmg))
				End If
			End If
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.HP > 0 Then
			CheckAutoAttack(w, t, attack_mode, def_mode, dmg, be_quiet Or use_protect_msg)
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			GoTo EndAttack
		End If
		'End If
		
		'遐ｴ螢翫い繝九Γ
		If t.HP = 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.PlayAnimation("Invalid_string_refer_to_original_code")
		Else
			t.SpecialEffect("Invalid_string_refer_to_original_code")
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		separate_parts = False
		If t.HP = 0 Then
			If t.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				If t.OtherForm(LIndex(t.FeatureData("Invalid_string_refer_to_original_code"), 2)).IsAbleToEnter(t.x, t.y) Then
					If t.IsFeatureLevelSpecified("Invalid_string_refer_to_original_code") Then
						If Dice(100) <= 10 * t.FeatureLevel("Invalid_string_refer_to_original_code") Then
							separate_parts = True
						End If
					Else
						separate_parts = True
					End If
				End If
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'And Not use_protect_msg _
		'And Not use_shield_msg _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If t.HP = 0 Then
			If separate_parts Then
				fname = t.FeatureName("Invalid_string_refer_to_original_code")
				If t.IsMessageDefined("Invalid_string_refer_to_original_code" & t.Name & ")") Then
					t.PilotMessage("Invalid_string_refer_to_original_code" & t.Name & ")")
				ElseIf t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
					t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
				ElseIf t.IsMessageDefined("遐ｴ螢頑凾") Then 
					t.PilotMessage("Invalid_string_refer_to_original_code")
				ElseIf t.IsMessageDefined("Invalid_string_refer_to_original_code" & t.Name & ")") Then 
					t.PilotMessage("Invalid_string_refer_to_original_code" & t.Name & ")")
				ElseIf t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
					t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
				ElseIf t.IsMessageDefined("Invalid_string_refer_to_original_code") Then 
					t.PilotMessage("Invalid_string_refer_to_original_code")
				Else
					t.PilotMessage("繝繝｡繝ｼ繧ｸ螟ｧ")
				End If
			Else
				t.PilotMessage("Invalid_string_refer_to_original_code")
			End If
		End If
		'End If
		
		If Not be_quiet Then
			If t.HP = 0 Then
				'Invalid_string_refer_to_original_code
				PilotMessage(wname & "Invalid_string_refer_to_original_code")
			Else
				'Invalid_string_refer_to_original_code
				PilotMessage(wname & "(繝繝｡繝ｼ繧ｸ)")
			End If
		End If
		
		'繝繝｡繝ｼ繧ｸ繧｢繝九Γ
		If t.HP = 0 Then
			'縺ｩ縺ｩ繧√い繝九Γ
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Then
				PlayAnimation(wname & "Invalid_string_refer_to_original_code")
			Else
				SpecialEffect(wname & "Invalid_string_refer_to_original_code")
			End If
		End If
		If ((dmg <= 0.05 * t.MaxHP And t.HP >= 0.25 * t.MaxHP) Or dmg <= 10) And Len(critical_type) = 0 Then
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.PlayAnimation("Invalid_string_refer_to_original_code")
		Else
			t.SpecialEffect("Invalid_string_refer_to_original_code")
		End If
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'繝繝｡繝ｼ繧ｸ螟ｧ
		If t.IsAnimationDefined("繝繝｡繝ｼ繧ｸ螟ｧ") Then
			t.PlayAnimation("繝繝｡繝ｼ繧ｸ螟ｧ")
		Else
			t.SpecialEffect("繝繝｡繝ｼ繧ｸ螟ｧ")
		End If
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.PlayAnimation("Invalid_string_refer_to_original_code")
		t.SpecialEffect("Invalid_string_refer_to_original_code")
		'End If
		'繝繝｡繝ｼ繧ｸ荳ｭ
		If t.IsAnimationDefined("繝繝｡繝ｼ繧ｸ荳ｭ") Then
			t.PlayAnimation("繝繝｡繝ｼ繧ｸ荳ｭ")
		Else
			t.SpecialEffect("繝繝｡繝ｼ繧ｸ荳ｭ")
		End If
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'And Not use_protect_msg _
		'And Not use_shield_msg _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If t.HP = 0 Then
			'Invalid_string_refer_to_original_code
		ElseIf ((dmg <= 0.05 * t.MaxHP And t.HP >= 0.25 * t.MaxHP) Or dmg <= 10) And Len(critical_type) = 0 Then 
			'Invalid_string_refer_to_original_code
			t.PilotMessage("Invalid_string_refer_to_original_code")
		ElseIf t.HP < 0.25 * t.MaxHP Then 
			'繝繝｡繝ｼ繧ｸ螟ｧ
			t.PilotMessage("繝繝｡繝ｼ繧ｸ螟ｧ")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.PilotMessage("Invalid_string_refer_to_original_code")
		ElseIf t.HP >= 0.8 * t.MaxHP And Len(critical_type) = 0 Then 
			'Invalid_string_refer_to_original_code
			t.PilotMessage("Invalid_string_refer_to_original_code")
		Else
			t.PilotMessage("繝繝｡繝ｼ繧ｸ荳ｭ")
		End If
		'End If
		
		'繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡
		If use_shield And t.HP > 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If t.IsSysMessageDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname) Then
				t.SysMessage("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
			Else
				msg = msg & t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
			End If
			'Invalid_string_refer_to_original_code_
			'And Not IsWeaponClassifiedAs(w, "辟｡") _
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.EN = t.EN - 5
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If t.IsSysMessageDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname) Then
				t.SysMessage("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
			Else
				msg = msg & t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If t.IsSysMessageDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname) Then
				t.SysMessage("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
			Else
				msg = msg & t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If t.IsSysMessageDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname) Then
				t.SysMessage("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
			Else
				msg = msg & t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If t.IsSysMessageDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname) Then
				t.SysMessage("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
			ElseIf Not t.IsHero Then 
				msg = msg & t.Nickname & "縺ｮ[" & fname & "Invalid_string_refer_to_original_code"
			Else
				msg = msg & fname & "縺啓" & t.Nickname & "Invalid_string_refer_to_original_code"
			End If
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.HP > 0 Then
			If dmg = 0 Then
				If Len(critical_type) > 0 Then
					DisplaySysMessage(msg)
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					DisplaySysMessage(msg & t.Nickname & "Invalid_string_refer_to_original_code")
				Else
					DisplaySysMessage(msg & t.Nickname & "Invalid_string_refer_to_original_code")
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				If t.IsFeatureAvailable("繝ｩ繝ｼ繝九Φ繧ｰ蜿ｯ閭ｽ謚") Then
					buf = t.FeatureData("繝ｩ繝ｼ繝九Φ繧ｰ蜿ｯ閭ｽ謚")
					Select Case LIndex(buf, 2)
						Case "陦ｨ遉ｺ", ""
							fname = LIndex(buf, 1)
						Case Else
							fname = LIndex(buf, 2)
					End Select
					If MainPilot.IsSkillAvailable(LIndex(buf, 1)) Then
						DisplaySysMessage(msg & MainPilot.Nickname & "Invalid_string_refer_to_original_code")
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Else
						DisplaySysMessage(msg & MainPilot.Nickname & "Invalid_string_refer_to_original_code")
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					End If
				Else
					DisplaySysMessage(msg & t.Nickname & "Invalid_string_refer_to_original_code")
				End If
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
			Else
				DisplaySysMessage(msg & t.Nickname & "Invalid_string_refer_to_original_code")
			End If
		ElseIf t.IsConditionSatisfied("Invalid_string_refer_to_original_code") Then 
			If attack_num > 1 Then
				msg = msg & VB6.Format(hit_count) & "Invalid_string_refer_to_original_code"
			End If
			DisplaySysMessage(msg & t.Nickname & "縺ｯ[" & VB6.Format(dmg) & "Invalid_string_refer_to_original_code")
		Else
			If attack_num > 1 Then
				msg = msg & VB6.Format(hit_count) & "Invalid_string_refer_to_original_code"
			End If
			DisplaySysMessage(msg & t.Nickname & "縺ｯ[" & VB6.Format(dmg) & "Invalid_string_refer_to_original_code" & "Invalid_string_refer_to_original_code" & VB6.Format(t.HP) & "Invalid_string_refer_to_original_code" & VB6.Format(100 * (t.MaxHP - t.HP) \ t.MaxHP) & "Invalid_string_refer_to_original_code")
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If t.HP <= t.MaxHP \ 4 And Not t.IsConditionSatisfied("證ｴ襍ｰ") Then
			t.AddCondition("證ｴ襍ｰ", -1)
			t.Update()
			If t.IsHero Then
				DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
			End If
		End If
		'End If
		'End If
		
		'繝繝｡繝ｼ繧ｸ繧貞女縺代ｌ縺ｰ逵繧翫°繧峨＆繧√ｋ
		If t.IsConditionSatisfied("逹｡逵") And Not IsWeaponClassifiedAs(w, "逵") Then
			t.DeleteCondition("逹｡逵")
			DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
		End If
		
		'繝繝｡繝ｼ繧ｸ繧貞女縺代ｋ縺ｨ蜃咲ｵ占ｧ｣髯､
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.DeleteCondition("Invalid_string_refer_to_original_code")
		DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.HP = 0 Then
			If attack_num > 1 Then
				msg = msg & VB6.Format(hit_count) & "Invalid_string_refer_to_original_code"
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.SysMessage("Invalid_string_refer_to_original_code")
		ElseIf t.IsHero Then 
			DisplaySysMessage(msg & t.Nickname & "縺ｯ[" & VB6.Format(dmg) & "Invalid_string_refer_to_original_code")
		Else
			DisplaySysMessage(msg & t.Nickname & "縺ｯ[" & VB6.Format(dmg) & "Invalid_string_refer_to_original_code")
		End If
		
		'Invalid_string_refer_to_original_code
		
		'Invalid_string_refer_to_original_code
		If t.IsUnderSpecialPowerEffect("蠕ｩ豢ｻ") Then
			t.RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
			GoTo Resurrect
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.HP = t.MaxHP \ 2
		t.IncreaseMorale(10)
		If t.IsMessageDefined("蠕ｩ豢ｻ") Then
			t.PilotMessage("蠕ｩ豢ｻ")
		End If
		If t.IsAnimationDefined("蠕ｩ豢ｻ") Then
			t.PlayAnimation("蠕ｩ豢ｻ")
		Else
			t.SpecialEffect("蠕ｩ豢ｻ")
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If buf = "髱櫁｡ｨ遉ｺ" Then
			buf = "Invalid_string_refer_to_original_code"
		End If
		If t.IsSysMessageDefined("蠕ｩ豢ｻ", buf) Then
			t.SysMessage("蠕ｩ豢ｻ", buf)
		Else
			DisplaySysMessage(t.MainPilot.Nickname & "Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		End If
		GoTo Resurrect
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.MainPilot.IsSkillAvailable("蜀咲函") Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If MainPilot.IsSkillAvailable("Invalid_string_refer_to_original_code") Then
				If IsMessageDefined("Invalid_string_refer_to_original_code" & wname & ")") Then
					PilotMessage("Invalid_string_refer_to_original_code" & wname & ")")
					If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
						PlayAnimation("Invalid_string_refer_to_original_code", wname)
					Else
						SpecialEffect("Invalid_string_refer_to_original_code", wname)
					End If
				ElseIf IsMessageDefined("Invalid_string_refer_to_original_code") Then 
					PilotMessage("Invalid_string_refer_to_original_code")
					If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
						PlayAnimation("Invalid_string_refer_to_original_code", wname)
					Else
						SpecialEffect("Invalid_string_refer_to_original_code", wname)
					End If
				ElseIf IsMessageDefined("Invalid_string_refer_to_original_code" & wname & ")") Then 
					PilotMessage("Invalid_string_refer_to_original_code" & wname & ")")
					If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
						PlayAnimation("Invalid_string_refer_to_original_code", wname)
					Else
						SpecialEffect("Invalid_string_refer_to_original_code", wname)
					End If
				ElseIf IsMessageDefined("Invalid_string_refer_to_original_code") Then 
					PilotMessage("Invalid_string_refer_to_original_code")
					If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
						PlayAnimation("Invalid_string_refer_to_original_code", wname)
					Else
						SpecialEffect("Invalid_string_refer_to_original_code", wname)
					End If
				End If
				If IsSysMessageDefined("Invalid_string_refer_to_original_code") Then
					SysMessage("Invalid_string_refer_to_original_code")
				Else
					DisplaySysMessage(MainPilot.Nickname & "Invalid_string_refer_to_original_code" & t.Nickname & "Invalid_string_refer_to_original_code")
				End If
				GoTo Cure
			End If
			For i = 2 To CountPilot
				If Pilot(i).IsSkillAvailable("Invalid_string_refer_to_original_code") Then
					If IsMessageDefined("Invalid_string_refer_to_original_code" & wname & ")") Then
						PilotMessage("Invalid_string_refer_to_original_code" & wname & ")")
						If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
							PlayAnimation("Invalid_string_refer_to_original_code", wname)
						Else
							SpecialEffect("Invalid_string_refer_to_original_code", wname)
						End If
					ElseIf IsMessageDefined("Invalid_string_refer_to_original_code") Then 
						PilotMessage("Invalid_string_refer_to_original_code")
						If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
							PlayAnimation("Invalid_string_refer_to_original_code", wname)
						Else
							SpecialEffect("Invalid_string_refer_to_original_code", wname)
						End If
					ElseIf IsMessageDefined("Invalid_string_refer_to_original_code" & wname & ")") Then 
						PilotMessage("Invalid_string_refer_to_original_code" & wname & ")")
						If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
							PlayAnimation("Invalid_string_refer_to_original_code", wname)
						Else
							SpecialEffect("Invalid_string_refer_to_original_code", wname)
						End If
					ElseIf IsMessageDefined("Invalid_string_refer_to_original_code") Then 
						PilotMessage("Invalid_string_refer_to_original_code")
						If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
							PlayAnimation("Invalid_string_refer_to_original_code", wname)
						Else
							SpecialEffect("Invalid_string_refer_to_original_code", wname)
						End If
					End If
					If IsSysMessageDefined("Invalid_string_refer_to_original_code") Then
						SysMessage("Invalid_string_refer_to_original_code")
					Else
						DisplaySysMessage(Pilot(i).Nickname & "Invalid_string_refer_to_original_code" & t.Nickname & "Invalid_string_refer_to_original_code")
					End If
					GoTo Cure
				End If
			Next 
			For i = 1 To CountSupport
				If Support(i).IsSkillAvailable("Invalid_string_refer_to_original_code") Then
					If IsMessageDefined("Invalid_string_refer_to_original_code" & wname & ")") Then
						PilotMessage("Invalid_string_refer_to_original_code" & wname & ")")
						If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
							PlayAnimation("Invalid_string_refer_to_original_code", wname)
						Else
							SpecialEffect("Invalid_string_refer_to_original_code", wname)
						End If
					ElseIf IsMessageDefined("Invalid_string_refer_to_original_code") Then 
						PilotMessage("Invalid_string_refer_to_original_code")
						If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
							PlayAnimation("Invalid_string_refer_to_original_code", wname)
						Else
							SpecialEffect("Invalid_string_refer_to_original_code", wname)
						End If
					ElseIf IsMessageDefined("Invalid_string_refer_to_original_code" & wname & ")") Then 
						PilotMessage("Invalid_string_refer_to_original_code" & wname & ")")
						If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
							PlayAnimation("Invalid_string_refer_to_original_code", wname)
						Else
							SpecialEffect("Invalid_string_refer_to_original_code", wname)
						End If
					ElseIf IsMessageDefined("Invalid_string_refer_to_original_code") Then 
						PilotMessage("Invalid_string_refer_to_original_code")
						If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
							PlayAnimation("Invalid_string_refer_to_original_code", wname)
						Else
							SpecialEffect("Invalid_string_refer_to_original_code", wname)
						End If
					End If
					If IsSysMessageDefined("Invalid_string_refer_to_original_code") Then
						SysMessage("Invalid_string_refer_to_original_code")
					Else
						DisplaySysMessage(Support(i).Nickname & "Invalid_string_refer_to_original_code" & t.Nickname & "Invalid_string_refer_to_original_code")
					End If
					GoTo Cure
				End If
			Next 
			If IsHero Then
				If IsMessageDefined("Invalid_string_refer_to_original_code" & wname & ")") Then
					PilotMessage("Invalid_string_refer_to_original_code" & wname & ")")
					If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
						PlayAnimation("Invalid_string_refer_to_original_code", wname)
					Else
						SpecialEffect("Invalid_string_refer_to_original_code", wname)
					End If
					DisplaySysMessage(MainPilot.Nickname & "Invalid_string_refer_to_original_code" & t.Nickname & "Invalid_string_refer_to_original_code")
				ElseIf IsMessageDefined("Invalid_string_refer_to_original_code") Then 
					PilotMessage("Invalid_string_refer_to_original_code")
					If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
						PlayAnimation("Invalid_string_refer_to_original_code", wname)
					Else
						SpecialEffect("Invalid_string_refer_to_original_code", wname)
					End If
					DisplaySysMessage(MainPilot.Nickname & "Invalid_string_refer_to_original_code" & t.Nickname & "Invalid_string_refer_to_original_code")
				ElseIf IsMessageDefined("Invalid_string_refer_to_original_code" & wname & ")") Then 
					PilotMessage("Invalid_string_refer_to_original_code" & wname & ")")
					If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
						PlayAnimation("Invalid_string_refer_to_original_code", wname)
					Else
						SpecialEffect("Invalid_string_refer_to_original_code", wname)
					End If
					DisplaySysMessage(MainPilot.Nickname & "Invalid_string_refer_to_original_code" & t.Nickname & "Invalid_string_refer_to_original_code")
				ElseIf IsMessageDefined("Invalid_string_refer_to_original_code") Then 
					PilotMessage("Invalid_string_refer_to_original_code")
					If IsAnimationDefined("Invalid_string_refer_to_original_code", wname) Then
						PlayAnimation("Invalid_string_refer_to_original_code", wname)
					Else
						SpecialEffect("Invalid_string_refer_to_original_code", wname)
					End If
					If IsSysMessageDefined("Invalid_string_refer_to_original_code") Then
						SysMessage("Invalid_string_refer_to_original_code")
					Else
						DisplaySysMessage(MainPilot.Nickname & "Invalid_string_refer_to_original_code" & t.Nickname & "Invalid_string_refer_to_original_code")
					End If
				End If
				GoTo Cure
			End If
		End If
		
		If Dice(16) <= t.MainPilot.SkillLevel("蜀咲函") Then
			t.HP = t.MaxHP \ 2
			If t.IsMessageDefined("蠕ｩ豢ｻ") Then
				t.PilotMessage("蠕ｩ豢ｻ")
			End If
			If t.IsAnimationDefined("蠕ｩ豢ｻ") Then
				t.PlayAnimation("蠕ｩ豢ｻ")
			Else
				t.SpecialEffect("蠕ｩ豢ｻ")
			End If
			
			buf = t.MainPilot.SkillName0("蜀咲函")
			If buf = "髱櫁｡ｨ遉ｺ" Then
				buf = "蜀咲函"
			End If
			If t.IsSysMessageDefined("蜀咲函", buf) Then
				t.SysMessage("蜀咲函", buf)
			Else
				DisplaySysMessage(t.Nickname & "縺ｯ" & buf & "Invalid_string_refer_to_original_code")
			End If
			GoTo Resurrect
		End If
		'End If
		'End If
		
Cure: 
		
		'Invalid_string_refer_to_original_code
		If separate_parts Then
			uname = LIndex(t.FeatureData("Invalid_string_refer_to_original_code"), 2)
			
			If Not t.IsHero Then
				If BattleAnimation Then
					ExplodeAnimation((t.Size), t.x, t.y)
				Else
					PlayWave("Explode.wav")
				End If
			End If
			
			fname = t.FeatureName("Invalid_string_refer_to_original_code")
			If t.IsAnimationDefined("Invalid_string_refer_to_original_code" & t.Name & ")") Then
				t.PlayAnimation("Invalid_string_refer_to_original_code" & t.Name & ")")
			ElseIf t.IsAnimationDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
				t.PlayAnimation("Invalid_string_refer_to_original_code" & fname & ")")
			ElseIf t.IsAnimationDefined("Invalid_string_refer_to_original_code") Then 
				t.PlayAnimation("Invalid_string_refer_to_original_code")
			ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & t.Name & ")") Then 
				t.SpecialEffect("Invalid_string_refer_to_original_code" & t.Name & ")")
			ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
				t.SpecialEffect("Invalid_string_refer_to_original_code" & fname & ")")
			ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code") Then 
				t.SpecialEffect("Invalid_string_refer_to_original_code")
			ElseIf t.IsAnimationDefined("Invalid_string_refer_to_original_code" & t.Name & ")") Then 
				t.PlayAnimation("Invalid_string_refer_to_original_code" & t.Name & ")")
			ElseIf t.IsAnimationDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
				t.PlayAnimation("Invalid_string_refer_to_original_code" & fname & ")")
			ElseIf t.IsAnimationDefined("Invalid_string_refer_to_original_code") Then 
				t.PlayAnimation("Invalid_string_refer_to_original_code")
			ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & t.Name & ")") Then 
				t.SpecialEffect("Invalid_string_refer_to_original_code" & t.Name & ")")
			ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
				t.SpecialEffect("Invalid_string_refer_to_original_code" & fname & ")")
			Else
				t.SpecialEffect("Invalid_string_refer_to_original_code")
			End If
			
			t.Transform(uname)
			With t.CurrentForm
				.HP = .MaxHP
				'Invalid_string_refer_to_original_code
				If .Party = Stage Then
					.UsedAction = .MaxAction
				End If
			End With
			
			If t.IsSysMessageDefined("Invalid_string_refer_to_original_code" & t.Name & ")") Then
				t.SysMessage("Invalid_string_refer_to_original_code" & t.Name & ")")
			ElseIf t.IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
				t.SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
			ElseIf t.IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
				t.SysMessage("Invalid_string_refer_to_original_code")
			ElseIf t.IsSysMessageDefined("Invalid_string_refer_to_original_code" & t.Name & ")") Then 
				t.SysMessage("Invalid_string_refer_to_original_code" & t.Name & ")")
			ElseIf t.IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
				t.SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
			ElseIf t.IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
				t.SysMessage("Invalid_string_refer_to_original_code")
			ElseIf t.IsHero() Then 
				If t.Nickname <> t.OtherForm(uname).Nickname Then
					DisplaySysMessage(t.Nickname & "縺ｯ" & t.OtherForm(uname).Nickname & "Invalid_string_refer_to_original_code")
				Else
					DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
				End If
			Else
				DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
			End If
			
			t = t.CurrentForm
			SelectedTarget = t
			SelectedTargetForEvent = t
			GoTo Resurrect
		End If
		
		'繝ｦ繝九ャ繝育ｴ螢翫↓繧医ｋ豌怜鴨縺ｮ螟牙虚
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		AttackUnit.CurrentForm.IncreaseMorale(3)
		IncreaseMorale(3)
		'End If
		
		'Invalid_string_refer_to_original_code
		For	Each p In PList
			With p
				'Invalid_string_refer_to_original_code
				If .Unit_Renamed Is Nothing Then
					GoTo NextPilot
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				GoTo NextPilot
				'End If
				
				If .Party = Party Then
					'Invalid_string_refer_to_original_code
					If .Personality <> "讖滓｢ｰ" Then
						.Morale = .Morale + 1
					End If
				ElseIf .Party = t.Party Then 
					'Invalid_string_refer_to_original_code
					Select Case .Personality
						Case "Invalid_string_refer_to_original_code"
							morale_mod = 2
						Case "Invalid_string_refer_to_original_code"
							morale_mod = 1
						Case "Invalid_string_refer_to_original_code"
							morale_mod = -1
						Case Else
							morale_mod = 0
					End Select
					
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					.Morale = .Morale + 5 * morale_mod
				Else
					.Morale = .Morale + morale_mod
				End If
				'End If
			End With
NextPilot: 
		Next p
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.IsMessageDefined("閼ｱ蜃ｺ") And Not is_event And Not IsEventDefined("Invalid_string_refer_to_original_code" & t.MainPilot.ID, True) Then
			t.PilotMessage("閼ｱ蜃ｺ")
		End If
		
		'Invalid_string_refer_to_original_code
		If Not BattleAnimation Then
			If Not su Is Nothing Then
				With su
					.x = prev_x
					.y = prev_y
					.Area = prev_area
				End With
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		t.Die()
		'End If
		
Resurrect: 'Invalid_string_refer_to_original_code
		
EndAttack: 
		
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'And HP > 0 And t.HP > 0 _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		If Not second_attack And IsWeaponAvailable(w, "Invalid_string_refer_to_original_code") And IsTargetWithinRange(w, t) Then
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			second_attack = True
			RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
			GoTo begin
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If MainPilot.Intuition >= t.MainPilot.Intuition Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		End If
		If slevel >= Dice(32) Then
			second_attack = True
			RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
			GoTo begin
		End If
		'End If
		
		'蜀榊ｱ樊ｧ
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		second_attack = True
		RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
		GoTo begin
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If su Is t Then
			CheckAdditionalAttack(w, t, be_quiet, attack_mode, "謠ｴ隴ｷ髦ｲ蠕｡", dmg)
		Else
			CheckAdditionalAttack(w, t, be_quiet, attack_mode, "", dmg)
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If Not su Is Nothing Then
			su = su.CurrentForm
			With su
				
				sx = .x
				sy = .y
				
				'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
				MapDataForUnit(sx, sy) = Nothing
				
				.x = prev_x
				.y = prev_y
				.Area = prev_area
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				MapDataForUnit(.x, .y) = su
				MapDataForUnit(tx, ty) = orig_t
				If BattleAnimation Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If Not IsRButtonPressed() Then
						su.PlayAnimation("Invalid_string_refer_to_original_code")
					End If
				Else
					If Not IsRButtonPressed() Then
						PaintUnitBitmap(orig_t, "Invalid_string_refer_to_original_code")
						If use_support_guard Then
							MoveUnitBitmap(su, sx, sy, .x, .y, 80, 4)
						Else
							MoveUnitBitmap(su, sx, sy, .x, .y, 50)
						End If
					Else
						PaintUnitBitmap(su, "Invalid_string_refer_to_original_code")
						PaintUnitBitmap(orig_t, "Invalid_string_refer_to_original_code")
					End If
				End If
			End With
		End If
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		MapDataForUnit(tx, ty) = orig_t
		PaintUnitBitmap(orig_t, "Invalid_string_refer_to_original_code")
		'End If
		'End With
		'End If
		
		If is_hit Then
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			With CurrentForm
				If .MainPilot.IsSkillAvailable("蜻ｽ荳ｭ譎よｰ怜鴨蠅怜刈") Then
					.Pilot(1).Morale = .Pilot(1).Morale + .MainPilot.SkillLevel("蜻ｽ荳ｭ譎よｰ怜鴨蠅怜刈")
				End If
			End With
		End If
		
		'Invalid_string_refer_to_original_code
		t.IncreaseMorale(1)
		If t.MainPilot.IsSkillAvailable("謳榊す譎よｰ怜鴨蠅怜刈") Then
			t.Pilot(1).Morale = t.Pilot(1).Morale + t.MainPilot.SkillLevel("謳榊す譎よｰ怜鴨蠅怜刈")
		End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		With CurrentForm
			If .MainPilot.IsSkillAvailable("螟ｱ謨玲凾豌怜鴨蠅怜刈") Then
				.Pilot(1).Morale = .Pilot(1).Morale + .MainPilot.SkillLevel("螟ｱ謨玲凾豌怜鴨蠅怜刈")
			End If
		End With
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.MainPilot.IsSkillAvailable("蝗樣∩譎よｰ怜鴨蠅怜刈") Then
			t.Pilot(1).Morale = t.Pilot(1).Morale + t.MainPilot.SkillLevel("蝗樣∩譎よｰ怜鴨蠅怜刈")
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.RemoveSpecialPowerInEffect("髦ｲ蠕｡")
		'End If
		If is_hit Then
			t.RemoveSpecialPowerInEffect("陲ｫ蠑ｾ")
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.DeleteCondition("Invalid_string_refer_to_original_code")
		t.BitmapID = MakeUnitBitmap(t)
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		PaintUnitBitmap(t, "Invalid_string_refer_to_original_code")
		'End If
		'End If
		If t.IsConditionSatisfied("髱櫁｡ｨ遉ｺ莉伜刈") Then
			t.DeleteCondition("髱櫁｡ｨ遉ｺ莉伜刈")
			t.BitmapID = MakeUnitBitmap(t)
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			PaintUnitBitmap(t, "Invalid_string_refer_to_original_code")
		End If
		'End If
		
		'謌ｦ髣倥↓蜿ょ刈縺励◆繝ｦ繝九ャ繝医ｒ隴伜挨
		With CurrentForm
			If IsOptionDefined("繝ｦ繝九ャ繝域ュ蝣ｱ髫阡ｽ") Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.AddCondition("隴伜挨貂医∩", -1, 0, "髱櫁｡ｨ遉ｺ")
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.AddCondition("隴伜挨貂医∩", -1, 0, "髱櫁｡ｨ遉ｺ")
			'End If
			If .IsConditionSatisfied("繝ｦ繝九ャ繝域ュ蝣ｱ髫阡ｽ") Then
				.DeleteCondition("繝ｦ繝九ャ繝域ュ蝣ｱ髫阡ｽ")
			End If
			If t.IsConditionSatisfied("繝ｦ繝九ャ繝域ュ蝣ｱ髫阡ｽ") Then
				t.DeleteCondition("繝ｦ繝九ャ繝域ュ蝣ｱ髫阡ｽ")
			End If
			'End If
		End With
		
		'Invalid_string_refer_to_original_code
		CurrentForm.Update()
		t.Update()
		
		'Invalid_string_refer_to_original_code
		Select Case attack_mode
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				RestoreSelections()
				Exit Sub
		End Select
		
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'And t.CurrentForm.MaxAction > 0 _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			AddCondition("Invalid_string_refer_to_original_code", 1)
		End If
		AddCondition("Invalid_string_refer_to_original_code", 1)
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(partners)
			With partners(i).CurrentForm
				For j = 1 To .CountWeapon
					If .Weapon(j).Name = wname Then
						.UseWeapon(j)
						If .IsWeaponClassifiedAs(j, "閾ｪ") Then
							If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
								uname = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), 2)
								If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
									.Transform(uname)
									With .CurrentForm
										.HP = .MaxHP
										.UsedAction = .MaxAction
									End With
								Else
									.Die()
								End If
							Else
								.Die()
							End If
						ElseIf .IsWeaponClassifiedAs(j, "螟ｱ") And .HP = 0 Then 
							.Die()
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If .IsFeatureAvailable("螟牙ｽ｢謚") Then
								uname = ""
								For k = 1 To .CountFeature
									If .Feature(k) = "螟牙ｽ｢謚" And LIndex(.FeatureData(k), 1) = wname Then
										uname = LIndex(.FeatureData(k), 2)
										If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
											.Transform(uname)
										End If
										Exit For
									End If
								Next 
								If uname <> .CurrentForm.Name Then
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
										.Transform(uname)
									End If
								End If
							End If
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
								.Transform(uname)
							End If
						End If
					End If
					Exit For
					'End If
				Next 
				
				'Invalid_string_refer_to_original_code
				If j > .CountWeapon Then
					If Weapon(w).ENConsumption > 0 Then
						.EN = .EN - WeaponENConsumption(w)
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					.AddCondition("Invalid_string_refer_to_original_code")
				End If
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.DeleteCondition("Invalid_string_refer_to_original_code")
				'End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				hp_ratio = 100 * .HP / .MaxHP
				en_ratio = 100 * .EN / .MaxEN
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				.HP = .MaxHP * hp_ratio / 100
				.EN = .MaxEN * en_ratio / 100
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				hp_ratio = 100 * .HP / .MaxHP
				en_ratio = 100 * .EN / .MaxEN
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				.HP = .MaxHP * hp_ratio / 100
				.EN = .MaxEN * en_ratio / 100
				'End If
				If IsWeaponClassifiedAs(w, "螟ｱ") Then
					.HP = MaxLng(.HP - .MaxHP * WeaponLevel(w, "螟ｱ") \ 10, 0)
				End If
				If IsWeaponClassifiedAs(w, "閾ｪ") Then
					If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						uname = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), 2)
						If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
							.Transform(uname)
							With .CurrentForm
								.HP = .MaxHP
								.UsedAction = .MaxAction
							End With
						Else
							.Die()
						End If
					Else
						.Die()
					End If
				ElseIf IsWeaponClassifiedAs(w, "螟ｱ") And .HP = 0 Then 
					.Die()
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
						.Transform(uname)
					End If
				End If
				'End If
				'End If
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		
		'Invalid_string_refer_to_original_code
		IsWeaponClassifiedAs(w, "閾ｪ")
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			uname = LIndex(FeatureData("Invalid_string_refer_to_original_code"), 2)
			If OtherForm(uname).IsAbleToEnter(x, y) Then
				Transform(uname)
				With CurrentForm
					.HP = .MaxHP
					.UsedAction = .MaxAction
				End With
				fname = FeatureName("Invalid_string_refer_to_original_code")
				If IsSysMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then
					SysMessage("Invalid_string_refer_to_original_code" & Name & ")")
				ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
					SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
				ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
					SysMessage("Invalid_string_refer_to_original_code")
				ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then 
					SysMessage("Invalid_string_refer_to_original_code" & Name & ")")
				ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
					SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
				ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
					SysMessage("Invalid_string_refer_to_original_code")
				Else
					DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
				End If
			Else
				Die()
			End If
		Else
			Die()
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		Die()
		
		'螟牙ｽ｢謚
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If IsFeatureAvailable("螟牙ｽ｢謚") Then
			For i = 1 To CountFeature
				If Feature(i) = "螟牙ｽ｢謚" And LIndex(FeatureData(i), 1) = wname Then
					uname = LIndex(FeatureData(i), 2)
					If OtherForm(uname).IsAbleToEnter(x, y) Then
						Transform(uname)
					End If
					Exit For
				End If
			Next 
			If uname <> CurrentForm.Name Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If OtherForm(uname).IsAbleToEnter(x, y) Then
					Transform(uname)
				End If
			End If
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If OtherForm(uname).IsAbleToEnter(x, y) Then
			Transform(uname)
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: Attack に変換されていないステートメントがあります。ソース コードを確認してください。
		'Invalid_string_refer_to_original_code
		num = Data.CountWeapon
		num = num + MainPilot.Data.CountWeapon
		For i = 2 To CountPilot
			num = num + Pilot(i).Data.CountWeapon
		Next 
		For i = 2 To CountSupport
			num = num + Support(i).Data.CountWeapon
		Next 
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		num = num + AdditionalSupport.Data.CountWeapon
		'End If
		For	Each itm In colItem
			num = num + itm.CountWeapon
			If w <= num Then
				itm.Exist = False
				DeleteItem((itm.ID))
				Exit For
			End If
		Next itm
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'And (dmg > 0 Or Not IsWeaponClassifiedAs(w, "谿ｺ")) _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		CheckMetamorphAttack(w, t, def_mode)
		'End If
		
		With CurrentForm
			'繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ縺ｮ蜉ｹ譫懊ｒ蜑企勁
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			.AddCondition("Invalid_string_refer_to_original_code")
			'End If
			.RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
			If is_hit Then
				.RemoveSpecialPowerInEffect("蜻ｽ荳ｭ")
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			.DeleteCondition("Invalid_string_refer_to_original_code")
			.BitmapID = MakeUnitBitmap(CurrentForm)
			PaintUnitBitmap(CurrentForm)
			'End If
			If .IsConditionSatisfied("髱櫁｡ｨ遉ｺ莉伜刈") Then
				.DeleteCondition("髱櫁｡ｨ遉ｺ莉伜刈")
				.BitmapID = MakeUnitBitmap(CurrentForm)
				PaintUnitBitmap(CurrentForm)
			End If
			For i = 1 To UBound(partners)
				With partners(i).CurrentForm
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					.DeleteCondition("Invalid_string_refer_to_original_code")
					.BitmapID = MakeUnitBitmap(partners(i).CurrentForm)
					PaintUnitBitmap(partners(i).CurrentForm)
					'End If
					If .IsConditionSatisfied("髱櫁｡ｨ遉ｺ莉伜刈") Then
						.DeleteCondition("髱櫁｡ｨ遉ｺ莉伜刈")
						.BitmapID = MakeUnitBitmap(partners(i).CurrentForm)
						PaintUnitBitmap(partners(i).CurrentForm)
					End If
				End With
			Next 
		End With
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If IsPictureVisible Then
			ClearPicture()
			'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
			MainForm.picMain(0).Refresh()
		End If
		'End If
		
		' ADD START MARGE
		'Invalid_string_refer_to_original_code
		If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Then
			PlayAnimation(wname & "Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			PlayAnimation("Invalid_string_refer_to_original_code")
		End If
		' ADD END MARGE
		
		'繝ｦ繝九ャ繝磯∈謚槭ｒ隗｣髯､
		RestoreSelections()
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function CheckDodgeFeature(ByVal w As Short, ByRef t As Unit, ByRef tx As Short, ByRef ty As Short, ByRef attack_mode As String, ByRef def_mode As String, ByRef dmg As Integer, ByRef be_quiet As Boolean) As Boolean
		Dim wname As String
		Dim ecost, nmorale As Short
		Dim fname, fdata As String
		Dim flevel As Double
		Dim fid, frange As Short
		Dim u As Unit
		Dim j, i, k As Short
		Dim prob As Integer
		Dim buf As String
		Dim team, uteam As String
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		wname = WeaponNickname(w)
		team = MainPilot.SkillData("Invalid_string_refer_to_original_code")
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		GoTo SkipBlock
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		u = Nothing
		flevel = 0
		fid = 0
		'Invalid_string_refer_to_original_code
		For i = MaxLng(tx - 3, 1) To MinLng(tx + 3, MapWidth)
			For j = MaxLng(ty - 3, 1) To MinLng(ty + 3, MapHeight)
				If MapDataForUnit(i, j) Is Nothing Or System.Math.Abs(tx - i) + System.Math.Abs(ty - j) > 3 Then
					GoTo NextPoint
				End If
				
				With MapDataForUnit(i, j)
					If .IsEnemy(t) Then
						GoTo NextPoint
					End If
					
					If .Area = "蝨ｰ荳ｭ" Then
						GoTo NextPoint
					End If
					
					If Not .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						GoTo NextPoint
					End If
					
					'Invalid_string_refer_to_original_code
					uteam = .MainPilot.SkillData("Invalid_string_refer_to_original_code")
					If team <> uteam And uteam <> "" Then
						GoTo NextPoint
					End If
					
					For k = 1 To .CountFeature
						If .Feature(k) = "Invalid_string_refer_to_original_code" Then
							fdata = .FeatureData(k)
							
							'Invalid_string_refer_to_original_code
							If IsNumeric(LIndex(fdata, 2)) Then
								frange = CShort(LIndex(fdata, 2))
							Else
								frange = 1
							End If
							
							'菴ｿ逕ｨ譚｡莉ｶ
							If IsNumeric(LIndex(fdata, 5)) Then
								ecost = CShort(LIndex(fdata, 5))
							Else
								ecost = 0
							End If
							If IsNumeric(LIndex(fdata, 6)) Then
								nmorale = CShort(LIndex(fdata, 6))
							Else
								nmorale = 0
							End If
							
							'Invalid_string_refer_to_original_code
							If .EN >= ecost And .MainPilot.Morale >= nmorale And .IsAttributeClassified(LIndex(fdata, 3), WeaponClass(w)) And System.Math.Abs(tx - i) + System.Math.Abs(ty - j) <= frange And System.Math.Abs(x - i) + System.Math.Abs(y - j) > frange And (Not MapDataForUnit(i, j) Is t Or Not t.IsFeatureAvailable("髦ｻ豁｢")) Then
								If .FeatureLevel(k) > flevel Then
									u = MapDataForUnit(i, j)
									flevel = .FeatureLevel(k)
									fid = k
								End If
							End If
						End If
					Next 
				End With
NextPoint: 
			Next 
		Next 
		If Not u Is Nothing Then
			'Invalid_string_refer_to_original_code
			If fid = 0 Then
				fname = u.FeatureName("Invalid_string_refer_to_original_code")
				fdata = u.FeatureData("Invalid_string_refer_to_original_code")
				flevel = u.FeatureLevel("Invalid_string_refer_to_original_code")
			Else
				fname = u.FeatureName(fid)
				fdata = u.FeatureData(fid)
				flevel = u.FeatureLevel(fid)
			End If
			If flevel = 1 Then
				flevel = 10000
			End If
			
			'Invalid_string_refer_to_original_code
			buf = LIndex(fdata, 4)
			If IsNumeric(buf) Then
				prob = CShort(buf)
			ElseIf InStr(buf, "+") > 0 Or InStr(buf, "-") > 0 Then 
				i = MaxLng(InStr(buf, "+"), InStr(buf, "-"))
				prob = 100 * (u.SkillLevel(Left(buf, i - 1)) + CShort(Mid(buf, i))) / 16
			Else
				prob = u.SkillLevel(buf) * 100 / 16
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = 100
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = 0
		'End If
		
		'Invalid_string_refer_to_original_code
		If dmg > 500 * flevel Then
			prob = 0
		End If
		
		'Invalid_string_refer_to_original_code
		If IsNumeric(LIndex(fdata, 5)) Then
			ecost = CShort(LIndex(fdata, 5))
		Else
			ecost = 0
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			u.EN = u.EN - ecost
			If Not be_quiet Then
				If u.IsMessageDefined("髦ｻ豁｢(" & fname & ")") Then
					u.PilotMessage("髦ｻ豁｢(" & fname & ")")
				Else
					u.PilotMessage("髦ｻ豁｢")
				End If
			End If
			If u.IsAnimationDefined("髦ｻ豁｢", fname) Then
				u.PlayAnimation("髦ｻ豁｢", fname)
			Else
				u.SpecialEffect("髦ｻ豁｢", fname)
			End If
			
			If u.IsSysMessageDefined("髦ｻ豁｢", fname) Then
				u.SysMessage("髦ｻ豁｢", fname)
			Else
				DisplaySysMessage(u.Nickname & "縺ｯ[" & fname & "]縺ｧ[" & wname & "Invalid_string_refer_to_original_code")
			End If
			
			CheckDodgeFeature = True
			Exit Function
		End If
		'End If
		
SkipBlock: 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		fname = t.FeatureName("Invalid_string_refer_to_original_code")
		
		'Invalid_string_refer_to_original_code
		If t.IsAnimationDefined("Invalid_string_refer_to_original_code", fname) Then
			t.PlayAnimation("Invalid_string_refer_to_original_code", fname)
		ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code", fname) Then 
			t.SpecialEffect("Invalid_string_refer_to_original_code", fname)
		ElseIf BattleAnimation Then 
			If fname = "Invalid_string_refer_to_original_code" Then
				ShowAnimation("Invalid_string_refer_to_original_code")
			Else
				ShowAnimation("Invalid_string_refer_to_original_code" & fname)
			End If
		End If
		
		'蝗樣∩髻ｳ
		DodgeEffect(Me, w)
		
		'Invalid_string_refer_to_original_code
		If Not be_quiet Then
			If t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
				t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
			Else
				t.PilotMessage("Invalid_string_refer_to_original_code")
			End If
		End If
		
		If t.IsSysMessageDefined("Invalid_string_refer_to_original_code", fname) Then
			t.SysMessage("Invalid_string_refer_to_original_code", fname)
		Else
			If fname <> "Invalid_string_refer_to_original_code" Then
				DisplaySysMessage(t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
			Else
				DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
			End If
		End If
		
		CheckDodgeFeature = True
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			fname = t.FeatureName("Invalid_string_refer_to_original_code")
			fdata = t.FeatureData("Invalid_string_refer_to_original_code")
			flevel = t.FeatureLevel("Invalid_string_refer_to_original_code")
			
			'逋ｺ蜍慕紫
			prob = flevel
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = 10
		End If
		
		'Invalid_string_refer_to_original_code
		If IsNumeric(LIndex(fdata, 2)) Then
			ecost = CShort(LIndex(fdata, 2))
		Else
			ecost = 0
		End If
		If IsNumeric(LIndex(fdata, 3)) Then
			nmorale = CShort(LIndex(fdata, 3))
		Else
			nmorale = 0
		End If
		If LIndex(fdata, 4) = "謇句虚" Then
			If def_mode <> "蝗樣∩" Then
				prob = 0
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If t.EN >= ecost And t.MainPilot.Morale >= nmorale And prob >= Dice(10) Then
			'Invalid_string_refer_to_original_code
			If ecost <> 0 Then
				t.EN = t.EN - ecost
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				UpdateMessageForm(Me, t)
			Else
				UpdateMessageForm(Me, Nothing)
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If t.IsAnimationDefined("Invalid_string_refer_to_original_code", fname) Then
			t.PlayAnimation("Invalid_string_refer_to_original_code", fname)
		ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code", fname) Then 
			t.SpecialEffect("Invalid_string_refer_to_original_code", fname)
		ElseIf BattleAnimation Then 
			ShowAnimation("Invalid_string_refer_to_original_code")
		Else
			'蝗樣∩髻ｳ
			DodgeEffect(Me, w)
		End If
		
		'Invalid_string_refer_to_original_code
		If Not be_quiet Then
			If t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
				t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
			Else
				t.PilotMessage("Invalid_string_refer_to_original_code")
			End If
		End If
		
		If t.IsSysMessageDefined("Invalid_string_refer_to_original_code", fname) Then
			t.SysMessage("Invalid_string_refer_to_original_code", fname)
		Else
			DisplaySysMessage(t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
		End If
		
		CheckDodgeFeature = True
		Exit Function
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		'逋ｺ蜍慕紫
		prob = flevel
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = 10
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsNumeric(LIndex(fdata, 3)) Then
			ecost = CShort(LIndex(fdata, 3))
		Else
			ecost = 0
		End If
		If IsNumeric(LIndex(fdata, 4)) Then
			nmorale = CShort(LIndex(fdata, 4))
		Else
			nmorale = 0
		End If
		If LIndex(fdata, 5) = "謇句虚" Then
			If def_mode <> "蝗樣∩" Then
				prob = 0
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		Dim new_x, new_y As Short
		If t.EN >= ecost And t.MainPilot.Morale >= nmorale And prob >= Dice(10) Then
			
			'Invalid_string_refer_to_original_code
			AreaInTeleport(t, StrToLng(LIndex(fdata, 2)))
			SafetyPoint(t, new_x, new_y)
			
			If (t.x <> new_x Or t.y <> new_y) And new_x <> 0 And new_y <> 0 Then
				'Invalid_string_refer_to_original_code
				If ecost <> 0 Then
					t.EN = t.EN - ecost
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					UpdateMessageForm(Me, t)
				Else
					UpdateMessageForm(Me, Nothing)
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.PlayAnimation("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.SpecialEffect("Invalid_string_refer_to_original_code")
		ElseIf BattleAnimation Then 
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			ShowAnimation("Invalid_string_refer_to_original_code")
		Else
			ShowAnimation("Invalid_string_refer_to_original_code" & fname)
		End If
		'End If
		
		'蝗樣∩髻ｳ
		DodgeEffect(Me, w)
		
		'Invalid_string_refer_to_original_code
		t.Jump(new_x, new_y)
		
		'Invalid_string_refer_to_original_code
		If Not be_quiet Then
			If t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
				t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
			Else
				t.PilotMessage("Invalid_string_refer_to_original_code")
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.SysMessage("Invalid_string_refer_to_original_code")
		DisplaySysMessage(t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
		'End If
		
		CheckDodgeFeature = True
		Exit Function
		'End If
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.MainPilot.IsSkillAvailable("Invalid_string_refer_to_original_code") Then
			prob = 2 * t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") - MainPilot.SkillLevel("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = 32
		End If
		
		If prob >= Dice(32) Then
			fname = t.MainPilot.SkillName0("Invalid_string_refer_to_original_code")
			
			'Invalid_string_refer_to_original_code
			If t.IsAnimationDefined("Invalid_string_refer_to_original_code", fname) Then
				t.PlayAnimation("Invalid_string_refer_to_original_code", fname)
			ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code", fname) Then 
				t.SpecialEffect("Invalid_string_refer_to_original_code", fname)
			ElseIf BattleAnimation Then 
				ShowAnimation("Invalid_string_refer_to_original_code")
			Else
				'蝗樣∩髻ｳ
				DodgeEffect(Me, w)
			End If
			
			'Invalid_string_refer_to_original_code
			If Not be_quiet Then
				If t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
					t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
				Else
					t.PilotMessage("Invalid_string_refer_to_original_code")
				End If
			End If
			
			If t.IsSysMessageDefined("Invalid_string_refer_to_original_code", fname) Then
				t.SysMessage("Invalid_string_refer_to_original_code", fname)
			Else
				DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
			End If
			
			CheckDodgeFeature = True
			Exit Function
		End If
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Function CheckParryFeature(ByVal w As Short, ByRef t As Unit, ByRef tx As Short, ByRef ty As Short, ByRef attack_mode As String, ByRef def_mode As String, ByRef dmg As Integer, ByRef msg As String, ByRef be_quiet As Boolean) As Boolean
		Dim wname, wname2 As String
		Dim w2 As Short
		Dim ecost, nmorale As Short
		Dim fname, fdata As String
		Dim flevel As Double
		Dim slevel, lv_mod As Double
		Dim opt As String
		Dim j, i, idx As Short
		Dim prob As Integer
		Dim buf As String
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		wname = WeaponNickname(w)
		
		'Invalid_string_refer_to_original_code
		slevel = t.SkillLevel("霑取茶")
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		wname2 = ""
		If t.IsFeatureAvailable("譬ｼ髣俶ｭｦ蝎ｨ") Then
			wname2 = t.FeatureData("譬ｼ髣俶ｭｦ蝎ｨ")
		Else
			For i = 1 To t.CountWeapon
				If t.IsWeaponClassifiedAs(i, "豁ｦ") And t.IsWeaponAvailable(i, "遘ｻ蜍募燕") Then
					wname2 = t.WeaponNickname(i)
					Exit For
				End If
			Next 
		End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Or (slevel > 0 And Len(wname2) = 0)) _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'霑取茶豁ｦ蝎ｨ繧呈､懃ｴ｢
		i = 0
		If t.IsFeatureAvailable("霑取茶豁ｦ蝎ｨ") Then
			For i = 1 To t.CountWeapon
				If t.Weapon(i).Name = t.FeatureData("霑取茶豁ｦ蝎ｨ") Then
					If Not t.IsWeaponAvailable(i, "遘ｻ蜍募燕") Then
						i = 0
					End If
					Exit For
				End If
			Next 
		End If
		If i = 0 Then
			'Invalid_string_refer_to_original_code
			For i = 1 To t.CountWeapon
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'And (t.Weapon(i).Bullet >= 10 _
				'Or (t.Weapon(i).Bullet = 0 And t.Weapon(i).ENConsumption <= 5)) _
				'And t.MainPilot.Morale >= t.Weapon(i).NecessaryMorale _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Exit For
			Next 
		End If
		'Next
		'End If
		
		'Invalid_string_refer_to_original_code
		If 0 < i And i <= t.CountWeapon Then
			If Not t.IsWeaponAvailable(i, "Invalid_string_refer_to_original_code") Then
				i = 0
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		If Not be_quiet Then
			If t.IsMessageDefined("霑取茶(" & t.Weapon(i).Name & ")") Then
				t.PilotMessage("霑取茶(" & t.Weapon(i).Name & ")")
			Else
				t.PilotMessage("霑取茶")
			End If
		Else
			IsWavePlayed = False
		End If
		
		'蜉ｹ譫憺浹
		If Not IsWavePlayed Then
			If IsAnimationDefined(wname & "(霑取茶)") Then
				PlayAnimation(wname & "(霑取茶)")
			ElseIf IsSpecialEffectDefined(wname & "(霑取茶)") Then 
				SpecialEffect(wname & "(霑取茶)")
			ElseIf t.IsAnimationDefined("霑取茶", fname) Then 
				t.PlayAnimation("霑取茶", fname)
			ElseIf t.IsSpecialEffectDefined("霑取茶", fname) Then 
				t.SpecialEffect("霑取茶", fname)
			ElseIf t.IsSpecialEffectDefined((t.Weapon(i).Name)) Then 
				t.SpecialEffect((t.Weapon(i).Name))
			Else
				AttackEffect(t, i)
			End If
		End If
		
		DisplaySysMessage(t.Nickname & "縺ｯ[" & t.WeaponNickname(i) & "]縺ｧ[" & wname & "Invalid_string_refer_to_original_code")
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "豌ｸ") And Weapon(w).Bullet > 0 Then
			SetBullet(w, Bullet(w) - 1)
			SyncBullet()
			IsMapAttackCanceled = True
		End If
		
		'霑取茶豁ｦ蝎ｨ縺ｮ蠑ｾ謨ｰ繧呈ｶ郁ｲｻ
		t.UseWeapon(i)
		
		CheckParryFeature = True
		Exit Function
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		GoTo SkipBlock
		'End If
		
		'髦ｻ豁｢
		For i = 1 To t.CountFeature
			If t.Feature(i) = "髦ｻ豁｢" Then
				fname = t.FeatureName0(i)
				fdata = t.FeatureData(i)
				flevel = t.FeatureLevel(i)
				If flevel = 1 Then
					flevel = 10000
				End If
				
				'Invalid_string_refer_to_original_code
				buf = LIndex(fdata, 3)
				If IsNumeric(buf) Then
					prob = CShort(buf)
				ElseIf InStr(buf, "+") > 0 Or InStr(buf, "-") > 0 Then 
					j = MaxLng(InStr(buf, "+"), InStr(buf, "-"))
					prob = 100 * (t.SkillLevel(Left(buf, j - 1)) + CShort(Mid(buf, j))) / 16
				Else
					prob = 100 * t.SkillLevel(buf) / 16
				End If
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				prob = 100
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = 0
			'End If
			
			'Invalid_string_refer_to_original_code
			If Not t.IsAttributeClassified(LIndex(fdata, 2), WeaponClass(w)) Then
				prob = 0
			End If
			
			'菴ｿ逕ｨ譚｡莉ｶ
			If IsNumeric(LIndex(fdata, 4)) Then
				ecost = CShort(LIndex(fdata, 4))
			Else
				ecost = 0
			End If
			If IsNumeric(LIndex(fdata, 5)) Then
				nmorale = CShort(LIndex(fdata, 5))
			Else
				nmorale = 0
			End If
			If t.EN < ecost Or t.MainPilot.Morale < nmorale Then
				prob = 0
			End If
			
			'繧ｪ繝励す繝ｧ繝ｳ
			slevel = 0
			For j = 6 To LLength(fdata)
				If prob = 0 Then
					Exit For
				End If
				
				opt = LIndex(fdata, j)
				idx = InStr(opt, "*")
				If idx > 0 Then
					lv_mod = StrToDbl(Mid(opt, idx + 1))
					opt = Left(opt, idx - 1)
				Else
					lv_mod = -1
				End If
				
				Select Case t.MainPilot.SkillType(opt)
					Case "逶ｸ谿ｺ"
						If LIndex(fdata, 1) = LIndex(FeatureData("髦ｻ豁｢"), 1) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
							msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
							prob = 0
						End If
					Case "Invalid_string_refer_to_original_code"
						If LIndex(fdata, 1) = LIndex(FeatureData("髦ｻ豁｢"), 1) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
							flevel = flevel - FeatureLevel("髦ｻ豁｢")
							If flevel <= 0 Then
								msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
								prob = 0
							End If
						End If
					Case "霑第磁辟｡蜉ｹ"
						'Invalid_string_refer_to_original_code_
						'Or IsWeaponClassifiedAs(w, "謗･") _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						prob = 0
						'End If
					Case "謇句虚"
						If def_mode <> "髦ｲ蠕｡" Then
							prob = 0
						End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 20
						End If
						slevel = lv_mod * (t.SyncLevel - 30)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = -30 * lv_mod Then
							prob = 0
						End If
						If slevel = -30 * lv_mod Then
							slevel = 0
						End If
						'End If
					Case "髴雁鴨"
						If lv_mod = -1 Then
							lv_mod = 10
						End If
						slevel = lv_mod * t.PlanaLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case "繧ｪ繝ｼ繝ｩ"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.AuraLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.PsychicLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case Else
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.SkillLevel(opt)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
				End Select
			Next 
			
			'Invalid_string_refer_to_original_code
			If dmg > 500 * flevel + slevel Then
				prob = 0
			End If
			
			'Invalid_string_refer_to_original_code
			If prob >= Dice(100) Then
				If ecost <> 0 Then
					t.EN = t.EN - ecost
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					UpdateMessageForm(Me, t)
				Else
					UpdateMessageForm(Me, Nothing)
				End If
			End If
			If Not be_quiet Then
				If t.IsMessageDefined("髦ｻ豁｢(" & fname & ")") Then
					t.PilotMessage("髦ｻ豁｢(" & fname & ")")
				Else
					t.PilotMessage("髦ｻ豁｢")
				End If
			End If
			If IsAnimationDefined(wname & "(髦ｻ豁｢)") Then
				PlayAnimation(wname & "(髦ｻ豁｢)")
			ElseIf IsSpecialEffectDefined(wname & "(髦ｻ豁｢)") Then 
				SpecialEffect(wname & "(髦ｻ豁｢)")
			ElseIf t.IsAnimationDefined("髦ｻ豁｢", fname) Then 
				t.PlayAnimation("髦ｻ豁｢", fname)
			Else
				t.SpecialEffect("髦ｻ豁｢", fname)
			End If
			
			If t.IsSysMessageDefined("髦ｻ豁｢", fname) Then
				t.SysMessage("髦ｻ豁｢", fname)
			Else
				DisplaySysMessage(t.Nickname & "縺ｯ[" & fname & "]縺ｧ[" & wname & "Invalid_string_refer_to_original_code")
			End If
			
			CheckParryFeature = True
			Exit Function
			'End If
			'End If
		Next 
		
SkipBlock: 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		GoTo SkipParryAttack
		'End If
		
		'蠖薙※霄ｫ謚
		For i = 1 To t.CountFeature
			'Invalid_string_refer_to_original_code
			If t.Feature(i) = "蠖薙※霄ｫ謚" Then
				fname = t.FeatureName0(i)
				If fname = "" Then
					fname = "蠖薙※霄ｫ謚"
				End If
				fdata = t.FeatureData(i)
				flevel = t.FeatureLevel(i)
				If flevel = 1 Then
					flevel = 10000
				End If
				
				'Invalid_string_refer_to_original_code
				buf = LIndex(fdata, 4)
				If IsNumeric(buf) Then
					prob = CShort(buf)
				ElseIf InStr(buf, "+") > 0 Or InStr(buf, "-") > 0 Then 
					j = MaxLng(InStr(buf, "+"), InStr(buf, "-"))
					prob = 100 * (t.SkillLevel(Left(buf, j - 1)) + CShort(Mid(buf, j))) / 16
				Else
					prob = 100 * t.SkillLevel(buf) / 16
				End If
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				prob = 100
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit For
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Or attack_mode = "蠖薙※霄ｫ謚" _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit For
			'End If
			
			'Invalid_string_refer_to_original_code
			If Not t.IsAttributeClassified(LIndex(fdata, 3), WeaponClass(w)) Then
				prob = 0
			End If
			
			'菴ｿ逕ｨ譚｡莉ｶ
			If IsNumeric(LIndex(fdata, 5)) Then
				ecost = CShort(LIndex(fdata, 5))
			Else
				ecost = 0
			End If
			If IsNumeric(LIndex(fdata, 6)) Then
				nmorale = CShort(LIndex(fdata, 6))
			Else
				nmorale = 0
			End If
			If t.EN < ecost Or t.MainPilot.Morale < nmorale Then
				prob = 0
			End If
			
			'繧ｪ繝励す繝ｧ繝ｳ
			slevel = 0
			For j = 7 To LLength(fdata)
				If prob = 0 Then
					Exit For
				End If
				
				opt = LIndex(fdata, j)
				idx = InStr(opt, "*")
				If idx > 0 Then
					lv_mod = StrToDbl(Mid(opt, idx + 1))
					opt = Left(opt, idx - 1)
				Else
					lv_mod = -1
				End If
				
				Select Case t.MainPilot.SkillType(opt)
					Case "逶ｸ谿ｺ"
						If IsSameCategory(fdata, FeatureData("蠖薙※霄ｫ謚")) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
							prob = 0
						End If
					Case "Invalid_string_refer_to_original_code"
						If IsSameCategory(fdata, FeatureData("蠖薙※霄ｫ謚")) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
							flevel = flevel - FeatureLevel("蠖薙※霄ｫ謚")
							If flevel <= 0 Then
								prob = 0
							End If
						End If
					Case "霑第磁辟｡蜉ｹ"
						'Invalid_string_refer_to_original_code_
						'Or IsWeaponClassifiedAs(w, "謗･") _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						prob = 0
						'End If
					Case "謇句虚"
						If def_mode <> "髦ｲ蠕｡" Then
							prob = 0
						End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 20
						End If
						slevel = lv_mod * (t.SyncLevel - 30)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = -30 * lv_mod Then
							prob = 0
						End If
						If slevel = -30 * lv_mod Then
							slevel = 0
						End If
						'End If
					Case "髴雁鴨"
						If lv_mod = -1 Then
							lv_mod = 10
						End If
						slevel = lv_mod * t.PlanaLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case "繧ｪ繝ｼ繝ｩ"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.AuraLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.PsychicLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case Else
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.SkillLevel(opt)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
				End Select
			Next 
			
			'Invalid_string_refer_to_original_code
			If dmg > 500 * flevel + slevel Then
				prob = 0
			End If
			
			'菴ｿ逕ｨ縺吶ｋ蠖薙※霄ｫ謚繧呈､懃ｴ｢
			wname2 = LIndex(fdata, 2)
			w2 = 0
			For j = 1 To t.CountWeapon
				If t.Weapon(j).Name = wname2 Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					w2 = j
				End If
				Exit For
				'End If
			Next 
			
			'Invalid_string_refer_to_original_code
			If prob >= Dice(100) And w2 > 0 Then
				If ecost <> 0 Then
					t.EN = t.EN - ecost
					UpdateMessageForm(Me, t)
				End If
				
				'Invalid_string_refer_to_original_code
				If Not be_quiet Then
					If t.IsMessageDefined("蠖薙※霄ｫ謚(" & fname & ")") Then
						t.PilotMessage("蠖薙※霄ｫ謚(" & fname & ")")
					Else
						t.PilotMessage("蠖薙※霄ｫ謚")
					End If
				Else
					IsWavePlayed = False
				End If
				
				'蜉ｹ譫憺浹
				If Not IsWavePlayed Then
					If IsAnimationDefined(wname & "(蠖薙※霄ｫ謚)") Then
						PlayAnimation(wname & "(蠖薙※霄ｫ謚)")
					ElseIf IsSpecialEffectDefined(wname & "(蠖薙※霄ｫ謚)") Then 
						SpecialEffect(wname & "(蠖薙※霄ｫ謚)")
					ElseIf t.IsAnimationDefined("蠖薙※霄ｫ謚", fname) Then 
						t.PlayAnimation("蠖薙※霄ｫ謚", fname)
					ElseIf t.IsSpecialEffectDefined("蠖薙※霄ｫ謚", fname) Then 
						t.SpecialEffect("蠖薙※霄ｫ謚", fname)
					ElseIf BattleAnimation Then 
						ShowAnimation("謇鍋ｪ∝多荳ｭ")
						'Invalid_string_refer_to_original_code_
						'Or IsWeaponClassifiedAs(w, "謗･") _
						'Invalid_string_refer_to_original_code_
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						PlayWave("Sword.wav")
					Else
						PlayWave("BeamCoat.wav")
					End If
				End If
				
				If t.IsSysMessageDefined("蠖薙※霄ｫ謚", fname) Then
					t.SysMessage("蠖薙※霄ｫ謚", fname)
				Else
					DisplaySysMessage(t.Nickname & "縺ｯ[" & fname & "]縺ｧ[" & wname & "Invalid_string_refer_to_original_code")
				End If
				
				'Invalid_string_refer_to_original_code
				t.Attack(w2, Me, "蠖薙※霄ｫ謚", "")
				t = t.CurrentForm
				
				CheckParryFeature = True
				Exit Function
			End If
			'End If
		Next 
		
SkipParryAttack: 
		
		'Invalid_string_refer_to_original_code
		wname2 = ""
		If t.IsFeatureAvailable("譬ｼ髣俶ｭｦ蝎ｨ") Then
			wname2 = t.FeatureData("譬ｼ髣俶ｭｦ蝎ｨ")
		Else
			For i = 1 To t.CountWeapon
				'Invalid_string_refer_to_original_code_
				'And t.IsWeaponMastered(i) _
				'And t.MainPilot.Morale >= t.Weapon(i).NecessaryMorale _
				'And Not t.IsDisabled(t.Weapon(i).Name) _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				wname2 = t.WeaponNickname(i)
				Exit For
			Next 
		End If
		'Next
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") > 0 And Len(wname2) > 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = 0
			
			'Invalid_string_refer_to_original_code
			If IsWeaponClassifiedAs(w, "繧ｵ") Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If prob > 0 Then
					prob = 0
				End If
			Else
				prob = 0
			End If
			
			prob = prob + 2 * t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code")
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = 32
		End If
		
		If prob >= Dice(32) Then
			'Invalid_string_refer_to_original_code
			If Not be_quiet Then
				If t.IsMessageDefined("Invalid_string_refer_to_original_code" & wname2 & ")") Then
					t.PilotMessage("Invalid_string_refer_to_original_code" & wname2 & ")")
				Else
					t.PilotMessage("Invalid_string_refer_to_original_code")
				End If
			Else
				IsWavePlayed = False
			End If
			
			'蜉ｹ譫憺浹
			If Not IsWavePlayed Then
				If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Then
					PlayAnimation(wname & "Invalid_string_refer_to_original_code")
				ElseIf IsSpecialEffectDefined(wname & "Invalid_string_refer_to_original_code") Then 
					SpecialEffect(wname & "Invalid_string_refer_to_original_code")
				ElseIf t.IsAnimationDefined("Invalid_string_refer_to_original_code", wname2) Then 
					t.PlayAnimation("Invalid_string_refer_to_original_code", wname2)
				ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code", wname2) Then 
					t.SpecialEffect("Invalid_string_refer_to_original_code", wname2)
				Else
					ParryEffect(Me, w, t)
				End If
			End If
			
			DisplaySysMessage(t.Nickname & "縺ｯ[" & wname2 & "]縺ｧ[" & wname & "Invalid_string_refer_to_original_code")
			
			'Invalid_string_refer_to_original_code
			If IsWeaponClassifiedAs(w, "豌ｸ") And Weapon(w).Bullet > 0 Then
				SetBullet(w, Bullet(w) - 1)
				SyncBullet()
				IsMapAttackCanceled = True
			End If
			
			CheckParryFeature = True
			Exit Function
		End If
		IsWeaponClassifiedAs(w, "謗･")
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		prob = 2 * t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") - MainPilot.SkillLevel("Invalid_string_refer_to_original_code")
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = 32
		'End If
		
		If prob >= Dice(32) Then
			'Invalid_string_refer_to_original_code
			If Not be_quiet Then
				If t.IsMessageDefined("Invalid_string_refer_to_original_code" & wname2 & ")") Then
					t.PilotMessage("Invalid_string_refer_to_original_code" & wname2 & ")")
				Else
					t.PilotMessage("Invalid_string_refer_to_original_code")
				End If
			Else
				IsWavePlayed = False
			End If
			
			'蜉ｹ譫憺浹
			If Not IsWavePlayed Then
				If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Then
					PlayAnimation(wname & "Invalid_string_refer_to_original_code")
				ElseIf IsSpecialEffectDefined(wname & "Invalid_string_refer_to_original_code") Then 
					SpecialEffect(wname & "Invalid_string_refer_to_original_code")
				ElseIf t.IsAnimationDefined("Invalid_string_refer_to_original_code", wname2) Then 
					t.PlayAnimation("Invalid_string_refer_to_original_code", wname2)
				ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code", wname2) Then 
					t.SpecialEffect("Invalid_string_refer_to_original_code", wname2)
				Else
					DodgeEffect(Me, w)
					Sleep(190)
					PlayWave("Sword.wav")
				End If
			End If
			
			DisplaySysMessage(t.Nickname & "縺ｯ[" & wname2 & "]縺ｧ[" & wname & "Invalid_string_refer_to_original_code")
			
			'Invalid_string_refer_to_original_code
			If IsWeaponClassifiedAs(w, "豌ｸ") And Weapon(w).Bullet > 0 Then
				SetBullet(w, Bullet(w) - 1)
				SyncBullet()
				IsMapAttackCanceled = True
			End If
			
			CheckParryFeature = True
			Exit Function
		End If
		IsWeaponClassifiedAs(w, "豁ｦ")
		'Invalid_string_refer_to_original_code
		prob = 2 * t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") - MainPilot.SkillLevel("Invalid_string_refer_to_original_code")
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = 32
		'End If
		
		If prob >= Dice(32) Then
			'Invalid_string_refer_to_original_code
			If Not be_quiet Then
				If t.IsMessageDefined("Invalid_string_refer_to_original_code" & wname2 & ")") Then
					t.PilotMessage("Invalid_string_refer_to_original_code" & wname2 & ")")
				Else
					t.PilotMessage("Invalid_string_refer_to_original_code")
				End If
			Else
				IsWavePlayed = False
			End If
			
			'蜉ｹ譫憺浹
			If Not IsWavePlayed Then
				If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Then
					PlayAnimation(wname & "Invalid_string_refer_to_original_code")
				ElseIf IsSpecialEffectDefined(wname & "Invalid_string_refer_to_original_code") Then 
					SpecialEffect(wname & "Invalid_string_refer_to_original_code")
				ElseIf t.IsAnimationDefined("Invalid_string_refer_to_original_code", wname2) Then 
					t.PlayAnimation("Invalid_string_refer_to_original_code", wname2)
				ElseIf t.IsSpecialEffectDefined("Invalid_string_refer_to_original_code", wname2) Then 
					t.SpecialEffect("Invalid_string_refer_to_original_code", wname2)
				Else
					DodgeEffect(Me, w)
					Sleep(190)
					PlayWave("Sword.wav")
				End If
			End If
			
			DisplaySysMessage(t.Nickname & "縺ｯ[" & wname2 & "]縺ｧ[" & wname & "Invalid_string_refer_to_original_code")
			
			'Invalid_string_refer_to_original_code
			If IsWeaponClassifiedAs(w, "豌ｸ") And Weapon(w).Bullet > 0 Then
				SetBullet(w, Bullet(w) - 1)
				SyncBullet()
				IsMapAttackCanceled = True
			End If
			
			CheckParryFeature = True
			Exit Function
		End If
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To t.CountFeature
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			fname = t.FeatureName0(i)
			If fname = "" Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				fname = "Invalid_string_refer_to_original_code"
			End If
			'End If
			fdata = t.FeatureData(i)
			flevel = t.FeatureLevel(i)
			If flevel = 1 Then
				flevel = 10000
			End If
			
			'Invalid_string_refer_to_original_code
			buf = LIndex(fdata, 3)
			If IsNumeric(buf) Then
				prob = CShort(buf)
			ElseIf InStr(buf, "+") > 0 Or InStr(buf, "-") > 0 Then 
				j = MaxLng(InStr(buf, "+"), InStr(buf, "-"))
				prob = 100 * (t.SkillLevel(Left(buf, j - 1)) + CShort(Mid(buf, j))) / 16
			Else
				prob = 100 * t.SkillLevel(buf) / 16
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = prob \ 2
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = 100
			'End If
			
			'Invalid_string_refer_to_original_code
			If attack_mode = "蠖薙※霄ｫ謚" Then
				Exit For
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit For
			'End If
			
			'Invalid_string_refer_to_original_code
			If Not t.IsAttributeClassified(LIndex(fdata, 2), WeaponClass(w)) Then
				prob = 0
			End If
			
			'菴ｿ逕ｨ譚｡莉ｶ
			If IsNumeric(LIndex(fdata, 4)) Then
				ecost = CShort(LIndex(fdata, 4))
			Else
				ecost = 0
			End If
			If IsNumeric(LIndex(fdata, 5)) Then
				nmorale = CShort(LIndex(fdata, 5))
			Else
				nmorale = 0
			End If
			If t.EN < ecost Or t.MainPilot.Morale < nmorale Then
				prob = 0
			End If
			
			'繧ｪ繝励す繝ｧ繝ｳ
			slevel = 0
			For j = 6 To LLength(fdata)
				If prob = 0 Then
					Exit For
				End If
				
				opt = LIndex(fdata, j)
				idx = InStr(opt, "*")
				If idx > 0 Then
					lv_mod = StrToDbl(Mid(opt, idx + 1))
					opt = Left(opt, idx - 1)
				Else
					lv_mod = -1
				End If
				
				Select Case t.MainPilot.SkillType(opt)
					Case "逶ｸ谿ｺ"
						If LIndex(fdata, 1) = LIndex(FeatureData("髦ｻ豁｢"), 1) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
							msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
							prob = 0
						End If
					Case "Invalid_string_refer_to_original_code"
						If LIndex(fdata, 1) = LIndex(FeatureData("髦ｻ豁｢"), 1) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
							flevel = flevel - FeatureLevel("髦ｻ豁｢")
							If flevel <= 0 Then
								msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
								prob = 0
							End If
						End If
					Case "霑第磁辟｡蜉ｹ"
						'Invalid_string_refer_to_original_code_
						'Or IsWeaponClassifiedAs(w, "謗･") _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						prob = 0
						'End If
					Case "謇句虚"
						If def_mode <> "髦ｲ蠕｡" Then
							prob = 0
						End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 20
						End If
						slevel = lv_mod * (t.SyncLevel - 30)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = -30 * lv_mod Then
							prob = 0
						End If
						If slevel = -30 * lv_mod Then
							slevel = 0
						End If
						'End If
					Case "髴雁鴨"
						If lv_mod = -1 Then
							lv_mod = 10
						End If
						slevel = lv_mod * t.PlanaLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case "繧ｪ繝ｼ繝ｩ"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.AuraLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.PsychicLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case Else
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.SkillLevel(opt)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
				End Select
			Next 
			
			'Invalid_string_refer_to_original_code
			If dmg > 500 * flevel + slevel Then
				prob = 0
			End If
			
			'Invalid_string_refer_to_original_code
			If prob >= Dice(100) Then
				If ecost <> 0 Then
					t.EN = t.EN - ecost
					UpdateMessageForm(Me, t)
				End If
				
				'Invalid_string_refer_to_original_code
				If Not be_quiet Then
					If t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
						t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
					Else
						t.PilotMessage("Invalid_string_refer_to_original_code")
					End If
				Else
					IsWavePlayed = False
				End If
				
				'蜉ｹ譫憺浹
				If Not IsWavePlayed Then
					If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Then
						PlayAnimation(wname & "Invalid_string_refer_to_original_code")
					ElseIf IsSpecialEffectDefined(wname & "Invalid_string_refer_to_original_code") Then 
						SpecialEffect(wname & "Invalid_string_refer_to_original_code")
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						t.PlayAnimation("Invalid_string_refer_to_original_code")
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						t.SpecialEffect("Invalid_string_refer_to_original_code")
					ElseIf BattleAnimation Then 
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						ShowAnimation("Invalid_string_refer_to_original_code")
					Else
						ShowAnimation("Invalid_string_refer_to_original_code" & fname)
					End If
					'Invalid_string_refer_to_original_code_
					'Or IsWeaponClassifiedAs(w, "謗･") _
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					PlayWave("Sword.wav")
				Else
					PlayWave("BeamCoat.wav")
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.SysMessage("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			DisplaySysMessage(t.Nickname & "縺ｯ[" & fname & "]縺ｧ[" & wname & "Invalid_string_refer_to_original_code")
			DisplaySysMessage(t.Nickname & "縺ｯ[" & wname & "Invalid_string_refer_to_original_code")
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Attack(w, Me, "Invalid_string_refer_to_original_code")
			'End If
			
			CheckParryFeature = True
			Exit Function
			'End If
			'End If
		Next 
	End Function
	
	'Invalid_string_refer_to_original_code
	Private Function CheckDummyFeature(ByVal w As Short, ByRef t As Unit, ByVal be_quiet As Boolean) As Boolean
		Dim wname As String
		Dim fname As String
		
		wname = WeaponNickname(w)
		
		If t.IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
			'Invalid_string_refer_to_original_code
			IsWavePlayed = False
			If Not be_quiet Then
				PilotMessage(wname & "(蜻ｽ荳ｭ)")
			End If
			If IsAnimationDefined(wname & "(蜻ｽ荳ｭ)") Or IsAnimationDefined(wname) Then
				PlayAnimation(wname & "(蜻ｽ荳ｭ)")
			ElseIf IsSpecialEffectDefined(wname & "(蜻ｽ荳ｭ)") Then 
				SpecialEffect(wname & "(蜻ｽ荳ｭ)")
			ElseIf Not IsWavePlayed Then 
				HitEffect(Me, w, t)
			End If
			
			fname = t.FeatureName("Invalid_string_refer_to_original_code")
			If Len(fname) > 0 Then
				If InStr(fname, "Lv") > 0 Then
					fname = Left(fname, InStr(fname, "Lv") - 1)
				End If
			Else
				fname = "Invalid_string_refer_to_original_code"
			End If
			
			If Not be_quiet Then
				If t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
					t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
				Else
					t.PilotMessage("Invalid_string_refer_to_original_code")
				End If
			End If
			If t.IsAnimationDefined("Invalid_string_refer_to_original_code", fname) Then
				t.PlayAnimation("Invalid_string_refer_to_original_code", fname)
			Else
				t.SpecialEffect("Invalid_string_refer_to_original_code", fname)
			End If
			
			If t.IsSysMessageDefined("Invalid_string_refer_to_original_code", fname) Then
				t.SysMessage("Invalid_string_refer_to_original_code", fname)
			Else
				DisplaySysMessage(t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
			End If
			
			t.SetConditionLevel("Invalid_string_refer_to_original_code", t.ConditionLevel("Invalid_string_refer_to_original_code") - 1)
			If t.ConditionLevel("Invalid_string_refer_to_original_code") = 0 Then
				t.DeleteCondition("Invalid_string_refer_to_original_code")
			End If
			
			CheckDummyFeature = True
		ElseIf t.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then 
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			IsWavePlayed = False
			If Not be_quiet Then
				PilotMessage(wname & "(蜻ｽ荳ｭ)")
			End If
			If IsAnimationDefined(wname & "(蜻ｽ荳ｭ)") Or IsAnimationDefined(wname) Then
				PlayAnimation(wname & "(蜻ｽ荳ｭ)")
			ElseIf IsSpecialEffectDefined(wname & "(蜻ｽ荳ｭ)") Then 
				SpecialEffect(wname & "(蜻ｽ荳ｭ)")
			ElseIf Not IsWavePlayed Then 
				HitEffect(Me, w, t)
			End If
			
			fname = t.FeatureName("Invalid_string_refer_to_original_code")
			If Len(fname) > 0 Then
				If InStr(fname, "Lv") > 0 Then
					fname = Left(fname, InStr(fname, "Lv") - 1)
				End If
			Else
				fname = "Invalid_string_refer_to_original_code"
			End If
			
			If Not be_quiet Then
				If t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
					t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
				Else
					t.PilotMessage("Invalid_string_refer_to_original_code")
				End If
			End If
			If t.IsAnimationDefined("Invalid_string_refer_to_original_code", fname) Then
				t.PlayAnimation("Invalid_string_refer_to_original_code", fname)
			Else
				t.SpecialEffect("Invalid_string_refer_to_original_code", fname)
			End If
			
			If IsSysMessageDefined("Invalid_string_refer_to_original_code", fname) Then
				SysMessage("Invalid_string_refer_to_original_code", fname)
			Else
				DisplaySysMessage(t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
			End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.SetConditionLevel("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			t.AddCondition("Invalid_string_refer_to_original_code")
		End If
		
		CheckDummyFeature = True
		'End If
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Private Function CheckShieldFeature(ByVal w As Short, ByRef t As Unit, ByVal dmg As Integer, ByVal be_quiet As Boolean, ByRef use_shield As Boolean, ByRef use_shield_msg As Boolean) As Boolean
		Dim prob As Short
		Dim fname As String
		
		'Invalid_string_refer_to_original_code
		If dmg <= 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") <= 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Or t.IsConditionSatisfied("逹｡逵") _
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "邊ｾ") Or IsWeaponClassifiedAs(w, "谿ｺ") Or IsWeaponClassifiedAs(w, "豬ｸ") Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'繧ｷ繝ｼ繝ｫ繝臥ｳｻ髦ｲ蠕｡閭ｽ蜉帙ｒ讀懃ｴ｢
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code")
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code")
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code_
		'And Not IsWeaponClassifiedAs(w, "辟｡") _
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code")
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") + 1
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") + 2
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		use_shield = True
		
		If IsWeaponClassifiedAs(w, "遐ｴ") Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			dmg = (5 * dmg) \ 6
		Else
			dmg = 3 * dmg \ 4
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		dmg = (2 * dmg) \ 3
		dmg = dmg \ 2
		'End If
		'End If
		
		If dmg > 0 And dmg < 10 Then
			dmg = 10
		End If
		
		If dmg < t.HP And Not be_quiet Then
			If t.IsMessageDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡(" & fname & ")") Then
				t.PilotMessage("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡(" & fname & ")")
				use_shield_msg = True
			ElseIf t.IsMessageDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡") Then 
				t.PilotMessage("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡")
				use_shield_msg = True
			End If
		End If
		
		If t.IsAnimationDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname) Then
			t.PlayAnimation("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
		ElseIf t.IsSpecialEffectDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname) Then 
			t.SpecialEffect("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
		Else
			ShieldEffect(t)
		End If
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Private Function CheckDefenseFeature(ByVal w As Short, ByRef t As Unit, ByRef tx As Short, ByRef ty As Short, ByRef attack_mode As String, ByRef def_mode As String, ByRef dmg As Integer, ByRef msg As String, ByRef be_quiet As Boolean, ByRef is_penetrated As Boolean) As Boolean
		Dim wname As String
		Dim ecost, nmorale As Short
		Dim fname, fdata As String
		Dim flevel As Double
		Dim fid, frange As Short
		Dim opt As String
		Dim lv_mod As Double
		Dim u As Unit
		Dim slevel As Double
		Dim k, i, j, idx As Short
		Dim neautralize As Boolean
		Dim team, uteam As String
		Dim dmg_mod As Double
		Dim defined As Boolean
		
		wname = WeaponNickname(w)
		team = MainPilot.SkillData("Invalid_string_refer_to_original_code")
		
		'Invalid_string_refer_to_original_code
		If dmg < 0 Then
			t.HP = t.HP - dmg
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			UpdateMessageForm(Me, t)
		Else
			UpdateMessageForm(Me, Nothing)
		End If
		
		NegateEffect(Me, t, w, wname, dmg, "Invalid_string_refer_to_original_code")
		
		CheckDefenseFeature = True
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If dmg = 0 And Weapon(w).Power > 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			DisplaySysMessage(msg & t.Nickname & "縺ｫ縺ｯ[" & wname & "Invalid_string_refer_to_original_code")
		Else
			NegateEffect(Me, t, w, wname, dmg, "", "", 0, msg, be_quiet)
		End If
		CheckDefenseFeature = True
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If Not IsNormalWeapon(w) Then
			'Invalid_string_refer_to_original_code
			If CriticalProbability(w, t, def_mode) = 0 And Weapon(w).Power = 0 Then
				'Invalid_string_refer_to_original_code
				NegateEffect(Me, t, w, wname, dmg, "", "", 0, msg, be_quiet)
				CheckDefenseFeature = True
				Exit Function
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		GoTo SkipBarrier
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		u = Nothing
		flevel = 0
		fid = 0
		'Invalid_string_refer_to_original_code
		For i = MaxLng(tx - 3, 1) To MinLng(tx + 3, MapWidth)
			For j = MaxLng(ty - 3, 1) To MinLng(ty + 3, MapHeight)
				If MapDataForUnit(i, j) Is Nothing Or System.Math.Abs(tx - i) + System.Math.Abs(ty - j) > 3 Then
					GoTo NextPoint
				End If
				
				With MapDataForUnit(i, j)
					'Invalid_string_refer_to_original_code
					If .IsEnemy(t) Then
						GoTo NextPoint
					End If
					
					'Invalid_string_refer_to_original_code
					If .MaxAction = 0 Then
						GoTo NextPoint
					End If
					
					'Invalid_string_refer_to_original_code
					If .Area = "蝨ｰ荳ｭ" Then
						GoTo NextPoint
					End If
					
					'Invalid_string_refer_to_original_code
					If Not .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						GoTo NextPoint
					End If
					
					'Invalid_string_refer_to_original_code
					uteam = .MainPilot.SkillData("Invalid_string_refer_to_original_code")
					If team <> uteam And uteam <> "" Then
						GoTo NextPoint
					End If
					
					For k = 1 To .CountFeature
						If .Feature(k) = "Invalid_string_refer_to_original_code" Then
							fdata = .FeatureData(k)
							
							'Invalid_string_refer_to_original_code
							If IsNumeric(LIndex(fdata, 2)) Then
								frange = CShort(LIndex(fdata, 2))
							Else
								frange = 1
							End If
							
							'菴ｿ逕ｨ譚｡莉ｶ
							If IsNumeric(LIndex(fdata, 4)) Then
								ecost = CShort(LIndex(fdata, 4))
							Else
								ecost = 20 * frange
							End If
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'縺吶〒縺ｫ逋ｺ蜍墓ｸ医∩
							ecost = 0
						End If
						If IsNumeric(LIndex(fdata, 5)) Then
							nmorale = CShort(LIndex(fdata, 5))
						Else
							nmorale = 0
						End If
						
						'Invalid_string_refer_to_original_code
						'Invalid_string_refer_to_original_code_
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If .FeatureLevel(k) > flevel Then
							u = MapDataForUnit(i, j)
							flevel = .FeatureLevel(k)
							fid = k
						End If
						'End If
						'End If
					Next 
				End With
NextPoint: 
			Next 
		Next 
		If Not u Is Nothing Then
			'Invalid_string_refer_to_original_code
			If fid = 0 Then
				fname = u.FeatureName0("Invalid_string_refer_to_original_code")
				fdata = u.FeatureData("Invalid_string_refer_to_original_code")
			Else
				fname = u.FeatureName0(fid)
				fdata = u.FeatureData(fid)
			End If
			If fname = "" Then
				If u.IsFeatureAvailable("繝舌Μ繧｢") Then
					fname = u.FeatureName0("繝舌Μ繧｢")
				Else
					fname = "Invalid_string_refer_to_original_code"
				End If
			End If
			
			If IsNumeric(LIndex(fdata, 4)) Then
				ecost = CShort(LIndex(fdata, 4))
			Else
				ecost = 20
			End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			u.EN = u.EN - ecost
			If u.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
				u.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
			Else
				u.PilotMessage("Invalid_string_refer_to_original_code")
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			u.PlayAnimation("Invalid_string_refer_to_original_code")
		Else
			u.SpecialEffect("Invalid_string_refer_to_original_code")
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		u.SysMessage("Invalid_string_refer_to_original_code")
		DisplaySysMessage(u.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
		'End If
		
		If fname = "Invalid_string_refer_to_original_code" Or fname = "繝舌Μ繧｢" Then
			u.AddCondition("Invalid_string_refer_to_original_code")
		Else
			u.AddCondition("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		End If
		'End If
		
		If 1000 * flevel >= dmg Then
			NegateEffect(Me, t, w, wname, dmg, fname, fdata, 10, msg, be_quiet)
			CheckDefenseFeature = True
			Exit Function
		ElseIf flevel > 0 Then 
			msg = msg & wname & "縺啓" & fname & "Invalid_string_refer_to_original_code"
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		u = Nothing
		flevel = 0
		fid = 0
		'Invalid_string_refer_to_original_code
		For i = MaxLng(tx - 3, 1) To MinLng(tx + 3, MapWidth)
			For j = MaxLng(ty - 3, 1) To MinLng(ty + 3, MapHeight)
				If MapDataForUnit(i, j) Is Nothing Or System.Math.Abs(tx - i) + System.Math.Abs(ty - j) > 3 Then
					GoTo NextPoint2
				End If
				
				With MapDataForUnit(i, j)
					'Invalid_string_refer_to_original_code
					If .IsEnemy(t) Then
						GoTo NextPoint2
					End If
					
					'Invalid_string_refer_to_original_code
					If .MaxAction = 0 Then
						GoTo NextPoint2
					End If
					
					'Invalid_string_refer_to_original_code
					If .Area = "蝨ｰ荳ｭ" Then
						GoTo NextPoint2
					End If
					
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					GoTo NextPoint2
					'End If
					
					'Invalid_string_refer_to_original_code
					uteam = .MainPilot.SkillData("Invalid_string_refer_to_original_code")
					If team <> uteam And uteam <> "" Then
						GoTo NextPoint2
					End If
					
					For k = 1 To .CountFeature
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						fdata = .FeatureData(k)
						
						'Invalid_string_refer_to_original_code
						If IsNumeric(LIndex(fdata, 2)) Then
							frange = CShort(LIndex(fdata, 2))
						Else
							frange = 1
						End If
						
						'菴ｿ逕ｨ譚｡莉ｶ
						If IsNumeric(LIndex(fdata, 4)) Then
							ecost = CShort(LIndex(fdata, 4))
						Else
							ecost = 20 * frange
						End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'縺吶〒縺ｫ逋ｺ蜍墓ｸ医∩
						ecost = 0
						'End If
						If IsNumeric(LIndex(fdata, 5)) Then
							nmorale = CShort(LIndex(fdata, 5))
						Else
							nmorale = 0
						End If
						
						'Invalid_string_refer_to_original_code
						'Invalid_string_refer_to_original_code_
						'Invalid_string_refer_to_original_code_
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If .FeatureLevel(k) > flevel Then
							u = MapDataForUnit(i, j)
							flevel = .FeatureLevel(k)
							fid = k
						End If
						'End If
						'End If
					Next 
				End With
NextPoint2: 
			Next 
		Next 
		If Not u Is Nothing Then
			'Invalid_string_refer_to_original_code
			If fid = 0 Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				fname = u.FeatureName0(fid)
				fdata = u.FeatureData(fid)
			End If
			If fname = "" Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				fname = "Invalid_string_refer_to_original_code"
			End If
		End If
		
		If IsNumeric(LIndex(fdata, 4)) Then
			ecost = CShort(LIndex(fdata, 4))
		Else
			ecost = 20
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		u.EN = u.EN - ecost
		If u.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
			u.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
		Else
			u.PilotMessage("Invalid_string_refer_to_original_code")
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		u.PlayAnimation("Invalid_string_refer_to_original_code")
		u.SpecialEffect("Invalid_string_refer_to_original_code")
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		u.SysMessage("Invalid_string_refer_to_original_code")
		DisplaySysMessage(u.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		u.AddCondition("Invalid_string_refer_to_original_code")
		u.AddCondition("Invalid_string_refer_to_original_code")
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		'End If
		
		If 500 * flevel >= dmg Then
			NegateEffect(Me, t, w, wname, dmg, fname, fdata, 10, msg, be_quiet)
			CheckDefenseFeature = True
			Exit Function
		ElseIf flevel > 0 Then 
			dmg = dmg - 500 * flevel
			msg = msg & wname & "縺啓" & fname & "Invalid_string_refer_to_original_code"
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		u = Nothing
		flevel = 0
		fid = 0
		'Invalid_string_refer_to_original_code
		For i = MaxLng(tx - 3, 1) To MinLng(tx + 3, MapWidth)
			For j = MaxLng(ty - 3, 1) To MinLng(ty + 3, MapHeight)
				If MapDataForUnit(i, j) Is Nothing Or System.Math.Abs(tx - i) + System.Math.Abs(ty - j) > 3 Then
					GoTo NextPoint3
				End If
				
				With MapDataForUnit(i, j)
					'Invalid_string_refer_to_original_code
					If .IsEnemy(t) Then
						GoTo NextPoint3
					End If
					
					'Invalid_string_refer_to_original_code
					If .MaxAction = 0 Then
						GoTo NextPoint3
					End If
					
					'Invalid_string_refer_to_original_code
					If .Area = "蝨ｰ荳ｭ" Then
						GoTo NextPoint3
					End If
					
					'Invalid_string_refer_to_original_code
					If Not .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						GoTo NextPoint3
					End If
					
					'Invalid_string_refer_to_original_code
					uteam = .MainPilot.SkillData("Invalid_string_refer_to_original_code")
					If team <> uteam And uteam <> "" Then
						GoTo NextPoint3
					End If
					
					For k = 1 To .CountFeature
						If .Feature(k) = "Invalid_string_refer_to_original_code" Then
							fdata = .FeatureData(k)
							
							'Invalid_string_refer_to_original_code
							If IsNumeric(LIndex(fdata, 2)) Then
								frange = CShort(LIndex(fdata, 2))
							Else
								frange = 1
							End If
							
							'菴ｿ逕ｨ譚｡莉ｶ
							If IsNumeric(LIndex(fdata, 4)) Then
								ecost = CShort(LIndex(fdata, 4))
							Else
								ecost = 20 * frange
							End If
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'縺吶〒縺ｫ逋ｺ蜍墓ｸ医∩
							ecost = 0
						End If
						If IsNumeric(LIndex(fdata, 5)) Then
							nmorale = CShort(LIndex(fdata, 5))
						Else
							nmorale = 0
						End If
						
						'Invalid_string_refer_to_original_code
						'Invalid_string_refer_to_original_code_
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If .FeatureLevel(k) > flevel Then
							u = MapDataForUnit(i, j)
							flevel = .FeatureLevel(k)
							fid = k
						End If
						'End If
						'End If
					Next 
				End With
NextPoint3: 
			Next 
		Next 
		If Not u Is Nothing Then
			'Invalid_string_refer_to_original_code
			If fid = 0 Then
				fname = u.FeatureName0("Invalid_string_refer_to_original_code")
				fdata = u.FeatureData("Invalid_string_refer_to_original_code")
			Else
				fname = u.FeatureName0(fid)
				fdata = u.FeatureData(fid)
			End If
			If fname = "" Then
				If u.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
					fname = u.FeatureName0("Invalid_string_refer_to_original_code")
				Else
					fname = "Invalid_string_refer_to_original_code"
				End If
			End If
			
			If IsNumeric(LIndex(fdata, 4)) Then
				ecost = CShort(LIndex(fdata, 4))
			Else
				ecost = 20
			End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			u.EN = u.EN - ecost
			If u.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
				u.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
			Else
				u.PilotMessage("Invalid_string_refer_to_original_code")
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			u.PlayAnimation("Invalid_string_refer_to_original_code")
		Else
			u.SpecialEffect("Invalid_string_refer_to_original_code")
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		u.SysMessage("Invalid_string_refer_to_original_code")
		DisplaySysMessage(u.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
		'End If
		
		If fname = "Invalid_string_refer_to_original_code" Or fname = "Invalid_string_refer_to_original_code" Then
			u.AddCondition("Invalid_string_refer_to_original_code")
		Else
			u.AddCondition("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		End If
		'End If
		
		dmg = dmg * (10 - flevel) \ 10
		If dmg < 0 Then
			msg = msg & u.Nickname & "Invalid_string_refer_to_original_code"
			u.HP = u.HP - dmg
			CheckDefenseFeature = True
			Exit Function
		ElseIf flevel > 0 Then 
			msg = msg & u.Nickname & "縺ｮ[" & fname & "Invalid_string_refer_to_original_code"
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To t.CountFeature
			If t.Feature(i) = "繝舌Μ繧｢" Then
				fname = t.FeatureName0(i)
				If fname = "" Then
					If t.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						fname = t.FeatureName0("Invalid_string_refer_to_original_code")
					Else
						fname = "繝舌Μ繧｢"
					End If
				End If
				fdata = t.FeatureData(i)
				flevel = t.FeatureLevel(i)
				
				'Invalid_string_refer_to_original_code
				If IsNumeric(LIndex(fdata, 3)) Then
					ecost = CShort(LIndex(fdata, 3))
				Else
					ecost = 10
				End If
				If IsNumeric(LIndex(fdata, 4)) Then
					nmorale = CShort(LIndex(fdata, 4))
				Else
					nmorale = 0
				End If
				
				'繧ｪ繝励す繝ｧ繝ｳ
				neautralize = False
				slevel = 0
				For j = 5 To LLength(fdata)
					opt = LIndex(fdata, j)
					idx = InStr(opt, "*")
					If idx > 0 Then
						lv_mod = StrToDbl(Mid(opt, idx + 1))
						opt = Left(opt, idx - 1)
					Else
						lv_mod = -1
					End If
					Select Case t.MainPilot.SkillType(opt)
						Case "逶ｸ谿ｺ"
							If IsSameCategory(fdata, FeatureData("繝舌Μ繧｢")) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
								msg = msg & Nickname & "縺ｯ[" & t.FeatureName(i) & "Invalid_string_refer_to_original_code"
								neautralize = True
							End If
						Case "Invalid_string_refer_to_original_code"
							If IsSameCategory(fdata, FeatureData("繝舌Μ繧｢")) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
								flevel = flevel - FeatureLevel("繝舌Μ繧｢")
								If flevel <= 0 Then
									msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
									neautralize = True
								End If
							End If
						Case "霑第磁辟｡蜉ｹ"
							'Invalid_string_refer_to_original_code_
							'Or IsWeaponClassifiedAs(w, "謗･") _
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							neautralize = True
					End Select
				Next 
			End If
			'UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
			'Case "謇句虚"
				'If def_mode <> "髦ｲ蠕｡" Then
					'neautralize = True
				'End If
				''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case "Invalid_string_refer_to_original_code"
						'If lv_mod = -1 Then
							'lv_mod = 20
						'End If
						'slevel = lv_mod * (t.SyncLevel - 30)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'If slevel = -30 * lv_mod Then
							'neautralize = True
						'End If
						'If slevel = -30 * lv_mod Then
							'slevel = 0
						'End If
						'End If
						''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case "髴雁鴨"
							'If lv_mod = -1 Then
								'lv_mod = 10
							'End If
							'slevel = lv_mod * t.PlanaLevel
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'If slevel = 0 Then
								'neautralize = True
							'End If
							'End If
							''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
							'Case "繧ｪ繝ｼ繝ｩ"
								'If lv_mod = -1 Then
									'lv_mod = 200
								'End If
								'slevel = lv_mod * t.AuraLevel
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								'If slevel = 0 Then
									'neautralize = True
								'End If
								'End If
								''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
								'Case "Invalid_string_refer_to_original_code"
									'If lv_mod = -1 Then
										'lv_mod = 200
									'End If
									'slevel = lv_mod * t.PsychicLevel
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									'If slevel = 0 Then
										'neautralize = True
									'End If
									'End If
									''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If InStr(fdata, "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then
			neautralize = True
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.EN >= ecost And t.MainPilot.Morale >= nmorale And t.IsAttributeClassified(LIndex(fdata, 2), WeaponClass(w)) And Not neautralize Then
			'Invalid_string_refer_to_original_code
			t.EN = t.EN - ecost
			If dmg <= 1000 * flevel + slevel Then
				If ecost <> 0 Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					UpdateMessageForm(Me, t)
				Else
					UpdateMessageForm(Me, Nothing)
				End If
			End If
			NegateEffect(Me, t, w, wname, dmg, fname, fdata, ecost, msg, be_quiet)
			CheckDefenseFeature = True
			Exit Function
		ElseIf flevel > 0 Or slevel > 0 Then 
			If InStr(msg, "[" & fname & "Invalid_string_refer_to_original_code") = 0 Then
				is_penetrated = True
				msg = msg & wname & "縺啓" & fname & "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				t.PlayAnimation("Invalid_string_refer_to_original_code")
			Else
				t.SpecialEffect("Invalid_string_refer_to_original_code")
			End If
		End If
		'End If
		'End If
		'End If
		'Next
		
		'Invalid_string_refer_to_original_code
		For i = 1 To t.CountFeature
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			fname = t.FeatureName0(i)
			If fname = "" Then
				If t.IsFeatureAvailable("繝舌Μ繧｢") Then
					fname = t.FeatureName("繝舌Μ繧｢")
				Else
					fname = "Invalid_string_refer_to_original_code"
				End If
			End If
			fdata = t.FeatureData(i)
			flevel = t.FeatureLevel(i)
			
			'Invalid_string_refer_to_original_code
			If IsNumeric(LIndex(fdata, 3)) Then
				ecost = CShort(LIndex(fdata, 3))
			Else
				ecost = 0
			End If
			If IsNumeric(LIndex(fdata, 4)) Then
				nmorale = CShort(LIndex(fdata, 4))
			Else
				nmorale = 0
			End If
			
			'繧ｪ繝励す繝ｧ繝ｳ
			neautralize = False
			slevel = 0
			For j = 5 To LLength(fdata)
				opt = LIndex(fdata, j)
				idx = InStr(opt, "*")
				If idx > 0 Then
					lv_mod = StrToDbl(Mid(opt, idx + 1))
					opt = Left(opt, idx - 1)
				Else
					lv_mod = -1
				End If
				Select Case t.MainPilot.SkillType(opt)
					Case "逶ｸ谿ｺ"
						'Invalid_string_refer_to_original_code_
						'And Abs(x - tx) + Abs(y - ty) = 1 _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
						neautralize = True
						'End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code_
						'And Abs(x - tx) + Abs(y - ty) = 1 _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If flevel <= 0 Then
							msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
							neautralize = True
						End If
						'End If
					Case "霑第磁辟｡蜉ｹ"
						'Invalid_string_refer_to_original_code_
						'Or IsWeaponClassifiedAs(w, "謗･") _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						neautralize = True
						'End If
					Case "謇句虚"
						If def_mode <> "髦ｲ蠕｡" Then
							neautralize = True
						End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 20
						End If
						slevel = lv_mod * (t.SyncLevel - 30)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = -30 * lv_mod Then
							neautralize = True
						End If
						If slevel = -30 * lv_mod Then
							slevel = 0
						End If
						'End If
					Case "髴雁鴨"
						If lv_mod = -1 Then
							lv_mod = 10
						End If
						slevel = lv_mod * t.PlanaLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case "繧ｪ繝ｼ繝ｩ"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.AuraLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.PsychicLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case Else
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.SkillLevel(opt)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
				End Select
			Next 
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStr(fdata, "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then
				neautralize = True
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If t.EN >= ecost And t.MainPilot.Morale >= nmorale And t.IsAttributeClassified(LIndex(fdata, 2), WeaponClass(w)) And Not neautralize Then
				'Invalid_string_refer_to_original_code
				t.EN = t.EN - ecost
				If dmg <= 500 * flevel + slevel Then
					If ecost <> 0 Then
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						UpdateMessageForm(Me, t)
					Else
						UpdateMessageForm(Me, Nothing)
					End If
				End If
				NegateEffect(Me, t, w, wname, dmg, fname, fdata, ecost, msg, be_quiet)
				CheckDefenseFeature = True
				Exit Function
			ElseIf flevel > 0 Or slevel > 0 Then 
				dmg = dmg - 500 * flevel - slevel
				If InStr(msg, "[" & fname & "Invalid_string_refer_to_original_code") = 0 Then
					msg = msg & wname & "縺啓" & fname & "Invalid_string_refer_to_original_code"
				End If
			End If
			'End If
			'End If
		Next 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To t.CountFeature
			If t.Feature(i) = "Invalid_string_refer_to_original_code" Then
				fname = t.FeatureName0(i)
				If fname = "" Then
					If t.IsFeatureAvailable("繝舌Μ繧｢") Then
						fname = t.FeatureName("繝舌Μ繧｢")
					Else
						fname = "Invalid_string_refer_to_original_code"
					End If
				End If
				fdata = t.FeatureData(i)
				flevel = t.FeatureLevel(i)
				
				'Invalid_string_refer_to_original_code
				If IsNumeric(LIndex(fdata, 3)) Then
					ecost = CShort(LIndex(fdata, 3))
				Else
					ecost = 10
				End If
				If IsNumeric(LIndex(fdata, 4)) Then
					nmorale = CShort(LIndex(fdata, 4))
				Else
					nmorale = 0
				End If
				
				'繧ｪ繝励す繝ｧ繝ｳ
				neautralize = False
				slevel = 0
				For j = 5 To LLength(fdata)
					opt = LIndex(fdata, j)
					idx = InStr(opt, "*")
					If idx > 0 Then
						lv_mod = StrToDbl(Mid(opt, idx + 1))
						opt = Left(opt, idx - 1)
					Else
						lv_mod = -1
					End If
					Select Case t.MainPilot.SkillType(opt)
						Case "逶ｸ谿ｺ"
							If IsSameCategory(fdata, FeatureData("Invalid_string_refer_to_original_code")) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
								msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
								neautralize = True
							End If
						Case "Invalid_string_refer_to_original_code"
							If IsSameCategory(fdata, FeatureData("Invalid_string_refer_to_original_code")) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
								flevel = flevel - FeatureLevel("Invalid_string_refer_to_original_code")
								If flevel <= 0 Then
									msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
									neautralize = True
								End If
							End If
						Case "霑第磁辟｡蜉ｹ"
							'Invalid_string_refer_to_original_code_
							'Or IsWeaponClassifiedAs(w, "謗･") _
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							neautralize = True
					End Select
				Next 
			End If
			'UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
			'Case "謇句虚"
				'If def_mode <> "髦ｲ蠕｡" Then
					'neautralize = True
				'End If
				''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case "Invalid_string_refer_to_original_code"
						'If lv_mod = -1 Then
							'lv_mod = 0.5
						'End If
						'slevel = lv_mod * (t.SyncLevel - 30)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'If slevel = -30 * lv_mod Then
							'neautralize = True
						'End If
						'If slevel = -30 * lv_mod Then
							'slevel = 0
						'End If
						'End If
						''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case "髴雁鴨"
							'If lv_mod = -1 Then
								'lv_mod = 0.2
							'End If
							'slevel = lv_mod * t.PlanaLevel
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'If slevel = 0 Then
								'neautralize = True
							'End If
							'End If
							''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
							'Case "繧ｪ繝ｼ繝ｩ"
								'If lv_mod = -1 Then
									'lv_mod = 5
								'End If
								'slevel = lv_mod * t.AuraLevel
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								'If slevel = 0 Then
									'neautralize = True
								'End If
								'End If
								''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
								'Case "Invalid_string_refer_to_original_code"
									'If lv_mod = -1 Then
										'lv_mod = 5
									'End If
									'slevel = lv_mod * t.PsychicLevel
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									'If slevel = 0 Then
										'neautralize = True
									'End If
									'End If
									''UPGRADE_WARNING: CheckDefenseFeature に変換されていないステートメントがあります。ソース コードを確認してください。
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If InStr(fdata, "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then
			neautralize = True
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.EN >= ecost And t.MainPilot.Morale >= nmorale And t.IsAttributeClassified(LIndex(fdata, 2), WeaponClass(w)) And Not neautralize And dmg > 0 Then
			'Invalid_string_refer_to_original_code
			dmg = dmg * (100 - 10 * flevel - slevel) \ 100
			
			If ecost <> 0 Then
				t.EN = t.EN - ecost
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				UpdateMessageForm(Me, t)
			Else
				UpdateMessageForm(Me, Nothing)
			End If
		End If
		
		If dmg <= 0 Then
			NegateEffect(Me, t, w, wname, dmg, fname, fdata, ecost, msg, be_quiet)
			t.HP = t.HP - dmg
			UpdateMessageForm(Me, t)
			CheckDefenseFeature = True
			Exit Function
		ElseIf flevel > 0 Or slevel > 0 Then 
			If InStr(msg, "[" & fname & "]") = 0 Then
				msg = msg & "[" & fname & "Invalid_string_refer_to_original_code"
			End If
		End If
		'End If
		'End If
		'Next
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		GoTo SkipActiveBarrier
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To t.CountFeature
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			fname = t.FeatureName0(i)
			If fname = "" Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				fname = "Invalid_string_refer_to_original_code"
			End If
			'End If
			fdata = t.FeatureData(i)
			flevel = t.FeatureLevel(i)
			
			'菴ｿ逕ｨ譚｡莉ｶ
			If IsNumeric(LIndex(fdata, 3)) Then
				ecost = CShort(LIndex(fdata, 3))
			Else
				ecost = 10
			End If
			If IsNumeric(LIndex(fdata, 4)) Then
				nmorale = CShort(LIndex(fdata, 4))
			Else
				nmorale = 0
			End If
			
			'繧ｪ繝励す繝ｧ繝ｳ
			neautralize = False
			slevel = 0
			For j = 5 To LLength(fdata)
				opt = LIndex(fdata, j)
				idx = InStr(opt, "*")
				If idx > 0 Then
					lv_mod = StrToDbl(Mid(opt, idx + 1))
					opt = Left(opt, idx - 1)
				Else
					lv_mod = -1
				End If
				Select Case t.MainPilot.SkillType(opt)
					Case "逶ｸ谿ｺ"
						'Invalid_string_refer_to_original_code_
						'And Abs(x - t.x) + Abs(y - t.y) = 1 _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						msg = msg & Nickname & "縺ｯ[" & t.FeatureName(i) & "Invalid_string_refer_to_original_code"
						neautralize = True
						'End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code_
						'And Abs(x - tx) + Abs(y - ty) = 1 _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If flevel <= 0 Then
							msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
							neautralize = True
						End If
						'End If
					Case "霑第磁辟｡蜉ｹ"
						'Invalid_string_refer_to_original_code_
						'Or IsWeaponClassifiedAs(w, "謗･") _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						neautralize = True
						'End If
					Case "謇句虚"
						If def_mode <> "髦ｲ蠕｡" Then
							neautralize = True
						End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 20
						End If
						slevel = lv_mod * (t.SyncLevel - 30)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = -30 * lv_mod Then
							neautralize = True
						End If
						If slevel = -30 * lv_mod Then
							slevel = 0
						End If
						'End If
					Case "髴雁鴨"
						If lv_mod = -1 Then
							lv_mod = 10
						End If
						slevel = lv_mod * t.PlanaLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case "繧ｪ繝ｼ繝ｩ"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.AuraLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.PsychicLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case Else
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.SkillLevel(opt)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
				End Select
			Next 
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStr(fdata, "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then
				neautralize = True
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If t.EN >= ecost And t.MainPilot.Morale >= nmorale And t.IsAttributeClassified(LIndex(fdata, 2), WeaponClass(w)) And t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") > 0 And Not neautralize Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				t.EN = t.EN - ecost
				If dmg <= 1000 * flevel + slevel Then
					If ecost <> 0 Then
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						UpdateMessageForm(Me, t)
					Else
						UpdateMessageForm(Me, Nothing)
					End If
				End If
				NegateEffect(Me, t, w, wname, dmg, fname, fdata, ecost, msg, be_quiet)
				CheckDefenseFeature = True
				Exit Function
			ElseIf flevel > 0 Or slevel > 0 Then 
				If InStr(msg, "[" & fname & "Invalid_string_refer_to_original_code") = 0 Then
					is_penetrated = True
					msg = msg & wname & "縺啓" & fname & "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					t.PlayAnimation("Invalid_string_refer_to_original_code")
				Else
					t.SpecialEffect("Invalid_string_refer_to_original_code")
				End If
			End If
			'End If
			'End If
			'End If
			'End If
		Next 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To t.CountFeature
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			fname = t.FeatureName0(i)
			If fname = "" Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				fname = "Invalid_string_refer_to_original_code"
			End If
			'End If
			fdata = t.FeatureData(i)
			flevel = t.FeatureLevel(i)
			
			'菴ｿ逕ｨ譚｡莉ｶ
			If IsNumeric(LIndex(fdata, 3)) Then
				ecost = CShort(LIndex(fdata, 3))
			Else
				ecost = 0
			End If
			If IsNumeric(LIndex(fdata, 4)) Then
				nmorale = CShort(LIndex(fdata, 4))
			Else
				nmorale = 0
			End If
			
			'繧ｪ繝励す繝ｧ繝ｳ
			neautralize = False
			slevel = 0
			For j = 5 To LLength(fdata)
				opt = LIndex(fdata, j)
				idx = InStr(opt, "*")
				If idx > 0 Then
					lv_mod = StrToDbl(Mid(opt, idx + 1))
					opt = Left(opt, idx - 1)
				Else
					lv_mod = -1
				End If
				Select Case t.MainPilot.SkillType(opt)
					Case "逶ｸ谿ｺ"
						'Invalid_string_refer_to_original_code_
						'And Abs(x - t.x) + Abs(y - t.y) = 1 _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						msg = msg & Nickname & "縺ｯ[" & t.FeatureName(i) & "Invalid_string_refer_to_original_code"
						neautralize = True
						'End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code_
						'And Abs(x - tx) + Abs(y - ty) = 1 _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If flevel <= 0 Then
							msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
							neautralize = True
						End If
						'End If
					Case "霑第磁辟｡蜉ｹ"
						'Invalid_string_refer_to_original_code_
						'Or IsWeaponClassifiedAs(w, "謗･") _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						neautralize = True
						'End If
					Case "謇句虚"
						If def_mode <> "髦ｲ蠕｡" Then
							neautralize = True
						End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 20
						End If
						slevel = lv_mod * (t.SyncLevel - 30)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = -30 * lv_mod Then
							neautralize = True
						End If
						If slevel = -30 * lv_mod Then
							slevel = 0
						End If
						'End If
					Case "髴雁鴨"
						If lv_mod = -1 Then
							lv_mod = 10
						End If
						slevel = lv_mod * t.PlanaLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case "繧ｪ繝ｼ繝ｩ"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.AuraLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.PsychicLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case Else
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.SkillLevel(opt)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
				End Select
			Next 
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStr(fdata, "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then
				neautralize = True
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If t.EN >= ecost And t.MainPilot.Morale >= nmorale And t.IsAttributeClassified(LIndex(fdata, 2), WeaponClass(w)) And t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") > 0 And Not neautralize Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				t.EN = t.EN - ecost
				If dmg <= 500 * flevel + slevel Then
					If ecost <> 0 Then
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						UpdateMessageForm(Me, t)
					Else
						UpdateMessageForm(Me, Nothing)
					End If
				End If
				NegateEffect(Me, t, w, wname, dmg, fname, fdata, ecost, msg, be_quiet)
				CheckDefenseFeature = True
				Exit Function
			ElseIf flevel > 0 Or slevel > 0 Then 
				dmg = dmg - 500 * flevel - slevel
				If InStr(msg, "[" & fname & "Invalid_string_refer_to_original_code") = 0 Then
					msg = msg & wname & "縺啓" & fname & "Invalid_string_refer_to_original_code"
				End If
			End If
			'End If
			'End If
			'End If
		Next 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To t.CountFeature
			If t.Feature(i) = "Invalid_string_refer_to_original_code" Then
				fname = t.FeatureName0(i)
				If fname = "" Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Else
					fname = "Invalid_string_refer_to_original_code"
				End If
			End If
			fdata = t.FeatureData(i)
			flevel = t.FeatureLevel(i)
			
			'菴ｿ逕ｨ譚｡莉ｶ
			If IsNumeric(LIndex(fdata, 3)) Then
				ecost = CShort(LIndex(fdata, 3))
			Else
				ecost = 10
			End If
			If IsNumeric(LIndex(fdata, 4)) Then
				nmorale = CShort(LIndex(fdata, 4))
			Else
				nmorale = 0
			End If
			
			'繧ｪ繝励す繝ｧ繝ｳ
			neautralize = False
			slevel = 0
			For j = 5 To LLength(fdata)
				opt = LIndex(fdata, j)
				idx = InStr(opt, "*")
				If idx > 0 Then
					lv_mod = StrToDbl(Mid(opt, idx + 1))
					opt = Left(opt, idx - 1)
				Else
					lv_mod = -1
				End If
				Select Case t.MainPilot.SkillType(opt)
					Case "逶ｸ谿ｺ"
						If IsSameCategory(fdata, FeatureData("Invalid_string_refer_to_original_code")) And System.Math.Abs(x - t.x) + System.Math.Abs(y - t.y) = 1 Then
							msg = msg & Nickname & "縺ｯ[" & t.FeatureName(i) & "Invalid_string_refer_to_original_code"
							neautralize = True
						End If
					Case "Invalid_string_refer_to_original_code"
						If IsSameCategory(fdata, FeatureData("Invalid_string_refer_to_original_code")) And System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
							flevel = flevel - FeatureLevel("Invalid_string_refer_to_original_code")
							If flevel <= 0 Then
								msg = msg & Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code"
								neautralize = True
							End If
						End If
					Case "霑第磁辟｡蜉ｹ"
						'Invalid_string_refer_to_original_code_
						'Or IsWeaponClassifiedAs(w, "謗･") _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						neautralize = True
						'End If
					Case "謇句虚"
						If def_mode <> "髦ｲ蠕｡" Then
							neautralize = True
						End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 0.5
						End If
						slevel = lv_mod * (t.SyncLevel - 30)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = -30 * lv_mod Then
							neautralize = True
						End If
						If slevel = -30 * lv_mod Then
							slevel = 0
						End If
						'End If
					Case "髴雁鴨"
						If lv_mod = -1 Then
							lv_mod = 0.2
						End If
						slevel = lv_mod * t.PlanaLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case "繧ｪ繝ｼ繝ｩ"
						If lv_mod = -1 Then
							lv_mod = 5
						End If
						slevel = lv_mod * t.AuraLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 5
						End If
						slevel = lv_mod * t.PsychicLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
					Case Else
						If lv_mod = -1 Then
							lv_mod = 5
						End If
						slevel = lv_mod * t.SkillLevel(opt)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							neautralize = True
						End If
						'End If
				End Select
			Next 
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If InStr(fdata, "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then
				neautralize = True
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			If t.EN >= ecost And t.MainPilot.Morale >= nmorale And t.IsAttributeClassified(LIndex(fdata, 2), WeaponClass(w)) And t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") > 0 And Not neautralize And dmg > 0 Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				dmg = dmg * (100 - 10 * flevel - slevel) \ 100
				
				If ecost <> 0 Then
					t.EN = t.EN - ecost
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					UpdateMessageForm(Me, t)
				Else
					UpdateMessageForm(Me, Nothing)
				End If
			End If
			
			If dmg <= 0 Then
				NegateEffect(Me, t, w, wname, dmg, fname, fdata, ecost, msg, be_quiet)
				t.HP = t.HP - dmg
				UpdateMessageForm(Me, t)
				CheckDefenseFeature = True
				Exit Function
			ElseIf flevel > 0 Or slevel > 0 Then 
				If InStr(msg, "[" & fname & "]") = 0 Then
					msg = msg & "[" & fname & "Invalid_string_refer_to_original_code"
				End If
			End If
			'End If
			'End If
			'End If
		Next 
		
SkipActiveBarrier: 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To t.CountFeature
			If t.Feature(i) = "螟画鋤" Then
				fdata = t.FeatureData(i)
				flevel = t.FeatureLevel(i)
				
				'Invalid_string_refer_to_original_code
				If IsNumeric(LIndex(fdata, 3)) Then
					nmorale = CShort(LIndex(fdata, 3))
				Else
					nmorale = 0
				End If
				
				'Invalid_string_refer_to_original_code
				If t.MainPilot.Morale >= nmorale And t.IsAttributeClassified(LIndex(fdata, 2), WeaponClass(w)) Then
					t.EN = t.EN + 0.01 * flevel * dmg
				End If
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.HP = t.HP + dmg
			NegateEffect(Me, t, w, wname, dmg, fname, "Invalid_string_refer_to_original_code", 0, msg, be_quiet)
			CheckDefenseFeature = True
			Exit Function
		End If
		'End If
		
SkipBarrier: 
		
		'Invalid_string_refer_to_original_code
		If Weapon(w).Power = 0 Then
			Exit Function
		End If
		
		'逶ｾ髦ｲ蠕｡
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'And (t.IsConditionSatisfied("逶ｾ莉伜刈") _
		'Or t.FeatureLevel("逶ｾ") > t.ConditionLevel("逶ｾ繝繝｡繝ｼ繧ｸ")) _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		fname = t.FeatureName0("逶ｾ")
		
		If Not be_quiet Then
			t.PilotMessage("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
		End If
		
		If t.IsAnimationDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname) Then
			t.PlayAnimation("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
		ElseIf t.IsSpecialEffectDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname) Then 
			t.SpecialEffect("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
		Else
			ShowAnimation("Invalid_string_refer_to_original_code")
		End If
		
		If IsWeaponClassifiedAs(w, "遐ｴ") Then
			dmg = MaxLng(dmg - 50 * (t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") + 4), 0)
		Else
			dmg = MaxLng(dmg - 100 * (t.MainPilot.SkillLevel("Invalid_string_refer_to_original_code") + 4), 0)
		End If
		
		If t.IsSysMessageDefined("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname) Then
			t.SysMessage("繧ｷ繝ｼ繝ｫ繝蛾亟蠕｡", fname)
		ElseIf dmg = 0 Then 
			DisplaySysMessage(t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
		Else
			DisplaySysMessage(t.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
		End If
		
		If dmg = 0 Then
			'Invalid_string_refer_to_original_code
			
			'Invalid_string_refer_to_original_code
			IsWavePlayed = False
			If Not be_quiet Then
				PilotMessage(wname & "(蜻ｽ荳ｭ)")
			End If
			If IsAnimationDefined(wname & "(蜻ｽ荳ｭ)") Or IsAnimationDefined(wname) Then
				PlayAnimation(wname & "(蜻ｽ荳ｭ)")
			ElseIf IsSpecialEffectDefined(wname & "(蜻ｽ荳ｭ)") Then 
				SpecialEffect(wname & "(蜻ｽ荳ｭ)")
			ElseIf Not IsWavePlayed Then 
				HitEffect(Me, w, t)
			End If
			
			CheckDefenseFeature = True
			Exit Function
		Else
			'Invalid_string_refer_to_original_code
			If t.IsConditionSatisfied("逶ｾ莉伜刈") Then
				If IsWeaponClassifiedAs(w, "遐ｴ") Then
					t.SetConditionLevel("逶ｾ莉伜刈", t.ConditionLevel("逶ｾ莉伜刈") - 2)
				Else
					t.SetConditionLevel("逶ｾ莉伜刈", t.ConditionLevel("逶ｾ莉伜刈") - 1)
				End If
				If t.ConditionLevel("逶ｾ莉伜刈") <= 0 Then
					t.DeleteCondition("逶ｾ莉伜刈")
				End If
			Else
				If IsWeaponClassifiedAs(w, "遐ｴ") Then
					If t.IsConditionSatisfied("逶ｾ繝繝｡繝ｼ繧ｸ") Then
						t.SetConditionLevel("逶ｾ繝繝｡繝ｼ繧ｸ", t.ConditionLevel("逶ｾ繝繝｡繝ｼ繧ｸ") + 2)
					Else
						t.AddCondition("逶ｾ繝繝｡繝ｼ繧ｸ", -1, 2)
					End If
				Else
					If t.IsConditionSatisfied("逶ｾ繝繝｡繝ｼ繧ｸ") Then
						t.SetConditionLevel("逶ｾ繝繝｡繝ｼ繧ｸ", t.ConditionLevel("逶ｾ繝繝｡繝ｼ繧ｸ") + 1)
					Else
						t.AddCondition("逶ｾ繝繝｡繝ｼ繧ｸ", -1, 1)
					End If
				End If
			End If
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.IsFeatureAvailable("陞榊粋") Then
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'And Not IsWeaponClassifiedAs(w, "謗･") _
			'And (t.FeatureLevel("陞榊粋") >= Dice(16) _
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			t.HP = t.HP + dmg
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			UpdateMessageForm(Me, t)
		Else
			UpdateMessageForm(Me, Nothing)
		End If
		
		fname = t.FeatureName("陞榊粋")
		If Not be_quiet Then
			If t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
				t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
			Else
				t.PilotMessage("Invalid_string_refer_to_original_code")
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.PlayAnimation("Invalid_string_refer_to_original_code")
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.SpecialEffect("Invalid_string_refer_to_original_code")
		AbsorbEffect(Me, w, t)
		'End If
		If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Then
			PlayAnimation(wname & "Invalid_string_refer_to_original_code")
		ElseIf IsSpecialEffectDefined(wname & "Invalid_string_refer_to_original_code") Then 
			SpecialEffect(wname & "Invalid_string_refer_to_original_code")
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.SysMessage("Invalid_string_refer_to_original_code")
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		DisplaySysMessage(msg & t.Nickname & "縺ｯ[" & wname & "Invalid_string_refer_to_original_code")
		DisplaySysMessage(msg & t.Nickname & "縺ｯ[" & wname & "Invalid_string_refer_to_original_code")
		'End If
		'End If
		
		CheckDefenseFeature = True
		Exit Function
		'End If
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub CheckAutoAttack(ByVal w As Short, ByRef t As Unit, ByRef attack_mode As String, ByRef def_mode As String, ByRef dmg As Integer, ByRef be_quiet As Boolean)
		Dim wname2 As String
		Dim w2 As Short
		Dim ecost, nmorale As Short
		Dim fname, fdata As String
		Dim flevel As Double
		Dim slevel, lv_mod As Double
		Dim opt As String
		Dim j, i, idx As Short
		Dim prob As Integer
		Dim buf As String
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Or attack_mode = "蠖薙※霄ｫ謚" _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Sub
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Or IsWeaponClassifiedAs(w, "辟｡") _
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Sub
		'End If
		
		'Invalid_string_refer_to_original_code
		i = 1
		Do While i <= t.CountFeature
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			fname = t.FeatureName0(i)
			If fname = "" Then
				fname = "Invalid_string_refer_to_original_code"
			End If
			fdata = t.FeatureData(i)
			flevel = t.FeatureLevel(i)
			If flevel = 1 Then
				flevel = 10000
			End If
			
			'Invalid_string_refer_to_original_code
			buf = LIndex(fdata, 4)
			If IsNumeric(buf) Then
				prob = CShort(buf)
			ElseIf InStr(buf, "+") > 0 Or InStr(buf, "-") > 0 Then 
				j = MaxLng(InStr(buf, "+"), InStr(buf, "-"))
				prob = 100 * (t.SkillLevel(Left(buf, j - 1)) + CShort(Mid(buf, j))) / 16
			Else
				prob = 100 * t.SkillLevel(buf) / 16
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			prob = 100
			'End If
			
			'Invalid_string_refer_to_original_code
			If Not t.IsAttributeClassified(LIndex(fdata, 3), WeaponClass(w)) Then
				prob = 0
			End If
			
			'菴ｿ逕ｨ譚｡莉ｶ
			If IsNumeric(LIndex(fdata, 5)) Then
				ecost = CShort(LIndex(fdata, 5))
			Else
				ecost = 0
			End If
			If IsNumeric(LIndex(fdata, 6)) Then
				nmorale = CShort(LIndex(fdata, 6))
			Else
				nmorale = 0
			End If
			If t.EN < ecost Or t.MainPilot.Morale < nmorale Then
				prob = 0
			End If
			
			'Invalid_string_refer_to_original_code
			If t.MaxAction = 0 Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				prob = 0
			End If
			'End If
			
			'繧ｪ繝励す繝ｧ繝ｳ
			slevel = 0
			For j = 7 To LLength(fdata)
				If prob = 0 Then
					Exit For
				End If
				
				opt = LIndex(fdata, j)
				idx = InStr(opt, "*")
				If idx > 0 Then
					lv_mod = StrToDbl(Mid(opt, idx + 1))
					opt = Left(opt, idx - 1)
				Else
					lv_mod = -1
				End If
				
				Select Case t.MainPilot.SkillType(opt)
					Case "逶ｸ谿ｺ"
						'Invalid_string_refer_to_original_code_
						'And Abs(x - t.x) + Abs(y - t.y) = 1 _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						prob = 0
						'End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code_
						'And Abs(x - t.x) + Abs(y - t.y) = 1 _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If flevel <= 0 Then
							prob = 0
						End If
						'End If
					Case "霑第磁辟｡蜉ｹ"
						'Invalid_string_refer_to_original_code_
						'Or IsWeaponClassifiedAs(w, "謗･") _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						prob = 0
						'End If
					Case "謇句虚"
						If def_mode <> "髦ｲ蠕｡" Then
							prob = 0
						End If
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 20
						End If
						slevel = lv_mod * (t.SyncLevel - 30)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = -30 * lv_mod Then
							prob = 0
						End If
						If slevel = -30 * lv_mod Then
							slevel = 0
						End If
						'End If
					Case "髴雁鴨"
						If lv_mod = -1 Then
							lv_mod = 10
						End If
						slevel = lv_mod * t.PlanaLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case "繧ｪ繝ｼ繝ｩ"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.AuraLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case "Invalid_string_refer_to_original_code"
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.PsychicLevel
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
					Case Else
						If lv_mod = -1 Then
							lv_mod = 200
						End If
						slevel = lv_mod * t.SkillLevel(opt)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If slevel = 0 Then
							prob = 0
						End If
						'End If
				End Select
			Next 
			
			'Invalid_string_refer_to_original_code
			If dmg > 500 * flevel + slevel Then
				prob = 0
			End If
			
			'菴ｿ逕ｨ縺吶ｋ豁ｦ蝎ｨ繧呈､懃ｴ｢
			wname2 = LIndex(fdata, 2)
			w2 = 0
			For j = 1 To t.CountWeapon
				If t.Weapon(j).Name = wname2 Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code_
					'Or IsWeaponClassifiedAs(w, "謗･") _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					w2 = j
				Else
					If t.IsTargetWithinRange(j, Me) Then
						w2 = j
					End If
				End If
				'End If
				Exit For
				'End If
			Next 
			
			'Invalid_string_refer_to_original_code
			If prob >= Dice(100) And w2 > 0 Then
				If ecost <> 0 Then
					t.EN = t.EN - ecost
					UpdateMessageForm(Me, t)
				End If
				
				'Invalid_string_refer_to_original_code
				If Not be_quiet Then
					If t.IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then
						t.PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
					Else
						t.PilotMessage("Invalid_string_refer_to_original_code")
					End If
				Else
					IsWavePlayed = False
				End If
				
				'蜉ｹ譫憺浹
				If Not IsWavePlayed Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					t.PlayAnimation("Invalid_string_refer_to_original_code")
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					t.SpecialEffect("Invalid_string_refer_to_original_code")
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.SysMessage("Invalid_string_refer_to_original_code")
			DisplaySysMessage(t.Nickname & "縺ｯ" & t.WeaponNickname(w2) & "Invalid_string_refer_to_original_code")
			'End If
			
			'Invalid_string_refer_to_original_code
			t.Attack(w2, Me, "Invalid_string_refer_to_original_code")
			t = t.CurrentForm
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Sub
			'End If
			'End If
			'End If
			i = i + 1
		Loop 
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	Public Sub CheckAdditionalAttack(ByVal w As Short, ByRef t As Unit, ByVal be_quiet As Boolean, ByRef attack_mode As String, ByRef def_mode As String, ByVal dmg As Integer)
		Dim wnskill, wname, wnickname, wclass As String
		Dim wtype, sname As String
		Dim wname2 As String
		Dim w2 As Short
		Dim ecost, nmorale As Short
		Dim fname, fdata As String
		Dim flevel As Double
		Dim i, j As Short
		Dim prob As Integer
		Dim buf As String
		Dim found As Boolean
		Dim attack_count As Short
		
		wname = Weapon(w).Name
		wnickname = WeaponNickname(w)
		wclass = WeaponClass(w)
		wnskill = Weapon(w).NecessarySkill
		
		'Invalid_string_refer_to_original_code
		i = 1
		Do While i <= CountFeature
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			fname = FeatureName0(i)
			If fname = "" Then
				fname = "Invalid_string_refer_to_original_code"
			End If
			fdata = FeatureData(i)
			flevel = FeatureLevel(i)
			If flevel = 1 Then
				flevel = 10000
			End If
			
			'Invalid_string_refer_to_original_code
			buf = LIndex(fdata, 4)
			If IsNumeric(buf) Then
				prob = CShort(buf)
			ElseIf InStr(buf, "+") > 0 Or InStr(buf, "-") > 0 Then 
				j = MaxLng(InStr(buf, "+"), InStr(buf, "-"))
				prob = 100 * (SkillLevel(Left(buf, j - 1)) + CShort(Mid(buf, j))) / 16
			Else
				prob = SkillLevel(buf) * 100 / 16
			End If
			
			'Invalid_string_refer_to_original_code
			wtype = LIndex(fdata, 3)
			found = False
			If Left(wtype, 1) = "@" Then
				'Invalid_string_refer_to_original_code
				wtype = Mid(wtype, 2)
				If wname = wtype Or wnickname = wtype Then
					found = True
				Else
					For j = 1 To LLength(wnskill)
						sname = LIndex(wnskill, j)
						If InStr(sname, "Lv") > 0 Then
							sname = Left(sname, InStr(sname, "Lv") - 1)
						End If
						If sname = wtype Then
							found = True
							Exit For
						End If
					Next 
				End If
			Else
				'Invalid_string_refer_to_original_code
				Select Case wtype
					Case "蜈ｨ"
						found = True
					Case "迚ｩ"
						'Invalid_string_refer_to_original_code_
						'Or InStrNotNest(wclass, "鬲疲ｭｦ") > 0 _
						'Invalid_string_refer_to_original_code_
						'Or InStrNotNest(wclass, "鬲疲磁") > 0 _
						'Or InStrNotNest(wclass, "鬲秘潟") > 0 _
						'Invalid_string_refer_to_original_code_
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						found = True
				End Select
			End If
			'UPGRADE_WARNING: CheckAdditionalAttack に変換されていないステートメントがあります。ソース コードを確認してください。
		Loop 
	End Sub
	
	'Invalid_string_refer_to_original_code
	'縲御ｸｭ蜥後阪檎嶌谿ｺ縲咲畑
	Private Function IsSameCategory(ByRef fdata1 As String, ByRef fdata2 As String) As Boolean
		Dim fc1, fc2 As String
		
		fc1 = LIndex(fdata1, 1)
		'Invalid_string_refer_to_original_code
		If InStr(fc1, "Lv") > 0 Then
			fc1 = Left(fc1, InStr(fc1, "Lv") - 1)
		End If
		
		fc2 = LIndex(fdata2, 1)
		'Invalid_string_refer_to_original_code
		If InStr(fc2, "Lv") > 0 Then
			fc2 = Left(fc2, InStr(fc2, "Lv") - 1)
		End If
		
		If fc1 = fc2 Then
			IsSameCategory = True
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CauseEffect(ByVal w As Short, ByRef t As Unit, ByRef msg As String, ByRef critical_type As String, ByRef def_mode As String, ByVal will_die As Boolean) As Boolean
		Dim i, prob, j As Short
		Dim fname, wname, ch As String
		Dim Skill() As String
		
		wname = WeaponNickname(w)
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = 100
		Dim sname, stype, vname As String
		Dim prev_money As Integer
		Dim iname As String
		prob = CriticalProbability(w, t, def_mode)
		'End If
		
		If will_die Then
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			GoTo SkipNormalEffect
		End If
		
		'Invalid_string_refer_to_original_code
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			t.AddCondition("Invalid_string_refer_to_original_code", 2)
		End If
		critical_type = critical_type & "Invalid_string_refer_to_original_code"
		CauseEffect = True
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") And Not t.SpecialEffectImmune("Invalid_string_refer_to_original_code") Then
				msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
				If IsWeaponLevelSpecified(w, "Invalid_string_refer_to_original_code") Then
					t.AddCondition("Invalid_string_refer_to_original_code", WeaponLevel(w, "Invalid_string_refer_to_original_code"))
				Else
					t.AddCondition("Invalid_string_refer_to_original_code", 1)
				End If
				critical_type = critical_type & "Invalid_string_refer_to_original_code"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "蜉｣") And Not t.SpecialEffectImmune("蜉｣") Then
				msg = msg & "[" & t.Nickname & "]縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code"
				If IsWeaponLevelSpecified(w, "蜉｣") Then
					t.AddCondition("Invalid_string_refer_to_original_code")
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Else
					t.AddCondition("Invalid_string_refer_to_original_code")
					DEFAULT_LEVEL( , Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
				End If
				critical_type = critical_type & "Invalid_string_refer_to_original_code"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			fname = "繝舌Μ繧｢"
			If t.IsFeatureAvailable("繝舌Μ繧｢") And InStr(t.FeatureData("繝舌Μ繧｢"), "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then
				fname = t.FeatureName0("繝舌Μ繧｢")
				If Len(fname) = 0 Then
					fname = "繝舌Μ繧｢"
				End If
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If Len(fname) = 0 Then
					fname = "Invalid_string_refer_to_original_code"
				End If
			ElseIf t.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then 
				fname = t.FeatureName0("Invalid_string_refer_to_original_code")
				If Len(fname) = 0 Then
					fname = "Invalid_string_refer_to_original_code"
				End If
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If Len(fname) = 0 Then
					fname = "Invalid_string_refer_to_original_code"
				End If
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If Len(fname) = 0 Then
					fname = "Invalid_string_refer_to_original_code"
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If Len(fname) = 0 Then
					fname = "Invalid_string_refer_to_original_code"
				End If
			ElseIf t.IsFeatureAvailable("Invalid_string_refer_to_original_code") And InStr(t.FeatureData("Invalid_string_refer_to_original_code"), "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then 
				fname = t.FeatureName0("Invalid_string_refer_to_original_code")
				If Len(fname) = 0 Then
					fname = "Invalid_string_refer_to_original_code"
				End If
			ElseIf t.IsFeatureAvailable("Invalid_string_refer_to_original_code") And InStr(t.FeatureData("Invalid_string_refer_to_original_code"), "繝舌Μ繧｢辟｡蜉ｹ蛹也┌蜉ｹ") = 0 Then 
				fname = t.FeatureName0("Invalid_string_refer_to_original_code")
				If Len(fname) = 0 Then
					fname = "Invalid_string_refer_to_original_code"
				End If
			ElseIf t.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then 
				fname = t.FeatureName0("Invalid_string_refer_to_original_code")
				If Len(fname) = 0 Then
					fname = "Invalid_string_refer_to_original_code"
				End If
			End If
			msg = msg & "[" & t.Nickname & "]縺ｮ" & fname & "Invalid_string_refer_to_original_code"
			
			If IsWeaponLevelSpecified(w, "荳ｭ") Then
				t.AddCondition("Invalid_string_refer_to_original_code")
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				t.AddCondition("Invalid_string_refer_to_original_code")
			End If
			critical_type = critical_type & "Invalid_string_refer_to_original_code"
			CauseEffect = True
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "遏ｳ") And Not t.SpecialEffectImmune("遏ｳ") And t.BossRank < 0 Then
				msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
				If IsWeaponLevelSpecified(w, "遏ｳ") Then
					t.AddCondition("Invalid_string_refer_to_original_code")
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Else
					t.AddCondition("Invalid_string_refer_to_original_code")
				End If
				critical_type = critical_type & "Invalid_string_refer_to_original_code"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.AddCondition("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			t.AddCondition("Invalid_string_refer_to_original_code")
		End If
		critical_type = critical_type & "Invalid_string_refer_to_original_code"
		CauseEffect = True
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "逞ｺ") And Not t.SpecialEffectImmune("逞ｺ") Then
				msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
				If IsWeaponLevelSpecified(w, "逞ｺ") Then
					t.AddCondition("鮗ｻ逞ｺ", WeaponLevel(w, "逞ｺ"))
				Else
					t.AddCondition("鮗ｻ逞ｺ", 3)
				End If
				critical_type = critical_type & " 鮗ｻ逞ｺ"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "逵") And Not t.SpecialEffectImmune("逵") And Not t.MainPilot.Personality = "讖滓｢ｰ" Then
				msg = msg & "[" & t.MainPilot.Nickname & "Invalid_string_refer_to_original_code"
				If IsWeaponLevelSpecified(w, "逵") Then
					t.AddCondition("逹｡逵", WeaponLevel(w, "逵"))
				Else
					t.AddCondition("逹｡逵", 3)
				End If
				critical_type = critical_type & " 逹｡逵"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "荵ｱ") And Not t.SpecialEffectImmune("荵ｱ") Then
				msg = msg & "[" & t.MainPilot.Nickname & "Invalid_string_refer_to_original_code"
				If IsWeaponLevelSpecified(w, "荵ｱ") Then
					t.AddCondition("豺ｷ荵ｱ", WeaponLevel(w, "荵ｱ"))
				Else
					t.AddCondition("豺ｷ荵ｱ", 3)
				End If
				critical_type = critical_type & " 豺ｷ荵ｱ"
				CauseEffect = True
			End If
		End If
		
		If Not t Is Me Then
			'Invalid_string_refer_to_original_code
			If prob >= Dice(100) Then
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				msg = msg & MainPilot.Nickname & "縺啓" & t.MainPilot.Nickname & "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				t.AddCondition("Invalid_string_refer_to_original_code")
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				t.AddCondition("Invalid_string_refer_to_original_code")
			End If
			If Not t.Master Is Nothing Then
				t.Master.DeleteSlave((t.ID))
			End If
			AddSlave(t)
			t.Master = Me
			t.Mode = MainPilot.ID
			PList.UpdateSupportMod(t)
			critical_type = critical_type & "Invalid_string_refer_to_original_code"
			CauseEffect = True
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'And t.BossRank < 0 _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & MainPilot.Nickname & "縺啓" & t.Nickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			t.DeleteCondition("Invalid_string_refer_to_original_code")
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.AddCondition("Invalid_string_refer_to_original_code")
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		t.AddCondition("Invalid_string_refer_to_original_code")
		'End If
		If Not t.Master Is Nothing Then
			t.Master.DeleteSlave((t.ID))
		End If
		AddSlave(t)
		t.Master = Me
		PList.UpdateSupportMod(t)
		critical_type = critical_type & "Invalid_string_refer_to_original_code"
		CauseEffect = True
		'End If
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "謦ｹ") And Not t.SpecialEffectImmune("謦ｹ") Then
				msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
				If IsWeaponLevelSpecified(w, "謦ｹ") Then
					t.AddCondition("謦ｹ荵ｱ", WeaponLevel(w, "謦ｹ"))
				Else
					t.AddCondition("謦ｹ荵ｱ", 2)
				End If
				critical_type = critical_type & " 謦ｹ荵ｱ"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & t.MainPilot.Nickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.AddCondition("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			t.AddCondition("Invalid_string_refer_to_original_code")
		End If
		critical_type = critical_type & "Invalid_string_refer_to_original_code"
		CauseEffect = True
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "逶ｲ") And Not t.SpecialEffectImmune("逶ｲ") Then
				msg = msg & "[" & t.MainPilot.Nickname & "Invalid_string_refer_to_original_code"
				If IsWeaponLevelSpecified(w, "逶ｲ") Then
					t.AddCondition("逶ｲ逶ｮ", WeaponLevel(w, "逶ｲ"))
				Else
					t.AddCondition("逶ｲ逶ｮ", 3)
				End If
				critical_type = critical_type & " 逶ｲ逶ｮ"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & t.Nickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.AddCondition("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			t.AddCondition("Invalid_string_refer_to_original_code")
		End If
		critical_type = critical_type & "Invalid_string_refer_to_original_code"
		CauseEffect = True
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			t.AddCondition("Invalid_string_refer_to_original_code", 1)
		End If
		critical_type = critical_type & "Invalid_string_refer_to_original_code"
		CauseEffect = True
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "豁｢") And Not t.SpecialEffectImmune("豁｢") Then
				msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
				If t.Party <> Stage Then
					If IsWeaponLevelSpecified(w, "豁｢") Then
						t.AddCondition("Invalid_string_refer_to_original_code", WeaponLevel(w, "豁｢") + 1)
					Else
						t.AddCondition("Invalid_string_refer_to_original_code", 2)
					End If
				Else
					If IsWeaponLevelSpecified(w, "豁｢") Then
						t.AddCondition("Invalid_string_refer_to_original_code", WeaponLevel(w, "豁｢"))
					Else
						t.AddCondition("Invalid_string_refer_to_original_code", 1)
					End If
				End If
				critical_type = critical_type & "Invalid_string_refer_to_original_code"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & t.MainPilot.Nickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			t.AddCondition("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			t.AddCondition("Invalid_string_refer_to_original_code")
		End If
		critical_type = critical_type & "Invalid_string_refer_to_original_code"
		CauseEffect = True
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			t.AddCondition("雕翫ｊ", 3)
		End If
		critical_type = critical_type & " 雕翫ｊ"
		CauseEffect = True
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & t.MainPilot.Nickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Else
			t.AddCondition("迢よ姶螢ｫ", 3)
		End If
		critical_type = critical_type & " 迢よ姶螢ｫ"
		CauseEffect = True
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "繧ｾ") And Not t.SpecialEffectImmune("繧ｾ") Then
				msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
				If IsWeaponLevelSpecified(w, "繧ｾ") Then
					t.AddCondition("Invalid_string_refer_to_original_code")
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Else
					t.AddCondition("Invalid_string_refer_to_original_code")
				End If
				critical_type = critical_type & "Invalid_string_refer_to_original_code"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "螳ｳ") And Not t.SpecialEffectImmune("螳ｳ") Then
				msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
				If IsWeaponLevelSpecified(w, "螳ｳ") Then
					t.AddCondition("Invalid_string_refer_to_original_code", WeaponLevel(w, "螳ｳ"))
				Else
					t.AddCondition("Invalid_string_refer_to_original_code", 10000)
				End If
				critical_type = critical_type & "Invalid_string_refer_to_original_code"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "髯､") And Not t.SpecialEffectImmune("髯､") Then
				For i = 1 To t.CountCondition
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'And t.ConditionLifetime(i) > 0 _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Exit For
				Next 
			End If
			'Next
			If i <= t.CountCondition Then
				msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
				Do 
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'And t.ConditionLifetime(i) > 0 _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					t.DeleteCondition(i)
				Loop 
			Else
				i = i + 1
			End If
			'UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
			'Loop
			critical_type = critical_type & " 隗｣髯､"
			CauseEffect = True
		End If
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Or MainPilot.Technique <= t.MainPilot.Technique) _
			'And Not t.IsConditionSatisfied("荳肴ｭｻ霄ｫ") _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			critical_type = critical_type & " 蜊ｳ豁ｻ"
			CauseEffect = True
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'And t.BossRank < 0 _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & t.MainPilot.Nickname & "Invalid_string_refer_to_original_code"
			If InStr(WeaponClass(w), "蜻貝") > 0 Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				t.AddCondition("Invalid_string_refer_to_original_code")
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				t.HP = 1
			End If
		Else
			t.AddCondition("Invalid_string_refer_to_original_code")
		End If
		critical_type = critical_type & "Invalid_string_refer_to_original_code"
		CauseEffect = True
		'End If
		'End If
		
		If t.MainPilot.Personality <> "讖滓｢ｰ" Then
			'Invalid_string_refer_to_original_code
			If prob >= Dice(100) Then
				If IsWeaponClassifiedAs(w, "閼ｱ") And Not t.SpecialEffectImmune("閼ｱ") Then
					msg = msg & "[" & t.MainPilot.Nickname & "]縺ｮ" & Term("豌怜鴨", t) & "Invalid_string_refer_to_original_code"
					If IsWeaponLevelSpecified(w, "閼ｱ") Then
						t.IncreaseMorale(-5 * WeaponLevel(w, "閼ｱ"))
					Else
						t.IncreaseMorale(-10)
					End If
					critical_type = critical_type & "Invalid_string_refer_to_original_code"
					CauseEffect = True
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			If prob >= Dice(100) Then
				If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") And Not t.SpecialEffectImmune("Invalid_string_refer_to_original_code") Then
					msg = msg & MainPilot.Nickname & "縺ｯ[" & t.MainPilot.Nickname & "]縺ｮ" & Term("豌怜鴨", t) & "Invalid_string_refer_to_original_code"
					If IsWeaponLevelSpecified(w, "Invalid_string_refer_to_original_code") Then
						t.IncreaseMorale(-5 * WeaponLevel(w, "Invalid_string_refer_to_original_code"))
						IncreaseMorale(2.5 * WeaponLevel(w, "Invalid_string_refer_to_original_code"))
					Else
						t.IncreaseMorale(-10)
						IncreaseMorale(5)
					End If
					critical_type = critical_type & "Invalid_string_refer_to_original_code"
					CauseEffect = True
				End If
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "菴取判") And Not t.SpecialEffectImmune("菴取判") Then
				msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
				If t.IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
					t.DeleteCondition("Invalid_string_refer_to_original_code")
				Else
					If IsWeaponLevelSpecified(w, "菴取判") Then
						t.AddCondition("Invalid_string_refer_to_original_code", WeaponLevel(w, "菴取判"))
					Else
						t.AddCondition("Invalid_string_refer_to_original_code", 3)
					End If
				End If
				critical_type = critical_type & "Invalid_string_refer_to_original_code"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "菴朱亟") And Not t.SpecialEffectImmune("菴朱亟") Then
				msg = msg & "[" & t.Nickname & "Invalid_string_refer_to_original_code"
				If t.IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
					t.DeleteCondition("Invalid_string_refer_to_original_code")
				Else
					If IsWeaponLevelSpecified(w, "菴朱亟") Then
						t.AddCondition("Invalid_string_refer_to_original_code", WeaponLevel(w, "菴朱亟"))
					Else
						t.AddCondition("Invalid_string_refer_to_original_code", 3)
					End If
				End If
				critical_type = critical_type & "Invalid_string_refer_to_original_code"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "菴朱°") And Not t.SpecialEffectImmune("菴朱°") Then
				msg = msg & "[" & t.Nickname & "]縺ｮ" & Term("驕句虚諤ｧ", t) & "Invalid_string_refer_to_original_code"
				If t.IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
					t.DeleteCondition("Invalid_string_refer_to_original_code")
				Else
					If IsWeaponLevelSpecified(w, "菴朱°") Then
						t.AddCondition("Invalid_string_refer_to_original_code", WeaponLevel(w, "菴朱°"), DEFAULT_LEVEL, Term("驕句虚諤ｧ", t) & "Invalid_string_refer_to_original_code")
					Else
						t.AddCondition("Invalid_string_refer_to_original_code", 3, DEFAULT_LEVEL, Term("驕句虚諤ｧ", t) & "Invalid_string_refer_to_original_code")
					End If
				End If
				critical_type = critical_type & "Invalid_string_refer_to_original_code"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "菴守ｧｻ") And Not t.SpecialEffectImmune("菴守ｧｻ") Then
				msg = msg & "[" & t.Nickname & "]縺ｮ" & Term("遘ｻ蜍募鴨", t) & "Invalid_string_refer_to_original_code"
				If t.IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
					t.DeleteCondition("Invalid_string_refer_to_original_code")
				Else
					If IsWeaponLevelSpecified(w, "菴守ｧｻ") Then
						t.AddCondition("Invalid_string_refer_to_original_code", WeaponLevel(w, "菴守ｧｻ"), DEFAULT_LEVEL, Term("遘ｻ蜍募鴨", t) & "Invalid_string_refer_to_original_code")
					Else
						t.AddCondition("Invalid_string_refer_to_original_code", 3, DEFAULT_LEVEL, Term("遘ｻ蜍募鴨", t) & "Invalid_string_refer_to_original_code")
					End If
				End If
				critical_type = critical_type & "Invalid_string_refer_to_original_code"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			If IsWeaponClassifiedAs(w, "陦ｰ") And Not t.SpecialEffectImmune("陦ｰ") Then
				msg = msg & "[" & t.Nickname & "]縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code"
				If t.BossRank >= 0 Then
					Select Case CShort(WeaponLevel(w, "陦ｰ"))
						Case 1
							t.HP = t.HP * 7 \ 8
							msg = msg & "12.5%"
						Case 2
							t.HP = t.HP * 3 \ 4
							msg = msg & "25%"
						Case 3
							t.HP = t.HP \ 2
							msg = msg & "50%"
					End Select
				Else
					Select Case CShort(WeaponLevel(w, "陦ｰ"))
						Case 1
							t.HP = t.HP * 3 \ 4
							msg = msg & "25%"
						Case 2
							t.HP = t.HP \ 2
							msg = msg & "50%"
						Case 3
							t.HP = t.HP \ 4
							msg = msg & "75%"
					End Select
				End If
				msg = msg & "Invalid_string_refer_to_original_code"
				critical_type = critical_type & " 貂幄｡ｰ"
				CauseEffect = True
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & t.Nickname & "]縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code"
			If t.BossRank >= 0 Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case 1
					't.EN = t.EN * 7 \ 8
					'msg = msg & "12.5%"
					''UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case 2
						't.EN = t.EN * 3 \ 4
						'msg = msg & "25%"
						''UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case 3
							't.EN = t.EN \ 2
							'msg = msg & "50%"
							'End Select
			Else
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case 1
					't.EN = t.EN * 3 \ 4
					'msg = msg & "25%"
					''UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case 2
						't.EN = t.EN \ 2
						'msg = msg & "50%"
						''UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case 3
							't.EN = t.EN \ 4
							'msg = msg & "75%"
							'End Select
			End If
			msg = msg & "Invalid_string_refer_to_original_code"
			critical_type = critical_type & " 貂幄｡ｰ"
			CauseEffect = True
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		i = InStrNotNest(strWeaponClass(w), "蠑ｱ")
		Do While i > 0
			ch = Mid(GetClassBundle(strWeaponClass(w), i), 2)
			If prob >= Dice(100) Then
				If Not t.SpecialEffectImmune(ch) Then
					msg = msg & "[" & t.Nickname & "]縺ｯ[" & ch & "Invalid_string_refer_to_original_code"
					If IsWeaponLevelSpecified(w, "蠑ｱ" & ch) Then
						t.AddCondition(ch & "螻樊ｧ蠑ｱ轤ｹ莉伜刈", WeaponLevel(w, "蠑ｱ" & ch))
					Else
						t.AddCondition(ch & "螻樊ｧ蠑ｱ轤ｹ莉伜刈", 3)
					End If
					critical_type = critical_type & " " & ch & "螻樊ｧ蠑ｱ轤ｹ莉伜刈"
					CauseEffect = True
				End If
			End If
			i = InStrNotNest(strWeaponClass(w), "蠑ｱ", i + 1)
		Loop 
		
		'譛牙柑莉伜刈螻樊ｧ
		i = InStrNotNest(strWeaponClass(w), "蜉ｹ")
		Do While i > 0
			ch = Mid(GetClassBundle(strWeaponClass(w), i), 2)
			If prob >= Dice(100) Then
				'Invalid_string_refer_to_original_code
				If Not t.Weakness(ch) And Not t.SpecialEffectImmune(ch) Then
					msg = msg & "[" & t.Nickname & "]縺ｫ[" & ch & "Invalid_string_refer_to_original_code"
					If IsWeaponLevelSpecified(w, "蜉ｹ" & ch) Then
						t.AddCondition(ch & "螻樊ｧ譛牙柑莉伜刈", WeaponLevel(w, "蜉ｹ" & ch))
					Else
						t.AddCondition(ch & "螻樊ｧ譛牙柑莉伜刈", 3)
					End If
					critical_type = critical_type & " " & ch & "螻樊ｧ譛牙柑莉伜刈"
					CauseEffect = True
				End If
			End If
			i = InStrNotNest(strWeaponClass(w), "蜉ｹ", i + 1)
		Loop 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Do While i > 0
			ch = Mid(GetClassBundle(strWeaponClass(w), i), 2)
			If prob >= Dice(100) Then
				If Not t.SpecialEffectImmune(ch) Then
					ReDim Skill(0)
					Select Case ch
						Case "繧ｪ"
							Skill(0) = "繧ｪ繝ｼ繝ｩ"
						Case "Invalid_string_refer_to_original_code"
							Skill(0) = "Invalid_string_refer_to_original_code"
						Case "繧ｷ"
							Skill(0) = "Invalid_string_refer_to_original_code"
						Case "繧ｵ"
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code_
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							ReDim Skill(1)
							Skill(0) = "Invalid_string_refer_to_original_code"
							Skill(1) = "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							Skill(0) = "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							Skill(0) = "Invalid_string_refer_to_original_code"
					End Select
				Else
					ReDim Skill(1)
					Skill(0) = "Invalid_string_refer_to_original_code"
					Skill(1) = "Invalid_string_refer_to_original_code"
				End If
				'UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case "Invalid_string_refer_to_original_code"
					'Skill(0) = "髴雁鴨"
					''UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case "Invalid_string_refer_to_original_code"
						'Skill(0) = "Invalid_string_refer_to_original_code"
						''UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case "謚"
							'Skill(0) = "謚"
							''UPGRADE_WARNING: CauseEffect に変換されていないステートメントがあります。ソース コードを確認してください。
			Else
				t.AddCondition(Skill(j) & "Invalid_string_refer_to_original_code", 3)
			End If
			critical_type = critical_type & " " & Skill(j) & "Invalid_string_refer_to_original_code"
			'Next
			CauseEffect = True
			'End If
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Loop 
		
SkipNormalEffect: 
		
		'Invalid_string_refer_to_original_code
		
		'逶励∩
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'And ((Party = "蜻ｳ譁ｹ" And t.Party0 <> "蜻ｳ譁ｹ") _
			'Or (Party <> "蜻ｳ譁ｹ" And t.Party0 = "蜻ｳ譁ｹ")) _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If t.Party0 = "蜻ｳ譁ｹ" Then
				'Invalid_string_refer_to_original_code
				prev_money = Money
				IncrMoney(-t.Value \ 2)
				If Weapon(w).Power > 0 Then
					msg = msg & "[" & t.Nickname & "]縺ｯ" & Term("Invalid_string_refer_to_original_code", t) & VB6.Format(prev_money - Money) & "Invalid_string_refer_to_original_code"
				Else
					msg = msg & "[" & t.Nickname & "]縺ｯ" & Term("Invalid_string_refer_to_original_code", t) & VB6.Format(prev_money - Money) & "Invalid_string_refer_to_original_code"
				End If
				critical_type = critical_type & " 逶励∩"
				CauseEffect = True
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If IDList.IsDefined(iname) Then
					IList.Add(iname)
					If Weapon(w).Power > 0 Then
						msg = msg & "[" & t.Nickname & "]縺九ｉ" & IDList.Item(iname).Nickname & "Invalid_string_refer_to_original_code"
					Else
						msg = msg & "[" & t.Nickname & "]縺九ｉ" & IDList.Item(iname).Nickname & "Invalid_string_refer_to_original_code"
					End If
				Else
					ErrorMessage(t.Name & "Invalid_string_refer_to_original_code")
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				End If
				critical_type = critical_type & " 逶励∩"
				CauseEffect = True
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If IDList.IsDefined(iname) Then
					IList.Add(iname)
					If Weapon(w).Power > 0 Then
						msg = msg & "[" & t.Nickname & "]縺九ｉ" & IDList.Item(iname).Nickname & "Invalid_string_refer_to_original_code"
					Else
						msg = msg & "[" & t.Nickname & "]縺九ｉ" & IDList.Item(iname).Nickname & "Invalid_string_refer_to_original_code"
					End If
				Else
					ErrorMessage(t.Name & "Invalid_string_refer_to_original_code")
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				End If
				critical_type = critical_type & " 逶励∩"
				CauseEffect = True
			ElseIf t.Value > 0 Then 
				'Invalid_string_refer_to_original_code
				IncrMoney(t.Value \ 4)
				If Weapon(w).Power > 0 Then
					msg = msg & "[" & t.Nickname & "]縺九ｉ" & Term("Invalid_string_refer_to_original_code", t) & VB6.Format(t.Value \ 4) & "Invalid_string_refer_to_original_code"
				Else
					msg = msg & "[" & t.Nickname & "]縺九ｉ" & Term("Invalid_string_refer_to_original_code", t) & VB6.Format(t.Value \ 4) & "Invalid_string_refer_to_original_code"
				End If
				critical_type = critical_type & " 逶励∩"
				CauseEffect = True
			End If
			
			'Invalid_string_refer_to_original_code
			If t.Party0 <> "蜻ｳ譁ｹ" Then
				t.AddCondition("Invalid_string_refer_to_original_code")
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			End If
		End If
		'End If
		
		'繝ｩ繝ｼ繝九Φ繧ｰ
		If prob >= Dice(100) Then
			'Invalid_string_refer_to_original_code_
			'And t.IsFeatureAvailable("繝ｩ繝ｼ繝九Φ繧ｰ蜿ｯ閭ｽ謚") _
			'And Party0 = "蜻ｳ譁ｹ" _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			stype = LIndex(t.FeatureData("繝ｩ繝ｼ繝九Φ繧ｰ蜿ｯ閭ｽ謚"), 1)
			Select Case LIndex(t.FeatureData("繝ｩ繝ｼ繝九Φ繧ｰ蜿ｯ閭ｽ謚"), 2)
				Case "陦ｨ遉ｺ", ""
					sname = stype
				Case Else
					sname = LIndex(t.FeatureData("繝ｩ繝ｼ繝九Φ繧ｰ蜿ｯ閭ｽ謚"), 2)
			End Select
			If Not MainPilot.IsSkillAvailable(stype) Then
				msg = msg & "[" & MainPilot.Nickname & "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				vname = "Ability(" & MainPilot.ID & ")"
				If Not IsGlobalVariableDefined(vname) Then
					DefineGlobalVariable(vname)
					'UPGRADE_WARNING: オブジェクト GlobalVariableList.Item().StringValue の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
					GlobalVariableList.Item(vname).StringValue = stype
				Else
					With GlobalVariableList.Item(vname)
						'UPGRADE_WARNING: オブジェクト GlobalVariableList.Item(vname).StringValue の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
						'UPGRADE_WARNING: オブジェクト GlobalVariableList.Item().StringValue の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
						.StringValue = .StringValue & " " & stype
					End With
				End If
				
				vname = "Ability(" & MainPilot.ID & "," & stype & ")"
				If Not IsGlobalVariableDefined(vname) Then
					DefineGlobalVariable(vname)
				End If
				
				If LLength(t.FeatureData("繝ｩ繝ｼ繝九Φ繧ｰ蜿ｯ閭ｽ謚")) = 1 Then
					SetVariableAsString(vname, "-1 髱櫁｡ｨ遉ｺ")
				ElseIf stype <> sname Then 
					SetVariableAsString(vname, "-1 " & sname)
				Else
					SetVariableAsString(vname, "-1")
				End If
				
				critical_type = critical_type & " 繝ｩ繝ｼ繝九Φ繧ｰ"
				CauseEffect = True
			End If
		End If
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CheckBlowAttack(ByVal w As Short, ByRef t As Unit, ByRef dmg As Integer, ByRef msg As String, ByRef attack_mode As String, ByRef def_mode As String, ByRef critical_type As String) As Boolean
		Dim tx, ty As Short
		Dim sx, sy As Short
		Dim nx, ny As Short
		Dim dx, dy As Short
		Dim is_crashed As Boolean
		Dim t2 As Unit
		Dim dmg2, orig_dmg As Integer
		Dim wlevel As Short
		Dim i, prob As Short
		Dim is_critical As Boolean
		Dim td As TerrainData
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "蜷ｹ") And t.SpecialEffectImmune("蜷ｹ") Then
			Exit Function
		End If
		If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") And t.SpecialEffectImmune("Invalid_string_refer_to_original_code") Then
			Exit Function
		End If
		
		wlevel = MaxLng(WeaponLevel(w, "蜷ｹ"), WeaponLevel(w, "Invalid_string_refer_to_original_code"))
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = 100
		prob = CriticalProbability(w, t, def_mode)
		'End If
		
		'Invalid_string_refer_to_original_code
		If prob >= Dice(100) Then
			wlevel = wlevel + 1
			is_critical = True
		End If
		
		'Invalid_string_refer_to_original_code
		If wlevel = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If t.Size = "XL" Then
			Exit Function
		End If
		If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
			Select Case Size
				Case "SS"
					If t.Size <> "SS" And t.Size <> "S" Then
						Exit Function
					End If
				Case "S"
					If t.Size = "L" Or t.Size = "LL" Then
						Exit Function
					End If
				Case "M"
					If t.Size = "LL" Then
						Exit Function
					End If
			End Select
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		If t.Data.Speed = 0 And t.Speed = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If t Is Me Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		sx = SelectedX
		sy = SelectedY
		sx = x
		sy = y
		'End If
		
		'Invalid_string_refer_to_original_code
		tx = t.x
		ty = t.y
		If Not IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
			If System.Math.Abs(sx - tx) > System.Math.Abs(sy - ty) Then
				If sx > tx Then
					dx = -1
				Else
					dx = 1
				End If
			ElseIf System.Math.Abs(sx - tx) < System.Math.Abs(sy - ty) Then 
				If sy > ty Then
					dy = -1
				Else
					dy = 1
				End If
			Else
				If Dice(2) = 1 Then
					If sx > tx Then
						dx = -1
					Else
						dx = 1
					End If
				Else
					If sy > ty Then
						dy = -1
					Else
						dy = 1
					End If
				End If
			End If
		Else
			'Invalid_string_refer_to_original_code
			If System.Math.Abs(sx - tx) > System.Math.Abs(sy - ty) Then
				If Dice(2) = 1 Then
					dy = 1
				Else
					dy = -1
				End If
			ElseIf System.Math.Abs(sx - tx) < System.Math.Abs(sy - ty) Then 
				If Dice(2) = 1 Then
					dx = 1
				Else
					dx = -1
				End If
			ElseIf sx = tx And sx = ty Then 
				Select Case Dice(4)
					Case 1
						dx = -1
					Case 2
						dx = 1
					Case 3
						dy = -1
					Case 4
						dy = 1
				End Select
			Else
				If Dice(2) = 1 Then
					If sx > tx Then
						dx = 1
					Else
						dx = -1
					End If
				Else
					If sy > ty Then
						dy = 1
					Else
						dy = -1
					End If
				End If
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		nx = tx
		ny = ty
		i = 1
		Do While i <= wlevel
			nx = nx + dx
			ny = ny + dy
			
			'Invalid_string_refer_to_original_code
			'MOD START 240a
			'        Set td = TDList.Item(MapData(X, Y, 0))
			Select Case MapData(x, y, Map.MapDataIndex.BoxType)
				Case Map.BoxTypes.Under, Map.BoxTypes.UpperBmpOnly
					td = TDList.Item(MapData(x, y, Map.MapDataIndex.TerrainType))
				Case Else
					td = TDList.Item(MapData(x, y, Map.MapDataIndex.LayerType))
			End Select
			'MOD START 240a
			With td
				'Invalid_string_refer_to_original_code_
				'(t.Area = "豌ｴ荳ｭ" And (.Class = "豌ｴ" Or .Class = "豺ｱ豌ｴ")) Or _
				't.Area = Class _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If .IsFeatureAvailable("鞫ｩ謫ｦ") Then
					i = i + .FeatureLevel("鞫ｩ謫ｦ")
				End If
				'End If
			End With
			
			'繝槭ャ繝礼ｫｯ
			If nx < 1 Or MapWidth < nx Or ny < 1 Or MapHeight < ny Then
				nx = nx - dx
				ny = ny - dy
				Exit Do
			End If
			
			'Invalid_string_refer_to_original_code
			If Not t.IsAbleToEnter(nx, ny) Or Not MapDataForUnit(nx, ny) Is Nothing Then
				is_crashed = True
				
				If Not MapDataForUnit(nx, ny) Is Nothing Then
					t2 = MapDataForUnit(nx, ny)
				End If
				
				nx = nx - dx
				ny = ny - dy
				Exit Do
			End If
			
			'Invalid_string_refer_to_original_code
			If t.Area <> "遨ｺ荳ｭ" Then
				If TerrainHasObstacle(nx, ny) Then
					is_crashed = True
				End If
			End If
			
			i = i + 1
		Loop 
		
		'Invalid_string_refer_to_original_code
		If tx <> nx Or ty <> ny Then
			EraseUnitBitmap(tx, ty)
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			PlayAnimation("Invalid_string_refer_to_original_code")
		Else
			MoveUnitBitmap(t, tx, ty, nx, ny, 20)
		End If
		t.Jump(nx, ny, False)
		'End If
		
		'Invalid_string_refer_to_original_code
		orig_dmg = dmg
		If is_crashed Then
			dmg = orig_dmg + MaxLng((orig_dmg - t.Armor * t.MainPilot.Morale \ 100) \ 2, 0)
			
			'譛菴弱ム繝｡繝ｼ繧ｸ
			If def_mode = "髦ｲ蠕｡" Then
				dmg = MaxLng(dmg, 5)
			Else
				dmg = MaxLng(dmg, 10)
			End If
			
			PlayWave("Crash.wav")
		End If
		
		'Invalid_string_refer_to_original_code
		If Not t2 Is Nothing And Not t2 Is t Then
			With t2
				dmg2 = (orig_dmg - .Armor * .MainPilot.Morale \ 100) \ 2
				
				'譛菴弱ム繝｡繝ｼ繧ｸ
				If dmg2 < 10 Then
					dmg2 = 10
				End If
				
				'Invalid_string_refer_to_original_code
				If .IsConditionSatisfied("辟｡謨ｵ") Then
					dmg2 = 0
				End If
				
				'Invalid_string_refer_to_original_code
				If .HP - dmg2 < 10 Then
					dmg2 = .HP - 10
				End If
				
				'繝繝｡繝ｼ繧ｸ驕ｩ逕ｨ
				If dmg2 > 0 Then
					.HP = .HP - dmg2
				Else
					dmg2 = 0
				End If
				
				'繝繝｡繝ｼ繧ｸ驥剰｡ｨ遉ｺ
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				DrawSysString(.x, .y, VB6.Format(dmg2), True)
			End With
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'UPGRADE_WARNING: CheckBlowAttack に変換されていないステートメントがあります。ソース コードを確認してください。
		'End If
		
		'繝繝｡繝ｼ繧ｸ繧貞女縺代ｌ縺ｰ逵繧翫°繧峨＆繧√ｋ
		'UPGRADE_WARNING: CheckBlowAttack に変換されていないステートメントがあります。ソース コードを確認してください。
		'End With
		'End If
		
		msg = t.Nickname & "Invalid_string_refer_to_original_code" & msg
		If is_critical Then
			msg = "Invalid_string_refer_to_original_code" & msg
		End If
		
		'Invalid_string_refer_to_original_code
		critical_type = critical_type & "Invalid_string_refer_to_original_code"
		CheckBlowAttack = True
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CheckDrawAttack(ByVal w As Short, ByRef t As Unit, ByRef msg As String, ByRef def_mode As String, ByRef critical_type As String) As Boolean
		Dim tx, ty As Short
		Dim sx, sy As Short
		Dim nx, ny As Short
		Dim prob As Short
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If System.Math.Abs(x - tx) + System.Math.Abs(y - ty) = 1 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If t.Size = "XL" Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		If t.Data.Speed = 0 And t.Speed = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If t Is Me Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = 100
		prob = CriticalProbability(w, t, def_mode)
		'End If
		
		'Invalid_string_refer_to_original_code
		If Dice(100) > prob Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		sx = SelectedX
		sy = SelectedY
		sx = x
		sy = y
		'End If
		
		'Invalid_string_refer_to_original_code
		tx = t.x
		ty = t.y
		
		'Invalid_string_refer_to_original_code
		If sx = tx And sy = ty Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If MapDataForUnit(sx, sy) Is Nothing Then
			nx = sx
			ny = sy
		ElseIf System.Math.Abs(sx - tx) > System.Math.Abs(sy - ty) Then 
			If sx > tx Then
				nx = sx - 1
			Else
				nx = sx + 1
			End If
			ny = y
			
			If Not MapDataForUnit(nx, ny) Is Nothing Then
				If sy <> ty Then
					If sy > ty Then
						If MapDataForUnit(sx, sy - 1) Is Nothing Then
							nx = sx
							ny = sy - 1
						ElseIf MapDataForUnit(nx, sy - 1) Is Nothing Then 
							ny = sy - 1
						End If
					Else
						If MapDataForUnit(sx, sy + 1) Is Nothing Then
							nx = sx
							ny = sy + 1
						ElseIf MapDataForUnit(nx, sy + 1) Is Nothing Then 
							ny = sy + 1
						End If
					End If
				End If
			End If
		ElseIf System.Math.Abs(sx - tx) < System.Math.Abs(sy - ty) Then 
			nx = sx
			If sy > ty Then
				ny = sy - 1
			Else
				ny = sy + 1
			End If
			
			If Not MapDataForUnit(nx, ny) Is Nothing Then
				If sx <> tx Then
					If sx > tx Then
						If MapDataForUnit(sx - 1, sy) Is Nothing Then
							nx = sx - 1
							ny = sy
						ElseIf MapDataForUnit(sx - 1, ny) Is Nothing Then 
							nx = sx - 1
						End If
					Else
						If MapDataForUnit(sx + 1, sy) Is Nothing Then
							nx = sx + 1
							ny = sy
						ElseIf MapDataForUnit(sx + 1, ny) Is Nothing Then 
							nx = sx + 1
						End If
					End If
				End If
			End If
		Else
			If Dice(2) = 1 Then
				If sx > tx Then
					nx = sx - 1
				Else
					nx = sx + 1
				End If
				ny = sy
				
				If Not MapDataForUnit(nx, ny) Is Nothing Then
					nx = sx
					If sy > ty Then
						ny = sy - 1
					Else
						ny = sy + 1
					End If
				End If
			Else
				nx = sx
				If sy > ty Then
					ny = sy - 1
				Else
					ny = sy + 1
				End If
				
				If Not MapDataForUnit(nx, ny) Is Nothing Then
					If sx > tx Then
						nx = sx - 1
					Else
						nx = sx + 1
					End If
					ny = sy
				End If
			End If
			
			If Not MapDataForUnit(nx, ny) Is Nothing Then
				If sx > tx Then
					nx = sx - 1
				Else
					nx = sx + 1
				End If
				If sy > ty Then
					ny = sy - 1
				Else
					ny = sy + 1
				End If
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If nx = tx And ny = ty Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		t.Jump(nx, ny)
		
		'Invalid_string_refer_to_original_code
		If t.x = tx And t.y = ty Then
			Exit Function
		End If
		
		msg = t.Nickname & "Invalid_string_refer_to_original_code" & msg
		
		'Invalid_string_refer_to_original_code
		critical_type = critical_type & "Invalid_string_refer_to_original_code"
		CheckDrawAttack = True
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CheckTeleportAwayAttack(ByVal w As Short, ByRef t As Unit, ByRef msg As String, ByRef def_mode As String, ByRef critical_type As String) As Boolean
		Dim tx, ty As Short
		Dim nx, ny As Short
		Dim d, prob, i As Short
		
		'Invalid_string_refer_to_original_code
		If t.SpecialEffectImmune("霆｢") Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If t.Size = "XL" Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		If t.Data.Speed = 0 And t.Speed = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If t Is Me Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = 100
		prob = CriticalProbability(w, t, def_mode)
		'End If
		
		'Invalid_string_refer_to_original_code
		If Dice(100) > prob Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		tx = t.x
		ty = t.y
		For i = 1 To 10
			d = Dice(WeaponLevel(w, "霆｢"))
			If Dice(2) = 1 Then
				nx = tx + d
			Else
				nx = tx - d
			End If
			
			d = WeaponLevel(w, "霆｢") - d
			If Dice(2) = 1 Then
				ny = ty + d
			Else
				ny = ty - d
			End If
			
			If 1 <= nx And nx <= MapWidth And 1 <= ny And ny <= MapHeight Then
				Exit For
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		If i > 10 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		t.Jump(nx, ny)
		
		'Invalid_string_refer_to_original_code
		If t.x = tx And t.y = ty Then
			Exit Function
		End If
		
		msg = t.Nickname & "Invalid_string_refer_to_original_code" & msg
		
		'Invalid_string_refer_to_original_code
		critical_type = critical_type & " 蠑ｷ蛻ｶ霆｢遘ｻ"
		CheckTeleportAwayAttack = True
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CheckMetamorphAttack(ByVal w As Short, ByRef t As Unit, ByRef def_mode As String) As Boolean
		Dim prob, wlv As Short
		Dim uname As String
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If t.BossRank >= 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If t Is Me Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Select Case Size
			Case "SS"
				Select Case t.Size
					Case "M", "L", "LL", "XL"
						Exit Function
				End Select
			Case "S"
				Select Case t.Size
					Case "L", "LL", "XL"
						Exit Function
				End Select
			Case "M"
				Select Case t.Size
					Case "SS", "LL", "XL"
						Exit Function
				End Select
			Case "L"
				Select Case t.Size
					Case "SS", "S", "XL"
						Exit Function
				End Select
			Case "LL"
				Select Case t.Size
					Case "SS", "S", "M"
						Exit Function
				End Select
			Case "XL"
				Select Case t.Size
					Case "SS", "S", "M", "L"
						Exit Function
				End Select
		End Select
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		prob = 100
		prob = CriticalProbability(w, t, def_mode)
		'End If
		
		'Invalid_string_refer_to_original_code
		If Dice(100) > prob Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Not OtherForm((t.Name)).IsAbleToEnter(x, y) Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		uname = Nickname
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		'螟芽ｺｫ
		Transform((t.Name))
		
		With CurrentForm
			'Invalid_string_refer_to_original_code
			If wlv > 0 Then
				.AddCondition("谿九ｊ譎る俣", wlv)
			End If
			.AddCondition("Invalid_string_refer_to_original_code", -1, 1, Name & " 謇句虚隗｣髯､蜿ｯ")
			.AddCondition("Invalid_string_refer_to_original_code", -1)
			
			'Invalid_string_refer_to_original_code
			.AddCondition("Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			.AddCondition("Invalid_string_refer_to_original_code", -1, 0, "髱櫁｡ｨ遉ｺ " & t.MainPilot.MessageType)
		End With
		
		DisplaySysMessage(uname & "縺ｯ" & t.Nickname & "Invalid_string_refer_to_original_code")
		
		'Invalid_string_refer_to_original_code
		CheckMetamorphAttack = True
	End Function
	
	
	'Invalid_string_refer_to_original_code
	Public Sub MapAttack(ByVal w As Short, ByVal tx As Short, ByVal ty As Short, Optional ByVal is_event As Boolean = False)
		Dim k, i, j, num As Short
		Dim t, u As Unit
		Dim prev_level As Short
		Dim earned_exp As Integer
		Dim prev_money, earnings As Integer
		Dim prev_stype() As String
		Dim prev_sname() As String
		Dim prev_slevel() As Double
		Dim sname As String
		Dim prev_special_power() As String
		Dim msg As String
		Dim partners() As Unit
		Dim wname, wnickname As String
		Dim targets() As Unit
		Dim targets_hp_ratio() As Double
		Dim targets_x() As Short
		Dim targets_y() As Short
		Dim rx, ry As Short
		Dim min_range, max_range As Short
		Dim uname, fname As String
		Dim hp_ratio, en_ratio As Double
		Dim itm As Item
		
		wname = Weapon(w).Name
		SelectedWeaponName = wname
		wnickname = WeaponNickname(w)
		
		'Invalid_string_refer_to_original_code
		min_range = Weapon(w).MinRange
		max_range = WeaponMaxRange(w)
		If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
			If ty < y Then
				AreaInLine(x, y, min_range, max_range, "N")
			ElseIf ty > y Then 
				AreaInLine(x, y, min_range, max_range, "S")
			ElseIf tx < x Then 
				AreaInLine(x, y, min_range, max_range, "W")
			Else
				AreaInLine(x, y, min_range, max_range, "E")
			End If
		ElseIf IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then 
			If ty < y And System.Math.Abs(y - ty) > System.Math.Abs(x - tx) Then
				AreaInCone(x, y, min_range, max_range, "N")
			ElseIf ty > y And System.Math.Abs(y - ty) > System.Math.Abs(x - tx) Then 
				AreaInCone(x, y, min_range, max_range, "S")
			ElseIf tx < x And System.Math.Abs(x - tx) > System.Math.Abs(y - ty) Then 
				AreaInCone(x, y, min_range, max_range, "W")
			Else
				AreaInCone(x, y, min_range, max_range, "E")
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If ty < y And System.Math.Abs(y - ty) >= System.Math.Abs(x - tx) Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			ElseIf ty > y And System.Math.Abs(y - ty) >= System.Math.Abs(x - tx) Then 
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			ElseIf tx < x And System.Math.Abs(x - tx) >= System.Math.Abs(y - ty) Then 
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		ElseIf IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then 
			AreaInRange(x, y, max_range, min_range, "縺吶∋縺ｦ")
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			AreaInPointToPoint(x, y, tx, ty)
		End If
		MaskData(x, y) = False
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		For	Each u In UList
			With u
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If IsAlly(u) Or WeaponAdaption(w, .Area) = 0 Then
					MaskData(.x, .y) = True
				End If
				'End If
			End With
		Next u
		MaskData(x, y) = False
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Dim TmpMaskData() As Boolean
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		ReDim TmpMaskData(MapWidth, MapHeight)
		For i = 1 To MapWidth
			For j = 1 To MapHeight
				TmpMaskData(i, j) = MaskData(i, j)
			Next 
		Next 
		
		CombinationPartner("Invalid_string_refer_to_original_code")
		
		For i = 1 To UBound(partners)
			With partners(i)
				MaskData(.x, .y) = False
				TmpMaskData(.x, .y) = True
			End With
		Next 
		
		MaskScreen()
		For i = 1 To MapWidth
			For j = 1 To MapHeight
				MaskData(i, j) = TmpMaskData(i, j)
			Next 
		Next 
		Dim min_item, min_value As Short
		Dim uparty As String
		Dim found As Boolean
		ReDim partners(0)
		ReDim SelectedPartners(0)
		MaskScreen()
		'End If
		
		'Invalid_string_refer_to_original_code
		MaskData(x, y) = True
		
		'Invalid_string_refer_to_original_code
		ReDim targets(0)
		For i = 1 To MapWidth
			For j = 1 To MapHeight
				'Invalid_string_refer_to_original_code
				If MaskData(i, j) Then
					GoTo NextLoop
				End If
				If MapDataForUnit(i, j) Is Nothing Then
					GoTo NextLoop
				End If
				
				t = MapDataForUnit(i, j)
				With t
					If WeaponAdaption(w, .Area) = 0 Then
						GoTo NextLoop
					End If
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If IsAlly(t) Then
						GoTo NextLoop
					End If
					'End If
					If .IsUnderSpecialPowerEffect("髫繧瑚ｺｫ") Then
						GoTo NextLoop
					End If
					
					ReDim Preserve targets(UBound(targets) + 1)
					targets(UBound(targets)) = t
				End With
NextLoop: 
			Next 
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		rx = tx
		ry = ty
		rx = x
		ry = y
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(targets) - 1
			
			min_item = i
			With targets(i)
				min_value = System.Math.Abs(.x - rx) + System.Math.Abs(.y - ry)
			End With
			For j = i + 1 To UBound(targets)
				With targets(j)
					If System.Math.Abs(.x - rx) + System.Math.Abs(.y - ry) < min_value Then
						min_item = j
						min_value = System.Math.Abs(.x - rx) + System.Math.Abs(.y - ry)
					End If
				End With
			Next 
			If min_item <> i Then
				u = targets(i)
				targets(i) = targets(min_item)
				targets(min_item) = u
			End If
		Next 
		
		'謌ｦ髣伜燕縺ｫ荳譌ｦ繧ｯ繝ｪ繧｢
		'UPGRADE_NOTE: オブジェクト SupportAttackUnit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SupportAttackUnit = Nothing
		'UPGRADE_NOTE: オブジェクト SupportGuardUnit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SupportGuardUnit = Nothing
		'UPGRADE_NOTE: オブジェクト SupportGuardUnit2 をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SupportGuardUnit2 = Nothing
		
		'Invalid_string_refer_to_original_code
		If Not is_event Then
			'Invalid_string_refer_to_original_code
			HandleEvent("菴ｿ逕ｨ", MainPilot.ID, wname)
			If IsScenarioFinished Then
				IsScenarioFinished = False
				Exit Sub
			End If
			If IsCanceled Then
				IsCanceled = False
				Exit Sub
			End If
			
			'Invalid_string_refer_to_original_code
			For i = 1 To UBound(targets)
				t = targets(i)
				SaveSelections()
				SelectedTarget = t
				HandleEvent("Invalid_string_refer_to_original_code")
				RestoreSelections()
				If IsScenarioFinished Or IsCanceled Then
					Exit Sub
				End If
			Next 
		End If
		
		'Invalid_string_refer_to_original_code
		If Not is_event Then
			'Invalid_string_refer_to_original_code_
			'Or MaxAction(True) = 0 _
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Sub
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		ReDim targets_hp_ratio(UBound(targets))
		ReDim targets_x(UBound(targets))
		ReDim targets_y(UBound(targets))
		For i = 1 To UBound(targets)
			t = targets(i).CurrentForm
			targets(i) = t
			With t
				targets_hp_ratio(i) = .HP / .MaxHP
				targets_x(i) = .x
				targets_y(i) = .y
			End With
		Next 
		
		OpenMessageForm(Me)
		
		'Invalid_string_refer_to_original_code
		SaveSelections()
		
		'Invalid_string_refer_to_original_code
		SelectedUnit = Me
		SelectedUnitForEvent = Me
		SelectedWeapon = w
		SelectedX = tx
		SelectedY = ty
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_NOTE: オブジェクト SelectedTarget をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SelectedTarget = Nothing
		'UPGRADE_NOTE: オブジェクト SelectedTargetForEvent をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SelectedTargetForEvent = Nothing
		
		'Invalid_string_refer_to_original_code
		If IsAnimationDefined(wname & "(貅門ｙ)") Then
			PlayAnimation(wname & "(貅門ｙ)")
		ElseIf IsAnimationDefined(wname) And Not IsOptionDefined("豁ｦ蝎ｨ貅門ｙ繧｢繝九Γ髱櫁｡ｨ遉ｺ") And WeaponAnimation Then 
			PlayAnimation(wname & "(貅門ｙ)")
		ElseIf IsSpecialEffectDefined(wname & "(貅門ｙ)") Then 
			SpecialEffect(wname & "(貅門ｙ)")
		End If
		
		'Invalid_string_refer_to_original_code
		If IsMessageDefined(wname) Then
			If IsMessageDefined("縺九¢螢ｰ(" & wname & ")") Then
				PilotMessage("縺九¢螢ｰ(" & wname & ")")
			Else
				PilotMessage("縺九¢螢ｰ")
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		PilotMessage(wname, "Invalid_string_refer_to_original_code")
		
		'謌ｦ髣倥い繝九Γ or 蜉ｹ譫憺浹
		If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Or IsAnimationDefined(wname) Then
			PlayAnimation(wname & "Invalid_string_refer_to_original_code")
		ElseIf IsSpecialEffectDefined(wname) Then 
			SpecialEffect(wname)
		Else
			AttackEffect(Me, w)
		End If
		
		'Invalid_string_refer_to_original_code
		SelectedMapAttackPower = 0
		SelectedMapAttackPower = WeaponPower(w, "蛻晄悄蛟､")
		
		'Invalid_string_refer_to_original_code
		IsMapAttackCanceled = False
		
		'Invalid_string_refer_to_original_code
		UseWeapon(w)
		UpdateMessageForm(Me)
		
		'Invalid_string_refer_to_original_code
		If IsSysMessageDefined(wname) Then
			'Invalid_string_refer_to_original_code
			SysMessage(wname)
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			SysMessage(wname)
		End If
		'Invalid_string_refer_to_original_code_
		'And (InStr(wnickname, "繝溘し繧､繝ｫ") > 0 _
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Or Right$(wnickname, 4) = "繝ｬ繝ｼ繧ｶ繝ｼ" _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		'UPGRADE_WARNING: MapAttack に変換されていないステートメントがあります。ソース コードを確認してください。
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		msg = msg & "[" & wnickname & "Invalid_string_refer_to_original_code"
		'End If
		
		'Invalid_string_refer_to_original_code
		DisplaySysMessage(msg)
		'End If
		
		'Invalid_string_refer_to_original_code
		PilotMessage(wname & "(蜻ｽ荳ｭ)")
		
		'Invalid_string_refer_to_original_code
		RestoreSelections()
		
		'Invalid_string_refer_to_original_code
		With MainPilot
			prev_level = .Level
			ReDim prev_special_power(.CountSpecialPower)
			For i = 1 To .CountSpecialPower
				prev_special_power(i) = .SpecialPower(i)
			Next 
			ReDim prev_stype(.CountSkill)
			ReDim prev_slevel(.CountSkill)
			ReDim prev_sname(.CountSkill)
			For i = 1 To .CountSkill
				prev_stype(i) = .Skill(i)
				prev_slevel(i) = .SkillLevel(i, "蝓ｺ譛ｬ蛟､")
				prev_sname(i) = .SkillName(i)
			Next 
		End With
		prev_money = Money
		
		'Invalid_string_refer_to_original_code
		SelectedTarget = Me
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
			Jump(tx, ty)
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(targets)
			t = targets(i).CurrentForm
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If Party = "蜻ｳ譁ｹ" Or Party = "Invalid_string_refer_to_original_code" Then
				UpdateMessageForm(t, Me)
			Else
				UpdateMessageForm(Me, t)
			End If
			
			'Invalid_string_refer_to_original_code
			Attack(w, t, "Invalid_string_refer_to_original_code")
			
			'Invalid_string_refer_to_original_code
			If Not SupportGuardUnit Is Nothing Then
				targets(i) = SupportGuardUnit.CurrentForm
				targets_hp_ratio(i) = SupportGuardUnitHPRatio
				targets_x(i) = targets(i).x
				targets_y(i) = targets(i).y
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Or CountPilot = 0 _
			'Or IsMapAttackCanceled _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			CloseMessageForm()
			SelectedMapAttackPower = 0
			GoTo DoEvent
			'End If
			
			ClearMessageForm()
			'End If
		Next 
		
		'Invalid_string_refer_to_original_code
		If IsMessageDefined(wname & "Invalid_string_refer_to_original_code") Then
			PilotMessage(wname & "Invalid_string_refer_to_original_code")
		End If
		If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Then
			PlayAnimation(wname & "Invalid_string_refer_to_original_code")
		ElseIf IsSpecialEffectDefined(wname & "Invalid_string_refer_to_original_code") Then 
			SpecialEffect(wname & "Invalid_string_refer_to_original_code")
		End If
		
		'Invalid_string_refer_to_original_code
		If IsPictureVisible Then
			ClearPicture()
			'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
			MainForm.picMain(0).Refresh()
		End If
		
		'Invalid_string_refer_to_original_code
		SelectedMapAttackPower = 0
		
		' ADD START MARGE
		'Invalid_string_refer_to_original_code
		If IsAnimationDefined(wname & "Invalid_string_refer_to_original_code") Then
			PlayAnimation(wname & "Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			PlayAnimation("Invalid_string_refer_to_original_code")
		End If
		' ADD END MARGE
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		DeleteCondition("Invalid_string_refer_to_original_code")
		BitmapID = MakeUnitBitmap(Me)
		If IsPictureVisible Then
			PaintUnitBitmap(Me, "Invalid_string_refer_to_original_code")
		Else
			PaintUnitBitmap(Me)
		End If
		'End If
		If IsConditionSatisfied("髱櫁｡ｨ遉ｺ莉伜刈") Then
			DeleteCondition("髱櫁｡ｨ遉ｺ莉伜刈")
			BitmapID = MakeUnitBitmap(Me)
			If IsPictureVisible Then
				PaintUnitBitmap(Me, "Invalid_string_refer_to_original_code")
			Else
				PaintUnitBitmap(Me)
			End If
		End If
		For i = 1 To UBound(partners)
			With partners(i).CurrentForm
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.DeleteCondition("Invalid_string_refer_to_original_code")
				.BitmapID = MakeUnitBitmap(partners(i).CurrentForm)
				PaintUnitBitmap(partners(i).CurrentForm)
				'End If
				If .IsConditionSatisfied("髱櫁｡ｨ遉ｺ莉伜刈") Then
					.DeleteCondition("髱櫁｡ｨ遉ｺ莉伜刈")
					.BitmapID = MakeUnitBitmap(partners(i).CurrentForm)
					PaintUnitBitmap(partners(i).CurrentForm)
				End If
			End With
		Next 
		
		If Party = "蜻ｳ譁ｹ" And Not is_event Then
			'Invalid_string_refer_to_original_code
			For i = 1 To UBound(targets)
				t = targets(i).CurrentForm
				If Not IsEnemy(t) Then
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					
					'Invalid_string_refer_to_original_code
					If Not IsOptionDefined("Invalid_string_refer_to_original_code") Then
						For j = 1 To UBound(partners)
							partners(j).CurrentForm.GetExp(t, "Invalid_string_refer_to_original_code")
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						Next 
					End If
					
					'Invalid_string_refer_to_original_code
					earnings = t.Value \ 2
					
					'Invalid_string_refer_to_original_code
					If IsUnderSpecialPowerEffect("Invalid_string_refer_to_original_code") Then
						earnings = MinDbl(earnings * (1 + 0.1 * SpecialPowerEffectLevel("Invalid_string_refer_to_original_code")), 999999999)
					End If
					
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				End If
			Next 
		End If
		
		'Invalid_string_refer_to_original_code
		IncrMoney(earnings)
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		'Invalid_string_refer_to_original_code
		If Not IsOptionDefined("Invalid_string_refer_to_original_code") Then
			For j = 1 To UBound(partners)
				partners(j).CurrentForm.GetExp(t, "Invalid_string_refer_to_original_code")
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Next 
		End If
		'End If
		'Next
		
		'Invalid_string_refer_to_original_code
		If Money > prev_money Then
			DisplaySysMessage(VB6.Format(Money - prev_money) & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
		End If
		With MainPilot
			'Invalid_string_refer_to_original_code
			If .Level > prev_level Then
				If IsAnimationDefined("Invalid_string_refer_to_original_code") Then
					PlayAnimation("Invalid_string_refer_to_original_code")
				ElseIf IsSpecialEffectDefined("Invalid_string_refer_to_original_code") Then 
					SpecialEffect("Invalid_string_refer_to_original_code")
				End If
				If IsMessageDefined("Invalid_string_refer_to_original_code") Then
					PilotMessage("Invalid_string_refer_to_original_code")
				End If
				
				msg = .Nickname & "縺ｯ" & VB6.Format(earned_exp) & "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				'Invalid_string_refer_to_original_code
				For i = 1 To .CountSkill
					sname = .Skill(i)
					If InStr(.SkillName(i), "髱櫁｡ｨ遉ｺ") = 0 Then
						Select Case sname
							Case "Invalid_string_refer_to_original_code"
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							Case Else
								For j = 1 To UBound(prev_stype)
									If sname = prev_stype(j) Then
										Exit For
									End If
								Next 
								If j > UBound(prev_stype) Then
									msg = msg & ";" & .SkillName(i) & "Invalid_string_refer_to_original_code"
								ElseIf .SkillLevel(sname, "蝓ｺ譛ｬ蛟､") > prev_slevel(j) Then 
									msg = msg & ";" & prev_sname(j) & " => " & .SkillName(i) & "Invalid_string_refer_to_original_code"
								End If
						End Select
					End If
				Next 
				
				'Invalid_string_refer_to_original_code
				If .CountSpecialPower > UBound(prev_special_power) Then
					msg = msg & ";繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ"
					For i = 1 To .CountSpecialPower
						sname = .SpecialPower(i)
						For j = 1 To UBound(prev_special_power)
							If sname = prev_special_power(j) Then
								Exit For
							End If
						Next 
						If j > UBound(prev_special_power) Then
							msg = msg & "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						End If
					Next 
					msg = msg & "Invalid_string_refer_to_original_code"
				End If
				
				DisplaySysMessage(msg)
				
				HandleEvent("Invalid_string_refer_to_original_code", .ID)
				
				PList.UpdateSupportMod(Me)
			Else
				If earned_exp > 0 Then
					DisplaySysMessage(.Nickname & "縺ｯ" & VB6.Format(earned_exp) & "Invalid_string_refer_to_original_code")
				End If
			End If
		End With
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		AddCondition("Invalid_string_refer_to_original_code")
		'End If
		RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
		RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
		If earnings > 0 Then
			RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
		End If
		For i = 1 To UBound(targets)
			targets(i).CurrentForm.RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
		Next 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(targets)
			targets(i).CurrentForm.UpdateCondition()
		Next 
		
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			For i = 1 To UBound(targets)
				With targets(i).CurrentForm
					'Invalid_string_refer_to_original_code_
					'And .MaxAction > 0 _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					AddCondition("Invalid_string_refer_to_original_code", 1)
					Exit For
				End With
			Next 
		End If
		'End With
		'Next
		AddCondition("Invalid_string_refer_to_original_code", 1)
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(partners)
			With partners(i).CurrentForm
				For j = 1 To .CountWeapon
					If .Weapon(j).Name = wname Then
						.UseWeapon(j)
						If .IsWeaponClassifiedAs(j, "閾ｪ") Then
							If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
								uname = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), 2)
								If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
									.Transform(uname)
									With .CurrentForm
										.HP = .MaxHP
										.UsedAction = .MaxAction
									End With
								Else
									.Die()
								End If
							Else
								.Die()
							End If
						ElseIf .IsWeaponClassifiedAs(j, "螟ｱ") And .HP = 0 Then 
							.Die()
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If .IsFeatureAvailable("螟牙ｽ｢謚") Then
								For k = 1 To .CountFeature
									If .Feature(k) = "螟牙ｽ｢謚" And LIndex(.FeatureData(k), 1) = wname Then
										uname = LIndex(.FeatureData(k), 2)
										If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
											.Transform(uname)
										End If
										Exit For
									End If
								Next 
								If uname <> .CurrentForm.Name Then
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
										.Transform(uname)
									End If
								End If
							End If
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
								.Transform(uname)
							End If
						End If
					End If
					Exit For
					'End If
				Next 
				
				'Invalid_string_refer_to_original_code
				If j > .CountWeapon Then
					If Weapon(w).ENConsumption > 0 Then
						.EN = .EN - WeaponENConsumption(w)
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					.AddCondition("Invalid_string_refer_to_original_code")
				End If
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.DeleteCondition("Invalid_string_refer_to_original_code")
				'End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				hp_ratio = 100 * .HP / .MaxHP
				en_ratio = 100 * .EN / .MaxEN
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				.HP = .MaxHP * hp_ratio / 100
				.EN = .MaxEN * en_ratio / 100
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				hp_ratio = 100 * .HP / .MaxHP
				en_ratio = 100 * .EN / .MaxEN
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				.HP = .MaxHP * hp_ratio / 100
				.EN = .MaxEN * en_ratio / 100
				'End If
				If IsWeaponClassifiedAs(w, "螟ｱ") Then
					.HP = MaxLng(.HP - .MaxHP * WeaponLevel(w, "螟ｱ") \ 10, 0)
				End If
				If IsWeaponClassifiedAs(w, "閾ｪ") Then
					If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						uname = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), 2)
						If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
							.Transform(uname)
							With .CurrentForm
								.HP = .MaxHP
								.UsedAction = .MaxAction
							End With
						Else
							.Die()
						End If
					Else
						.Die()
					End If
				ElseIf IsWeaponClassifiedAs(w, "螟ｱ") And .HP = 0 Then 
					.Die()
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
						.Transform(uname)
					End If
				End If
				'End If
				'End If
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		
		'Invalid_string_refer_to_original_code
		If IsWeaponClassifiedAs(w, "閾ｪ") Then
			If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				uname = LIndex(FeatureData("Invalid_string_refer_to_original_code"), 2)
				If OtherForm(uname).IsAbleToEnter(x, y) Then
					Transform(uname)
					With CurrentForm
						.HP = .MaxHP
						.UsedAction = .MaxAction
					End With
					fname = FeatureName("Invalid_string_refer_to_original_code")
					If IsSysMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then
						SysMessage("Invalid_string_refer_to_original_code" & Name & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
						SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
						SysMessage("Invalid_string_refer_to_original_code")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then 
						SysMessage("Invalid_string_refer_to_original_code" & Name & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
						SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
						SysMessage("Invalid_string_refer_to_original_code")
					Else
						DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
					End If
				Else
					Die()
					CloseMessageForm()
					If Not is_event Then
						HandleEvent("Invalid_string_refer_to_original_code")
						If IsScenarioFinished Then
							Exit Sub
						End If
					End If
				End If
			Else
				Die()
				CloseMessageForm()
				If Not is_event Then
					HandleEvent("Invalid_string_refer_to_original_code")
					If IsScenarioFinished Then
						Exit Sub
					End If
				End If
			End If
			
			'Invalid_string_refer_to_original_code
		ElseIf IsWeaponClassifiedAs(w, "螟ｱ") And HP = 0 Then 
			Die()
			CloseMessageForm()
			If Not is_event Then
				HandleEvent("Invalid_string_refer_to_original_code")
				If IsScenarioFinished Then
					Exit Sub
				End If
			End If
			
			'螟牙ｽ｢謚
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If IsFeatureAvailable("螟牙ｽ｢謚") Then
				For i = 1 To CountFeature
					If Feature(i) = "螟牙ｽ｢謚" And LIndex(FeatureData(i), 1) = wname Then
						uname = LIndex(FeatureData(i), 2)
						If OtherForm(uname).IsAbleToEnter(x, y) Then
							Transform(uname)
						End If
						Exit For
					End If
				Next 
				If uname <> CurrentForm.Name Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If OtherForm(uname).IsAbleToEnter(x, y) Then
						Transform(uname)
					End If
				End If
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If OtherForm(uname).IsAbleToEnter(x, y) Then
				Transform(uname)
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: MapAttack に変換されていないステートメントがあります。ソース コードを確認してください。
		'Invalid_string_refer_to_original_code
		num = Data.CountWeapon
		num = num + MainPilot.Data.CountWeapon
		For i = 2 To CountPilot
			num = num + Pilot(i).Data.CountWeapon
		Next 
		For i = 2 To CountSupport
			num = num + Support(i).Data.CountWeapon
		Next 
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		num = num + AdditionalSupport.Data.CountWeapon
		'End If
		For	Each itm In colItem
			num = num + itm.CountWeapon
			If w <= num Then
				itm.Exist = False
				DeleteItem((itm.ID))
				Exit For
			End If
		Next itm
		'End If
		
		CloseMessageForm()
		
DoEvent: 
		
		'Invalid_string_refer_to_original_code
		If Not is_event Then
			For i = 1 To UBound(targets)
				t = targets(i).CurrentForm
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				SaveSelections()
				SwapSelections()
				
				HandleEvent("Invalid_string_refer_to_original_code")
				
				RestoreSelections()
				If IsScenarioFinished Or IsCanceled Then
					Exit Sub
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If t.HP / t.MaxHP < targets_hp_ratio(i) Then
					'Invalid_string_refer_to_original_code
					SaveSelections()
					SwapSelections()
					
					HandleEvent("Invalid_string_refer_to_original_code")
					100 * (t.MaxHP - t.HP) \ t.MaxHP
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					
					RestoreSelections()
					If IsScenarioFinished Or IsCanceled Then
						Exit Sub
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				With t.CurrentForm
					'Invalid_string_refer_to_original_code_
					'And (.x <> targets_x(i) Or .y <> targets_y(i)) _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					HandleEvent("騾ｲ蜈･", .MainPilot.ID, .x, .y)
					If IsScenarioFinished Or IsCanceled Then
						Exit Sub
					End If
				End With
			Next 
		End If
		'End With
		'End If
		'Next
		
		'Invalid_string_refer_to_original_code
		For i = 1 To 4
			
			Select Case i
				Case 1
					uparty = "蜻ｳ譁ｹ"
				Case 2
					uparty = "Invalid_string_refer_to_original_code"
				Case 3
					uparty = "謨ｵ"
				Case 4
					uparty = "Invalid_string_refer_to_original_code"
			End Select
			
			found = False
			For j = 1 To UBound(targets)
				With targets(j).CurrentForm
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					found = True
					Exit For
					'End If
				End With
			Next 
			
			If found Then
				found = False
				For	Each u In UList
					With u
						'Invalid_string_refer_to_original_code_
						'Invalid_string_refer_to_original_code_
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						found = True
						Exit For
					End With
				Next u
			End If
			'End With
		Next 
		If Not found Then
			HandleEvent("Invalid_string_refer_to_original_code")
			If IsScenarioFinished Or IsCanceled Then
				Exit Sub
			End If
		End If
		'End If
		'Next
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		HandleEvent("Invalid_string_refer_to_original_code")
		If IsScenarioFinished Or IsCanceled Then
			Exit Sub
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		SaveSelections()
		For i = 1 To UBound(targets)
			SelectedTarget = targets(i).CurrentForm
			With SelectedTarget
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				HandleEvent("Invalid_string_refer_to_original_code")
				If IsScenarioFinished Then
					RestoreSelections()
					Exit Sub
				End If
				'End If
			End With
		Next 
		RestoreSelections()
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		UList.CheckAutoHyperMode()
		UList.CheckAutoNormalMode()
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub UseWeapon(ByVal w As Short)
		Dim i, lv As Short
		Dim hp_ratio, en_ratio As Double
		
		'Invalid_string_refer_to_original_code
		If Weapon(w).ENConsumption > 0 Then
			EN = EN - WeaponENConsumption(w)
		End If
		
		'蠑ｾ謨ｰ豸郁ｲｻ
		If Weapon(w).Bullet > 0 And Not IsWeaponClassifiedAs(w, "豌ｸ") Then
			SetBullet(w, Bullet(w) - 1)
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			For i = 1 To UBound(dblBullet)
				SetBullet(i, MinLng(MaxBullet(i) * dblBullet(w), Bullet(i)))
			Next 
		Else
			For i = 1 To UBound(dblBullet)
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				SetBullet(i, MinLng(CShort(MaxBullet(i) * dblBullet(w) + 0.49999), Bullet(i)))
			Next 
		End If
		'Next
		'End If
		
		'Invalid_string_refer_to_original_code
		SyncBullet()
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		AddCondition("Invalid_string_refer_to_original_code")
		'End If
		
		If IsWeaponClassifiedAs(w, "蟆ｽ") Then
			EN = 0
		End If
		
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		DeleteCondition("Invalid_string_refer_to_original_code")
		'End If
		
		If WeaponLevel(w, "Invalid_string_refer_to_original_code") > 0 Then
			AddCondition(WeaponNickname(w) & "Invalid_string_refer_to_original_code", WeaponLevel(w, "Invalid_string_refer_to_original_code"))
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		hp_ratio = 100 * HP / MaxHP
		en_ratio = 100 * EN / MaxEN
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		HP = MaxHP * hp_ratio / 100
		EN = MaxEN * en_ratio / 100
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		hp_ratio = 100 * HP / MaxHP
		en_ratio = 100 * EN / MaxEN
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		HP = MaxHP * hp_ratio / 100
		EN = MaxEN * en_ratio / 100
		'End If
		
		If Party = "蜻ｳ譁ｹ" Then
			If IsWeaponClassifiedAs(w, "驫ｭ") Then
				IncrMoney(-MaxLng(WeaponLevel(w, "驫ｭ"), 1) * Value \ 10)
			End If
		End If
		
		If IsWeaponClassifiedAs(w, "螟ｱ") Then
			HP = MaxLng(HP - MaxHP * WeaponLevel(w, "螟ｱ") \ 10, 0)
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'        AddCondition "蜷井ｽ捺橿菴ｿ逕ｨ荳榊庄", 1, 0, "髱櫁｡ｨ遉ｺ"
		'    End If
	End Sub
	
	'蠑ｾ謨ｰ
	Public Function Bullet(ByVal w As Short) As Short
		Bullet = dblBullet(w) * intMaxBullet(w)
	End Function
	
	'譛螟ｧ蠑ｾ謨ｰ
	Public Function MaxBullet(ByVal w As Short) As Short
		MaxBullet = intMaxBullet(w)
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub SetBullet(ByVal w As Short, ByVal new_bullet As Short)
		If new_bullet < 0 Then
			dblBullet(w) = 0
		ElseIf intMaxBullet(w) > 0 Then 
			dblBullet(w) = new_bullet / intMaxBullet(w)
		Else
			dblBullet(w) = 1
		End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub SyncBullet()
		Dim j, a, w, i, k As Short
		Dim lv, idx As Short
		
		'Invalid_string_refer_to_original_code
		For w = 1 To CountWeapon
			If IsWeaponClassifiedAs(w, "蜈ｱ") Then
				lv = WeaponLevel(w, "蜈ｱ")
				'Invalid_string_refer_to_original_code
				For i = 1 To CountWeapon
					If w <> i And IsWeaponClassifiedAs(i, "蜈ｱ") And lv = WeaponLevel(i, "蜈ｱ") And MaxBullet(w) > 0 Then
						If MaxBullet(i) > MaxBullet(w) Then
							SetBullet(i, MinLng(Bullet(i), MaxBullet(i) * Bullet(w) \ MaxBullet(w)))
						Else
							SetBullet(i, MinLng(Bullet(i), CShort(MaxBullet(i) * Bullet(w) / MaxBullet(w) + 0.49999)))
						End If
					End If
				Next 
				'Invalid_string_refer_to_original_code
				For i = 1 To CountAbility
					If IsAbilityClassifiedAs(i, "蜈ｱ") And lv = AbilityLevel(i, "蜈ｱ") And MaxBullet(w) > 0 Then
						If MaxStock(i) > MaxBullet(w) Then
							SetStock(i, MinLng(Stock(i), MaxStock(i) * Bullet(w) \ MaxBullet(w)))
						Else
							SetStock(i, MinLng(Stock(i), MaxStock(i) * Bullet(w) / MaxBullet(w) + 0.49999))
						End If
					End If
				Next 
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		For a = 1 To CountAbility
			If IsAbilityClassifiedAs(a, "蜈ｱ") Then
				lv = AbilityLevel(a, "蜈ｱ")
				'Invalid_string_refer_to_original_code
				For i = 1 To CountAbility
					If a <> i And IsAbilityClassifiedAs(i, "蜈ｱ") And lv = AbilityLevel(i, "蜈ｱ") And MaxStock(a) > 0 Then
						If MaxStock(i) > MaxStock(a) Then
							SetStock(i, MinLng(Stock(i), MaxStock(i) * Stock(a) \ MaxStock(a)))
						Else
							SetStock(i, MinLng(Stock(i), MaxStock(i) * Stock(a) / MaxStock(a) + 0.49999))
						End If
					End If
				Next 
				'Invalid_string_refer_to_original_code
				For i = 1 To CountWeapon
					If IsWeaponClassifiedAs(i, "蜈ｱ") And lv = WeaponLevel(i, "蜈ｱ") And MaxStock(a) > 0 Then
						If MaxBullet(i) > MaxStock(a) Then
							SetBullet(i, MinLng(Bullet(i), MaxBullet(i) * Stock(a) \ MaxStock(a)))
						Else
							SetBullet(i, MinLng(Bullet(i), MaxBullet(i) * Stock(a) / MaxStock(a) + 0.49999))
						End If
					End If
				Next 
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		For w = 1 To CountWeapon
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			For i = 1 To CountWeapon
				If w <> i And MaxBullet(i) > 0 Then
					SetBullet(w, MinLng(Bullet(w), CShort(MaxBullet(w) * Bullet(i) / MaxBullet(i) + 0.49999)))
				End If
			Next 
			'End If
		Next 
		
		'Invalid_string_refer_to_original_code
		Dim counter As Short
		For i = 1 To CountOtherForm
			With OtherForm(i)
				idx = 1
				For j = 1 To CountWeapon
					counter = idx
					For k = counter To .CountWeapon
						If Weapon(j).Name = .Weapon(k).Name And MaxBullet(j) > 0 And .MaxBullet(k) > 0 Then
							.SetBullet(k, .MaxBullet(k) * Bullet(j) \ MaxBullet(j))
							idx = k + 1
							Exit For
						End If
					Next 
				Next 
				
				idx = 1
				For j = 1 To CountAbility
					counter = idx
					For k = counter To .CountAbility
						If Ability(j).Name = .Ability(k).Name And MaxStock(j) > 0 And .MaxStock(k) > 0 Then
							.SetStock(k, .MaxStock(k) * Stock(j) \ MaxStock(j))
							idx = k + 1
							Exit For
						End If
					Next 
				Next 
			End With
		Next 
	End Sub
	
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Function Ability(ByVal a As Short) As AbilityData
		Ability = adata(a)
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CountAbility() As Short
		CountAbility = UBound(adata)
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AbilityNickname(ByVal a As Short) As String
		Dim u As Unit
		
		'Invalid_string_refer_to_original_code
		u = SelectedUnitForEvent
		SelectedUnitForEvent = Me
		AbilityNickname = adata(a).Nickname
		SelectedUnitForEvent = u
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AbilityMinRange(ByVal a As Short) As Short
		AbilityMinRange = Ability(a).MinRange
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AbilityMaxRange(ByVal a As Short) As Short
		AbilityMaxRange = Ability(a).MaxRange
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AbilityENConsumption(ByVal a As Short) As Short
		'UPGRADE_NOTE: rate は rate_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
		Dim rate_Renamed As Double
		Dim p As Pilot
		Dim i As Short
		
		With Ability(a)
			AbilityENConsumption = .ENConsumption
			
			'Invalid_string_refer_to_original_code
			If CountPilot > 0 Then
				p = MainPilot
				
				'Invalid_string_refer_to_original_code
				If IsSpellAbility(a) Then
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'UPGRADE_WARNING: AbilityENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case 1
						''UPGRADE_WARNING: AbilityENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case 2
							'AbilityENConsumption = 0.9 * AbilityENConsumption
							''UPGRADE_WARNING: AbilityENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
							'Case 3
								'AbilityENConsumption = 0.8 * AbilityENConsumption
								''UPGRADE_WARNING: AbilityENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
								'Case 4
									'AbilityENConsumption = 0.7 * AbilityENConsumption
									''UPGRADE_WARNING: AbilityENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
									'Case 5
										'AbilityENConsumption = 0.6 * AbilityENConsumption
										''UPGRADE_WARNING: AbilityENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
										'Case 6
											'AbilityENConsumption = 0.5 * AbilityENConsumption
											''UPGRADE_WARNING: AbilityENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
											'Case 7
												'AbilityENConsumption = 0.45 * AbilityENConsumption
												''UPGRADE_WARNING: AbilityENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
												'Case 8
													'AbilityENConsumption = 0.4 * AbilityENConsumption
													''UPGRADE_WARNING: AbilityENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
													'Case 9
														'AbilityENConsumption = 0.35 * AbilityENConsumption
														''UPGRADE_WARNING: AbilityENConsumption に変換されていないステートメントがあります。ソース コードを確認してください。
				End If
				
				'Invalid_string_refer_to_original_code
				If IsFeatAbility(a) Then
					'Invalid_string_refer_to_original_code
					Select Case p.SkillLevel("謚")
						Case 1
						Case 2
							AbilityENConsumption = 0.9 * AbilityENConsumption
						Case 3
							AbilityENConsumption = 0.8 * AbilityENConsumption
						Case 4
							AbilityENConsumption = 0.7 * AbilityENConsumption
						Case 5
							AbilityENConsumption = 0.6 * AbilityENConsumption
						Case 6
							AbilityENConsumption = 0.5 * AbilityENConsumption
						Case 7
							AbilityENConsumption = 0.45 * AbilityENConsumption
						Case 8
							AbilityENConsumption = 0.4 * AbilityENConsumption
						Case 9
							AbilityENConsumption = 0.35 * AbilityENConsumption
						Case Is >= 10
							AbilityENConsumption = 0.3 * AbilityENConsumption
					End Select
					AbilityENConsumption = MinLng(MaxLng(AbilityENConsumption, 5), .ENConsumption)
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			rate_Renamed = 1
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			For i = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				rate_Renamed = rate_Renamed - 0.1 * FeatureLevel(i)
				'End If
			Next 
			'End If
			
			If rate_Renamed < 0.1 Then
				rate_Renamed = 0.1
			End If
			AbilityENConsumption = rate_Renamed * AbilityENConsumption
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAbilityClassifiedAs(ByVal a As Short, ByRef attr As String) As Boolean
		If InStrNotNest(Ability(a).Class_Renamed, attr) > 0 Then
			IsAbilityClassifiedAs = True
		Else
			IsAbilityClassifiedAs = False
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function AbilityLevel(ByVal a As Short, ByRef attr As String) As Double
		Dim attrlv, aclass As String
		Dim start_idx, i As Short
		Dim c As String
		
		On Error GoTo ErrorHandler
		
		attrlv = attr & "L"
		
		'Invalid_string_refer_to_original_code
		aclass = Ability(a).Class_Renamed
		
		'Invalid_string_refer_to_original_code
		start_idx = InStr(aclass, attrlv)
		If start_idx = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		start_idx = start_idx + Len(attrlv)
		i = start_idx
		Do While True
			c = Mid(aclass, i, 1)
			
			If c = "" Then
				Exit Do
			End If
			
			Select Case Asc(c)
				Case 45 To 46, 48 To 57 '"-", ".", 0-9
				Case Else
					Exit Do
			End Select
			
			i = i + 1
		Loop 
		
		AbilityLevel = CDbl(Mid(aclass, start_idx, i - start_idx))
		Exit Function
		
ErrorHandler: 
		ErrorMessage(Name & "縺ｮ" & "Invalid_string_refer_to_original_code")
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsSpellAbility(ByVal a As Short) As Boolean
		Dim i As Short
		Dim nskill As String
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		IsSpellAbility = True
		Exit Function
		'End If
		
		With MainPilot
			For i = 1 To LLength((Ability(a).NecessarySkill))
				nskill = LIndex((Ability(a).NecessarySkill), i)
				If InStr(nskill, "Lv") > 0 Then
					nskill = Left(nskill, InStr(nskill, "Lv") - 1)
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsSpellAbility = True
				Exit Function
				'End If
			Next 
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsFeatAbility(ByVal a As Short) As Boolean
		Dim i As Short
		Dim nskill As String
		
		If IsAbilityClassifiedAs(a, "謚") Then
			IsFeatAbility = True
			Exit Function
		End If
		
		With MainPilot
			For i = 1 To LLength((Ability(a).NecessarySkill))
				nskill = LIndex((Ability(a).NecessarySkill), i)
				If InStr(nskill, "Lv") > 0 Then
					nskill = Left(nskill, InStr(nskill, "Lv") - 1)
				End If
				If .SkillType(nskill) = "謚" Then
					IsFeatAbility = True
					Exit Function
				End If
			Next 
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Function IsAbilityAvailable(ByVal a As Short, ByRef ref_mode As String) As Boolean
		Dim j, i, k As Short
		Dim ad As AbilityData
		Dim uname, pname As String
		Dim u As Unit
		
		IsAbilityAvailable = False
		
		ad = Ability(a)
		
		'Invalid_string_refer_to_original_code
		If IsDisabled((ad.Name)) Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If CountPilot = 0 Then
			IsAbilityAvailable = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Not IsAbilityMastered(a) Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Not IsAbilityEnabled(a) Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If ref_mode = "繧､繝ｳ繧ｿ繝ｼ繝溘ャ繧ｷ繝ｧ繝ｳ" Or ref_mode = "" Then
			IsAbilityAvailable = True
			Exit Function
		End If
		
		With MainPilot
			'Invalid_string_refer_to_original_code
			If ad.NecessaryMorale > 0 Then
				If .Morale < ad.NecessaryMorale Then
					Exit Function
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
			'End If
			'End If
		End With
		
		'Invalid_string_refer_to_original_code
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			If IsAbilityClassifiedAs(a, "繧ｪ") Then
				Exit Function
			End If
		End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		'End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			If IsAbilityClassifiedAs(a, "繧ｷ") Then
				Exit Function
			End If
		End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			If IsAbilityClassifiedAs(a, "繧ｵ") Then
				Exit Function
			End If
		End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			If IsAbilityClassifiedAs(a, "繧ｵ") Then
				Exit Function
			End If
		End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		'End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		'End If
		If ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
			If IsAbilityClassifiedAs(a, "謚") Then
				Exit Function
			End If
		End If
		For i = 1 To CountCondition
			If Len(Condition(i)) > 6 Then
				If Right(Condition(i), 6) = "Invalid_string_refer_to_original_code" Then
					If InStrNotNest(Ability(a).Class_Renamed, Left(Condition(i), Len(Condition(i)) - 6)) > 0 Then
						Exit Function
					End If
				End If
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		If MaxStock(a) > 0 Then
			If Stock(a) < 1 Then
				Exit Function
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If ad.ENConsumption > 0 Then
			If EN < AbilityENConsumption(a) Then
				Exit Function
			End If
		End If
		
		'縺企≡縺瑚ｶｳ繧翫ｋ縺銀ｦ窶ｦ
		If Party = "蜻ｳ譁ｹ" Then
			If IsAbilityClassifiedAs(a, "驫ｭ") Then
				If Money < MaxLng(AbilityLevel(a, "驫ｭ"), 1) * Value \ 10 Then
					Exit Function
				End If
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
			If IsAbilityClassifiedAs(a, "Invalid_string_refer_to_original_code") Then
				Exit Function
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		With MainPilot
			If IsSpellAbility(a) Or IsAbilityClassifiedAs(a, "髻ｳ") Then
				Exit Function
			End If
		End With
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("迢よ姶螢ｫ") Then
			With MainPilot
				If IsSpellAbility(a) Then
					Exit Function
				End If
			End With
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If Not IsCombinationAbilityAvailable(a) Then
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If IsFeatureAvailable("螟牙ｽ｢謚") Then
			For i = 1 To CountFeature
				If Feature(i) = "螟牙ｽ｢謚" And LIndex(FeatureData(i), 1) = ad.Name Then
					If Not OtherForm(LIndex(FeatureData(i), 2)).IsAbleToEnter(x, y) Then
						Exit Function
					End If
				End If
			Next 
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		'End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If HP > MaxHP \ 4 Then
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied(AbilityNickname(a) & "Invalid_string_refer_to_original_code") Then
			Exit Function
		End If
		'Invalid_string_refer_to_original_code
		Dim lv As Short
		If IsAbilityClassifiedAs(a, "蜈ｱ") Then
			lv = AbilityLevel(a, "蜈ｱ")
			For i = 1 To CountAbility
				If IsAbilityClassifiedAs(i, "蜈ｱ") Then
					If lv = AbilityLevel(i, "蜈ｱ") Then
						If IsConditionSatisfied(AbilityNickname(i) & "Invalid_string_refer_to_original_code") Then
							Exit Function
						End If
					End If
				End If
			Next 
			For i = 1 To CountAbility
				If IsAbilityClassifiedAs(i, "蜈ｱ") Then
					If lv = AbilityLevel(i, "蜈ｱ") Then
						If IsConditionSatisfied(AbilityNickname(i) & "Invalid_string_refer_to_original_code") Then
							Exit Function
						End If
					End If
				End If
			Next 
		End If
		
		'菴ｿ逕ｨ遖∵ｭ｢
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If ref_mode = "繝√Ε繝ｼ繧ｸ" Then
			IsAbilityAvailable = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If IsAbilityClassifiedAs(a, "Invalid_string_refer_to_original_code") Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Function
		End If
		'End If
		
		For i = 1 To ad.CountEffect
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			For j = 1 To CountServant
				With Servant(j).CurrentForm
					Select Case .Status_Renamed
						Case "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'菴ｿ逕ｨ荳榊庄
							Exit Function
						Case "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'Invalid_string_refer_to_original_code
							For k = 1 To .CountFeature
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								uname = LIndex(.FeatureData(k), 2)
								If UList.IsDefined(uname) Then
									With UList.Item(uname).CurrentForm
										'Invalid_string_refer_to_original_code_
										'Invalid_string_refer_to_original_code_
										'Then
										'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
										Exit Function
									End With
								End If
							Next 
					End Select
				End With
				'End If
				'End If
			Next 
			'End Select
			'End With
		Next 
		
		'Invalid_string_refer_to_original_code
		If Not UDList.IsDefined(ad.EffectData(i)) Then
			Exit Function
		End If
		pname = UDList.Item(ad.EffectData(i)).FeatureData("Invalid_string_refer_to_original_code")
		If Not PDList.IsDefined(pname) Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If InStr(pname, "(豎守畑)") = 0 And InStr(pname, "(繧ｶ繧ｳ)") = 0 Then
			If PList.IsDefined(pname) Then
				u = PList.Item(pname).Unit_Renamed
				If Not u Is Nothing Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Exit Function
				End If
			End If
		End If
		'End If
		'End If
		'Next
		
		If ref_mode = "Invalid_string_refer_to_original_code" Then
			IsAbilityAvailable = True
			Exit Function
		End If
		
		For i = 1 To ad.CountEffect
			If ad.EffectType(i) = "螟芽ｺｫ" Then
				'Invalid_string_refer_to_original_code
				If Ability(a).MaxRange = 0 Then
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Exit Function
				End If
				
				'Invalid_string_refer_to_original_code
				With OtherForm(LIndex(Ability(a).EffectData(i), 1))
					If Not .IsAbleToEnter(x, y) Then
						Exit Function
					End If
				End With
			End If
			'End If
		Next 
		
		If ref_mode = "遘ｻ蜍募燕" Then
			IsAbilityAvailable = True
			Exit Function
		End If
		
		If AbilityMaxRange(a) > 1 Or AbilityMaxRange(a) = 0 Then
			If IsAbilityClassifiedAs(a, "Invalid_string_refer_to_original_code") Then
				IsAbilityAvailable = True
			Else
				IsAbilityAvailable = False
			End If
		Else
			If IsAbilityClassifiedAs(a, "Invalid_string_refer_to_original_code") Then
				IsAbilityAvailable = False
			Else
				IsAbilityAvailable = True
			End If
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAbilityMastered(ByVal a As Short) As Boolean
		IsAbilityMastered = IsNecessarySkillSatisfied((Ability(a).NecessarySkill))
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAbilityEnabled(ByVal a As Short) As Boolean
		IsAbilityEnabled = IsNecessarySkillSatisfied((Ability(a).NecessaryCondition))
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAbilityUseful(ByVal a As Short, ByRef ref_mode As String) As Boolean
		Dim i, j As Short
		Dim max_range, min_range As Short
		
		'Invalid_string_refer_to_original_code
		If Not IsAbilityAvailable(a, ref_mode) Then
			IsAbilityUseful = False
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		IsAbilityUseful = True
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To Ability(a).CountEffect
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			IsAbilityUseful = True
			Exit Function
			'End If
		Next 
		
		min_range = AbilityMinRange(a)
		max_range = AbilityMaxRange(a)
		
		'Invalid_string_refer_to_original_code
		For i = MaxLng(x - max_range, 1) To MinLng(x + max_range, MapWidth)
			For j = MaxLng(y - max_range, 1) To MinLng(y + max_range, MapHeight)
				If System.Math.Abs(x - i) + System.Math.Abs(y - j) > max_range Then
					GoTo NextLoop
				End If
				
				If MapDataForUnit(i, j) Is Nothing Then
					GoTo NextLoop
				End If
				
				If IsAbilityEffective(a, MapDataForUnit(i, j)) Then
					IsAbilityUseful = True
					Exit Function
				End If
NextLoop: 
			Next 
		Next 
		
		IsAbilityUseful = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAbilityEffective(ByVal a As Short, ByRef t As Unit) As Boolean
		Dim i, j As Short
		Dim edata As String
		Dim elevel As Double
		Dim flag As Boolean
		
		With t
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			Select Case Party
				Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
					If .Party <> "蜻ｳ譁ｹ" And .Party0 <> "蜻ｳ譁ｹ" And .Party <> "Invalid_string_refer_to_original_code" And .Party0 <> "Invalid_string_refer_to_original_code" Then
						Exit Function
					End If
				Case Else
					If .Party <> Party And .Party0 <> Party Then
						Exit Function
					End If
			End Select
			
			'Invalid_string_refer_to_original_code
			If Not IsAbilityApplicable(a, t) Then
				Exit Function
			End If
			
			IsAbilityEffective = True
			For i = 1 To Ability(a).CountEffect
				edata = Ability(a).EffectData(i)
				elevel = Ability(a).EffectLevel(i)
				Select Case Ability(a).EffectType(i)
					Case "蝗槫ｾｩ"
						If elevel > 0 Then
							If .HP < .MaxHP Then
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								IsAbilityEffective = True
								Exit Function
							End If
						End If
						IsAbilityEffective = False
						'Invalid_string_refer_to_original_code
						IsAbilityEffective = True
						Exit Function
						'End If
						
					Case "Invalid_string_refer_to_original_code"
						If edata = "" Then
							'Invalid_string_refer_to_original_code_
							'Or .ConditionLifetime("豺ｷ荵ｱ") > 0 _
							'Invalid_string_refer_to_original_code_
							'Or .ConditionLifetime("雕翫ｊ") > 0 _
							'Or .ConditionLifetime("迢よ姶螢ｫ") > 0 _
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code_
							'Or .ConditionLifetime("鮗ｻ逞ｺ") > 0 _
							'Or .ConditionLifetime("逹｡逵") > 0 _
							'Invalid_string_refer_to_original_code_
							'Or .ConditionLifetime("逶ｲ逶ｮ") > 0 _
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code_
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							IsAbilityEffective = True
							Exit Function
						End If
						For j = 1 To .CountCondition
							If Len(.Condition(j)) > 6 Then
								'Invalid_string_refer_to_original_code
								'Invalid_string_refer_to_original_code
								'Invalid_string_refer_to_original_code
								If Right(.Condition(j), 6) = "Invalid_string_refer_to_original_code" Then
									If .ConditionLifetime(.Condition(j)) > 0 Then
										IsAbilityEffective = True
										Exit Function
									End If
								End If
							End If
						Next 
						For j = 1 To LLength(edata)
							If .ConditionLifetime(LIndex(edata, j)) > 0 Then
								IsAbilityEffective = True
								Exit Function
							End If
						Next 
						'End If
						IsAbilityEffective = False
						
					Case "陬懃ｵｦ"
						If elevel > 0 Then
							If .EN < .MaxEN Then
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								IsAbilityEffective = True
								Exit Function
							End If
						End If
						IsAbilityEffective = False
						'End If
						
					Case "髴雁鴨蝗槫ｾｩ", "繝励Λ繝ｼ繝雁屓蠕ｩ"
						If elevel > 0 Then
							If .MainPilot.Plana < .MainPilot.MaxPlana Then
								IsAbilityEffective = True
								Exit Function
							End If
							IsAbilityEffective = False
						End If
						
					Case "Invalid_string_refer_to_original_code"
						If elevel > 0 Then
							If .MainPilot.SP < .MainPilot.MaxSP Then
								IsAbilityEffective = True
								Exit Function
							End If
							
							For j = 2 To .CountPilot
								If .Pilot(j).SP < .Pilot(j).MaxSP Then
									IsAbilityEffective = True
									Exit Function
								End If
							Next 
							
							For j = 1 To .CountSupport
								If .Support(j).SP < .Support(j).MaxSP Then
									IsAbilityEffective = True
									Exit Function
								End If
							Next 
							
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If .AdditionalSupport.SP < .AdditionalSupport.MaxSP Then
								IsAbilityEffective = True
								Exit Function
							End If
						End If
						
						IsAbilityEffective = False
						'End If
						
					Case "豌怜鴨蠅怜刈"
						If elevel > 0 Then
							With .MainPilot
								If .Morale < .MaxMorale And .Personality <> "讖滓｢ｰ" Then
									IsAbilityEffective = True
									Exit Function
								End If
							End With
							
							For j = 2 To .CountPilot
								With .Pilot(j)
									If .Morale < .MaxMorale And .Personality <> "讖滓｢ｰ" Then
										IsAbilityEffective = True
										Exit Function
									End If
								End With
							Next 
							
							For j = 1 To .CountSupport
								With .Support(j)
									If .Morale < .MaxMorale And .Personality <> "讖滓｢ｰ" Then
										IsAbilityEffective = True
										Exit Function
									End If
								End With
							Next 
							
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							With .AdditionalSupport
								If .Morale < .MaxMorale And .Personality <> "讖滓｢ｰ" Then
									IsAbilityEffective = True
									Exit Function
								End If
							End With
						End If
						
						IsAbilityEffective = False
						'End If
						
					Case "Invalid_string_refer_to_original_code"
						If edata = "" Then
							For j = 1 To .CountWeapon
								If .Bullet(j) < .MaxBullet(j) Then
									IsAbilityEffective = True
									Exit Function
								End If
							Next 
						Else
							For j = 1 To .CountWeapon
								If .Bullet(j) < .MaxBullet(j) Then
									If .WeaponNickname(j) = edata Or InStrNotNest(.Weapon(j).Class_Renamed, edata) > 0 Then
										IsAbilityEffective = True
										Exit Function
									End If
								End If
							Next 
						End If
						IsAbilityEffective = False
						
					Case "莉伜刈"
						If Not .IsConditionSatisfied(LIndex(edata, 1) & "莉伜刈") Or IsAbilityClassifiedAs(a, "髯､") Then
							IsAbilityEffective = True
							Exit Function
						End If
						IsAbilityEffective = False
						
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code_
						'Or IsAbilityClassifiedAs(a, "髯､") _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						IsAbilityEffective = True
						Exit Function
						'End If
						IsAbilityEffective = False
						
					Case "Invalid_string_refer_to_original_code"
						If Not .IsConditionSatisfied(edata) Then
							IsAbilityEffective = True
							Exit Function
						End If
						IsAbilityEffective = False
						
					Case "蜀崎｡悟虚"
						If Ability(a).MaxRange = 0 Then
							GoTo NextEffect
						End If
						
						If .Action = 0 And .MaxAction > 0 Then
							IsAbilityEffective = True
							Exit Function
						End If
						IsAbilityEffective = False
						
					Case "螟芽ｺｫ"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						IsAbilityEffective = True
						Exit Function
						'End If
						IsAbilityEffective = False
						
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code_
						'Or .IsConditionSatisfied("豺ｷ荵ｱ") > 0 _
						'Or .IsEnemy(Me) Or IsEnemy(t) _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						IsAbilityEffective = False
						GoTo NextEffect
						'End If
						
						If InStr(edata, "繧ｵ繧､繧ｺ蛻ｶ髯仙ｼｷ") > 0 Then
							If Size <> .Size Then
								IsAbilityEffective = False
								GoTo NextEffect
							End If
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							Select Case Size
								Case "SS"
									Select Case .Size
										Case "M", "L", "LL", "XL"
											IsAbilityEffective = False
											GoTo NextEffect
									End Select
								Case "S"
									Select Case .Size
										Case "L", "LL", "XL"
											IsAbilityEffective = False
											GoTo NextEffect
									End Select
								Case "M"
									Select Case .Size
										Case "SS", "LL", "XL"
											IsAbilityEffective = False
											GoTo NextEffect
									End Select
								Case "L"
									Select Case .Size
										Case "SS", "S", "XL"
											IsAbilityEffective = False
											GoTo NextEffect
									End Select
								Case "LL"
									Select Case .Size
										Case "SS", "S", "M"
											IsAbilityEffective = False
											GoTo NextEffect
									End Select
								Case "XL"
									Select Case .Size
										Case "SS", "S", "M", "L"
											IsAbilityEffective = False
											GoTo NextEffect
									End Select
							End Select
						End If
						
						IsAbilityEffective = True
						Exit Function
						
				End Select
NextEffect: 
			Next 
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			If IsAbilityEffective Then
				Exit Function
			End If
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAbilityApplicable(ByVal a As Short, ByRef t As Unit) As Boolean
		Dim i As Short
		Dim fname As String
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If Not t.Weakness(Ability(a).Class_Renamed) And Not t.Effective(Ability(a).Class_Renamed) Then
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		'End If
		
		If Me Is t Then
			'Invalid_string_refer_to_original_code
			If Not IsAbilityClassifiedAs(a, "謠ｴ") Then
				IsAbilityApplicable = True
			End If
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If t.Immune(Ability(a).Class_Renamed) Then
			If Not t.Weakness(Ability(a).Class_Renamed) And Not t.Effective(Ability(a).Class_Renamed) Then
				Exit Function
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If t.IsConditionSatisfied("逶ｲ逶ｮ") Then
			Exit Function
		End If
		'End If
		
		With t.MainPilot
			If IsAbilityClassifiedAs(a, "蟇ｾ") Then
				'UPGRADE_WARNING: Mod に新しい動作が指定されています。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"' をクリックしてください。
				If .Level Mod AbilityLevel(a, "蟇ｾ") <> 0 Then
					Exit Function
				End If
			End If
			
			If IsAbilityClassifiedAs(a, "邊ｾ") Then
				If .Personality = "讖滓｢ｰ" Then
					Exit Function
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If .Sex <> "逕ｷ諤ｧ" Then
				Exit Function
			End If
			'End If
			If IsAbilityClassifiedAs(a, "笙") Then
				If .Sex <> "螂ｳ諤ｧ" Then
					Exit Function
				End If
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		If t.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			For i = 1 To Ability(a).CountEffect
				If Ability(a).EffectType(i) = "蝗槫ｾｩ" Then
					Exit For
				End If
			Next 
			If i <= Ability(a).CountEffect Then
				For i = 2 To CInt(t.FeatureData("Invalid_string_refer_to_original_code"))
					fname = LIndex(t.FeatureData("Invalid_string_refer_to_original_code"), i)
					If Left(fname, 1) = "!" Then
						fname = Mid(fname, 2)
						If fname <> AbilityNickname(a) Then
							Exit Function
						End If
					Else
						If fname = AbilityNickname(a) Then
							Exit Function
						End If
					End If
				Next 
			End If
		End If
		
		IsAbilityApplicable = True
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsTargetWithinAbilityRange(ByVal a As Short, ByRef t As Unit) As Boolean
		Dim distance As Short
		
		IsTargetWithinAbilityRange = True
		
		distance = System.Math.Abs(x - t.x) + System.Math.Abs(y - t.y)
		
		'Invalid_string_refer_to_original_code
		If distance < AbilityMinRange(a) Then
			IsTargetWithinAbilityRange = False
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If distance > AbilityMaxRange(a) Then
			IsTargetWithinAbilityRange = False
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'And AbilityMaxRange(a) = 1 _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Dim partners() As Unit
		CombinationPartner("Invalid_string_refer_to_original_code", a, partners, t.x, t.y)
		If UBound(partners) = 0 Then
			IsTargetWithinAbilityRange = False
			Exit Function
		End If
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsTargetReachableForAbility(ByVal a As Short, ByRef t As Unit) As Boolean
		Dim i, j As Short
		Dim max_range As Short
		
		IsTargetReachableForAbility = True
		
		With t
			'Invalid_string_refer_to_original_code
			max_range = AbilityMaxRange(a)
			For i = MaxLng(.x - max_range, 1) To MinLng(.x + max_range, MapWidth)
				For j = MaxLng(.y - (max_range - System.Math.Abs(.x - i)), 1) To MinLng(.y + (max_range - System.Math.Abs(.x - i)), MapHeight)
					If Not MaskData(i, j) Then
						Exit Function
					End If
				Next 
			Next 
		End With
		
		IsTargetReachableForAbility = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Stock(ByVal a As Short) As Short
		Stock = dblStock(a) * MaxStock(a)
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function MaxStock(ByVal a As Short) As Short
		If BossRank > 0 Then
			MaxStock = Ability(a).Stock * (5 + BossRank) / 5
		Else
			MaxStock = Ability(a).Stock
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub SetStock(ByVal a As Short, ByVal new_stock As Short)
		If new_stock < 0 Then
			dblStock(a) = 0
		ElseIf MaxStock(a) > 0 Then 
			dblStock(a) = new_stock / MaxStock(a)
		Else
			dblStock(a) = 1
		End If
	End Sub
	
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Function ExecuteAbility(ByVal a As Short, ByRef t As Unit, Optional ByVal is_map_ability As Boolean = False, Optional ByVal is_event As Boolean = False) As Boolean
		Dim partners() As Unit
		Dim num, j, i, k, w As Short
		Dim aclass, aname, anickname, atype As String
		Dim edata As String
		Dim elevel, elevel2 As Double
		Dim elv_mod, elv_mod2 As Double
		Dim epower As Integer
		Dim prev_value As Integer
		Dim is_useful, flag As Boolean
		Dim u As Unit
		Dim p As Pilot
		Dim buf, msg As String
		Dim uname, pname, fname As String
		Dim ftype, fdata As String
		Dim flevel As Double
		Dim ftype2, fdata2 As String
		Dim flevel2 As Double
		Dim is_anime_played As Boolean
		Dim hp_ratio, en_ratio As Double
		Dim tx, ty As Short
		Dim tx2, ty2 As Short
		Dim itm As Item
		Dim cname As String
		
		aname = Ability(a).Name
		anickname = AbilityNickname(a)
		aclass = Ability(a).Class_Renamed
		
		'Invalid_string_refer_to_original_code
		SaveSelections()
		
		'Invalid_string_refer_to_original_code
		SelectedUnit = Me
		SelectedUnitForEvent = Me
		SelectedTarget = t
		SelectedTargetForEvent = t
		SelectedAbility = a
		SelectedAbilityName = aname
		
		If Not is_map_ability Then
			'Invalid_string_refer_to_original_code
			If BattleAnimation Then
				RedrawScreen()
			End If
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			If AbilityMaxRange(a) = 0 Then
				For i = 1 To MapWidth
					For j = 1 To MapHeight
						MaskData(i, j) = True
					Next 
				Next 
				MaskData(x, y) = False
			End If
			
			'Invalid_string_refer_to_original_code
			If AbilityMaxRange(a) = 1 Then
				CombinationPartner("Invalid_string_refer_to_original_code", a, partners, t.x, t.y)
			Else
				CombinationPartner("Invalid_string_refer_to_original_code", a, partners)
			End If
			For i = 1 To UBound(partners)
				With partners(i)
					MaskData(.x, .y) = False
				End With
			Next 
			
			If Not BattleAnimation Then
				MaskScreen()
			End If
		Else
			ReDim partners(0)
			ReDim SelectedPartners(0)
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To Ability(a).CountEffect
			edata = Ability(a).EffectData(i)
			Select Case Ability(a).EffectType(i)
				Case "螟芽ｺｫ"
					If Not UDList.IsDefined(LIndex(edata, 1)) Then
						ErrorMessage(LIndex(edata, 1) & "Invalid_string_refer_to_original_code")
						Exit Function
					End If
					
					With UDList.Item(LIndex(edata, 1))
						If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
							If Not PList.IsDefined(.FeatureData("Invalid_string_refer_to_original_code")) Then
								PList.Add(.FeatureData("Invalid_string_refer_to_original_code"), MainPilot.Level, Party0)
							End If
						End If
					End With
			End Select
		Next 
		
		'Invalid_string_refer_to_original_code
		If IsAnimationDefined(aname & "(貅門ｙ)") Then
			PlayAnimation(aname & "(貅門ｙ)")
		End If
		If IsMessageDefined("縺九¢螢ｰ(" & aname & ")") Then
			If Not frmMessage.Visible Then
				If SelectedTarget Is Me Then
					OpenMessageForm(Me)
				Else
					OpenMessageForm(SelectedTarget, Me)
				End If
			End If
			PilotMessage("縺九¢螢ｰ(" & aname & ")")
		End If
		If IsMessageDefined(aname) Or IsMessageDefined("Invalid_string_refer_to_original_code") Then
			If Not frmMessage.Visible Then
				If SelectedTarget Is Me Then
					OpenMessageForm(Me)
				Else
					OpenMessageForm(SelectedTarget, Me)
				End If
			End If
			PilotMessage(aname, "Invalid_string_refer_to_original_code")
		End If
		If IsAnimationDefined(aname & "(菴ｿ逕ｨ)") Then
			PlayAnimation(aname & "(菴ｿ逕ｨ)", "", True)
		End If
		If IsAnimationDefined(aname & "Invalid_string_refer_to_original_code") Or IsAnimationDefined(aname) Then
			PlayAnimation(aname & "Invalid_string_refer_to_original_code", "", True)
			is_anime_played = True
		Else
			SpecialEffect(aname, "", True)
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To Ability(a).CountEffect
			Select Case Ability(a).EffectType(i)
				Case "Invalid_string_refer_to_original_code"
					aname = ""
					Exit For
				Case "蜀崎｡悟虚"
					If Ability(a).MaxRange > 0 Then
						atype = Ability(a).EffectType(i)
					End If
				Case "隗｣隱ｬ"
				Case Else
					atype = Ability(a).EffectType(i)
			End Select
		Next 
		Select Case UBound(partners)
			Case 0
				'騾壼ｸｸ
				msg = Nickname & "縺ｯ"
			Case 1
				'Invalid_string_refer_to_original_code
				If Nickname <> partners(1).Nickname Then
					msg = Nickname & "縺ｯ[" & partners(1).Nickname & "]縺ｨ蜈ｱ縺ｫ"
				ElseIf MainPilot.Nickname <> partners(1).MainPilot.Nickname Then 
					msg = MainPilot.Nickname & "縺ｨ[" & partners(1).MainPilot.Nickname & "]縺ｮ[" & Nickname & "]縺ｯ"
				Else
					msg = Nickname & "Invalid_string_refer_to_original_code"
				End If
			Case 2
				'Invalid_string_refer_to_original_code
				If Nickname <> partners(1).Nickname Then
					msg = Nickname & "縺ｯ[" & partners(1).Nickname & "]縲ー" & partners(2).Nickname & "]縺ｨ蜈ｱ縺ｫ"
				ElseIf MainPilot.Nickname <> partners(1).MainPilot.Nickname Then 
					msg = MainPilot.Nickname & "縲ー" & partners(1).MainPilot.Nickname & "]縲ー" & partners(2).MainPilot.Nickname & "]縺ｮ[" & Nickname & "]縺ｯ"
				Else
					msg = Nickname & "Invalid_string_refer_to_original_code"
				End If
			Case Else
				'Invalid_string_refer_to_original_code
				msg = Nickname & "Invalid_string_refer_to_original_code"
		End Select
		
		If IsSpellAbility(a) Then
			If Not t Is Nothing And Ability(a).MaxRange <> 0 Then
				If Me Is t Then
					msg = msg & "Invalid_string_refer_to_original_code"
				Else
					msg = msg & "[" & t.Nickname & "]縺ｫ"
				End If
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & anickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & Left(anickname, Len(anickname) - 2) & "Invalid_string_refer_to_original_code"
		Else
			msg = msg & "[" & anickname & "Invalid_string_refer_to_original_code"
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & anickname & "Invalid_string_refer_to_original_code"
		'UPGRADE_WARNING: ExecuteAbility に変換されていないステートメントがあります。ソース コードを確認してください。
		msg = msg & "[" & anickname & "Invalid_string_refer_to_original_code"
		If Not t Is Nothing And Ability(a).MaxRange <> 0 Then
			If Me Is t Then
				msg = msg & "Invalid_string_refer_to_original_code"
			Else
				msg = msg & "[" & t.Nickname & "]縺ｫ"
			End If
		End If
		msg = msg & "[" & anickname & "Invalid_string_refer_to_original_code"
		'End If
		
		If IsSysMessageDefined(aname) Then
			'Invalid_string_refer_to_original_code
			If Not frmMessage.Visible Then
				If SelectedTarget Is Me Then
					OpenMessageForm(Me)
				Else
					OpenMessageForm(SelectedTarget, Me)
				End If
			End If
			SysMessage(aname)
		ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
			'Invalid_string_refer_to_original_code
			If Not frmMessage.Visible Then
				If SelectedTarget Is Me Then
					OpenMessageForm(Me)
				Else
					OpenMessageForm(SelectedTarget, Me)
				End If
			End If
			SysMessage("Invalid_string_refer_to_original_code")
		ElseIf atype = "螟芽ｺｫ" And Ability(a).MaxRange = 0 Then 
			'Invalid_string_refer_to_original_code
		ElseIf atype <> "" Then 
			If Not frmMessage.Visible Then
				If SelectedTarget Is Me Then
					OpenMessageForm(Me)
				Else
					OpenMessageForm(SelectedTarget, Me)
				End If
			End If
			DisplaySysMessage(msg)
		End If
		
		'Invalid_string_refer_to_original_code
		UseAbility(a)
		
		'Invalid_string_refer_to_original_code
		If Dice(10) <= AbilityLevel(a, "髮｣") Then
			DisplaySysMessage("縺励°縺嶺ｽ輔ｂ縺翫″縺ｪ縺九▲縺溪ｦ")
			GoTo Finish
		End If
		'Invalid_string_refer_to_original_code
		If IsAnimationDefined(aname & "Invalid_string_refer_to_original_code") Or IsAnimationDefined(aname) Then
			PlayAnimation(aname & "Invalid_string_refer_to_original_code")
			is_anime_played = True
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If Not Me Is t Then
			If t.Immune(aclass) Then
				GoTo Finish
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If IsAbilityClassifiedAs(a, "閼ｱ") Then
			t.IncreaseMorale(-10)
		End If
		
		'Invalid_string_refer_to_original_code
		If IsAbilityClassifiedAs(a, "髯､") Then
			i = 1
			Do While i <= t.CountCondition
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'And t.ConditionLifetime(i) <> 0 _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				t.DeleteCondition(i)
			Loop 
		Else
			i = i + 1
		End If
		'Loop
		'End If
		
		'Invalid_string_refer_to_original_code
		elv_mod = 1#
		elv_mod2 = 1#
		With MainPilot
			'蠕玲э謚
			If .IsSkillAvailable("蠕玲э謚") Then
				buf = .SkillData("蠕玲э謚")
				For i = 1 To Len(buf)
					If InStr(aclass, GetClassBundle(buf, i)) > 0 Then
						elv_mod = 1.2 * elv_mod
						elv_mod2 = 1.4 * elv_mod2
						Exit For
					End If
				Next 
			End If
			
			'荳榊ｾ玲焔
			If .IsSkillAvailable("荳榊ｾ玲焔") Then
				buf = .SkillData("荳榊ｾ玲焔")
				For i = 1 To Len(buf)
					If InStr(aclass, GetClassBundle(buf, i)) > 0 Then
						elv_mod = 0.8 * elv_mod
						elv_mod2 = 0.6 * elv_mod2
						Exit For
					End If
				Next 
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		For i = 1 To Ability(a).CountEffect
			With Ability(a)
				edata = .EffectData(i)
				elevel = .EffectLevel(i) * elv_mod
				elevel2 = .EffectLevel(i) * elv_mod2
			End With
			Select Case Ability(a).EffectType(i)
				Case "蝗槫ｾｩ"
					With t
						If elevel > 0 Then
							'Invalid_string_refer_to_original_code
							If .HP = .MaxHP Then
								GoTo NextLoop
							End If
							
							'Invalid_string_refer_to_original_code
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							GoTo NextLoop
						End If
						
						If Not is_anime_played Then
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							ShowAnimation("Invalid_string_refer_to_original_code")
						Else
							ShowAnimation("Invalid_string_refer_to_original_code")
						End If
						'End If
						
						prev_value = .HP
						With MainPilot
							If IsSpellAbility(a) Then
								epower = CInt(5 * elevel * .Shooting)
							Else
								epower = 500 * elevel
							End If
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						End With
						t.HP = t.HP + epower
						DrawSysString(.x, .y, "+" & VB6.Format(.HP - prev_value))
						If t Is Me Then
							UpdateMessageForm(Me)
						Else
							UpdateMessageForm(t, Me)
						End If
						DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "縺啓" & VB6.Format(.HP - prev_value) & "]蝗槫ｾｩ縺励◆;" & "谿九ｊ" & Term("Invalid_string_refer_to_original_code", t) & "縺ｯ" & VB6.Format(.HP) & "Invalid_string_refer_to_original_code" & VB6.Format(100 * (.MaxHP - .HP) \ .MaxHP) & "Invalid_string_refer_to_original_code")
						is_useful = True
						'UPGRADE_WARNING: ExecuteAbility に変換されていないステートメントがあります。ソース コードを確認してください。
						prev_value = .HP
						With MainPilot
							If IsSpellAbility(a) Then
								epower = CInt(5 * elevel * .Shooting)
							Else
								epower = 500 * elevel
							End If
						End With
						t.HP = t.HP + epower
						DrawSysString(.x, .y, "-" & VB6.Format(prev_value - .HP))
						If t Is Me Then
							UpdateMessageForm(Me)
						Else
							UpdateMessageForm(t, Me)
						End If
						DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "縺啓" & VB6.Format(prev_value - .HP) & "Invalid_string_refer_to_original_code" & "谿九ｊ" & Term("Invalid_string_refer_to_original_code", t) & "縺ｯ" & VB6.Format(.HP) & "Invalid_string_refer_to_original_code" & VB6.Format(100 * (.MaxHP - .HP) \ .MaxHP) & "Invalid_string_refer_to_original_code")
						'End If
					End With
					
				Case "陬懃ｵｦ"
					With t
						If elevel > 0 Then
							'Invalid_string_refer_to_original_code
							If .EN = .MaxEN Then
								GoTo NextLoop
							End If
							
							'Invalid_string_refer_to_original_code
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							GoTo NextLoop
						End If
						
						If Not is_anime_played Then
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							ShowAnimation("Invalid_string_refer_to_original_code")
						Else
							ShowAnimation("Invalid_string_refer_to_original_code")
						End If
						'End If
						
						prev_value = .EN
						With MainPilot
							If IsSpellAbility(a) Then
								epower = CInt(elevel * .Shooting \ 2)
							Else
								epower = 50 * elevel
							End If
							epower = epower * (10 + .SkillLevel("陬懃ｵｦ")) \ 10
						End With
						t.EN = t.EN + epower
						DrawSysString(.x, .y, "+" & VB6.Format(.EN - prev_value))
						If t Is Me Then
							UpdateMessageForm(Me)
						Else
							UpdateMessageForm(t, Me)
						End If
						DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "縺啓" & VB6.Format(.EN - prev_value) & "]蝗槫ｾｩ縺励◆;" & "谿九ｊ" & Term("Invalid_string_refer_to_original_code", t) & "縺ｯ" & VB6.Format(.EN))
						is_useful = True
						'UPGRADE_WARNING: ExecuteAbility に変換されていないステートメントがあります。ソース コードを確認してください。
						'Invalid_string_refer_to_original_code
						If .EN = 0 Then
							GoTo NextLoop
						End If
						
						prev_value = .EN
						With MainPilot
							If IsSpellAbility(a) Then
								epower = CInt(elevel * .Shooting \ 2)
							Else
								epower = 50 * elevel
							End If
						End With
						t.EN = t.EN + epower
						DrawSysString(.x, .y, "-" & VB6.Format(prev_value - .EN))
						If t Is Me Then
							UpdateMessageForm(Me)
						Else
							UpdateMessageForm(t, Me)
						End If
						DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "縺啓" & VB6.Format(prev_value - .EN) & "Invalid_string_refer_to_original_code" & "谿九ｊ" & Term("Invalid_string_refer_to_original_code", t) & "縺ｯ" & VB6.Format(.EN))
						'End If
					End With
					
				Case "髴雁鴨蝗槫ｾｩ", "繝励Λ繝ｼ繝雁屓蠕ｩ"
					With t.MainPilot
						If elevel > 0 Then
							'Invalid_string_refer_to_original_code
							If .Plana = .MaxPlana Then
								GoTo NextLoop
							End If
							
							prev_value = .Plana
							If IsSpellAbility(a) Then
								.Plana = .Plana + CInt(elevel * MainPilot.Shooting \ 10)
							Else
								.Plana = .Plana + 10 * elevel
							End If
							DrawSysString(t.x, t.y, "+" & VB6.Format(.Plana - prev_value))
							If t Is Me Then
								UpdateMessageForm(Me)
							Else
								UpdateMessageForm(t, Me)
							End If
							DisplaySysMessage(.Nickname & "縺ｮ[" & .SkillName0("髴雁鴨") & "]縺啓" & VB6.Format(.Plana - prev_value) & "Invalid_string_refer_to_original_code")
							is_useful = True
						ElseIf elevel < 0 Then 
							'Invalid_string_refer_to_original_code
							If .Plana = 0 Then
								GoTo NextLoop
							End If
							
							prev_value = .Plana
							If IsSpellAbility(a) Then
								.Plana = .Plana + CInt(elevel * MainPilot.Shooting \ 10)
							Else
								.Plana = .Plana + 10 * elevel
							End If
							DrawSysString(t.x, t.y, "-" & VB6.Format(prev_value - .Plana))
							If t Is Me Then
								UpdateMessageForm(Me)
							Else
								UpdateMessageForm(t, Me)
							End If
							DisplaySysMessage(.Nickname & "縺ｮ[" & .SkillName0("髴雁鴨") & "]縺啓" & VB6.Format(prev_value - .Plana) & "Invalid_string_refer_to_original_code")
						End If
					End With
					
				Case "Invalid_string_refer_to_original_code"
					If IsSpellAbility(a) Then
						epower = CInt(elevel * MainPilot.Shooting \ 10)
					Else
						epower = 10 * elevel
					End If
					
					With t
						'Invalid_string_refer_to_original_code
						num = .CountPilot + .CountSupport
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						num = num + 1
						'End If
						
						If elevel > 0 Then
							If num = 1 Then
								'Invalid_string_refer_to_original_code
								With .MainPilot
									prev_value = .SP
									.SP = .SP + epower
									DrawSysString(t.x, t.y, "+" & VB6.Format(.SP - prev_value))
									DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									If .SP > prev_value Then
										is_useful = True
									End If
								End With
							Else
								'Invalid_string_refer_to_original_code
								With .MainPilot
									prev_value = .SP
									.SP = .SP + epower \ 5 + epower \ num
									DrawSysString(t.x, t.y, "+" & VB6.Format(.SP - prev_value))
									DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									If .SP > prev_value Then
										is_useful = True
									End If
								End With
								
								For j = 2 To .CountPilot
									With .Pilot(j)
										prev_value = .SP
										.SP = .SP + epower \ 5 + epower \ num
										DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
										'Invalid_string_refer_to_original_code
										'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
										If .SP > prev_value Then
											is_useful = True
										End If
									End With
								Next 
								
								For j = 1 To .CountSupport
									With .Support(j)
										prev_value = .SP
										.SP = .SP + epower \ 5 + epower \ num
										DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
										'Invalid_string_refer_to_original_code
										'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
										If .SP > prev_value Then
											is_useful = True
										End If
									End With
								Next 
								
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								With .AdditionalSupport
									prev_value = .SP
									.SP = .SP + epower \ 5 + epower \ num
									DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									If .SP > prev_value Then
										is_useful = True
									End If
								End With
							End If
						End If
						'UPGRADE_WARNING: ExecuteAbility に変換されていないステートメントがあります。ソース コードを確認してください。
						If num = 1 Then
							'Invalid_string_refer_to_original_code
							With .MainPilot
								prev_value = .SP
								.SP = .SP + epower
								DrawSysString(t.x, t.y, "-" & VB6.Format(prev_value - .SP))
								DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							End With
						Else
							'Invalid_string_refer_to_original_code
							With .MainPilot
								prev_value = .SP
								.SP = .SP + epower \ 5 + epower \ num
								DrawSysString(t.x, t.y, "+" & VB6.Format(prev_value - .SP))
								DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							End With
							
							For j = 2 To .CountPilot
								With .Pilot(j)
									prev_value = .SP
									.SP = .SP + epower \ 5 + epower \ num
									DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								End With
							Next 
							
							For j = 1 To .CountSupport
								With .Support(j)
									prev_value = .SP
									.SP = .SP + epower \ 5 + epower \ num
									DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								End With
							Next 
							
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							With .AdditionalSupport
								prev_value = .SP
								.SP = .SP + epower \ 5 + epower \ num
								DisplaySysMessage(.Nickname & "縺ｮ" & Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code")
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							End With
						End If
						'End If
						'End If
					End With
					
				Case "豌怜鴨蠅怜刈"
					If IsSpellAbility(a) Then
						epower = CInt(elevel * MainPilot.Shooting \ 10)
					Else
						epower = 10 * elevel
					End If
					With t
						prev_value = .MainPilot.Morale
						.IncreaseMorale(epower)
						
						If elevel > 0 Then
							With .MainPilot
								DrawSysString(t.x, t.y, "+" & VB6.Format(.Morale - prev_value))
								DisplaySysMessage(.Nickname & "縺ｮ" & Term("豌怜鴨", t) & "Invalid_string_refer_to_original_code")
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							End With
						ElseIf elevel < 0 Then 
							With .MainPilot
								DrawSysString(t.x, t.y, "-" & VB6.Format(prev_value - .Morale))
								DisplaySysMessage(.Nickname & "縺ｮ" & Term("豌怜鴨", t) & "Invalid_string_refer_to_original_code")
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							End With
						End If
						
						If .MainPilot.Morale > prev_value Then
							is_useful = True
						End If
					End With
					
				Case "Invalid_string_refer_to_original_code"
					With t
						flag = False
						If edata = "" Then
							'蜈ｨ縺ｦ縺ｮ豁ｦ蝎ｨ縺ｮ蠑ｾ謨ｰ繧貞屓蠕ｩ
							For j = 1 To .CountWeapon
								If .Bullet(j) < .MaxBullet(j) Then
									.BulletSupply()
									flag = True
									Exit For
								End If
							Next 
							
							'Invalid_string_refer_to_original_code
							If flag Then
								For j = 1 To .CountAbility
									If .IsAbilityClassifiedAs(j, "蜈ｱ") Then
										For k = 1 To .CountWeapon
											If .IsWeaponClassifiedAs(k, "蜈ｱ") And .AbilityLevel(j, "蜈ｱ") = .WeaponLevel(k, "蜈ｱ") Then
												.SetStock(j, .MaxStock(j))
											End If
										Next 
									End If
								Next 
								
								'Invalid_string_refer_to_original_code
								.SyncBullet()
							End If
						Else
							'Invalid_string_refer_to_original_code
							For j = 1 To .CountWeapon
								If .Bullet(j) < .MaxBullet(j) Then
									If .WeaponNickname(j) = edata Or InStrNotNest(.Weapon(j).Class_Renamed, edata) > 0 Then
										.SetBullet(j, .MaxBullet(j))
										flag = True
										w = j
									End If
								End If
							Next 
							For j = 1 To .CountOtherForm
								With .OtherForm(j)
									For k = 1 To .CountWeapon
										If .Bullet(k) < .MaxBullet(k) Then
											If .WeaponNickname(k) = edata Or InStrNotNest(.Weapon(k).Class_Renamed, edata) > 0 Then
												.SetBullet(k, .MaxBullet(k))
											End If
										End If
									Next 
								End With
							Next 
							
							'Invalid_string_refer_to_original_code
							If flag Then
								If .IsWeaponClassifiedAs(w, "蜈ｱ") Then
									For j = 1 To .CountWeapon
										If .IsWeaponClassifiedAs(j, "蜈ｱ") And .WeaponLevel(j, "蜈ｱ") = .WeaponLevel(w, "蜈ｱ") Then
											.SetBullet(j, .MaxBullet(j))
										End If
									Next 
									For j = 1 To .CountAbility
										If .IsAbilityClassifiedAs(j, "蜈ｱ") And .AbilityLevel(j, "蜈ｱ") = .WeaponLevel(w, "蜈ｱ") Then
											.SetStock(j, .MaxStock(j))
										End If
									Next 
								End If
								
								'Invalid_string_refer_to_original_code
								.SyncBullet()
							End If
						End If
						
						If flag Then
							DisplaySysMessage(.Nickname & "Invalid_string_refer_to_original_code")
							If AbilityMaxRange(a) > 0 Then
								is_useful = True
							End If
						End If
					End With
					
				Case "Invalid_string_refer_to_original_code"
					With t
						If Not is_anime_played Then
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							ShowAnimation("Invalid_string_refer_to_original_code")
						End If
						'End If
						If edata = "" Then
							'Invalid_string_refer_to_original_code
							If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
								.DeleteCondition("Invalid_string_refer_to_original_code")
								is_useful = True
							End If
							If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
								.DeleteCondition("Invalid_string_refer_to_original_code")
								is_useful = True
							End If
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							.DeleteCondition("Invalid_string_refer_to_original_code")
							is_useful = True
						End If
						If .ConditionLifetime("豺ｷ荵ｱ") > 0 Then
							.DeleteCondition("豺ｷ荵ｱ")
							is_useful = True
						End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.DeleteCondition("Invalid_string_refer_to_original_code")
						is_useful = True
						'End If
						If .ConditionLifetime("雕翫ｊ") > 0 Then
							.DeleteCondition("雕翫ｊ")
							is_useful = True
						End If
						If .ConditionLifetime("迢よ姶螢ｫ") > 0 Then
							.DeleteCondition("迢よ姶螢ｫ")
							is_useful = True
						End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.DeleteCondition("Invalid_string_refer_to_original_code")
						is_useful = True
						'End If
						If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
							.DeleteCondition("Invalid_string_refer_to_original_code")
							is_useful = True
						End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.DeleteCondition("Invalid_string_refer_to_original_code")
						is_useful = True
						'End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.DeleteCondition("Invalid_string_refer_to_original_code")
						is_useful = True
						'End If
						If .ConditionLifetime("鮗ｻ逞ｺ") > 0 Then
							.DeleteCondition("鮗ｻ逞ｺ")
							is_useful = True
						End If
						If .ConditionLifetime("逹｡逵") > 0 Then
							.DeleteCondition("逹｡逵")
							is_useful = True
						End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.DeleteCondition("Invalid_string_refer_to_original_code")
						is_useful = True
						'End If
						If .ConditionLifetime("逶ｲ逶ｮ") > 0 Then
							.DeleteCondition("逶ｲ逶ｮ")
							is_useful = True
						End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.DeleteCondition("Invalid_string_refer_to_original_code")
						is_useful = True
						'End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.DeleteCondition("Invalid_string_refer_to_original_code")
						is_useful = True
						'End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.DeleteCondition("Invalid_string_refer_to_original_code")
						is_useful = True
						'End If
						'蜑句ｱ樊ｧ
						If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
							.DeleteCondition("Invalid_string_refer_to_original_code")
						End If
						If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
							.DeleteCondition("Invalid_string_refer_to_original_code")
						End If
						If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
							.DeleteCondition("Invalid_string_refer_to_original_code")
						End If
						If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
							.DeleteCondition("Invalid_string_refer_to_original_code")
						End If
						If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
							.DeleteCondition("Invalid_string_refer_to_original_code")
						End If
						If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
							.DeleteCondition("Invalid_string_refer_to_original_code")
						End If
						If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
							.DeleteCondition("Invalid_string_refer_to_original_code")
						End If
						If .ConditionLifetime("Invalid_string_refer_to_original_code") > 0 Then
							.DeleteCondition("Invalid_string_refer_to_original_code")
						End If
						j = 1
						Do While j <= .CountCondition
							'Invalid_string_refer_to_original_code
							If Len(.Condition(j)) > 6 And Right(.Condition(j), 6) = "Invalid_string_refer_to_original_code" And .ConditionLifetime(.Condition(j)) > 0 Then
								.DeleteCondition(.Condition(j))
								is_useful = True
							Else
								j = j + 1
							End If
						Loop 
						If is_useful Then
							If t Is CurrentForm Then
								UpdateMessageForm(t)
							Else
								UpdateMessageForm(t, CurrentForm)
							End If
							DisplaySysMessage(.Nickname & "Invalid_string_refer_to_original_code")
						End If
						'Invalid_string_refer_to_original_code
						j = 1
						Do While j <= LLength(edata)
							cname = LIndex(edata, j)
							If .ConditionLifetime(cname) > 0 Then
								.DeleteCondition(cname)
								If t Is CurrentForm Then
									UpdateMessageForm(t)
								Else
									UpdateMessageForm(t, CurrentForm)
								End If
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								cname = Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code"
							End If
							DisplaySysMessage(.Nickname & "縺ｮ[" & cname & "Invalid_string_refer_to_original_code")
							is_useful = True
							j = j + 1
							'End If
						Loop 
						'End If
					End With
					
				Case "莉伜刈"
					With t
						If elevel2 = 0 Then
							'Invalid_string_refer_to_original_code
							elevel2 = 10000
						Else
							'Invalid_string_refer_to_original_code
							elevel2 = MaxLng(CShort(elevel2), 1)
						End If
						
						'Invalid_string_refer_to_original_code
						If .IsConditionSatisfied(LIndex(edata, 1) & "莉伜刈") Then
							GoTo NextLoop
						End If
						
						ftype = LIndex(edata, 1)
						flevel = CDbl(LIndex(edata, 2))
						fdata = ""
						For j = 3 To LLength(edata)
							fdata = fdata & LIndex(edata, j) & " "
						Next 
						fdata = Trim(fdata)
						If Left(fdata, 1) = """" And Right(fdata, 1) = """" Then
							fdata = Trim(Mid(fdata, 2, Len(fdata) - 2))
						End If
						
						'Invalid_string_refer_to_original_code
						If ALDList.IsDefined(ftype) Then
							With ALDList.Item(ftype)
								For j = 1 To .Count
									'Invalid_string_refer_to_original_code
									ftype2 = .AliasType(j)
									
									If LIndex(.AliasData(j), 1) = "隗｣隱ｬ" Then
										'Invalid_string_refer_to_original_code
										If fdata <> "" Then
											ftype2 = LIndex(fdata, 1)
										End If
										flevel2 = DEFAULT_LEVEL
										fdata2 = .AliasData(j)
									Else
										'Invalid_string_refer_to_original_code
										If .AliasLevelIsPlusMod(j) Then
											If flevel = DEFAULT_LEVEL Then
												flevel = 1
											End If
											flevel2 = flevel + .AliasLevel(j)
										ElseIf .AliasLevelIsMultMod(j) Then 
											If flevel = DEFAULT_LEVEL Then
												flevel = 1
											End If
											flevel2 = flevel * .AliasLevel(j)
										ElseIf flevel <> DEFAULT_LEVEL Then 
											flevel2 = flevel
										Else
											flevel2 = .AliasLevel(j)
										End If
										
										fdata2 = .AliasData(j)
										If fdata <> "" Then
											If InStr(fdata2, "髱櫁｡ｨ遉ｺ") <> 1 Then
												fdata2 = fdata & " " & ListTail(fdata2, LLength(fdata) + 1)
											End If
										End If
									End If
									
									t.AddCondition(ftype2 & "莉伜刈", elevel2, flevel2, fdata2)
								Next 
							End With
						Else
							.AddCondition(ftype & "莉伜刈", elevel2, flevel, fdata)
						End If
						
						.Update()
						
						If t Is CurrentForm Then
							UpdateMessageForm(t)
						Else
							UpdateMessageForm(t, CurrentForm)
						End If
						Select Case LIndex(edata, 1)
							Case "閠先ｧ", "Invalid_string_refer_to_original_code"
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								DisplaySysMessage(.Nickname & "縺ｯ[" & LIndex(edata, 3) & "]螻樊ｧ縺ｫ蟇ｾ縺吶ｋ[" & LIndex(edata, 1) & "Invalid_string_refer_to_original_code")
							Case "Invalid_string_refer_to_original_code"
								DisplaySysMessage(.Nickname & "縺ｯ[" & LIndex(edata, 3) & "Invalid_string_refer_to_original_code")
							Case "Invalid_string_refer_to_original_code"
								DisplaySysMessage(.Nickname & "縺ｯ[" & LIndex(edata, 3) & "Invalid_string_refer_to_original_code")
							Case "Invalid_string_refer_to_original_code"
								DisplaySysMessage(.Nickname & "縺ｮ" & "Invalid_string_refer_to_original_code")
							Case "Invalid_string_refer_to_original_code"
								DisplaySysMessage(.Nickname & "縺ｮ" & "Invalid_string_refer_to_original_code")
							Case "Invalid_string_refer_to_original_code"
								DisplaySysMessage(.Nickname & "縺ｮ" & "Invalid_string_refer_to_original_code")
							Case "Invalid_string_refer_to_original_code"
								DisplaySysMessage(.Nickname & "縺ｮ" & "Invalid_string_refer_to_original_code")
							Case "Invalid_string_refer_to_original_code"
								DisplaySysMessage(.Nickname & "縺ｮ" & "Invalid_string_refer_to_original_code")
							Case "繧ｵ繧､繧ｺ螟画峩"
								DisplaySysMessage(.Nickname & "縺ｮ" & "Invalid_string_refer_to_original_code")
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							Case "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code"
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								'Invalid_string_refer_to_original_code
							Case Else
								'莉伜刈縺吶ｋ閭ｽ蜉帛錐
								fname = ListIndex(fdata, 1)
								If fname = "" Or fname = "髱櫁｡ｨ遉ｺ" Then
									If LIndex(edata, 2) <> VB6.Format(DEFAULT_LEVEL) Then
										fname = LIndex(edata, 1) & "Lv" & LIndex(edata, 2)
									Else
										fname = LIndex(edata, 1)
									End If
								End If
								DisplaySysMessage(.Nickname & "縺ｯ[" & fname & "Invalid_string_refer_to_original_code")
						End Select
						
						If AbilityMaxRange(a) > 0 Then
							is_useful = True
						End If
					End With
					
				Case "Invalid_string_refer_to_original_code"
					With t
						If elevel2 = 0 Then
							'Invalid_string_refer_to_original_code
							elevel2 = 10000
						Else
							'Invalid_string_refer_to_original_code
							elevel2 = MaxLng(CShort(elevel2), 1)
						End If
						
						'Invalid_string_refer_to_original_code
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						GoTo NextLoop
						'End If
						
						ftype = LIndex(edata, 1)
						flevel = CDbl(LIndex(edata, 2))
						fdata = ""
						For j = 3 To LLength(edata)
							fdata = fdata & LIndex(edata, j) & " "
						Next 
						fdata = Trim(fdata)
						
						'Invalid_string_refer_to_original_code
						If ALDList.IsDefined(ftype) Then
							With ALDList.Item(ftype)
								For j = 1 To .Count
									'Invalid_string_refer_to_original_code
									ftype2 = .AliasType(i)
									
									If LIndex(.AliasData(j), 1) = "隗｣隱ｬ" Then
										'Invalid_string_refer_to_original_code
										If fdata <> "" Then
											ftype2 = LIndex(fdata, 1)
										End If
										flevel2 = DEFAULT_LEVEL
										fdata2 = .AliasData(j)
										t.AddCondition(ftype2 & "莉伜刈", elevel2, flevel2, fdata2)
									Else
										'Invalid_string_refer_to_original_code
										If .AliasLevelIsMultMod(j) Then
											If flevel = DEFAULT_LEVEL Then
												flevel = 1
											End If
											flevel2 = flevel * .AliasLevel(j)
										ElseIf flevel <> DEFAULT_LEVEL Then 
											flevel2 = flevel
										Else
											flevel2 = .AliasLevel(j)
										End If
										
										fdata2 = .AliasData(j)
										If fdata <> "" Then
											If InStr(fdata2, "髱櫁｡ｨ遉ｺ") <> 1 Then
												fdata2 = fdata & " " & ListTail(fdata2, LLength(fdata) + 1)
											End If
										End If
										
										t.AddCondition(ftype2 & "Invalid_string_refer_to_original_code")
									End If
								Next 
							End With
						Else
							.AddCondition(ftype & "Invalid_string_refer_to_original_code")
						End If
						
						.Update()
						
						If t Is CurrentForm Then
							UpdateMessageForm(t)
						Else
							UpdateMessageForm(t, CurrentForm)
						End If
						
						'Invalid_string_refer_to_original_code
						fname = LIndex(edata, 3)
						If fname = "" Or fname = "髱櫁｡ｨ遉ｺ" Then
							fname = LIndex(edata, 1)
						End If
						If t.SkillName0(fname) <> "髱櫁｡ｨ遉ｺ" Then
							fname = t.SkillName0(fname)
						End If
						DisplaySysMessage(.Nickname & "縺ｮ[" & fname & "Invalid_string_refer_to_original_code")
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						
						If AbilityMaxRange(a) > 0 Then
							is_useful = True
						End If
					End With
					
				Case "Invalid_string_refer_to_original_code"
					With t
						If elevel2 = 0 Then
							'Invalid_string_refer_to_original_code
							elevel2 = 10000
						Else
							'Invalid_string_refer_to_original_code
							elevel = MaxLng(CShort(elevel2), 1)
						End If
						
						'Invalid_string_refer_to_original_code
						If .IsConditionSatisfied(edata) Then
							GoTo NextLoop
						End If
						
						.AddCondition(edata, elevel2)
						
						'迥ｶ諷狗匱蜍輔い繝九Γ繝ｼ繧ｷ繝ｧ繝ｳ陦ｨ遉ｺ
						If Not IsAnimationDefined(aname & "Invalid_string_refer_to_original_code") And Not IsAnimationDefined(aname) Then
							Select Case edata
								Case "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code", "迢よ姶螢ｫ"
									ShowAnimation(edata & "Invalid_string_refer_to_original_code")
							End Select
						End If
						
						Select Case edata
							Case "Invalid_string_refer_to_original_code"
								cname = Term("Invalid_string_refer_to_original_code", t) & "Invalid_string_refer_to_original_code"
							Case "Invalid_string_refer_to_original_code"
								cname = Term("驕句虚諤ｧ", t) & "Invalid_string_refer_to_original_code"
							Case "Invalid_string_refer_to_original_code"
								cname = Term("驕句虚諤ｧ", t) & "Invalid_string_refer_to_original_code"
							Case "Invalid_string_refer_to_original_code"
								cname = Term("遘ｻ蜍募鴨", t) & "Invalid_string_refer_to_original_code"
							Case "Invalid_string_refer_to_original_code"
								cname = Term("遘ｻ蜍募鴨", t) & "Invalid_string_refer_to_original_code"
							Case Else
								cname = edata
						End Select
						
						DisplaySysMessage(.Nickname & "縺ｯ" & cname & "Invalid_string_refer_to_original_code")
						
						If AbilityMaxRange(a) > 0 Then
							is_useful = True
						End If
					End With
					
				Case "Invalid_string_refer_to_original_code"
					UpdateMessageForm(CurrentForm)
					If Not UDList.IsDefined(edata) Then
						ErrorMessage(edata & "Invalid_string_refer_to_original_code")
						Exit Function
					End If
					
					pname = UDList.Item(edata).FeatureData("Invalid_string_refer_to_original_code")
					If Not PDList.IsDefined(pname) Then
						ErrorMessage("Invalid_string_refer_to_original_code")
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						Exit Function
					End If
					
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					u = SearchNearestEnemy(Me)
					If Not u Is Nothing Then
						If System.Math.Abs(x - u.x) > System.Math.Abs(y - u.y) Then
							If x < u.x Then
								tx = x + 1
							ElseIf x > u.x Then 
								tx = x - 1
							Else
								tx = x
							End If
							ty = y
							
							tx2 = x
							If y < u.y Then
								ty2 = y + 1
							ElseIf y > u.y Then 
								ty2 = y - 1
							Else
								If y = 1 Then
									If MapDataForUnit(x, 2) Is Nothing Then
										ty2 = 2
									Else
										ty2 = 1
									End If
								ElseIf y = MapHeight Then 
									If MapDataForUnit(x, MapHeight - 1) Is Nothing Then
										ty2 = MapHeight - 1
									Else
										ty2 = MapHeight
									End If
								Else
									If MapDataForUnit(x, y - 1) Is Nothing Then
										ty2 = y - 1
									ElseIf MapDataForUnit(x, y + 1) Is Nothing Then 
										ty2 = y - 1
									Else
										ty2 = y
									End If
								End If
							End If
						Else
							tx = x
							If y < u.y Then
								ty = y + 1
							ElseIf y > u.y Then 
								ty = y - 1
							Else
								ty = y
							End If
							
							If x < u.x Then
								tx2 = x + 1
							ElseIf x > u.x Then 
								tx2 = x - 1
							Else
								If x = 1 Then
									If MapDataForUnit(2, y) Is Nothing Then
										tx2 = 2
									Else
										tx2 = 1
									End If
								ElseIf x = MapWidth Then 
									If MapDataForUnit(MapWidth - 1, y) Is Nothing Then
										tx2 = MapWidth - 1
									Else
										tx2 = MapWidth
									End If
								Else
									If MapDataForUnit(x - 1, y) Is Nothing Then
										tx2 = x - 1
									ElseIf MapDataForUnit(x + 1, y) Is Nothing Then 
										tx2 = x + 1
									Else
										tx2 = x
									End If
								End If
							End If
							ty2 = y
						End If
					Else
						tx = x
						ty = y
						tx2 = x
						ty2 = y
					End If
					
					For j = 1 To MaxLng(elevel, 1)
						If InStr(PDList.Item(pname).Name, "(繧ｶ繧ｳ)") > 0 Or InStr(PDList.Item(pname).Name, "(豎守畑)") > 0 Then
							p = PList.Add(pname, MainPilot.Level, Party)
							p.FullRecover()
							u = UList.Add(edata, Rank, Party)
						Else
							If Not PList.IsDefined(pname) Then
								p = PList.Add(pname, MainPilot.Level, Party)
								p.FullRecover()
								u = UList.Add(edata, Rank, Party)
							Else
								p = PList.Item(pname)
								u = p.Unit_Renamed
								If u Is Nothing Then
									If UList.IsDefined(edata) Then
										u = UList.Item(edata)
									Else
										u = UList.Add(edata, Rank, Party)
									End If
								End If
							End If
						End If
						p.Ride(u)
						AddServant(u)
						
						If Party = "蜻ｳ譁ｹ" Then
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							u.ChangeParty("Invalid_string_refer_to_original_code")
						End If
						'End If
						
						With u
							.Summoner = CurrentForm
							.FullRecover()
							.Mode = MainPilot.ID
							.UsedAction = 0
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'End If
							
							If .IsMessageDefined("逋ｺ騾ｲ") Then
								If Not frmMessage.Visible Then
									OpenMessageForm(Me)
								End If
								.PilotMessage("逋ｺ騾ｲ")
							End If
							
							'繝ｦ繝九ャ繝医ｒ驟咲ｽｮ
							If MapDataForUnit(tx, ty) Is Nothing And .IsAbleToEnter(tx, ty) Then
								.StandBy(tx, ty, "Invalid_string_refer_to_original_code")
							ElseIf MapDataForUnit(tx2, ty2) Is Nothing And .IsAbleToEnter(tx2, ty2) Then 
								.StandBy(tx2, ty2, "Invalid_string_refer_to_original_code")
							Else
								.StandBy(x, y, "Invalid_string_refer_to_original_code")
							End If
							
							'Invalid_string_refer_to_original_code
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'Invalid_string_refer_to_original_code
							DisplaySysMessage(Nickname & "縺ｯ" & .Nickname & "Invalid_string_refer_to_original_code")
							DeleteServant(.ID)
							.Status_Renamed = "Invalid_string_refer_to_original_code"
							'End If
						End With
					Next 
					
				Case "螟芽ｺｫ"
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					GoTo NextLoop
					'End If
					
					buf = t.Name
					
					t.Transform(LIndex(edata, 1))
					t = t.CurrentForm
					If elevel2 > 0 Then
						t.AddCondition("谿九ｊ譎る俣", MaxLng(CShort(elevel2), 1))
					End If
					
					For j = 2 To LLength(edata)
						buf = buf & " " & LIndex(edata, j)
					Next 
					t.AddCondition("Invalid_string_refer_to_original_code", -1, 1, buf)
					
					'Invalid_string_refer_to_original_code
					Exit For
					
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					GoTo NextLoop
					'End If
					
					Transform((t.Name))
					
					With CurrentForm
						If elevel2 > 0 Then
							.AddCondition("谿九ｊ譎る俣", MaxLng(CShort(elevel2), 1))
						End If
						
						'Invalid_string_refer_to_original_code
						buf = Name
						For j = 1 To LLength(edata)
							buf = buf & " " & LIndex(edata, j)
						Next 
						.AddCondition("Invalid_string_refer_to_original_code", -1, 1, buf)
						.AddCondition("Invalid_string_refer_to_original_code", -1)
						
						'Invalid_string_refer_to_original_code
						.AddCondition("Invalid_string_refer_to_original_code")
						"髱櫁｡ｨ遉ｺ " & t.MainPilot.Bitmap
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.AddCondition("Invalid_string_refer_to_original_code", -1, 0, "髱櫁｡ｨ遉ｺ " & t.MainPilot.MessageType)
					End With
					
					'Invalid_string_refer_to_original_code
					ExecuteAbility = True
					RestoreSelections()
					Exit Function
					
				Case "蜀崎｡悟虚"
					If Not t Is CurrentForm Then
						If t.Action = 0 And t.MaxAction > 0 Then
							If t.UsedAction > t.MaxAction Then
								t.UsedAction = t.MaxAction
							End If
							t.UsedAction = t.UsedAction - 1
							DisplaySysMessage(t.Nickname & "Invalid_string_refer_to_original_code")
							is_useful = True
						End If
					Else
						t.UsedAction = t.UsedAction - 1
					End If
			End Select
NextLoop: 
		Next 
		
		t.CurrentForm.Update()
		t.CurrentForm.CheckAutoHyperMode()
		t.CurrentForm.CheckAutoNormalMode()
		
		ExecuteAbility = is_useful
		
Finish: 
		
		'Invalid_string_refer_to_original_code
		RestoreSelections()
		
		'Invalid_string_refer_to_original_code
		If is_map_ability Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(partners)
			With partners(i).CurrentForm
				For j = 1 To .CountAbility
					'Invalid_string_refer_to_original_code
					If .Ability(j).Name = aname Then
						.UseAbility(j)
						If .IsAbilityClassifiedAs(j, "閾ｪ") Then
							If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
								uname = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), 2)
								If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
									.Transform(uname)
									With .CurrentForm
										.HP = .MaxHP
										.UsedAction = .MaxAction
									End With
								Else
									.Die()
								End If
							Else
								.Die()
							End If
						ElseIf .IsAbilityClassifiedAs(j, "螟ｱ") And .HP = 0 Then 
							.Die()
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If .IsFeatureAvailable("螟牙ｽ｢謚") Then
								For k = 1 To .CountFeature
									If .Feature(k) = "螟牙ｽ｢謚" And LIndex(.FeatureData(k), 1) = aname Then
										uname = LIndex(.FeatureData(k), 2)
										If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
											.Transform(uname)
										End If
										Exit For
									End If
								Next 
								If uname <> .CurrentForm.Name Then
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
										.Transform(uname)
									End If
								End If
							End If
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
								.Transform(uname)
							End If
						End If
					End If
					Exit For
					'End If
				Next 
				
				'Invalid_string_refer_to_original_code
				If j > .CountAbility Then
					If Ability(a).ENConsumption > 0 Then
						.EN = .EN - AbilityENConsumption(a)
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					.AddCondition("Invalid_string_refer_to_original_code")
				End If
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.DeleteCondition("Invalid_string_refer_to_original_code")
				'End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				hp_ratio = 100 * .HP / .MaxHP
				en_ratio = 100 * .EN / .MaxEN
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				.HP = .MaxHP * hp_ratio / 100
				.EN = .MaxEN * en_ratio / 100
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				hp_ratio = 100 * .HP / .MaxHP
				en_ratio = 100 * .EN / .MaxEN
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				.HP = .MaxHP * hp_ratio / 100
				.EN = .MaxEN * en_ratio / 100
				'End If
				If IsAbilityClassifiedAs(a, "螟ｱ") Then
					.HP = MaxLng(.HP - .MaxHP * AbilityLevel(a, "螟ｱ") \ 10, 0)
				End If
				If IsAbilityClassifiedAs(a, "閾ｪ") Then
					If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						uname = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), 2)
						If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
							.Transform(uname)
							With .CurrentForm
								.HP = .MaxHP
								.UsedAction = .MaxAction
							End With
						Else
							.Die()
						End If
					Else
						.Die()
					End If
				ElseIf IsAbilityClassifiedAs(a, "螟ｱ") And .HP = 0 Then 
					.Die()
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
						.Transform(uname)
					End If
				End If
				'End If
				'End If
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		With CurrentForm
			'Invalid_string_refer_to_original_code
			For i = 1 To .CountAbility
				If .Ability(i).Name = aname Then
					'Invalid_string_refer_to_original_code
					If .Ability(i).IsItem And .Stock(i) = 0 And .MaxStock(i) > 0 Then
						For j = 1 To .CountItem
							For k = 1 To .Item(j).CountAbility
								If .Item(j).Ability(k).Name = aname Then
									.Item(j).Exist = False
									.DeleteItem(j)
									.Update()
									GoTo ExitLoop
								End If
							Next 
						Next 
					End If
				End If
			Next 
ExitLoop: 
			
			'Invalid_string_refer_to_original_code
			If .HP = 0 Then
				.Die()
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		RedrawScreen()
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If is_useful And Not is_event And Not IsOptionDefined("Invalid_string_refer_to_original_code") Then
			GetExp(t, "Invalid_string_refer_to_original_code")
			If Not IsOptionDefined("Invalid_string_refer_to_original_code") Then
				For i = 1 To UBound(partners)
					partners(i).CurrentForm.GetExp(t, "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code")
				Next 
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		
		'Invalid_string_refer_to_original_code
		If IsAbilityClassifiedAs(a, "閾ｪ") Then
			If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				uname = LIndex(FeatureData("Invalid_string_refer_to_original_code"), 2)
				If OtherForm(uname).IsAbleToEnter(x, y) Then
					Transform(uname)
					With CurrentForm
						.HP = .MaxHP
						.UsedAction = .MaxAction
					End With
					fname = FeatureName("Invalid_string_refer_to_original_code")
					If IsSysMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then
						SysMessage("Invalid_string_refer_to_original_code" & Name & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
						SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
						SysMessage("Invalid_string_refer_to_original_code")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then 
						SysMessage("Invalid_string_refer_to_original_code" & Name & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
						SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
						SysMessage("Invalid_string_refer_to_original_code")
					Else
						DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
					End If
				Else
					Die()
				End If
			Else
				Die()
			End If
			
			'Invalid_string_refer_to_original_code
		ElseIf IsAbilityClassifiedAs(a, "螟ｱ") And HP = 0 Then 
			Die()
			
			'螟牙ｽ｢謚
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If IsFeatureAvailable("螟牙ｽ｢謚") Then
				For i = 1 To CountFeature
					If Feature(i) = "螟牙ｽ｢謚" And LIndex(FeatureData(i), 1) = Ability(a).Name Then
						uname = LIndex(FeatureData(i), 2)
						If OtherForm(uname).IsAbleToEnter(x, y) Then
							Transform(uname)
						End If
						Exit For
					End If
				Next 
				If uname <> CurrentForm.Name Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If OtherForm(uname).IsAbleToEnter(x, y) Then
						Transform(uname)
					End If
				End If
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If OtherForm(uname).IsAbleToEnter(x, y) Then
				Transform(uname)
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: ExecuteAbility に変換されていないステートメントがあります。ソース コードを確認してください。
		'Invalid_string_refer_to_original_code
		num = Data.CountAbility
		num = num + MainPilot.Data.CountAbility
		For i = 2 To CountPilot
			num = num + Pilot(i).Data.CountAbility
		Next 
		For i = 2 To CountSupport
			num = num + Support(i).Data.CountAbility
		Next 
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		num = num + AdditionalSupport.Data.CountAbility
		'End If
		For	Each itm In colItem
			num = num + itm.CountAbility
			If a <= num Then
				itm.Exist = False
				DeleteItem((itm.ID))
				Exit For
			End If
		Next itm
		'End If
		
		' ADD START MARGE
		'Invalid_string_refer_to_original_code
		If IsAnimationDefined(aname & "Invalid_string_refer_to_original_code") Then
			PlayAnimation(aname & "Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			PlayAnimation("Invalid_string_refer_to_original_code")
		End If
		' ADD END MARGE
		
		With CurrentForm
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			.DeleteCondition("Invalid_string_refer_to_original_code")
			.BitmapID = MakeUnitBitmap(CurrentForm)
			PaintUnitBitmap(CurrentForm)
			'End If
			If .IsConditionSatisfied("髱櫁｡ｨ遉ｺ莉伜刈") Then
				.DeleteCondition("髱櫁｡ｨ遉ｺ莉伜刈")
				.BitmapID = MakeUnitBitmap(CurrentForm)
				PaintUnitBitmap(CurrentForm)
			End If
		End With
		For i = 1 To UBound(partners)
			With partners(i).CurrentForm
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.DeleteCondition("Invalid_string_refer_to_original_code")
				.BitmapID = MakeUnitBitmap(partners(i).CurrentForm)
				PaintUnitBitmap(partners(i).CurrentForm)
				'End If
				If .IsConditionSatisfied("髱櫁｡ｨ遉ｺ莉伜刈") Then
					.DeleteCondition("髱櫁｡ｨ遉ｺ莉伜刈")
					.BitmapID = MakeUnitBitmap(partners(i).CurrentForm)
					PaintUnitBitmap(partners(i).CurrentForm)
				End If
			End With
		Next 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub ExecuteMapAbility(ByVal a As Short, ByVal tx As Short, ByVal ty As Short, Optional ByVal is_event As Boolean = False)
		Dim k, i, j, num As Short
		Dim t, max_lv_t As Unit
		Dim targets() As Unit
		Dim partners() As Unit
		Dim is_useful As Boolean
		Dim anickname, aname, msg As String
		Dim min_range, max_range As Short
		Dim rx, ry As Short
		Dim uname, fname As String
		Dim hp_ratio, en_ratio As Double
		Dim itm As Item
		
		aname = Ability(a).Name
		anickname = AbilityNickname(a)
		
		If Not is_event Then
			'Invalid_string_refer_to_original_code
			HandleEvent("菴ｿ逕ｨ", MainPilot.ID, aname)
			If IsScenarioFinished Then
				Exit Sub
			End If
			If IsCanceled Then
				IsCanceled = False
				Exit Sub
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		min_range = AbilityMinRange(a)
		max_range = AbilityMaxRange(a)
		If IsAbilityClassifiedAs(a, "Invalid_string_refer_to_original_code") Then
			If ty < y Then
				AreaInLine(x, y, min_range, max_range, "N")
			ElseIf ty > y Then 
				AreaInLine(x, y, min_range, max_range, "S")
			ElseIf tx < x Then 
				AreaInLine(x, y, min_range, max_range, "W")
			Else
				AreaInLine(x, y, min_range, max_range, "E")
			End If
		ElseIf IsAbilityClassifiedAs(a, "Invalid_string_refer_to_original_code") Then 
			If ty < y And System.Math.Abs(y - ty) > System.Math.Abs(x - tx) Then
				AreaInCone(x, y, min_range, max_range, "N")
			ElseIf ty > y And System.Math.Abs(y - ty) > System.Math.Abs(x - tx) Then 
				AreaInCone(x, y, min_range, max_range, "S")
			ElseIf tx < x And System.Math.Abs(x - tx) > System.Math.Abs(y - ty) Then 
				AreaInCone(x, y, min_range, max_range, "W")
			Else
				AreaInCone(x, y, min_range, max_range, "E")
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If ty < y And System.Math.Abs(y - ty) >= System.Math.Abs(x - tx) Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			ElseIf ty > y And System.Math.Abs(y - ty) >= System.Math.Abs(x - tx) Then 
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			ElseIf tx < x And System.Math.Abs(x - tx) >= System.Math.Abs(y - ty) Then 
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		ElseIf IsAbilityClassifiedAs(a, "Invalid_string_refer_to_original_code") Then 
			AreaInRange(x, y, max_range, min_range, "縺吶∋縺ｦ")
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			AreaInPointToPoint(x, y, tx, ty)
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To MapWidth
			For j = 1 To MapHeight
				If Not MaskData(i, j) Then
					t = MapDataForUnit(i, j)
					If Not t Is Nothing Then
						'Invalid_string_refer_to_original_code
						If IsAbilityEffective(a, t) Then
							MaskData(i, j) = False
						Else
							MaskData(i, j) = True
						End If
					End If
				End If
			Next 
		Next 
		
		'Invalid_string_refer_to_original_code
		If IsAbilityClassifiedAs(a, "謠ｴ") Then
			MaskData(x, y) = True
		End If
		
		'Invalid_string_refer_to_original_code
		ReDim targets(0)
		For i = 1 To MapWidth
			For j = 1 To MapHeight
				'Invalid_string_refer_to_original_code
				If MaskData(i, j) Then
					GoTo NextLoop
				End If
				t = MapDataForUnit(i, j)
				If t Is Nothing Then
					GoTo NextLoop
				End If
				If Not IsAbilityApplicable(a, t) Then
					MaskData(i, j) = True
					GoTo NextLoop
				End If
				
				ReDim Preserve targets(UBound(targets) + 1)
				targets(UBound(targets)) = t
NextLoop: 
			Next 
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		rx = tx
		ry = ty
		Dim min_item, min_value As Short
		Dim TmpMaskData() As Boolean
		rx = x
		ry = y
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(targets) - 1
			
			min_item = i
			With targets(i)
				min_value = System.Math.Abs(.x - rx) + System.Math.Abs(.y - ry)
			End With
			For j = i + 1 To UBound(targets)
				With targets(j)
					If System.Math.Abs(.x - rx) + System.Math.Abs(.y - ry) < min_value Then
						min_item = j
						min_value = System.Math.Abs(.x - rx) + System.Math.Abs(.y - ry)
					End If
				End With
			Next 
			If min_item <> i Then
				t = targets(i)
				targets(i) = targets(min_item)
				targets(min_item) = t
			End If
		Next 
		
		'蜷井ｽ捺橿
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		ReDim TmpMaskData(MapWidth, MapHeight)
		For i = 1 To MapWidth
			For j = 1 To MapHeight
				TmpMaskData(i, j) = MaskData(i, j)
			Next 
		Next 
		
		CombinationPartner("Invalid_string_refer_to_original_code", a, partners)
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(partners)
			With partners(i)
				MaskData(.x, .y) = False
				TmpMaskData(.x, .y) = True
			End With
		Next 
		
		MaskScreen()
		
		'Invalid_string_refer_to_original_code
		For i = 1 To MapWidth
			For j = 1 To MapHeight
				MaskData(i, j) = TmpMaskData(i, j)
			Next 
		Next 
		ReDim partners(0)
		ReDim SelectedPartners(0)
		MaskScreen()
		'End If
		
		OpenMessageForm(Me)
		
		'Invalid_string_refer_to_original_code
		SaveSelections()
		
		'Invalid_string_refer_to_original_code
		SelectedUnit = Me
		SelectedUnitForEvent = Me
		SelectedAbility = a
		SelectedAbilityName = Ability(a).Name
		SelectedX = tx
		SelectedY = ty
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_NOTE: オブジェクト SelectedTarget をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SelectedTarget = Nothing
		'UPGRADE_NOTE: オブジェクト SelectedTargetForEvent をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SelectedTargetForEvent = Nothing
		
		'Invalid_string_refer_to_original_code
		If IsAnimationDefined(aname & "(貅門ｙ)") Then
			PlayAnimation(aname & "(貅門ｙ)")
		End If
		If IsMessageDefined("縺九¢螢ｰ(" & aname & ")") Then
			PilotMessage("縺九¢螢ｰ(" & aname & ")")
		End If
		PilotMessage(aname, "Invalid_string_refer_to_original_code")
		If IsAnimationDefined(aname & "(菴ｿ逕ｨ)") Then
			PlayAnimation(aname & "(菴ｿ逕ｨ)", "", True)
		Else
			SpecialEffect(aname, "", True)
		End If
		
		'Invalid_string_refer_to_original_code
		UseAbility(a)
		
		UpdateMessageForm(Me)
		
		Select Case UBound(partners)
			Case 0
				'騾壼ｸｸ
				msg = Nickname & "縺ｯ"
			Case 1
				'Invalid_string_refer_to_original_code
				If Nickname <> partners(1).Nickname Then
					msg = Nickname & "縺ｯ[" & partners(1).Nickname & "]縺ｨ蜈ｱ縺ｫ"
				ElseIf MainPilot.Nickname <> partners(1).MainPilot.Nickname Then 
					msg = MainPilot.Nickname & "縺ｨ[" & partners(1).MainPilot.Nickname & "]縺ｮ[" & Nickname & "]縺ｯ"
				Else
					msg = Nickname & "Invalid_string_refer_to_original_code"
				End If
			Case 2
				'Invalid_string_refer_to_original_code
				If Nickname <> partners(1).Nickname Then
					msg = Nickname & "縺ｯ[" & partners(1).Nickname & "]縲ー" & partners(2).Nickname & "]縺ｨ蜈ｱ縺ｫ"
				ElseIf MainPilot.Nickname <> partners(1).MainPilot.Nickname Then 
					msg = MainPilot.Nickname & "縲ー" & partners(1).MainPilot.Nickname & "]縲ー" & partners(2).MainPilot.Nickname & "]縺ｮ[" & Nickname & "]縺ｯ"
				Else
					msg = Nickname & "Invalid_string_refer_to_original_code"
				End If
			Case Else
				'Invalid_string_refer_to_original_code
				msg = Nickname & "Invalid_string_refer_to_original_code"
		End Select
		
		If IsSpellAbility(a) Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & anickname & "Invalid_string_refer_to_original_code"
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			msg = msg & "[" & Left(anickname, Len(anickname) - 2) & "Invalid_string_refer_to_original_code"
		Else
			msg = msg & "[" & anickname & "Invalid_string_refer_to_original_code"
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		msg = msg & "[" & anickname & "Invalid_string_refer_to_original_code"
		'UPGRADE_WARNING: ExecuteMapAbility に変換されていないステートメントがあります。ソース コードを確認してください。
		msg = msg & "[" & anickname & "Invalid_string_refer_to_original_code"
		msg = msg & "[" & anickname & "Invalid_string_refer_to_original_code"
		'End If
		
		If IsSysMessageDefined(aname) Then
			'Invalid_string_refer_to_original_code
			SysMessage(aname)
		ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
			'Invalid_string_refer_to_original_code
			SysMessage("Invalid_string_refer_to_original_code")
		Else
			DisplaySysMessage(msg)
		End If
		
		'Invalid_string_refer_to_original_code
		RestoreSelections()
		
		'Invalid_string_refer_to_original_code
		If Dice(10) <= AbilityLevel(a, "髮｣") Then
			DisplaySysMessage("縺励°縺嶺ｽ輔ｂ縺翫″縺ｪ縺九▲縺溪ｦ")
			GoTo Finish
		End If
		
		'Invalid_string_refer_to_original_code
		SelectedTarget = Me
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_NOTE: オブジェクト max_lv_t をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		max_lv_t = Nothing
		For i = 1 To UBound(targets)
			t = targets(i).CurrentForm
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If t Is Me Then
				UpdateMessageForm(Me)
			Else
				UpdateMessageForm(t, Me)
			End If
			
			If ExecuteAbility(a, t, True) Then
				t = t.CurrentForm
				
				is_useful = True
				
				'Invalid_string_refer_to_original_code
				'繝ｦ繝九ャ繝医ｒ豎ゅａ縺ｦ縺翫￥
				If max_lv_t Is Nothing Then
					max_lv_t = t
				Else
					If t.MainPilot.Level > max_lv_t.MainPilot.Level Then
						max_lv_t = t
					End If
				End If
			End If
			'End If
		Next 
		
		' ADD START MARGE
		'Invalid_string_refer_to_original_code
		If IsAnimationDefined(aname & "Invalid_string_refer_to_original_code") Then
			PlayAnimation(aname & "Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			PlayAnimation("Invalid_string_refer_to_original_code")
		End If
		' ADD END MARGE
		
		With CurrentForm
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			.DeleteCondition("Invalid_string_refer_to_original_code")
			.BitmapID = MakeUnitBitmap(CurrentForm)
			PaintUnitBitmap(CurrentForm)
			'End If
			If .IsConditionSatisfied("髱櫁｡ｨ遉ｺ莉伜刈") Then
				.DeleteCondition("髱櫁｡ｨ遉ｺ莉伜刈")
				.BitmapID = MakeUnitBitmap(CurrentForm)
				PaintUnitBitmap(CurrentForm)
			End If
		End With
		For i = 1 To UBound(partners)
			With partners(i).CurrentForm
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.DeleteCondition("Invalid_string_refer_to_original_code")
				.BitmapID = MakeUnitBitmap(partners(i).CurrentForm)
				PaintUnitBitmap(partners(i).CurrentForm)
				'End If
				If .IsConditionSatisfied("髱櫁｡ｨ遉ｺ莉伜刈") Then
					.DeleteCondition("髱櫁｡ｨ遉ｺ莉伜刈")
					.BitmapID = MakeUnitBitmap(partners(i).CurrentForm)
					PaintUnitBitmap(partners(i).CurrentForm)
				End If
			End With
		Next 
		
		'迯ｲ蠕励＠縺溽ｵ碁ｨ灘､縺ｮ陦ｨ遉ｺ
		If is_useful And Not is_event And Not IsOptionDefined("Invalid_string_refer_to_original_code") Then
			GetExp(max_lv_t, "Invalid_string_refer_to_original_code")
			If Not IsOptionDefined("Invalid_string_refer_to_original_code") Then
				For i = 1 To UBound(partners)
					partners(i).CurrentForm.GetExp(Nothing, "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code")
				Next 
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(partners)
			With partners(i).CurrentForm
				For j = 1 To .CountAbility
					'Invalid_string_refer_to_original_code
					If .Ability(j).Name = aname Then
						.UseAbility(j)
						If .IsAbilityClassifiedAs(j, "閾ｪ") Then
							If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
								uname = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), 2)
								If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
									.Transform(uname)
									With .CurrentForm
										.HP = .MaxHP
										.UsedAction = .MaxAction
									End With
								Else
									.Die()
								End If
							Else
								.Die()
							End If
						ElseIf .IsAbilityClassifiedAs(j, "螟ｱ") And .HP = 0 Then 
							.Die()
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If .IsFeatureAvailable("螟牙ｽ｢謚") Then
								For k = 1 To .CountFeature
									If .Feature(k) = "螟牙ｽ｢謚" And LIndex(.FeatureData(k), 1) = aname Then
										uname = LIndex(.FeatureData(k), 2)
										If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
											.Transform(uname)
										End If
										Exit For
									End If
								Next 
								If uname <> .CurrentForm.Name Then
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									'Invalid_string_refer_to_original_code
									'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
									If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
										.Transform(uname)
									End If
								End If
							End If
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
								.Transform(uname)
							End If
						End If
					End If
					Exit For
					'End If
				Next 
				
				'Invalid_string_refer_to_original_code
				If j > .CountAbility Then
					If Ability(a).ENConsumption > 0 Then
						.EN = .EN - AbilityENConsumption(a)
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					.AddCondition("Invalid_string_refer_to_original_code")
				End If
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.DeleteCondition("Invalid_string_refer_to_original_code")
				'End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				hp_ratio = 100 * .HP / .MaxHP
				en_ratio = 100 * .EN / .MaxEN
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				.HP = .MaxHP * hp_ratio / 100
				.EN = .MaxEN * en_ratio / 100
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				hp_ratio = 100 * .HP / .MaxHP
				en_ratio = 100 * .EN / .MaxEN
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				.HP = .MaxHP * hp_ratio / 100
				.EN = .MaxEN * en_ratio / 100
				'End If
				If IsAbilityClassifiedAs(a, "螟ｱ") Then
					.HP = MaxLng(.HP - .MaxHP * AbilityLevel(a, "螟ｱ") \ 10, 0)
				End If
				If IsAbilityClassifiedAs(a, "閾ｪ") Then
					If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						uname = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), 2)
						If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
							.Transform(uname)
							With .CurrentForm
								.HP = .MaxHP
								.UsedAction = .MaxAction
							End With
						Else
							.Die()
						End If
					Else
						.Die()
					End If
				ElseIf IsAbilityClassifiedAs(a, "螟ｱ") And .HP = 0 Then 
					.Die()
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
						.Transform(uname)
					End If
				End If
				'End If
				'End If
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		If IsAbilityClassifiedAs(a, "Invalid_string_refer_to_original_code") Then
			Jump(tx, ty)
		End If
		
Finish: 
		
		'Invalid_string_refer_to_original_code
		
		'Invalid_string_refer_to_original_code
		If IsAbilityClassifiedAs(a, "閾ｪ") Then
			If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				'Invalid_string_refer_to_original_code
				uname = LIndex(FeatureData("Invalid_string_refer_to_original_code"), 2)
				If OtherForm(uname).IsAbleToEnter(x, y) Then
					Transform(uname)
					With CurrentForm
						.HP = .MaxHP
						.UsedAction = .MaxAction
					End With
					fname = FeatureName("Invalid_string_refer_to_original_code")
					If IsSysMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then
						SysMessage("Invalid_string_refer_to_original_code" & Name & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
						SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
						SysMessage("Invalid_string_refer_to_original_code")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then 
						SysMessage("Invalid_string_refer_to_original_code" & Name & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
						SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
					ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
						SysMessage("Invalid_string_refer_to_original_code")
					Else
						DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
					End If
				Else
					'Invalid_string_refer_to_original_code
					Die()
					If Not is_event Then
						HandleEvent("Invalid_string_refer_to_original_code")
						If IsScenarioFinished Then
							Exit Sub
						End If
					End If
				End If
			Else
				Die()
				If Not is_event Then
					HandleEvent("Invalid_string_refer_to_original_code")
					If IsScenarioFinished Then
						Exit Sub
					End If
				End If
			End If
			
			'Invalid_string_refer_to_original_code
		ElseIf IsAbilityClassifiedAs(a, "螟ｱ") And HP = 0 Then 
			Die()
			If Not is_event Then
				HandleEvent("Invalid_string_refer_to_original_code")
				If IsScenarioFinished Then
					Exit Sub
				End If
			End If
			
			'螟牙ｽ｢謚
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If IsFeatureAvailable("螟牙ｽ｢謚") Then
				For i = 1 To CountFeature
					If Feature(i) = "螟牙ｽ｢謚" And LIndex(FeatureData(i), 1) = Ability(a).Name Then
						uname = LIndex(FeatureData(i), 2)
						If OtherForm(uname).IsAbleToEnter(x, y) Then
							Transform(uname)
						End If
						Exit For
					End If
				Next 
				If uname <> CurrentForm.Name Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If OtherForm(uname).IsAbleToEnter(x, y) Then
						Transform(uname)
					End If
				End If
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If OtherForm(uname).IsAbleToEnter(x, y) Then
				Transform(uname)
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: ExecuteMapAbility に変換されていないステートメントがあります。ソース コードを確認してください。
		'Invalid_string_refer_to_original_code
		num = Data.CountAbility
		num = num + MainPilot.Data.CountAbility
		For i = 2 To CountPilot
			num = num + Pilot(i).Data.CountAbility
		Next 
		For i = 2 To CountSupport
			num = num + Support(i).Data.CountAbility
		Next 
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		num = num + AdditionalSupport.Data.CountAbility
		'End If
		For	Each itm In colItem
			num = num + itm.CountAbility
			If a <= num Then
				itm.Exist = False
				DeleteItem((itm.ID))
				Exit For
			End If
		Next itm
		'End If
		
		'Invalid_string_refer_to_original_code
		If Not is_event Then
			HandleEvent("Invalid_string_refer_to_original_code")
			If IsScenarioFinished Or IsCanceled Then
				Exit Sub
			End If
		End If
		
		CloseMessageForm()
		
		'Invalid_string_refer_to_original_code
		UList.CheckAutoHyperMode()
		UList.CheckAutoNormalMode()
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub UseAbility(ByVal a As Short)
		Dim i, lv As Short
		Dim hp_ratio, en_ratio As Double
		
		If Ability(a).ENConsumption > 0 Then
			EN = EN - AbilityENConsumption(a)
		End If
		
		If Ability(a).Stock > 0 Then
			SetStock(a, Stock(a) - 1)
			
			'荳譁我ｽｿ逕ｨ
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			For i = 1 To UBound(dblStock)
				SetStock(i, MinLng(MaxStock(i) * Stock(a) \ MaxStock(a), Stock(i)))
			Next 
		Else
			For i = 1 To UBound(dblStock)
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				SetStock(i, MinLng(CShort(MaxStock(i) * Stock(a) \ MaxStock(a) + 0.49999), Stock(i)))
			Next 
		End If
		'Next
		'End If
		
		'Invalid_string_refer_to_original_code
		SyncBullet()
		'End If
		
		'豸郁玲橿
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		AddCondition("Invalid_string_refer_to_original_code")
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsAbilityClassifiedAs(a, "蟆ｽ") Then
			EN = 0
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		DeleteCondition("Invalid_string_refer_to_original_code")
		'End If
		
		'Invalid_string_refer_to_original_code
		If AbilityLevel(a, "Invalid_string_refer_to_original_code") > 0 Then
			AddCondition(AbilityNickname(a) & "Invalid_string_refer_to_original_code", AbilityLevel(a, "Invalid_string_refer_to_original_code"))
		End If
		
		'豌怜鴨繧呈ｶ郁ｲｻ
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		
		'髴雁鴨縺ｮ豸郁ｲｻ
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		hp_ratio = 100 * HP / MaxHP
		en_ratio = 100 * EN / MaxEN
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		HP = MaxHP * hp_ratio / 100
		EN = MaxEN * en_ratio / 100
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		hp_ratio = 100 * HP / MaxHP
		en_ratio = 100 * EN / MaxEN
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		HP = MaxHP * hp_ratio / 100
		EN = MaxEN * en_ratio / 100
		'End If
		
		'Invalid_string_refer_to_original_code
		If Party = "蜻ｳ譁ｹ" Then
			If IsAbilityClassifiedAs(a, "驫ｭ") Then
				IncrMoney(-MaxLng(AbilityLevel(a, "驫ｭ"), 1) * Value \ 10)
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If IsAbilityClassifiedAs(a, "螟ｱ") Then
			HP = MaxLng(HP - MaxHP * AbilityLevel(a, "螟ｱ") \ 10, 0)
		End If
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Function MaxItemNum() As Short
		Dim i As Short
		
		MaxItemNum = Data.ItemNum
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		For i = 1 To CountFeature
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			MaxItemNum = MaxItemNum + FeatureLevel(i)
			Exit For
			'End If
		Next 
		'End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CountItem() As Short
		CountItem = colItem.Count()
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Item(ByRef Index As Object) As Item
		Dim itm As Item
		
		On Error GoTo ErrorHandler
		
		Item = colItem.Item(Index)
		
		Exit Function
		
ErrorHandler: 
		'Invalid_string_refer_to_original_code
		For	Each itm In colItem
			'UPGRADE_WARNING: オブジェクト Index の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			If itm.Name = Index Then
				Item = itm
				Exit Function
			End If
		Next itm
		'UPGRADE_NOTE: オブジェクト Item をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		Item = Nothing
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub AddItem(ByRef itm As Item, Optional ByVal without_refresh As Boolean = False)
		Dim i, num As Short
		Dim itm2 As Item
		Dim empty_slot As Short
		Dim found_item As Boolean
		
		'Invalid_string_refer_to_original_code
		If itm.Unit Is Me Then
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If itm.IsFeatureAvailable("髱櫁｡ｨ遉ｺ") Then
			GoTo EquipItem
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		Select Case itm.Part
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				num = 0
				For	Each itm2 In colItem
					With itm2
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						num = num + .Size
						'End If
					End With
				Next itm2
				
				'Invalid_string_refer_to_original_code
				num = num + itm.FeatureLevel("Invalid_string_refer_to_original_code")
				
				'Invalid_string_refer_to_original_code
				Do While num >= MaxItemNum And num > 0
					found_item = False
					
					'Invalid_string_refer_to_original_code
					For	Each itm2 In colItem
						With itm2
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							num = num - .Size
							If Party0 <> "蜻ｳ譁ｹ" Then
								.Exist = False
							End If
							DeleteItem(.ID)
							'UPGRADE_NOTE: オブジェクト itm2 をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
							itm2 = Nothing
							found_item = True
							Exit For
							'End If
							'End If
						End With
					Next itm2
					
					'Invalid_string_refer_to_original_code
					If Not itm2 Is Nothing Then
						num = num - Item(1).Size
						If Party0 <> "蜻ｳ譁ｹ" Then
							Item(1).Exist = False
						End If
						DeleteItem(1)
						found_item = True
					End If
					
					If Not found_item Then
						'Invalid_string_refer_to_original_code
						Exit Do
					End If
				Loop 
				
				If MaxItemNum = 0 Then
					'Invalid_string_refer_to_original_code
					Exit Sub
				End If
				'End If
				
			Case "Invalid_string_refer_to_original_code"
				For	Each itm2 In colItem
					With itm2
						'Invalid_string_refer_to_original_code_
						'Invalid_string_refer_to_original_code_
						'Or .Part = "逶ｾ" _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If Party0 <> "蜻ｳ譁ｹ" Then
							.Exist = False
						End If
						DeleteItem(.ID)
						Exit For
						'End If
					End With
				Next itm2
				
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				num = 0
				For	Each itm2 In colItem
					With itm2
						Select Case .Part
							Case "Invalid_string_refer_to_original_code"
								If Party0 <> "蜻ｳ譁ｹ" Then
									.Exist = False
								End If
								DeleteItem(.ID)
								Exit For
							Case "Invalid_string_refer_to_original_code", "逶ｾ"
								num = num + 1
								If num > 1 Then
									If Party0 <> "蜻ｳ譁ｹ" Then
										.Exist = False
									End If
									DeleteItem(.ID)
									Exit For
								End If
						End Select
					End With
				Next itm2
				For	Each itm2 In colItem
					With itm2
						Select Case .Part
							Case "Invalid_string_refer_to_original_code"
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								If Party0 <> "蜻ｳ譁ｹ" Then
									.Exist = False
								End If
								DeleteItem(.ID)
								Exit For
						End Select
					End With
				Next itm2
				'End If
				
			Case "逶ｾ"
				For	Each itm2 In colItem
					With itm2
						Select Case .Part
							Case "Invalid_string_refer_to_original_code"
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								If Party0 <> "蜻ｳ譁ｹ" Then
									.Exist = False
								End If
								DeleteItem(.ID)
								Exit For
							Case "Invalid_string_refer_to_original_code"
								i = i + 1
								If i > 1 Then
									If Party0 <> "蜻ｳ譁ｹ" Then
										.Exist = False
									End If
									DeleteItem(.ID)
									Exit For
								End If
						End Select
					End With
				Next itm2
				
			Case "荳｡閧ｩ"
				For	Each itm2 In colItem
					With itm2
						If .Part = "荳｡閧ｩ" Or .Part = "閧ｩ" Then
							If Party0 <> "蜻ｳ譁ｹ" Then
								.Exist = False
							End If
							DeleteItem(.ID)
						End If
					End With
				Next itm2
				
			Case "閧ｩ"
				num = 0
				For	Each itm2 In colItem
					With itm2
						Select Case .Part
							Case "荳｡閧ｩ"
								If Party0 <> "蜻ｳ譁ｹ" Then
									.Exist = False
								End If
								DeleteItem(.ID)
								Exit For
							Case "閧ｩ"
								num = num + 1
								If num > 1 Then
									If Party0 <> "蜻ｳ譁ｹ" Then
										.Exist = False
									End If
									DeleteItem(.ID)
									Exit For
								End If
						End Select
					End With
				Next itm2
				
			Case "髱櫁｡ｨ遉ｺ"
				'Invalid_string_refer_to_original_code
				
			Case Else
				'Invalid_string_refer_to_original_code
				For i = 1 To CountFeature
					'Invalid_string_refer_to_original_code_
					'And FeatureData(i) = itm.Part _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					empty_slot = ItemSlotSize(itm.Part)
					For	Each itm2 In colItem
						With itm2
							If .Part = itm.Part Then
								empty_slot = empty_slot - .Size
							End If
						End With
					Next itm2
					'Invalid_string_refer_to_original_code
					If empty_slot < itm.Size Then
						For	Each itm2 In colItem
							With itm2
								If .Part = itm.Part Then
									If Party0 <> "蜻ｳ譁ｹ" Then
										.Exist = False
									End If
									DeleteItem(.ID)
									empty_slot = empty_slot + .Size
									If empty_slot >= itm.Size Then
										Exit For
									End If
								End If
							End With
						Next itm2
					End If
					i = 0
					Exit For
					'End If
				Next 
				'Invalid_string_refer_to_original_code
				If i > 0 Then
					For	Each itm2 In colItem
						With itm2
							If itm.Part = .Part Then
								If Party0 <> "蜻ｳ譁ｹ" Then
									.Exist = False
								End If
								DeleteItem(.ID)
								Exit For
							End If
						End With
					Next itm2
				End If
		End Select
		
EquipItem: 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		itm.Exist = True
		'End If
		
		colItem.Add(itm, itm.ID)
		itm.Unit = Me
		
		'Invalid_string_refer_to_original_code
		Update(without_refresh)
	End Sub
	
	Public Sub AddItem0(ByRef itm As Item)
		colItem.Add(itm, itm.ID)
		itm.Unit = Me
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub DeleteItem(ByRef Index As Object, Optional ByVal without_refresh As Boolean = False)
		Dim itm, itm2 As Item
		Dim num, i, j, num2 As Short
		Dim prev_max_item_num As Short
		Dim prev_hard_point() As String
		Dim prev_hard_point_size() As Short
		Dim cur_hard_point() As String
		Dim cur_hard_point_size() As Short
		Dim is_changed As Boolean
		Dim is_ambidextrous As Boolean
		
		itm = Item(Index)
		
		'Invalid_string_refer_to_original_code
		If itm Is Nothing Then
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		num = Data.CountWeapon
		num2 = Data.CountAbility
		If CountPilot > 0 Then
			num = num + MainPilot.Data.CountWeapon
			num2 = num2 + MainPilot.Data.CountAbility
			For i = 2 To CountPilot
				num = num + Pilot(i).Data.CountWeapon
				num2 = num2 + Pilot(i).Data.CountAbility
			Next 
			For i = 2 To CountSupport
				num = num + Support(i).Data.CountWeapon
				num2 = num2 + Support(i).Data.CountAbility
			Next 
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			num = num + AdditionalSupport.Data.CountWeapon
			num2 = num2 + AdditionalSupport.Data.CountAbility
		End If
		'End If
		For	Each itm2 In colItem
			With itm2
				If itm Is itm2 Then
					For i = num + 1 To num + .CountWeapon
						If i <= CountWeapon Then
							'UPGRADE_NOTE: オブジェクト WData() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
							WData(i) = Nothing
						End If
					Next 
					For i = num2 + 1 To num2 + .CountAbility
						If i <= CountAbility Then
							'UPGRADE_NOTE: オブジェクト adata() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
							adata(i) = Nothing
						End If
					Next 
					Exit For
				Else
					num = num + .CountWeapon
					num2 = num2 + .CountAbility
				End If
			End With
		Next itm2
		
		With itm
			colItem.Remove(.ID)
			If Not .Unit Is Nothing Then
				If .Unit.ID = ID Then
					'UPGRADE_NOTE: オブジェクト itm.Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
					.Unit = Nothing
				End If
				'Invalid_string_refer_to_original_code
				If itm.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
					If PList.IsDefined(.FeatureData("Invalid_string_refer_to_original_code")) Then
						With PList.Item(.FeatureData("Invalid_string_refer_to_original_code"))
							.Alive = False
							'UPGRADE_NOTE: オブジェクト PList.Item().Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
							.Unit_Renamed = Nothing
						End With
					End If
				End If
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		Do 
			is_changed = False
			
			'Invalid_string_refer_to_original_code
			prev_max_item_num = MaxItemNum
			ReDim prev_hard_point(0)
			ReDim prev_hard_point_size(0)
			For i = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				For j = 1 To UBound(prev_hard_point)
					If prev_hard_point(j) = FeatureData(i) Then
						prev_hard_point_size(j) = prev_hard_point_size(j) + FeatureLevel(i)
						Exit For
					End If
				Next 
				If j > UBound(prev_hard_point) Then
					ReDim Preserve prev_hard_point(UBound(prev_hard_point) + 1)
					ReDim Preserve prev_hard_point_size(UBound(prev_hard_point))
					prev_hard_point(UBound(prev_hard_point)) = FeatureData(i)
					prev_hard_point_size(UBound(prev_hard_point)) = FeatureLevel(i)
				End If
				'End If
				'End If
			Next 
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			
			'Invalid_string_refer_to_original_code
			Update(without_refresh)
			
			'Invalid_string_refer_to_original_code
			If prev_max_item_num > MaxItemNum Then
				is_changed = True
				num = MaxItemNum
				
				i = 0
				For	Each itm In colItem
					With itm
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						i = i + 1
						'Invalid_string_refer_to_original_code
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						colItem.Remove(.ID)
						If Not .Unit Is Nothing Then
							If .Unit.ID = ID Then
								'UPGRADE_NOTE: オブジェクト itm.Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
								.Unit = Nothing
							End If
						End If
						'Invalid_string_refer_to_original_code
						If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
							If PList.IsDefined(.FeatureData("Invalid_string_refer_to_original_code")) Then
								With PList.Item(.FeatureData("Invalid_string_refer_to_original_code"))
									.Alive = False
									'UPGRADE_NOTE: オブジェクト PList.Item().Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
									.Unit_Renamed = Nothing
								End With
							End If
						End If
					End With
				Next itm
			End If
			'End If
			'End With
			'Next
			
			i = 0
			For	Each itm In colItem
				With itm
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					i = i + 1
					If i > num Then
						colItem.Remove(.ID)
						If Not .Unit Is Nothing Then
							If .Unit.ID = ID Then
								'UPGRADE_NOTE: オブジェクト itm.Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
								.Unit = Nothing
							End If
						End If
						'Invalid_string_refer_to_original_code
						If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
							If PList.IsDefined(.FeatureData("Invalid_string_refer_to_original_code")) Then
								With PList.Item(.FeatureData("Invalid_string_refer_to_original_code"))
									.Alive = False
									'UPGRADE_NOTE: オブジェクト PList.Item().Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
									.Unit_Renamed = Nothing
								End With
							End If
						End If
					End If
					'End If
				End With
			Next itm
			'End If
			
			'Invalid_string_refer_to_original_code
			ReDim cur_hard_point(0)
			ReDim cur_hard_point_size(0)
			For i = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				For j = 1 To UBound(cur_hard_point)
					If cur_hard_point(j) = FeatureData(i) Then
						cur_hard_point_size(j) = cur_hard_point_size(j) + FeatureLevel(i)
						Exit For
					End If
				Next 
				If j > UBound(cur_hard_point) Then
					ReDim Preserve cur_hard_point(UBound(cur_hard_point) + 1)
					ReDim Preserve cur_hard_point_size(UBound(cur_hard_point))
					cur_hard_point(UBound(cur_hard_point)) = FeatureData(i)
					cur_hard_point_size(UBound(cur_hard_point)) = FeatureLevel(i)
				End If
				'End If
			Next 
			
			'Invalid_string_refer_to_original_code
			For i = 1 To UBound(prev_hard_point)
				num = 0
				For j = 1 To UBound(cur_hard_point)
					If prev_hard_point(i) = cur_hard_point(j) Then
						num = cur_hard_point_size(j)
					End If
				Next 
				
				If num < prev_hard_point_size(i) Then
					is_changed = True
					For	Each itm In colItem
						With itm
							If .Part = prev_hard_point(i) Then
								num = num - .Size
								If num < 0 Then
									colItem.Remove(.ID)
									If Not .Unit Is Nothing Then
										If .Unit.ID = ID Then
											'UPGRADE_NOTE: オブジェクト itm.Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
											.Unit = Nothing
										End If
									End If
									'Invalid_string_refer_to_original_code
									If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
										If PList.IsDefined(.FeatureData("Invalid_string_refer_to_original_code")) Then
											With PList.Item(.FeatureData("Invalid_string_refer_to_original_code"))
												.Alive = False
												'UPGRADE_NOTE: オブジェクト PList.Item().Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
												.Unit_Renamed = Nothing
											End With
										End If
									End If
								End If
							End If
						End With
					Next itm
				End If
			Next 
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			num = 0
			For	Each itm In colItem
				With itm
					If .Part = "Invalid_string_refer_to_original_code" Then
						num = num + 1
						If num > 1 Then
							is_changed = True
							colItem.Remove(.ID)
							If Not .Unit Is Nothing Then
								If .Unit.ID = ID Then
									'UPGRADE_NOTE: オブジェクト itm.Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
									.Unit = Nothing
								End If
							End If
							'Invalid_string_refer_to_original_code
							If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
								If PList.IsDefined(.FeatureData("Invalid_string_refer_to_original_code")) Then
									With PList.Item(.FeatureData("Invalid_string_refer_to_original_code"))
										.Alive = False
										'UPGRADE_NOTE: オブジェクト PList.Item().Unit をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
										.Unit_Renamed = Nothing
									End With
								End If
							End If
						End If
					End If
				End With
			Next itm
			'End If
		Loop While is_changed
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function ItemSlotSize(ByRef ipart As String) As Short
		Dim i As Short
		
		Select Case ipart
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				ItemSlotSize = Data.ItemNum
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Exit Function
				'End If
				For i = 1 To CountFeature
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Select Case FeatureData(i)
						Case "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							ItemSlotSize = ItemSlotSize + FeatureLevel(i)
					End Select
					'End If
				Next 
			Case Else
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				ItemSlotSize = 1
				Exit Function
				'End If
				For i = 1 To CountFeature
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If FeatureData(i) = ipart Then
						ItemSlotSize = ItemSlotSize + FeatureLevel(i)
					End If
					'End If
				Next 
		End Select
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsEquiped(ByRef iname As String) As Boolean
		Dim i As Short
		
		IsEquiped = False
		For i = 1 To CountItem
			If Item(i).Name = iname Then
				IsEquiped = True
				Exit Function
			End If
		Next 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function WeaponProficiency() As String
		Dim fd As FeatureData
		
		For	Each fd In colFeature
			With fd
				If .Name = "豁ｦ蝎ｨ繧ｯ繝ｩ繧ｹ" Then
					WeaponProficiency = WeaponProficiency & " " & .StrData
				End If
			End With
		Next fd
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function ArmorProficiency() As String
		Dim fd As FeatureData
		
		For	Each fd In colFeature
			With fd
				If .Name = "髦ｲ蜈ｷ繧ｯ繝ｩ繧ｹ" Then
					ArmorProficiency = ArmorProficiency & " " & .StrData
				End If
			End With
		Next fd
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAbleToEquip(ByRef it As Item) As Boolean
		Dim iclass As String
		Dim eclass0, uclass, eclass As String
		Dim i, j As Short
		
		With it
			'Invalid_string_refer_to_original_code
			If Not .Unit Is Nothing Then
				If .Unit.ID = ID Then
					IsAbleToEquip = False
					Exit Function
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			If IsGlobalVariableDefined("Fix(" & .Name & ")") Then
				IsAbleToEquip = False
				Exit Function
			End If
			
			'Invalid_string_refer_to_original_code
			If Not .IsAvailable(Me) Then
				IsAbleToEquip = False
				Exit Function
			End If
			
			'Invalid_string_refer_to_original_code
			iclass = .Class_Renamed()
			
			'Invalid_string_refer_to_original_code
			If iclass = "豎守畑" Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsAbleToEquip = False
				Exit Function
			End If
			IsAbleToEquip = True
			Exit Function
			'End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			IsAbleToEquip = False
			Exit Function
			'End If
			
			'Invalid_string_refer_to_original_code
			uclass = Class0
			
			'Invalid_string_refer_to_original_code
			Select Case .Part
				Case "豁ｦ蝎ｨ", "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code"
					eclass = WeaponProficiency()
					For i = 1 To LLength(eclass)
						eclass0 = LIndex(eclass, i)
						If iclass = eclass0 Then
							IsAbleToEquip = True
							Exit Function
						ElseIf InStr(iclass, "蟆ら畑)") > 0 Then 
							'Invalid_string_refer_to_original_code
							If InStr(iclass, eclass0 & "(") = 1 And (InStr(iclass, "(" & uclass & "蟆ら畑)") > 0 Or InStr(iclass, "(" & Name & "蟆ら畑)") > 0 Or InStr(iclass, "(" & Nickname & "蟆ら畑)") > 0) Then
								IsAbleToEquip = True
								Exit Function
							End If
							
							'Invalid_string_refer_to_original_code
							If CountPilot > 0 Then
								If iclass = eclass0 & "(" & MainPilot.Sex & "蟆ら畑)" Then
									IsAbleToEquip = True
									Exit Function
								End If
							End If
						End If
					Next 
					
					'Invalid_string_refer_to_original_code
					For i = 1 To CountOtherForm
						With OtherForm(i)
							uclass = .Class0
							eclass = .WeaponProficiency()
							For j = 1 To LLength(eclass)
								eclass0 = LIndex(eclass, j)
								If iclass = eclass0 Then
									IsAbleToEquip = True
									Exit Function
								ElseIf InStr(iclass, "蟆ら畑)") > 0 Then 
									'Invalid_string_refer_to_original_code
									If InStr(iclass, eclass0 & "(") = 1 And (InStr(iclass, "(" & uclass & "蟆ら畑)") > 0 Or InStr(iclass, "(" & .Name & "蟆ら畑)") > 0 Or InStr(iclass, "(" & .Nickname & "蟆ら畑)") > 0) Then
										IsAbleToEquip = True
										Exit Function
									End If
									
									'Invalid_string_refer_to_original_code
									If CountPilot > 0 Then
										If iclass = eclass0 & "(" & MainPilot.Sex & "蟆ら畑)" Then
											IsAbleToEquip = True
											Exit Function
										End If
									End If
								End If
							Next 
						End With
					Next 
					
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					eclass = ArmorProficiency()
					For i = 1 To LLength(eclass)
						eclass0 = LIndex(eclass, i)
						If iclass = eclass0 Then
							IsAbleToEquip = True
							Exit Function
						ElseIf InStr(iclass, "蟆ら畑)") > 0 Then 
							'Invalid_string_refer_to_original_code
							If InStr(iclass, eclass0 & "(") = 1 And (InStr(iclass, "(" & uclass & "蟆ら畑)") > 0 Or InStr(iclass, "(" & Name & "蟆ら畑)") > 0 Or InStr(iclass, "(" & Nickname & "蟆ら畑)") > 0) Then
								IsAbleToEquip = True
								Exit Function
							End If
							
							'Invalid_string_refer_to_original_code
							If CountPilot > 0 Then
								If iclass = eclass0 & "(" & MainPilot.Sex & "蟆ら畑)" Then
									IsAbleToEquip = True
									Exit Function
								End If
							End If
						End If
					Next 
					
					'Invalid_string_refer_to_original_code
					For i = 1 To CountOtherForm
						With OtherForm(i)
							uclass = .Class0
							eclass = .ArmorProficiency()
							For j = 1 To LLength(eclass)
								eclass0 = LIndex(eclass, j)
								If iclass = eclass0 Then
									IsAbleToEquip = True
									Exit Function
								ElseIf InStr(iclass, "蟆ら畑)") > 0 Then 
									'Invalid_string_refer_to_original_code
									If InStr(iclass, eclass0 & "(") = 1 And (InStr(iclass, "(" & uclass & "蟆ら畑)") > 0 Or InStr(iclass, "(" & .Name & "蟆ら畑)") > 0 Or InStr(iclass, "(" & .Nickname & "蟆ら畑)") > 0) Then
										IsAbleToEquip = True
										Exit Function
									End If
									
									'Invalid_string_refer_to_original_code
									If CountPilot > 0 Then
										If iclass = eclass0 & "(" & MainPilot.Sex & "蟆ら畑)" Then
											IsAbleToEquip = True
											Exit Function
										End If
									End If
								End If
							Next 
						End With
					Next 
					
				Case "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If IsHero Then
						IsAbleToEquip = False
						Exit Function
					End If
					'End If
					
					'Invalid_string_refer_to_original_code
					If InStr(iclass, "蟆ら畑)") = 0 Then
						IsAbleToEquip = True
						Exit Function
					End If
					
					'Invalid_string_refer_to_original_code
					If InStr(iclass, "(" & uclass & "蟆ら畑)") > 0 Or InStr(iclass, "(" & Name & "蟆ら畑)") > 0 Or InStr(iclass, "(" & Nickname & "蟆ら畑)") > 0 Then
						IsAbleToEquip = True
						Exit Function
					End If
					
					'Invalid_string_refer_to_original_code
					If CountPilot > 0 Then
						If InStr(iclass, "(" & MainPilot.Sex & "蟆ら畑)") > 0 Then
							IsAbleToEquip = True
							Exit Function
						End If
					End If
					
					'Invalid_string_refer_to_original_code
					For i = 1 To CountOtherForm
						With OtherForm(i)
							If InStr(iclass, "(" & .Class0 & "蟆ら畑)") > 0 Or InStr(iclass, "(" & .Name & "蟆ら畑)") > 0 Or InStr(iclass, "(" & .Nickname & "蟆ら畑)") > 0 Then
								IsAbleToEquip = True
								Exit Function
							End If
						End With
					Next 
					
				Case Else
					'Invalid_string_refer_to_original_code
					If InStr(iclass, "蟆ら畑)") = 0 Then
						IsAbleToEquip = True
						Exit Function
					End If
					
					'Invalid_string_refer_to_original_code
					If InStr(iclass, "(" & uclass & "蟆ら畑)") > 0 Or InStr(iclass, "(" & Name & "蟆ら畑)") > 0 Or InStr(iclass, "(" & Nickname & "蟆ら畑)") > 0 Then
						IsAbleToEquip = True
						Exit Function
					End If
					
					'Invalid_string_refer_to_original_code
					If CountPilot > 0 Then
						If InStr(iclass, "(" & MainPilot.Sex & "蟆ら畑)") > 0 Then
							IsAbleToEquip = True
							Exit Function
						End If
					End If
					
					'Invalid_string_refer_to_original_code
					For i = 1 To CountOtherForm
						With OtherForm(i)
							If InStr(iclass, "(" & .Class0 & "蟆ら畑)") > 0 Or InStr(iclass, "(" & .Name & "蟆ら畑)") > 0 Or InStr(iclass, "(" & .Nickname & "蟆ら畑)") > 0 Then
								IsAbleToEquip = True
								Exit Function
							End If
						End With
					Next 
			End Select
		End With
		
		IsAbleToEquip = False
	End Function
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Sub PilotMessage(ByRef Situation As String, Optional ByRef msg_mode As String = "")
		Dim k, i, j, w As Short
		Dim p As Pilot
		Dim md As MessageData
		Dim dd As Dialog
		Dim msg As String
		Dim situations() As String
		Dim wname As String
		Dim pnames() As String
		Dim buf As String
		Dim selected_pilot As String
		Dim selected_situation As String
		Dim selected_msg As String
		
		'Invalid_string_refer_to_original_code
		IsWavePlayed = False
		
		'Invalid_string_refer_to_original_code
		ReDim situations(1)
		situations(1) = Situation
		Select Case Situation
			Case "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code", "霑取茶", "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				ReDim Preserve situations(2)
				situations(2) = "蝗樣∩"
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				ReDim Preserve situations(2)
				situations(2) = "Invalid_string_refer_to_original_code"
			Case "蝗樣∩", "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Case Else
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				wname = situations(1)
				
				'豁ｦ蝎ｨ逡ｪ蜿ｷ繧呈､懃ｴ｢
				For w = 1 To CountWeapon
					With Weapon(w)
						If Situation = .Name Or Situation = .Nickname Then
							Exit For
						End If
					End With
				Next 
				
				If Not IsDefense() Then
					ReDim Preserve situations(2)
					If IsWeaponClassifiedAs(w, "譬ｼ髣倡ｳｻ") Then
						situations(2) = "Invalid_string_refer_to_original_code"
					Else
						situations(2) = "Invalid_string_refer_to_original_code"
					End If
				ElseIf msg_mode = "繧ｫ繧ｦ繝ｳ繧ｿ繝ｼ" Then 
					ReDim Preserve situations(3)
					situations(1) = Situation & "(蜿肴茶)"
					situations(2) = Situation
					If IsWeaponClassifiedAs(w, "譬ｼ髣倡ｳｻ") Then
						situations(3) = "Invalid_string_refer_to_original_code"
					Else
						situations(3) = "Invalid_string_refer_to_original_code"
					End If
				Else
					ReDim Preserve situations(4)
					situations(1) = Situation & "(蜿肴茶)"
					situations(2) = Situation
					If IsWeaponClassifiedAs(w, "譬ｼ髣倡ｳｻ") Then
						situations(3) = "Invalid_string_refer_to_original_code"
						situations(4) = "Invalid_string_refer_to_original_code"
					Else
						situations(3) = "Invalid_string_refer_to_original_code"
						situations(4) = "Invalid_string_refer_to_original_code"
					End If
				End If
				'UPGRADE_WARNING: PilotMessage に変換されていないステートメントがあります。ソース コードを確認してください。
				ReDim Preserve situations(2)
				situations(2) = "Invalid_string_refer_to_original_code"
				'UPGRADE_WARNING: PilotMessage に変換されていないステートメントがあります。ソース コードを確認してください。
				'Invalid_string_refer_to_original_code
				
				'豁ｦ蝎ｨ逡ｪ蜿ｷ繧呈､懃ｴ｢
				wname = Left(Situation, InStr2(Situation, "(") - 1)
				For w = 1 To CountWeapon
					With Weapon(w)
						If wname = .Name Or wname = .Nickname Then
							Exit For
						End If
					End With
				Next 
				
				If Not IsDefense() Then
					ReDim Preserve situations(2)
					If IsWeaponClassifiedAs(w, "譬ｼ髣倡ｳｻ") Then
						situations(2) = "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Else
						situations(2) = "Invalid_string_refer_to_original_code" & Mid(Situation, InStr2(Situation, "("))
					End If
				ElseIf msg_mode = "繧ｫ繧ｦ繝ｳ繧ｿ繝ｼ" Then 
					ReDim Preserve situations(3)
					situations(1) = Situation & "(蜿肴茶)"
					situations(2) = Situation
					If IsWeaponClassifiedAs(w, "譬ｼ髣倡ｳｻ") Then
						situations(3) = "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Else
						situations(3) = "Invalid_string_refer_to_original_code" & Mid(Situation, InStr2(Situation, "("))
					End If
				Else
					ReDim Preserve situations(4)
					situations(1) = Situation & "(蜿肴茶)"
					situations(2) = Situation
					If IsWeaponClassifiedAs(w, "譬ｼ髣倡ｳｻ") Then
						situations(3) = "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						situations(4) = "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Else
						situations(3) = "Invalid_string_refer_to_original_code" & Mid(Situation, InStr2(Situation, "(")) & "(蜿肴茶)"
						situations(4) = "Invalid_string_refer_to_original_code" & Mid(Situation, InStr2(Situation, "("))
					End If
				End If
				'Invalid_string_refer_to_original_code
				If SelectedUnit Is Me Then
					If 0 < SelectedWeapon And SelectedWeapon <= CountWeapon Then
						wname = Weapon(SelectedWeapon).Name
					End If
				ElseIf SelectedTarget Is Me Then 
					If 0 < SelectedTWeapon And SelectedTWeapon <= CountWeapon Then
						wname = Weapon(SelectedTWeapon).Name
					End If
				End If
				'End If
		End Select
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(situations)
			buf = "Message(" & MainPilot.ID & "," & situations(i) & ")"
			If IsLocalVariableDefined(buf) Then
				'UPGRADE_WARNING: オブジェクト LocalVariableList.Item().StringValue の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
				selected_msg = LocalVariableList.Item(buf).StringValue
				selected_situation = situations(i)
				UndefineVariable(buf)
				Exit For
			End If
			
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			buf = "Message(" & MainPilot.ID & "Invalid_string_refer_to_original_code"
			If IsLocalVariableDefined(buf) Then
				'UPGRADE_WARNING: オブジェクト LocalVariableList.Item().StringValue の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
				selected_msg = LocalVariableList.Item(buf).StringValue
				selected_situation = "Invalid_string_refer_to_original_code"
				UndefineVariable(buf)
				Exit For
			End If
			'End If
			
			If situations(i) = "Invalid_string_refer_to_original_code" Or situations(i) = "Invalid_string_refer_to_original_code" Then
				buf = "Message(" & MainPilot.ID & "Invalid_string_refer_to_original_code"
				If IsLocalVariableDefined(buf) Then
					'UPGRADE_WARNING: オブジェクト LocalVariableList.Item().StringValue の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
					selected_msg = LocalVariableList.Item(buf).StringValue
					selected_situation = "Invalid_string_refer_to_original_code"
					UndefineVariable(buf)
					Exit For
				End If
			End If
		Next 
		If InStr(selected_msg, "::") > 0 Then
			selected_pilot = Left(selected_msg, InStr(selected_msg, "::") - 1)
			selected_msg = Mid(selected_msg, InStr(selected_msg, "::") + 2)
		End If
		
		'Invalid_string_refer_to_original_code
		If selected_msg = "" Then
			If InStr(Situation, "縺九¢螢ｰ") = 1 Then
				If Dice(3) = 1 Then
					Exit Sub
				End If
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If selected_msg = "" Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Or IsConditionSatisfied("鮗ｻ逞ｺ") _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			Exit Sub
		End If
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'辟｡險
		If InStr(Situation, "(") = 0 Then
			Select Case Situation
				Case "繝繝｡繝ｼ繧ｸ荳ｭ", "繝繝｡繝ｼ繧ｸ螟ｧ", "Invalid_string_refer_to_original_code"
					If NPDList.IsDefined(MainPilot.Name & "(繝繝｡繝ｼ繧ｸ)") Then
						DisplayBattleMessage(MainPilot.Name & "(繝繝｡繝ｼ繧ｸ)", "Invalid_string_refer_to_original_code")
						Exit Sub
					End If
				Case "縺九¢螢ｰ"
					Exit Sub
			End Select
			If wname <> "" Then
				If NPDList.IsDefined(MainPilot.Name & "Invalid_string_refer_to_original_code") Then
					DisplayBattleMessage(MainPilot.Name & "Invalid_string_refer_to_original_code", "Invalid_string_refer_to_original_code")
					Exit Sub
				End If
			End If
			DisplayBattleMessage(MainPilot.ID, "窶ｦ窶ｦ窶ｦ窶ｦ")
		End If
		Exit Sub
		'End If
		If IsConditionSatisfied("逹｡逵") Then
			'蟇晁ｨ
			If InStr(Situation, "(") = 0 Then
				DisplayBattleMessage(MainPilot.ID, "Invalid_string_refer_to_original_code")
			End If
			Exit Sub
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		ReDim situations(1)
		situations(1) = "Invalid_string_refer_to_original_code"
		'Invalid_string_refer_to_original_code
		If InStr(Situation, "(") = 0 Then
			msg = ""
			Select Case MainPilot.Sex
				Case "逕ｷ諤ｧ"
					Select Case Dice(4)
						Case 1
							msg = "Invalid_string_refer_to_original_code"
						Case 2
							msg = "Invalid_string_refer_to_original_code"
						Case 3
							msg = "Invalid_string_refer_to_original_code"
						Case 4
							msg = "Invalid_string_refer_to_original_code"
					End Select
				Case "螂ｳ諤ｧ"
					Select Case Dice(4)
						Case 1
							msg = "Invalid_string_refer_to_original_code"
						Case 2
							msg = "Invalid_string_refer_to_original_code"
						Case 3
							msg = "Invalid_string_refer_to_original_code"
						Case 4
							msg = "Invalid_string_refer_to_original_code"
					End Select
			End Select
			
			If msg <> "" Then
				If NPDList.IsDefined(MainPilot.Name & "Invalid_string_refer_to_original_code") Then
					DisplayBattleMessage(MainPilot.Name & "Invalid_string_refer_to_original_code", msg)
				ElseIf NPDList.IsDefined(MainPilot.Name & "(繝繝｡繝ｼ繧ｸ)") Then 
					DisplayBattleMessage(MainPilot.Name & "(繝繝｡繝ｼ繧ｸ)", msg)
				Else
					DisplayBattleMessage(MainPilot.ID, msg)
				End If
			End If
		End If
		Exit Sub
		'End If
		'End If
		If IsConditionSatisfied("豺ｷ荵ｱ") Then
			If IsMessageDefined("豺ｷ荵ｱ") Then
				'Invalid_string_refer_to_original_code
				ReDim situations(1)
				situations(1) = "豺ｷ荵ｱ"
			End If
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		ReDim pnames(3)
		pnames(1) = MainPilot.MessageType
		pnames(2) = MainPilot.MessageType
		pnames(3) = MainPilot.MessageType
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			ReDim Preserve pnames(4)
			pnames(4) = Pilot(1).MessageType
		End If
		For i = 2 To CountPilot
			pnames(1) = pnames(1) & " " & Pilot(i).MessageType
			pnames(2) = pnames(2) & " " & Pilot(i).MessageType
		Next 
		For i = 1 To CountSupport
			pnames(1) = pnames(1) & " " & Support(i).MessageType
		Next 
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		pnames(1) = pnames(1) & " " & AdditionalSupport.MessageType
		'End If
		If Situation = SelectedSpecialPower Then
			pnames(3) = SelectedPilot.MessageType
		End If
		For i = 1 To UBound(pnames)
			'Invalid_string_refer_to_original_code
			If i = 4 Then
				If MDList.IsDefined(MainPilot.MessageType) Then
					Exit For
				End If
			End If
			
			If DDList.IsDefined(pnames(i)) Then
				With DDList.Item(pnames(i))
					If selected_msg <> "" Then
						'Invalid_string_refer_to_original_code
						k = 0
						For j = 1 To .CountDialog
							If .Situation(j) = selected_situation Then
								k = k + 1
								If VB6.Format(k) = selected_msg Then
									PlayDialog(.Dialog(j), wname)
									Exit Sub
								End If
							ElseIf .Situation(j) = selected_msg Then 
								PlayDialog(.Dialog(j), wname)
								Exit Sub
							End If
						Next 
					Else
						For j = 1 To UBound(situations)
							dd = .SelectDialog(situations(j), Me)
							If Not dd Is Nothing Then
								PlayDialog(dd, wname)
								Exit Sub
							End If
						Next 
					End If
				End With
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		If Data.PilotNum > 0 And MainPilot Is Pilot(1) And Situation <> SelectedSpecialPower Then
			i = Dice(CountPilot + CountSupport)
		Else
			i = 1
		End If
		
TryAgain: 
		'Invalid_string_refer_to_original_code
		If Situation = SelectedSpecialPower Then
			If Not MDList.IsDefined((SelectedPilot.MessageType)) Then
				GoTo TrySelectedMessage
			End If
		ElseIf i = 1 Then 
			If Not MDList.IsDefined(MainPilot.MessageType) And Not MDList.IsDefined((Pilot(1).MessageType)) Then
				GoTo TrySelectedMessage
			End If
		ElseIf i <= CountPilot Then 
			If Not MDList.IsDefined((Pilot(i).MessageType)) Then
				i = 1
				GoTo TryAgain
			End If
		Else
			If Not MDList.IsDefined((Support(i - CountPilot).MessageType)) Then
				If i > 1 Then
					i = 1
					GoTo TryAgain
				Else
					GoTo TrySelectedMessage
				End If
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If Situation = SelectedSpecialPower Then
			md = MDList.Item((SelectedPilot.MessageType))
			p = SelectedPilot
		ElseIf i = 1 Then 
			md = MDList.Item(MainPilot.MessageType)
			p = MainPilot
			If Not md Is Nothing Then
				For j = 1 To UBound(situations)
					If Len(md.SelectMessage(situations(j), Me)) > 0 Then
						Exit For
					End If
				Next 
			Else
				md = MDList.Item((Pilot(1).MessageType))
				p = Pilot(1)
			End If
		ElseIf i <= CountPilot Then 
			md = MDList.Item((Pilot(i).MessageType))
			p = Pilot(i)
		Else
			md = MDList.Item((Support(i - CountPilot).MessageType))
			p = Support(i - CountPilot)
		End If
		
		'Invalid_string_refer_to_original_code
		If md Is Nothing Then
			If i <> 1 Then
				i = 1
				GoTo TryAgain
			Else
				GoTo TrySelectedMessage
			End If
		End If
		
		If selected_msg <> "" Then
			'Invalid_string_refer_to_original_code
			k = 0
			With md
				For j = 1 To .CountMessage
					If .Situation(j) = selected_situation Then
						k = k + 1
						If VB6.Format(k) = selected_msg Then
							PlayMessage(p, .Message(j), wname)
							Exit Sub
						End If
					ElseIf .Situation(j) = selected_msg Then 
						PlayMessage(p, .Message(j), wname)
						Exit Sub
					End If
				Next 
			End With
		Else
			'Invalid_string_refer_to_original_code
			For j = 1 To UBound(situations)
				msg = md.SelectMessage(situations(j), Me)
				If msg <> "" Then
					PlayMessage(p, msg, wname)
					Exit Sub
				End If
			Next 
		End If
		
		If i <> 1 Then
			i = 1
			GoTo TryAgain
		End If
		
TrySelectedMessage: 
		'Invalid_string_refer_to_original_code
		If selected_msg <> "" And selected_msg <> "-" Then
			If selected_pilot <> "" Then
				DisplayBattleMessage(selected_pilot, selected_msg)
			Else
				DisplayBattleMessage(MainPilot.ID, selected_msg)
			End If
		End If
	End Sub
	
	'繝繧､繧｢繝ｭ繧ｰ縺ｮ蜀咲函
	Public Sub PlayDialog(ByRef dd As Dialog, ByRef wname As String)
		Dim msg, buf As String
		Dim i, idx As Short
		Dim t As Unit
		Dim tw As Short
		
		'Invalid_string_refer_to_original_code
		IsPictureDrawn = False
		
		With dd
			'Invalid_string_refer_to_original_code
			For i = 1 To .Count
				msg = .Message(i)
				
				'Invalid_string_refer_to_original_code
				If msg = "-" Then
					Exit Sub
				End If
				
				'繝ｦ繝九ャ繝亥錐
				Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
					idx = InStr(msg, "Invalid_string_refer_to_original_code")
					buf = Nickname
					If InStr(buf, "(") > 0 Then
						buf = Left(buf, InStr(buf, "(") - 1)
					End If
					If InStr(buf, "蟆ら畑") > 0 Then
						buf = Mid(buf, InStr(buf, "蟆ら畑") + 2)
					End If
					msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 7)
				Loop 
				Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
					idx = InStr(msg, "Invalid_string_refer_to_original_code")
					buf = Nickname
					If InStr(buf, "(") > 0 Then
						buf = Left(buf, InStr(buf, "(") - 1)
					End If
					If InStr(buf, "蟆ら畑") > 0 Then
						buf = Mid(buf, InStr(buf, "蟆ら畑") + 2)
					End If
					msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 5)
				Loop 
				
				'Invalid_string_refer_to_original_code
				Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
					buf = MainPilot.Nickname
					If InStr(buf, "(") > 0 Then
						buf = Left(buf, InStr(buf, "(") - 1)
					End If
					idx = InStr(msg, "Invalid_string_refer_to_original_code")
					msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 8)
				Loop 
				
				'Invalid_string_refer_to_original_code
				Do While InStr(msg, "$(豁ｦ蝎ｨ)") > 0
					idx = InStr(msg, "$(豁ｦ蝎ｨ)")
					buf = wname
					ReplaceSubExpression(buf)
					If InStr(buf, "(") > 0 Then
						buf = Left(buf, InStr(buf, "(") - 1)
					End If
					If InStr(buf, "<") > 0 Then
						buf = Left(buf, InStr(buf, "<") - 1)
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'End If
					msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 5)
				Loop 
				
				'Invalid_string_refer_to_original_code
				Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
					idx = InStr(msg, "Invalid_string_refer_to_original_code")
					msg = Left(msg, idx - 1) & VB6.Format(100 * (MaxHP - HP) \ MaxHP) & Mid(msg, idx + 6)
				Loop 
				
				'Invalid_string_refer_to_original_code
				If SelectedUnit Is Me Then
					t = SelectedTarget
					tw = SelectedTWeapon
				Else
					t = SelectedUnit
					tw = SelectedWeapon
				End If
				
				If Not t Is Nothing Then
					'逶ｸ謇九Θ繝九ャ繝亥錐
					Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
						buf = t.Nickname
						If InStr(buf, "(") > 0 Then
							buf = Left(buf, InStr(buf, "(") - 1)
						End If
						If InStr(buf, "蟆ら畑") > 0 Then
							buf = Mid(buf, InStr(buf, "蟆ら畑") + 2)
						End If
						idx = InStr(msg, "Invalid_string_refer_to_original_code")
						msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 9)
					Loop 
					Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
						buf = t.Nickname
						If InStr(buf, "(") > 0 Then
							buf = Left(buf, InStr(buf, "(") - 1)
						End If
						If InStr(buf, "蟆ら畑") > 0 Then
							buf = Mid(buf, InStr(buf, "蟆ら畑") + 2)
						End If
						idx = InStr(msg, "Invalid_string_refer_to_original_code")
						msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 7)
					Loop 
					
					'Invalid_string_refer_to_original_code
					Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
						buf = t.MainPilot.Nickname
						If InStr(buf, "(") > 0 Then
							buf = Left(buf, InStr(buf, "(") - 1)
						End If
						idx = InStr(msg, "Invalid_string_refer_to_original_code")
						msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 10)
					Loop 
					
					'Invalid_string_refer_to_original_code
					Do While InStr(msg, "$(逶ｸ謇区ｭｦ蝎ｨ)") > 0
						If 1 <= tw And tw <= t.CountWeapon Then
							buf = t.WeaponNickname(tw)
						Else
							buf = ""
						End If
						If InStr(buf, "<") > 0 Then
							buf = Left(buf, InStr(buf, "<") - 1)
						End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Loop 
				End If
				idx = InStr(msg, "$(逶ｸ謇区ｭｦ蝎ｨ)")
				msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 7)
				'Loop
				
				'Invalid_string_refer_to_original_code
				Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
					With t
						buf = VB6.Format(100 * (.MaxHP - .HP) \ .MaxHP)
					End With
					idx = InStr(msg, "Invalid_string_refer_to_original_code")
					msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 8)
				Loop 
				'End If
				
				'Invalid_string_refer_to_original_code
				If .Name(i) = MainPilot.Name Then
					DisplayBattleMessage(MainPilot.ID, msg)
				ElseIf Left(.Name(i), 1) = "@" Then 
					DisplayBattleMessage(Mid(.Name(i), 2), msg)
				Else
					DisplayBattleMessage(.Name(i), msg)
				End If
			Next 
		End With
		
		'Invalid_string_refer_to_original_code
		If Not IsOptionDefined("謌ｦ髣倅ｸｭ逕ｻ髱｢蛻晄悄蛹也┌蜉ｹ") Then
			If IsPictureDrawn Then
				ClearPicture()
				'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
				MainForm.picMain(0).Refresh()
			End If
		End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub PlayMessage(ByRef p As Pilot, ByRef msg As String, ByRef wname As String)
		Dim buf As String
		Dim idx As Short
		Dim t As Unit
		Dim tw As Short
		
		'Invalid_string_refer_to_original_code
		If msg = "-" Then
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		IsPictureDrawn = False
		
		'繝ｦ繝九ャ繝亥錐
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			idx = InStr(msg, "Invalid_string_refer_to_original_code")
			buf = Nickname
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			If InStr(buf, "蟆ら畑") > 0 Then
				buf = Mid(buf, InStr(buf, "蟆ら畑") + 2)
			End If
			msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 7)
		Loop 
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			idx = InStr(msg, "Invalid_string_refer_to_original_code")
			buf = Nickname
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			If InStr(buf, "蟆ら畑") > 0 Then
				buf = Mid(buf, InStr(buf, "蟆ら畑") + 2)
			End If
			msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 5)
		Loop 
		
		'Invalid_string_refer_to_original_code
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			buf = MainPilot.Nickname
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			idx = InStr(msg, "Invalid_string_refer_to_original_code")
			msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 8)
		Loop 
		
		'Invalid_string_refer_to_original_code
		Do While InStr(msg, "$(豁ｦ蝎ｨ)") > 0
			idx = InStr(msg, "$(豁ｦ蝎ｨ)")
			buf = wname
			ReplaceSubExpression(buf)
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			If InStr(buf, "<") > 0 Then
				buf = Left(buf, InStr(buf, "<") - 1)
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'End If
			msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 5)
		Loop 
		
		'Invalid_string_refer_to_original_code
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			idx = InStr(msg, "Invalid_string_refer_to_original_code")
			msg = Left(msg, idx - 1) & VB6.Format(100 * (MaxHP - HP) \ MaxHP) & Mid(msg, idx + 6)
		Loop 
		
		'Invalid_string_refer_to_original_code
		If SelectedUnit Is Me Then
			t = SelectedTarget
			tw = SelectedTWeapon
		Else
			t = SelectedUnit
			tw = SelectedWeapon
		End If
		
		If Not t Is Nothing Then
			'逶ｸ謇九Θ繝九ャ繝亥錐
			Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
				buf = t.Nickname
				If InStr(buf, "(") > 0 Then
					buf = Left(buf, InStr(buf, "(") - 1)
				End If
				If InStr(buf, "蟆ら畑") > 0 Then
					buf = Mid(buf, InStr(buf, "蟆ら畑") + 2)
				End If
				idx = InStr(msg, "Invalid_string_refer_to_original_code")
				msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 9)
			Loop 
			Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
				buf = t.Nickname
				If InStr(buf, "(") > 0 Then
					buf = Left(buf, InStr(buf, "(") - 1)
				End If
				If InStr(buf, "蟆ら畑") > 0 Then
					buf = Mid(buf, InStr(buf, "蟆ら畑") + 2)
				End If
				idx = InStr(msg, "Invalid_string_refer_to_original_code")
				msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 7)
			Loop 
			
			'Invalid_string_refer_to_original_code
			Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
				buf = t.MainPilot.Nickname
				If InStr(buf, "(") > 0 Then
					buf = Left(buf, InStr(buf, "(") - 1)
				End If
				idx = InStr(msg, "Invalid_string_refer_to_original_code")
				msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 10)
			Loop 
			
			'Invalid_string_refer_to_original_code
			Do While InStr(msg, "$(逶ｸ謇区ｭｦ蝎ｨ)") > 0
				If 1 <= tw And tw <= t.CountWeapon Then
					buf = t.WeaponNickname(tw)
				Else
					buf = ""
				End If
				If InStr(buf, "<") > 0 Then
					buf = Left(buf, InStr(buf, "<") - 1)
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Loop 
		End If
		idx = InStr(msg, "$(逶ｸ謇区ｭｦ蝎ｨ)")
		msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 7)
		'Loop
		
		'Invalid_string_refer_to_original_code
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			With t
				buf = VB6.Format(100 * (.MaxHP - .HP) \ .MaxHP)
			End With
			idx = InStr(msg, "Invalid_string_refer_to_original_code")
			msg = Left(msg, idx - 1) & buf & Mid(msg, idx + 8)
		Loop 
		'End If
		
		'Invalid_string_refer_to_original_code
		DisplayBattleMessage((p.ID), msg)
		
		'Invalid_string_refer_to_original_code
		If Not IsOptionDefined("謌ｦ髣倅ｸｭ逕ｻ髱｢蛻晄悄蛹也┌蜉ｹ") Then
			If IsPictureDrawn Then
				ClearPicture()
				'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
				MainForm.picMain(0).Refresh()
			End If
		End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function IsMessageDefined(ByRef main_situation As String, Optional ByVal ignore_condition As Boolean = False) As Boolean
		Dim pnames(4) As String
		Dim msg As String
		Dim i As Short
		
		'Invalid_string_refer_to_original_code
		If Not ignore_condition Then
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Or IsConditionSatisfied("鮗ｻ逞ｺ") _
			'Or IsConditionSatisfied("逹｡逵") _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			IsMessageDefined = False
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		IsMessageDefined = False
		Exit Function
		'End If
		If IsConditionSatisfied("豺ｷ荵ｱ") And main_situation <> "豺ｷ荵ｱ" Then
			IsMessageDefined = False
			Exit Function
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsLocalVariableDefined("Message(" & MainPilot.ID & "," & main_situation & ")") Then
			IsMessageDefined = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		With MainPilot
			pnames(1) = .MessageType
			pnames(2) = .MessageType
			pnames(3) = .MessageType
		End With
		pnames(4) = Pilot(1).MessageType
		For i = 2 To CountPilot
			With Pilot(i)
				pnames(1) = pnames(1) & " " & .MessageType
				pnames(2) = pnames(2) & " " & .MessageType
			End With
		Next 
		For i = 1 To CountSupport
			pnames(1) = pnames(1) & " " & Support(i).MessageType
		Next 
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		pnames(1) = pnames(1) & " " & AdditionalSupport.MessageType
		'End If
		If main_situation <> "" Then
			If main_situation = SelectedSpecialPower Then
				pnames(3) = SelectedPilot.MessageType
			End If
		End If
		For i = 1 To 4
			If DDList.IsDefined(pnames(i)) Then
				With DDList.Item(pnames(i))
					If Not .SelectDialog(main_situation, Me, ignore_condition) Is Nothing Then
						IsMessageDefined = True
						Exit Function
					End If
				End With
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		If main_situation = SelectedSpecialPower Then
			With SelectedPilot
				If MDList.IsDefined(.MessageType) Then
					msg = MDList.Item(.MessageType).SelectMessage(main_situation, Me)
				End If
			End With
		Else
			With MainPilot
				If MDList.IsDefined(.MessageType) Then
					msg = MDList.Item(.MessageType).SelectMessage(main_situation, Me)
				End If
			End With
			If Len(msg) = 0 Then
				With Pilot(1)
					If MDList.IsDefined(.MessageType) Then
						msg = MDList.Item(.MessageType).SelectMessage(main_situation, Me)
					End If
				End With
			End If
		End If
		
		If Len(msg) > 0 Then
			IsMessageDefined = True
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub SysMessage(ByRef main_situation As String, Optional ByRef sub_situation As String = "", Optional ByRef add_msg As String = "")
		Dim uname, msg, uclass As String
		Dim situations() As String
		Dim idx, buf As String
		Dim i, ret As Short
		Dim wname As String
		
		If sub_situation = "" Or main_situation = sub_situation Then
			ReDim situations(1)
			situations(1) = main_situation & "(隗｣隱ｬ)"
		Else
			ReDim situations(2)
			situations(1) = main_situation & "(" & sub_situation & ")(隗｣隱ｬ)"
			situations(2) = main_situation & "(隗｣隱ｬ)"
		End If
		
		' ADD START MARGE
		'Invalid_string_refer_to_original_code
		If ExtendedAnimation Then
			With EADList
				For i = 1 To UBound(situations)
					'Invalid_string_refer_to_original_code
					If IsFeatureAvailable("謌ｦ髣倥い繝九Γ") Then
						uname = FeatureData("謌ｦ髣倥い繝九Γ")
						If .IsDefined(uname) Then
							msg = .Item(uname).SelectMessage(situations(i), Me)
							If Len(msg) > 0 Then
								GoTo FoundMessage
							End If
						End If
					End If
					
					'繝ｦ繝九ャ繝亥錐遘ｰ縺ｧ讀懃ｴ｢
					If .IsDefined(Name) Then
						msg = .Item(Name).SelectMessage(situations(i), Me)
						If Len(msg) > 0 Then
							GoTo FoundMessage
						End If
					End If
					
					'Invalid_string_refer_to_original_code
					uname = Nickname0
					ret = InStr(uname, "(")
					If ret > 1 Then
						uname = Left(uname, ret - 1)
					End If
					ret = InStr(uname, "逕ｨ")
					If ret > 0 Then
						If ret < Len(uname) Then
							uname = Mid(uname, ret + 1)
						End If
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If ret > 0 Then
						If ret < Len(uname) Then
							uname = Mid(uname, ret + 1)
						End If
					End If
					If Right(uname, 4) = "繧ｫ繧ｹ繧ｿ繝" Then
						uname = Left(uname, Len(uname) - 4)
					End If
					If Right(uname, 1) = "謾ｹ" Then
						uname = Left(uname, Len(uname) - 1)
					End If
					If .IsDefined(uname) Then
						msg = .Item(uname).SelectMessage(situations(i), Me)
						If Len(msg) > 0 Then
							GoTo FoundMessage
						End If
					End If
					
					'繝ｦ繝九ャ繝医け繝ｩ繧ｹ縺ｧ讀懃ｴ｢
					uclass = Class0
					If .IsDefined(uclass) Then
						msg = .Item(uclass).SelectMessage(situations(i), Me)
						If Len(msg) > 0 Then
							GoTo FoundMessage
						End If
					End If
					
					'豎守畑
					If .IsDefined("豎守畑") Then
						msg = .Item("豎守畑").SelectMessage(situations(i), Me)
						If Len(msg) > 0 Then
							GoTo FoundMessage
						End If
					End If
				Next 
			End With
		End If
		' ADD END MARGE
		
		'Invalid_string_refer_to_original_code
		With ADList
			For i = 1 To UBound(situations)
				'Invalid_string_refer_to_original_code
				If IsFeatureAvailable("謌ｦ髣倥い繝九Γ") Then
					uname = FeatureData("謌ｦ髣倥い繝九Γ")
					If .IsDefined(uname) Then
						msg = .Item(uname).SelectMessage(situations(i), Me)
						If Len(msg) > 0 Then
							GoTo FoundMessage
						End If
					End If
				End If
				
				'繝ｦ繝九ャ繝亥錐遘ｰ縺ｧ讀懃ｴ｢
				If .IsDefined(Name) Then
					msg = .Item(Name).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						GoTo FoundMessage
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				uname = Nickname0
				ret = InStr(uname, "(")
				If ret > 1 Then
					uname = Left(uname, ret - 1)
				End If
				ret = InStr(uname, "逕ｨ")
				If ret > 0 Then
					If ret < Len(uname) Then
						uname = Mid(uname, ret + 1)
					End If
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If ret > 0 Then
					If ret < Len(uname) Then
						uname = Mid(uname, ret + 1)
					End If
				End If
				If Right(uname, 4) = "繧ｫ繧ｹ繧ｿ繝" Then
					uname = Left(uname, Len(uname) - 4)
				End If
				If Right(uname, 1) = "謾ｹ" Then
					uname = Left(uname, Len(uname) - 1)
				End If
				If .IsDefined(uname) Then
					msg = .Item(uname).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						GoTo FoundMessage
					End If
				End If
				
				'繝ｦ繝九ャ繝医け繝ｩ繧ｹ縺ｧ讀懃ｴ｢
				uclass = Class0
				If .IsDefined(uclass) Then
					msg = .Item(uclass).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						GoTo FoundMessage
					End If
				End If
				
				'豎守畑
				If .IsDefined("豎守畑") Then
					msg = .Item("豎守畑").SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						GoTo FoundMessage
					End If
				End If
			Next 
		End With
		
		'迚ｹ谿雁柑譫懊ョ繝ｼ繧ｿ縺ｧ讀懃ｴ｢
		With EDList
			For i = 1 To UBound(situations)
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If .IsDefined(uname) Then
					msg = .Item(uname).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						GoTo FoundMessage
					End If
				End If
				'End If
				
				'繝ｦ繝九ャ繝亥錐遘ｰ縺ｧ讀懃ｴ｢
				If .IsDefined(Name) Then
					msg = .Item(Name).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						GoTo FoundMessage
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				uname = Nickname0
				ret = InStr(uname, "(")
				If ret > 1 Then
					uname = Left(uname, ret - 1)
				End If
				ret = InStr(uname, "逕ｨ")
				If ret > 0 Then
					If ret < Len(uname) Then
						uname = Mid(uname, ret + 1)
					End If
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If ret > 0 Then
					If ret < Len(uname) Then
						uname = Mid(uname, ret + 1)
					End If
				End If
				If Right(uname, 4) = "繧ｫ繧ｹ繧ｿ繝" Then
					uname = Left(uname, Len(uname) - 4)
				End If
				If Right(uname, 1) = "謾ｹ" Then
					uname = Left(uname, Len(uname) - 1)
				End If
				If .IsDefined(uname) Then
					msg = .Item(uname).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						GoTo FoundMessage
					End If
				End If
				
				'繝ｦ繝九ャ繝医け繝ｩ繧ｹ縺ｧ讀懃ｴ｢
				uclass = Class0
				If .IsDefined(uclass) Then
					msg = .Item(uclass).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						GoTo FoundMessage
					End If
				End If
				
				'豎守畑
				If .IsDefined("豎守畑") Then
					msg = .Item("豎守畑").SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						GoTo FoundMessage
					End If
				End If
			Next 
		End With
		
		'Invalid_string_refer_to_original_code
		Exit Sub
		
FoundMessage: 
		
		'Invalid_string_refer_to_original_code
		If msg = "-" Then
			Exit Sub
		End If
		
		'繝ｦ繝九ャ繝亥錐
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			idx = CStr(InStr(msg, "Invalid_string_refer_to_original_code"))
			buf = Nickname
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			If InStr(buf, "蟆ら畑") > 0 Then
				buf = Left(buf, InStr(buf, "蟆ら畑") + 2)
			End If
			msg = Left(msg, CDbl(idx) - 1) & buf & Mid(msg, CDbl(idx) + 7)
		Loop 
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			idx = CStr(InStr(msg, "Invalid_string_refer_to_original_code"))
			buf = Nickname
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			If InStr(buf, "蟆ら畑") > 0 Then
				buf = Left(buf, InStr(buf, "蟆ら畑") + 2)
			End If
			msg = Left(msg, CDbl(idx) - 1) & buf & Mid(msg, CDbl(idx) + 5)
		Loop 
		
		'Invalid_string_refer_to_original_code
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			idx = CStr(InStr(msg, "Invalid_string_refer_to_original_code"))
			buf = MainPilot.Nickname
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			msg = Left(msg, CDbl(idx) - 1) & buf & Mid(msg, CDbl(idx) + 8)
		Loop 
		
		'Invalid_string_refer_to_original_code
		If InStr(msg, "$(豁ｦ蝎ｨ)") > 0 Then
			If SelectedUnit Is Me Then
				wname = Weapon(SelectedWeapon).Name
			Else
				wname = Weapon(SelectedTWeapon).Name
			End If
			If InStr(wname, "(") > 0 Then
				wname = Left(wname, InStr(wname, "(") - 1)
			End If
			If InStr(wname, "<") > 0 Then
				wname = Left(wname, InStr(wname, "<") - 1)
			End If
			Do While InStr(msg, "$(豁ｦ蝎ｨ)") > 0
				idx = CStr(InStr(msg, "$(豁ｦ蝎ｨ)"))
				msg = Left(msg, CDbl(idx) - 1) & wname & Mid(msg, CDbl(idx) + 5)
			Loop 
		End If
		
		'Invalid_string_refer_to_original_code
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			idx = CStr(InStr(msg, "Invalid_string_refer_to_original_code"))
			msg = Left(msg, CDbl(idx) - 1) & VB6.Format(100 * (MaxHP - HP) \ MaxHP) & Mid(msg, CDbl(idx) + 6)
		Loop 
		
		'逶ｸ謇九Θ繝九ャ繝亥錐
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			If SelectedUnit Is Me Then
				If Not SelectedTarget Is Nothing Then
					buf = SelectedTarget.Nickname
				Else
					buf = ""
				End If
			Else
				buf = SelectedUnit.Nickname
			End If
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			If InStr(buf, "蟆ら畑") > 0 Then
				buf = Left(buf, InStr(buf, "蟆ら畑") + 2)
			End If
			idx = CStr(InStr(msg, "Invalid_string_refer_to_original_code"))
			msg = Left(msg, CDbl(idx) - 1) & buf & Mid(msg, CDbl(idx) + 9)
		Loop 
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			If SelectedUnit Is Me Then
				If Not SelectedTarget Is Nothing Then
					buf = SelectedTarget.Nickname
				Else
					buf = ""
				End If
			Else
				buf = SelectedUnit.Nickname
			End If
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			If InStr(buf, "蟆ら畑") > 0 Then
				buf = Left(buf, InStr(buf, "蟆ら畑") + 2)
			End If
			idx = CStr(InStr(msg, "Invalid_string_refer_to_original_code"))
			msg = Left(msg, CDbl(idx) - 1) & buf & Mid(msg, CDbl(idx) + 7)
		Loop 
		
		'Invalid_string_refer_to_original_code
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			If SelectedUnit Is Me Then
				If Not SelectedTarget Is Nothing Then
					buf = SelectedTarget.MainPilot.Nickname
				Else
					buf = ""
				End If
			Else
				buf = SelectedUnit.MainPilot.Nickname
			End If
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			idx = CStr(InStr(msg, "Invalid_string_refer_to_original_code"))
			msg = Left(msg, CDbl(idx) - 1) & buf & Mid(msg, CDbl(idx) + 10)
		Loop 
		
		'Invalid_string_refer_to_original_code
		Do While InStr(msg, "$(逶ｸ謇区ｭｦ蝎ｨ)") > 0
			If SelectedUnit Is Me Then
				If Not SelectedTarget Is Nothing Then
					buf = SelectedTarget.Weapon(SelectedTWeapon).Name
				Else
					buf = ""
				End If
			Else
				buf = SelectedUnit.Weapon(SelectedWeapon).Name
			End If
			If InStr(buf, "(") > 0 Then
				buf = Left(buf, InStr(buf, "(") - 1)
			End If
			If InStr(buf, "<") > 0 Then
				buf = Left(buf, InStr(buf, "<") - 1)
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'End If
			idx = CStr(InStr(msg, "$(逶ｸ謇区ｭｦ蝎ｨ)"))
			msg = Left(msg, CDbl(idx) - 1) & buf & Mid(msg, CDbl(idx) + 7)
		Loop 
		
		'Invalid_string_refer_to_original_code
		Do While InStr(msg, "Invalid_string_refer_to_original_code") > 0
			idx = CStr(InStr(msg, "Invalid_string_refer_to_original_code"))
			If SelectedUnit Is Me Then
				If Not SelectedTarget Is Nothing Then
					With SelectedTarget
						buf = VB6.Format(100 * (.MaxHP - .HP) \ .MaxHP)
					End With
				Else
					buf = ""
				End If
			Else
				With SelectedUnit
					buf = VB6.Format(100 * (.MaxHP - .HP) \ .MaxHP)
				End With
			End If
			msg = Left(msg, CDbl(idx) - 1) & buf & Mid(msg, CDbl(idx) + 8)
		Loop 
		
		If Not frmMessage.Visible Then
			OpenMessageForm()
		End If
		If add_msg <> "" Then
			DisplayBattleMessage("-", msg & "." & add_msg)
		Else
			DisplayBattleMessage("-", msg)
		End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function IsSysMessageDefined(ByRef main_situation As String, Optional ByRef sub_situation As String = "") As Boolean
		Dim uclass, uname, msg As String
		Dim situations() As String
		Dim i, ret As Short
		
		If sub_situation = "" Or main_situation = sub_situation Then
			ReDim situations(1)
			situations(1) = main_situation & "(隗｣隱ｬ)"
		Else
			ReDim situations(2)
			situations(1) = main_situation & "(" & sub_situation & ")(隗｣隱ｬ)"
			situations(2) = main_situation & "(隗｣隱ｬ)"
		End If
		
		' ADD START MARGE
		'Invalid_string_refer_to_original_code
		If ExtendedAnimation Then
			With EADList
				For i = 1 To UBound(situations)
					'Invalid_string_refer_to_original_code
					If IsFeatureAvailable("謌ｦ髣倥い繝九Γ") Then
						uname = FeatureData("謌ｦ髣倥い繝九Γ")
						If .IsDefined(uname) Then
							msg = .Item(uname).SelectMessage(situations(i), Me)
							If Len(msg) > 0 Then
								IsSysMessageDefined = True
								Exit Function
							End If
						End If
					End If
					
					'繝ｦ繝九ャ繝亥錐遘ｰ縺ｧ讀懃ｴ｢
					If .IsDefined(Name) Then
						msg = .Item(Name).SelectMessage(situations(i), Me)
						If Len(msg) > 0 Then
							IsSysMessageDefined = True
							Exit Function
						End If
					End If
					
					'Invalid_string_refer_to_original_code
					uname = Nickname0
					ret = InStr(uname, "(")
					If ret > 1 Then
						uname = Left(uname, ret - 1)
					End If
					ret = InStr(uname, "逕ｨ")
					If ret > 0 Then
						If ret < Len(uname) Then
							uname = Mid(uname, ret + 1)
						End If
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If ret > 0 Then
						If ret < Len(uname) Then
							uname = Mid(uname, ret + 1)
						End If
					End If
					If Right(uname, 4) = "繧ｫ繧ｹ繧ｿ繝" Then
						uname = Left(uname, Len(uname) - 4)
					End If
					If Right(uname, 1) = "謾ｹ" Then
						uname = Left(uname, Len(uname) - 1)
					End If
					If .IsDefined(uname) Then
						msg = .Item(uname).SelectMessage(situations(i), Me)
						If Len(msg) > 0 Then
							IsSysMessageDefined = True
							Exit Function
						End If
					End If
					
					'繝ｦ繝九ャ繝医け繝ｩ繧ｹ縺ｧ讀懃ｴ｢
					uclass = Class0
					If .IsDefined(uclass) Then
						msg = .Item(uclass).SelectMessage(situations(i), Me)
						If Len(msg) > 0 Then
							IsSysMessageDefined = True
							Exit Function
						End If
					End If
					
					'豎守畑
					If .IsDefined("豎守畑") Then
						msg = .Item("豎守畑").SelectMessage(situations(i), Me)
						If Len(msg) > 0 Then
							IsSysMessageDefined = True
							Exit Function
						End If
					End If
				Next 
			End With
		End If
		' ADD END MARGE
		
		'Invalid_string_refer_to_original_code
		With ADList
			For i = 1 To UBound(situations)
				'Invalid_string_refer_to_original_code
				If IsFeatureAvailable("謌ｦ髣倥い繝九Γ") Then
					uname = FeatureData("謌ｦ髣倥い繝九Γ")
					If .IsDefined(uname) Then
						msg = .Item(uname).SelectMessage(situations(i), Me)
						If Len(msg) > 0 Then
							IsSysMessageDefined = True
							Exit Function
						End If
					End If
				End If
				
				'繝ｦ繝九ャ繝亥錐遘ｰ縺ｧ讀懃ｴ｢
				If .IsDefined(Name) Then
					msg = .Item(Name).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						IsSysMessageDefined = True
						Exit Function
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				uname = Nickname0
				ret = InStr(uname, "(")
				If ret > 1 Then
					uname = Left(uname, ret - 1)
				End If
				ret = InStr(uname, "逕ｨ")
				If ret > 0 Then
					If ret < Len(uname) Then
						uname = Mid(uname, ret + 1)
					End If
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If ret > 0 Then
					If ret < Len(uname) Then
						uname = Mid(uname, ret + 1)
					End If
				End If
				If Right(uname, 4) = "繧ｫ繧ｹ繧ｿ繝" Then
					uname = Left(uname, Len(uname) - 4)
				End If
				If Right(uname, 1) = "謾ｹ" Then
					uname = Left(uname, Len(uname) - 1)
				End If
				If .IsDefined(uname) Then
					msg = .Item(uname).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						IsSysMessageDefined = True
						Exit Function
					End If
				End If
				
				'繝ｦ繝九ャ繝医け繝ｩ繧ｹ縺ｧ讀懃ｴ｢
				uclass = Class0
				If .IsDefined(uclass) Then
					msg = .Item(uclass).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						IsSysMessageDefined = True
						Exit Function
					End If
				End If
				
				'豎守畑
				If .IsDefined("豎守畑") Then
					msg = .Item("豎守畑").SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						IsSysMessageDefined = True
						Exit Function
					End If
				End If
			Next 
		End With
		
		'迚ｹ谿雁柑譫懊ョ繝ｼ繧ｿ縺ｧ讀懃ｴ｢
		With EDList
			For i = 1 To UBound(situations)
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If .IsDefined(uname) Then
					msg = .Item(uname).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						IsSysMessageDefined = True
						Exit Function
					End If
				End If
				'End If
				
				'繝ｦ繝九ャ繝亥錐遘ｰ縺ｧ讀懃ｴ｢
				If .IsDefined(Name) Then
					msg = .Item(Name).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						IsSysMessageDefined = True
						Exit Function
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				uname = Nickname0
				ret = InStr(uname, "(")
				If ret > 1 Then
					uname = Left(uname, ret - 1)
				End If
				ret = InStr(uname, "逕ｨ")
				If ret > 0 Then
					If ret < Len(uname) Then
						uname = Mid(uname, ret + 1)
					End If
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If ret > 0 Then
					If ret < Len(uname) Then
						uname = Mid(uname, ret + 1)
					End If
				End If
				If Right(uname, 4) = "繧ｫ繧ｹ繧ｿ繝" Then
					uname = Left(uname, Len(uname) - 4)
				End If
				If Right(uname, 1) = "謾ｹ" Then
					uname = Left(uname, Len(uname) - 1)
				End If
				If .IsDefined(uname) Then
					msg = .Item(uname).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						IsSysMessageDefined = True
						Exit Function
					End If
				End If
				
				'繝ｦ繝九ャ繝医け繝ｩ繧ｹ縺ｧ讀懃ｴ｢
				uclass = Class0
				If .IsDefined(uclass) Then
					msg = .Item(uclass).SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						IsSysMessageDefined = True
						Exit Function
					End If
				End If
				
				'豎守畑
				If .IsDefined("豎守畑") Then
					msg = .Item("豎守畑").SelectMessage(situations(i), Me)
					If Len(msg) > 0 Then
						IsSysMessageDefined = True
						Exit Function
					End If
				End If
			Next 
		End With
		
		IsSysMessageDefined = False
	End Function
	
	
	'Invalid_string_refer_to_original_code
	
	'迚ｹ谿雁柑譫懊ョ繝ｼ繧ｿ繧呈､懃ｴ｢
	Public Function SpecialEffectData(ByRef main_situation As String, Optional ByRef sub_situation As String = "") As String
		Dim uname, uclass As String
		Dim situations() As String
		Dim i, ret As Short
		
		'Invalid_string_refer_to_original_code
		If sub_situation = "" Or main_situation = sub_situation Then
			ReDim situations(1)
			situations(1) = main_situation
		Else
			ReDim situations(2)
			situations(1) = main_situation & "(" & sub_situation & ")"
			situations(2) = main_situation
		End If
		
		For i = 1 To UBound(situations)
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If EDList.IsDefined(uname) Then
				SpecialEffectData = EDList.Item(uname).SelectMessage(situations(i), Me)
				If Len(SpecialEffectData) > 0 Then
					Exit Function
				End If
			End If
			'End If
			
			'繝ｦ繝九ャ繝亥錐遘ｰ縺ｧ讀懃ｴ｢
			If EDList.IsDefined(Name) Then
				SpecialEffectData = EDList.Item(Name).SelectMessage(situations(i), Me)
				If Len(SpecialEffectData) > 0 Then
					Exit Function
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			uname = Nickname
			ret = InStr(uname, "(")
			If ret > 1 Then
				uname = Left(uname, ret - 1)
			End If
			ret = InStr(uname, "逕ｨ")
			If ret > 0 Then
				If ret < Len(uname) Then
					uname = Mid(uname, ret + 1)
				End If
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If ret > 0 Then
				If ret < Len(uname) Then
					uname = Mid(uname, ret + 1)
				End If
			End If
			If Right(uname, 4) = "繧ｫ繧ｹ繧ｿ繝" Then
				uname = Left(uname, Len(uname) - 4)
			End If
			If Right(uname, 1) = "謾ｹ" Then
				uname = Left(uname, Len(uname) - 1)
			End If
			If EDList.IsDefined(uname) Then
				SpecialEffectData = EDList.Item(uname).SelectMessage(situations(i), Me)
				If Len(SpecialEffectData) > 0 Then
					Exit Function
				End If
			End If
			
			'繝ｦ繝九ャ繝医け繝ｩ繧ｹ縺ｧ讀懃ｴ｢
			uclass = Class0
			If EDList.IsDefined(uclass) Then
				SpecialEffectData = EDList.Item(uclass).SelectMessage(situations(i), Me)
				If Len(SpecialEffectData) > 0 Then
					Exit Function
				End If
			End If
			
			'豎守畑
			If EDList.IsDefined("豎守畑") Then
				SpecialEffectData = EDList.Item("豎守畑").SelectMessage(situations(i), Me)
				If Len(SpecialEffectData) > 0 Then
					Exit Function
				End If
			End If
		Next 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub SpecialEffect(ByRef main_situation As String, Optional ByRef sub_situation As String = "", Optional ByVal keep_message_form As Boolean = False)
		Dim anime, sname As String
		Dim animes() As String
		Dim idx, i, j, w As Short
		Dim ret As Double
		Dim buf As String
		Dim anime_head As Short
		Dim is_message_form_opened As Boolean
		Dim is_weapon As Boolean
		Dim is_ability As Boolean
		Dim in_bulk As Boolean
		Dim wait_time As Integer
		Dim need_refresh As Boolean
		Dim prev_obj_color As Integer
		Dim prev_obj_fill_color As Integer
		Dim prev_obj_fill_style As Integer
		Dim prev_obj_draw_width As Integer
		Dim prev_obj_draw_option As String
		Dim prev_selected_target As Unit
		
		'迚ｹ谿雁柑譫懊ョ繝ｼ繧ｿ繧呈､懃ｴ｢
		anime = SpecialEffectData(main_situation, sub_situation)
		
		TrimString(anime)
		
		'陦ｨ遉ｺ繧ｭ繝｣繝ｳ繧ｻ繝ｫ
		If anime = "" Or anime = "-" Then
			Exit Sub
		End If
		
		'繝槭え繧ｹ縺ｮ蜿ｳ繝懊ち繝ｳ縺ｧ繧ｭ繝｣繝ｳ繧ｻ繝ｫ
		If IsRButtonPressed() Then
			'蠑剰ｩ穂ｾ｡縺ｮ縺ｿ陦後≧
			FormatMessage(anime)
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		For i = 1 To CountWeapon
			If Weapon(i).Name = main_situation Then
				w = i
				Exit For
			End If
		Next 
		If w > 0 Then
			Select Case LCase(anime)
				Case "swing.wav"
					'Invalid_string_refer_to_original_code_
					'Or InStr(main_situation, "繧ｹ繝斐い") > 0 _
					'Or InStr(main_situation, "繝ｩ繝ｳ繧ｹ") > 0 _
					'Or InStr(main_situation, "繧ｸ繝｣繝吶Μ繝ｳ") > 0 _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					ShowAnimation("Invalid_string_refer_to_original_code")
					Exit Sub
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					ShowAnimation("Invalid_string_refer_to_original_code")
					Exit Sub
			End Select
		End If
		'End Select
		'UPGRADE_WARNING: SpecialEffect に変換されていないステートメントがあります。ソース コードを確認してください。
		Select Case LCase(anime)
			Case "break.wav"
				ShowAnimation("謇捺茶蜻ｽ荳ｭ")
				Exit Sub
			Case "combo.wav"
				ShowAnimation("荵ｱ謇灘多荳ｭ")
				Exit Sub
			Case "crash.wav"
				ShowAnimation("蠑ｷ謇灘多荳ｭ Crash.wav")
				Exit Sub
			Case "explode.wav"
				ShowAnimation("Invalid_string_refer_to_original_code")
				Exit Sub
			Case "explode(far).wav"
				ShowAnimation("Invalid_string_refer_to_original_code")
				Exit Sub
			Case "explode(nuclear).wav"
				ShowAnimation("Invalid_string_refer_to_original_code")
				Exit Sub
			Case "fire.wav"
				ShowAnimation("轤主多荳ｭ")
				Exit Sub
			Case "glass.wav"
				If IsWeaponClassifiedAs(w, "蜀ｷ") Then
					ShowAnimation("蜃咲ｵ仙多荳ｭ Glass.wav")
				End If
				Exit Sub
			Case "punch.wav"
				ShowAnimation("謇捺茶蜻ｽ荳ｭ")
				Exit Sub
			Case "punch(2).wav", "punch(3).wav", "punch(4).wav"
				ShowAnimation("騾｣謇灘多荳ｭ")
				Exit Sub
			Case "saber.wav", "slash.wav"
				ShowAnimation("Invalid_string_refer_to_original_code" & anime)
				Exit Sub
			Case "shock(low).wav"
				ShowAnimation("蠑ｷ謇灘多荳ｭ Shock(Low).wav")
				Exit Sub
			Case "stab.wav"
				ShowAnimation("蛻ｺ遯∝多荳ｭ")
				Exit Sub
			Case "thunder.wav"
				ShowAnimation("謾ｾ髮ｻ蜻ｽ荳ｭ Thunder.wav")
				Exit Sub
			Case "whip.wav"
				ShowAnimation("謇捺茶蜻ｽ荳ｭ Whip.wav")
				Exit Sub
		End Select
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		is_message_form_opened = frmMessage.Visible
		
		'繧ｪ繝悶ず繧ｧ繧ｯ繝郁牡遲峨ｒ險倬鹸縺励※縺翫￥
		prev_obj_color = ObjColor
		prev_obj_fill_color = ObjFillColor
		prev_obj_fill_style = ObjFillStyle
		prev_obj_draw_width = ObjDrawWidth
		prev_obj_draw_option = ObjDrawOption
		
		'Invalid_string_refer_to_original_code
		ObjColor = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.White)
		ObjFillColor = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.White)
		'UPGRADE_ISSUE: 定数 vbFSTransparent はアップグレードされませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="55B59875-9A95-4B71-9D6A-7C294BF7139D"' をクリックしてください。
		ObjFillStyle = vbFSTransparent
		ObjDrawWidth = 1
		ObjDrawOption = ""
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountWeapon
			If main_situation = Weapon(i).Name Then
				is_weapon = True
				Exit For
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountAbility
			If main_situation = Ability(i).Name Then
				is_ability = True
				Exit For
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		prev_selected_target = SelectedTargetForEvent
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If Not is_weapon And Not is_ability Then
			If SelectedTargetForEvent Is Nothing Then
				SelectedTargetForEvent = Me
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		ReDim animes(1)
		anime_head = 1
		For i = 1 To Len(anime)
			If Mid(anime, i, 1) = ";" Then
				animes(UBound(animes)) = Mid(anime, anime_head, i - anime_head)
				ReDim Preserve animes(UBound(animes) + 1)
				anime_head = i + 1
			End If
		Next 
		animes(UBound(animes)) = Mid(anime, anime_head)
		
		On Error GoTo ErrorHandler
		
		For i = 1 To UBound(animes)
			anime = animes(i)
			
			'蠑剰ｩ穂ｾ｡
			FormatMessage(anime)
			
			'Invalid_string_refer_to_original_code
			If LCase(anime) = "clear" Then
				ClearPicture()
				need_refresh = True
				GoTo NextAnime
			End If
			
			'Invalid_string_refer_to_original_code
			Select Case LCase(Right(LIndex(anime, 1), 4))
				Case ".wav", ".mp3"
					'蜉ｹ譫憺浹
					PlayWave(anime)
					If wait_time > 0 Then
						If need_refresh Then
							'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
							MainForm.picMain(0).Refresh()
							need_refresh = False
						End If
						Sleep(wait_time)
						wait_time = 0
					End If
					GoTo NextAnime
					
				Case ".bmp", ".jpg", ".gif", ".png"
					'Invalid_string_refer_to_original_code
					If wait_time > 0 Then
						anime = VB6.Format(wait_time / 100) & ";" & anime
						wait_time = 0
						need_refresh = False
					ElseIf Left(anime, 1) = "@" Then 
						need_refresh = False
					Else
						need_refresh = True
					End If
					DisplayBattleMessage("-", anime)
					GoTo NextAnime
			End Select
			
			Select Case LCase(LIndex(anime, 1))
				Case "line", "circle", "arc", "oval", "color", "fillcolor", "fillstyle", "drawwidth"
					'Invalid_string_refer_to_original_code
					If wait_time > 0 Then
						anime = VB6.Format(wait_time / 100) & ";" & anime
						wait_time = 0
						need_refresh = False
					Else
						need_refresh = True
					End If
					DisplayBattleMessage("-", anime)
					GoTo NextAnime
				Case "center"
					'Invalid_string_refer_to_original_code
					buf = GetValueAsString(ListIndex(anime, 2))
					If UList.IsDefined(buf) Then
						With UList.Item(buf)
							Center(.x, .y)
							RedrawScreen()
							need_refresh = False
						End With
					End If
					GoTo NextAnime
				Case "keep"
					'Invalid_string_refer_to_original_code
					Exit For
			End Select
			
			'Invalid_string_refer_to_original_code
			If IsNumeric(anime) Then
				wait_time = 100 * CDbl(anime)
				GoTo NextAnime
			End If
			
			'Invalid_string_refer_to_original_code
			If wait_time > 0 Then
				anime = VB6.Format(wait_time / 100) & ";" & anime
				wait_time = 0
			End If
			If Not frmMessage.Visible Then
				If SelectedTarget Is Me Then
					OpenMessageForm(Me)
				Else
					OpenMessageForm(SelectedTarget, Me)
				End If
			End If
			DisplayBattleMessage("-", anime)
			GoTo NextAnime
			
NextAnime: 
		Next 
		
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If w > 0 Then
			ShowAnimation("Invalid_string_refer_to_original_code")
		ElseIf InStr(main_situation, "(蜻ｽ荳ｭ)") > 0 Then 
			ShowAnimation("繝繝｡繝ｼ繧ｸ蜻ｽ荳ｭ -.wav")
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If need_refresh Then
			'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
			MainForm.picMain(0).Refresh()
			need_refresh = False
		End If
		If wait_time > 0 Then
			Sleep(wait_time)
			wait_time = 0
		End If
		
		'逕ｻ蜒上ｒ豸亥悉縺励※縺翫￥
		If IsPictureDrawn And InStr(main_situation, "(貅門ｙ)") = 0 And LCase(anime) <> "keep" Then
			ClearPicture()
			'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
			MainForm.picMain(0).Refresh()
		End If
		
		'Invalid_string_refer_to_original_code
		If Not is_message_form_opened And Not keep_message_form Then
			CloseMessageForm()
		End If
		
		'Invalid_string_refer_to_original_code
		ObjColor = prev_obj_color
		ObjFillColor = prev_obj_fill_color
		ObjFillStyle = prev_obj_fill_style
		ObjDrawWidth = prev_obj_draw_width
		ObjDrawOption = prev_obj_draw_option
		
		'Invalid_string_refer_to_original_code
		SelectedTargetForEvent = prev_selected_target
		
		Exit Sub
		
ErrorHandler: 
		
		If Len(EventErrorMessage) > 0 Then
			DisplayEventErrorMessage(CurrentLineNum, EventErrorMessage)
			EventErrorMessage = ""
		Else
			DisplayEventErrorMessage(CurrentLineNum, "")
		End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function IsSpecialEffectDefined(ByRef main_situation As String, Optional ByRef sub_situation As String = "") As Boolean
		Dim msg As String
		
		msg = SpecialEffectData(main_situation, sub_situation)
		
		If Len(msg) > 0 Then
			IsSpecialEffectDefined = True
		End If
	End Function
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	' MOD START MARGE
	'Public Function AnimationData(main_situation As String, sub_situation As String) As String
	Public Function AnimationData(ByRef main_situation As String, ByRef sub_situation As String, Optional ByVal ext_anime_only As Boolean = False) As String
		' MOD END MARGE
		Dim uname, uclass As String
		Dim situations() As String
		Dim i, ret As Short
		
		If Not BattleAnimation Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If sub_situation = "" Or main_situation = sub_situation Then
			ReDim situations(1)
			situations(1) = main_situation
		Else
			ReDim situations(2)
			situations(1) = main_situation & "(" & sub_situation & ")"
			situations(2) = main_situation
		End If
		
		For i = 1 To UBound(situations)
			'Invalid_string_refer_to_original_code
			If IsFeatureAvailable("謌ｦ髣倥い繝九Γ") Then
				uname = FeatureData("謌ｦ髣倥い繝九Γ")
				' MOD START MARGE
				'            If ADList.IsDefined(uname) Then
				'                AnimationData = ADList.Item(uname).SelectMessage(situations(i), Me)
				'                If Len(AnimationData) > 0 Then
				'                    Exit Function
				'                End If
				'            End If
				If ExtendedAnimation Then
					If EADList.IsDefined(uname) Then
						AnimationData = EADList.Item(uname).SelectMessage(situations(i), Me)
						If Len(AnimationData) > 0 Then
							Exit Function
						End If
					End If
				End If
				If Not ext_anime_only Then
					If ADList.IsDefined(uname) Then
						AnimationData = ADList.Item(uname).SelectMessage(situations(i), Me)
						If Len(AnimationData) > 0 Then
							Exit Function
						End If
					End If
				End If
				' MOD END MARGE
			End If
			
			'繝ｦ繝九ャ繝亥錐遘ｰ縺ｧ讀懃ｴ｢
			' MOD START MARGE
			'        If ADList.IsDefined(Name) Then
			'            AnimationData = ADList.Item(Name).SelectMessage(situations(i), Me)
			'            If Len(AnimationData) > 0 Then
			'                Exit Function
			'            End If
			'        End If
			If ExtendedAnimation Then
				If EADList.IsDefined(Name) Then
					AnimationData = EADList.Item(Name).SelectMessage(situations(i), Me)
					If Len(AnimationData) > 0 Then
						Exit Function
					End If
				End If
			End If
			If Not ext_anime_only Then
				If ADList.IsDefined(Name) Then
					AnimationData = ADList.Item(Name).SelectMessage(situations(i), Me)
					If Len(AnimationData) > 0 Then
						Exit Function
					End If
				End If
			End If
			' MOD END MARGE
			
			'Invalid_string_refer_to_original_code
			uname = Nickname0
			ret = InStr(uname, "(")
			If ret > 1 Then
				uname = Left(uname, ret - 1)
			End If
			ret = InStr(uname, "逕ｨ")
			If ret > 0 Then
				If ret < Len(uname) Then
					uname = Mid(uname, ret + 1)
				End If
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If ret > 0 Then
				If ret < Len(uname) Then
					uname = Mid(uname, ret + 1)
				End If
			End If
			If Right(uname, 4) = "繧ｫ繧ｹ繧ｿ繝" Then
				uname = Left(uname, Len(uname) - 4)
			End If
			If Right(uname, 1) = "謾ｹ" Then
				uname = Left(uname, Len(uname) - 1)
			End If
			' MOD START MARGE
			'        If ADList.IsDefined(uname) Then
			'            AnimationData = ADList.Item(uname).SelectMessage(situations(i), Me)
			'            If Len(AnimationData) > 0 Then
			'                Exit Function
			'            End If
			'        End If
			If ExtendedAnimation Then
				If EADList.IsDefined(uname) Then
					AnimationData = EADList.Item(uname).SelectMessage(situations(i), Me)
					If Len(AnimationData) > 0 Then
						Exit Function
					End If
				End If
			End If
			If Not ext_anime_only Then
				If ADList.IsDefined(uname) Then
					AnimationData = ADList.Item(uname).SelectMessage(situations(i), Me)
					If Len(AnimationData) > 0 Then
						Exit Function
					End If
				End If
			End If
			' MOD END MARGE
			
			'繝ｦ繝九ャ繝医け繝ｩ繧ｹ縺ｧ讀懃ｴ｢
			uclass = Class0
			' MOD START MARGE
			'        If ADList.IsDefined(uclass) Then
			'            AnimationData = ADList.Item(uclass).SelectMessage(situations(i), Me)
			'            If Len(AnimationData) > 0 Then
			'                Exit Function
			'            End If
			'        End If
			If ExtendedAnimation Then
				If EADList.IsDefined(uclass) Then
					AnimationData = EADList.Item(uclass).SelectMessage(situations(i), Me)
					If Len(AnimationData) > 0 Then
						Exit Function
					End If
				End If
			End If
			If Not ext_anime_only Then
				If ADList.IsDefined(uclass) Then
					AnimationData = ADList.Item(uclass).SelectMessage(situations(i), Me)
					If Len(AnimationData) > 0 Then
						Exit Function
					End If
				End If
			End If
			' MOD END MARGE
			
			'豎守畑
			' MOD START MARGE
			'        If ADList.IsDefined("豎守畑") Then
			'            AnimationData = ADList.Item("豎守畑").SelectMessage(situations(i), Me)
			'            If Len(AnimationData) > 0 Then
			'                Exit Function
			'            End If
			'        End If
			If ExtendedAnimation Then
				If EADList.IsDefined("豎守畑") Then
					AnimationData = EADList.Item("豎守畑").SelectMessage(situations(i), Me)
					If Len(AnimationData) > 0 Then
						Exit Function
					End If
				End If
			End If
			If Not ext_anime_only Then
				If ADList.IsDefined("豎守畑") Then
					AnimationData = ADList.Item("豎守畑").SelectMessage(situations(i), Me)
					If Len(AnimationData) > 0 Then
						Exit Function
					End If
				End If
			End If
			' MOD END MARGE
		Next 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub PlayAnimation(ByRef main_situation As String, Optional ByRef sub_situation As String = "", Optional ByVal keep_message_form As Boolean = False)
		Dim anime, sname As String
		Dim animes() As String
		Dim j, i, idx As Short
		Dim ret As Double
		Dim buf As String
		Dim anime_head As Short
		Dim is_message_form_opened As Boolean
		Dim is_weapon As Boolean
		Dim is_ability As Boolean
		Dim in_bulk As Boolean
		Dim wait_time As Integer
		Dim need_refresh As Boolean
		Dim prev_obj_color As Integer
		Dim prev_obj_fill_color As Integer
		Dim prev_obj_fill_style As Integer
		Dim prev_obj_draw_width As Integer
		Dim prev_obj_draw_option As String
		Dim prev_selected_target As Unit
		
		'Invalid_string_refer_to_original_code
		anime = AnimationData(main_situation, sub_situation)
		
		'Invalid_string_refer_to_original_code
		If anime = "" Then
			Select Case Right(main_situation, 4)
				Case "(貅門ｙ)", "Invalid_string_refer_to_original_code", "(蜻ｽ荳ｭ)"
					anime = AnimationData(Left(main_situation, Len(main_situation) - 4), sub_situation)
					in_bulk = True
				Case "Invalid_string_refer_to_original_code"
					anime = AnimationData(Left(main_situation, Len(main_situation) - 4), sub_situation)
			End Select
		End If
		
		TrimString(anime)
		
		'陦ｨ遉ｺ繧ｭ繝｣繝ｳ繧ｻ繝ｫ
		If anime = "" Or anime = "-" Then
			Exit Sub
		End If
		
		'繝槭え繧ｹ縺ｮ蜿ｳ繝懊ち繝ｳ縺ｧ繧ｭ繝｣繝ｳ繧ｻ繝ｫ
		If IsRButtonPressed() Then
			' MOD START MARGE
			'        '蠑剰ｩ穂ｾ｡縺ｮ縺ｿ陦後≧
			'        FormatMessage anime
			'        Exit Sub
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'蠑剰ｩ穂ｾ｡縺ｮ縺ｿ陦後≧
			FormatMessage(anime)
			Exit Sub
		End If
		' MOD END MARGE
		'End If
		
		'Invalid_string_refer_to_original_code
		is_message_form_opened = frmMessage.Visible
		
		'繧ｪ繝悶ず繧ｧ繧ｯ繝郁牡遲峨ｒ險倬鹸縺励※縺翫￥
		prev_obj_color = ObjColor
		prev_obj_fill_color = ObjFillColor
		prev_obj_fill_style = ObjFillStyle
		prev_obj_draw_width = ObjDrawWidth
		prev_obj_draw_option = ObjDrawOption
		
		'Invalid_string_refer_to_original_code
		ObjColor = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.White)
		ObjFillColor = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.White)
		'UPGRADE_ISSUE: 定数 vbFSTransparent はアップグレードされませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="55B59875-9A95-4B71-9D6A-7C294BF7139D"' をクリックしてください。
		ObjFillStyle = vbFSTransparent
		ObjDrawWidth = 1
		ObjDrawOption = ""
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountWeapon
			If main_situation = Weapon(i).Name & "Invalid_string_refer_to_original_code" Then
				is_weapon = True
				Exit For
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountAbility
			If main_situation = Ability(i).Name & "Invalid_string_refer_to_original_code" Then
				is_ability = True
				Exit For
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		prev_selected_target = SelectedTargetForEvent
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If Not is_weapon And Not is_ability Then
			If SelectedTargetForEvent Is Nothing Then
				SelectedTargetForEvent = Me
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		ReDim animes(1)
		anime_head = 1
		For i = 1 To Len(anime)
			If Mid(anime, i, 1) = ";" Then
				animes(UBound(animes)) = Mid(anime, anime_head, i - anime_head)
				ReDim Preserve animes(UBound(animes) + 1)
				anime_head = i + 1
			End If
		Next 
		animes(UBound(animes)) = Mid(anime, anime_head)
		
		On Error GoTo ErrorHandler
		
		For i = 1 To UBound(animes)
			anime = animes(i)
			
			'Invalid_string_refer_to_original_code
			'繧ｵ繝悶Ν繝ｼ繝√Φ蜷阪ｒ縺ゅｉ縺九§繧√け繝ｪ繧｢縺励※縺翫￥
			sname = ""
			
			'蠑剰ｩ穂ｾ｡
			FormatMessage(anime)
			
			'Invalid_string_refer_to_original_code
			If LCase(anime) = "clear" Then
				ClearPicture()
				need_refresh = True
				GoTo NextAnime
			End If
			
			'Invalid_string_refer_to_original_code
			Select Case LCase(Right(LIndex(anime, 1), 4))
				Case ".wav", ".mp3"
					'蜉ｹ譫憺浹
					PlayWave(anime)
					If wait_time > 0 Then
						If need_refresh Then
							'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
							MainForm.picMain(0).Refresh()
							need_refresh = False
						End If
						Sleep(wait_time)
						wait_time = 0
					End If
					GoTo NextAnime
					
				Case ".bmp", ".jpg", ".gif", ".png"
					'Invalid_string_refer_to_original_code
					If wait_time > 0 Then
						anime = VB6.Format(wait_time / 100) & ";" & anime
						wait_time = 0
						need_refresh = False
					ElseIf Left(anime, 1) = "@" Then 
						need_refresh = False
					Else
						need_refresh = True
					End If
					DisplayBattleMessage("-", anime)
					GoTo NextAnime
			End Select
			
			Select Case LCase(LIndex(anime, 1))
				Case "line", "circle", "arc", "oval", "color", "fillcolor", "fillstyle", "drawwidth"
					'Invalid_string_refer_to_original_code
					If wait_time > 0 Then
						anime = VB6.Format(wait_time / 100) & ";" & anime
						wait_time = 0
						need_refresh = False
					Else
						need_refresh = True
					End If
					DisplayBattleMessage("-", anime)
					GoTo NextAnime
				Case "center"
					'Invalid_string_refer_to_original_code
					buf = GetValueAsString(ListIndex(anime, 2))
					If UList.IsDefined(buf) Then
						With UList.Item(buf)
							Center(.x, .y)
							RedrawScreen()
							need_refresh = False
						End With
					End If
					GoTo NextAnime
				Case "keep"
					'Invalid_string_refer_to_original_code
					Exit For
			End Select
			
			'Invalid_string_refer_to_original_code
			If IsNumeric(anime) Then
				wait_time = 100 * CDbl(anime)
				GoTo NextAnime
			End If
			
			'Invalid_string_refer_to_original_code
			
			'Invalid_string_refer_to_original_code
			sname = LIndex(anime, 1)
			If Left(sname, 1) = "@" Then
				sname = Mid(sname, 2)
			ElseIf is_weapon Then 
				'Invalid_string_refer_to_original_code
				sname = "謌ｦ髣倥い繝九Γ_" & sname & "Invalid_string_refer_to_original_code"
			Else
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				idx = InStr2(main_situation, "(")
				
				'Invalid_string_refer_to_original_code
				If idx > 0 Then
					Select Case Left(main_situation, idx - 1)
						Case "螟牙ｽ｢", "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code_
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							idx = 0
					End Select
				End If
				
				'Invalid_string_refer_to_original_code
				If idx > 0 Then
					If Mid(main_situation, idx) = "Invalid_string_refer_to_original_code" Then
						idx = 0
					End If
				End If
				
				If idx > 0 Then
					'Invalid_string_refer_to_original_code
					sname = "謌ｦ髣倥い繝九Γ_" & sname & Mid(main_situation, idx + 1, Len(main_situation) - idx - 1)
				Else
					sname = "謌ｦ髣倥い繝九Γ_" & sname & "Invalid_string_refer_to_original_code"
				End If
			End If
			
			'Invalid_string_refer_to_original_code
			If FindNormalLabel(sname) = 0 Then
				If in_bulk Then
					'Invalid_string_refer_to_original_code
					Select Case Right(main_situation, 4)
						Case "(貅門ｙ)"
							'陦ｨ遉ｺ繧偵く繝｣繝ｳ繧ｻ繝ｫ
							GoTo NextAnime
						Case "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
							If UBound(animes) > 1 Then
								GoTo NextAnime
							End If
							'縺昴≧縺ｧ縺ｪ縺代ｌ縺ｰ縲後ョ繝輔か繝ｫ繝医阪ｒ菴ｿ逕ｨ
							sname = "Invalid_string_refer_to_original_code"
						Case "(蜻ｽ荳ｭ)"
							'Invalid_string_refer_to_original_code
							If UBound(animes) > 1 Then
								GoTo NextAnime
							End If
							'縺昴≧縺ｧ縺ｪ縺代ｌ縺ｰ縲後ム繝｡繝ｼ繧ｸ縲阪ｒ菴ｿ逕ｨ
							sname = "謌ｦ髣倥い繝九Γ_繝繝｡繝ｼ繧ｸ蜻ｽ荳ｭ"
					End Select
				Else
					If wait_time > 0 Then
						anime = VB6.Format(wait_time / 100) & ";" & anime
						wait_time = 0
					End If
					If Not frmMessage.Visible Then
						If SelectedTarget Is Me Then
							OpenMessageForm(Me)
						Else
							OpenMessageForm(SelectedTarget, Me)
						End If
					End If
					DisplayBattleMessage("-", anime)
					GoTo NextAnime
				End If
			End If
			
			sname = "`" & sname & "`"
			
			'Invalid_string_refer_to_original_code
			For j = 2 To ListLength(anime)
				sname = sname & "," & ListIndex(anime, j)
			Next 
			If in_bulk Then
				sname = sname & "Invalid_string_refer_to_original_code"
			End If
			
			'謌ｦ髣倥い繝九Γ蜀咲函蜑阪↓繧ｦ繧ｧ繧､繝医ｒ蜈･繧後ｋ
			If need_refresh Then
				'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
				MainForm.picMain(0).Refresh()
				need_refresh = False
			End If
			If wait_time > 0 Then
				Sleep(wait_time)
				wait_time = 0
			End If
			
			'Invalid_string_refer_to_original_code
			IsPictureDrawn = False
			
			'謌ｦ髣倥い繝九Γ蜀咲函
			SaveBasePoint()
			CallFunction("Call(" & sname & ")", Expression.ValueType.StringType, buf, ret)
			RestoreBasePoint()
			
			'逕ｻ蜒上ｒ豸亥悉縺励※縺翫￥
			If IsPictureDrawn And LCase(buf) <> "keep" Then
				ClearPicture()
				'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
				MainForm.picMain(0).Refresh()
			End If
NextAnime: 
		Next 
		
		'Invalid_string_refer_to_original_code
		If need_refresh Then
			'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
			MainForm.picMain(0).Refresh()
			need_refresh = False
		End If
		If wait_time > 0 Then
			Sleep(wait_time)
			wait_time = 0
		End If
		
		'逕ｻ蜒上ｒ豸亥悉縺励※縺翫￥
		If IsPictureDrawn And sname = "" And InStr(main_situation, "(貅門ｙ)") = 0 And LCase(anime) <> "keep" Then
			ClearPicture()
			'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
			MainForm.picMain(0).Refresh()
		End If
		
		'Invalid_string_refer_to_original_code
		If Not is_message_form_opened And Not keep_message_form Then
			CloseMessageForm()
		End If
		
		'Invalid_string_refer_to_original_code
		ObjColor = prev_obj_color
		ObjFillColor = prev_obj_fill_color
		ObjFillStyle = prev_obj_fill_style
		ObjDrawWidth = prev_obj_draw_width
		ObjDrawOption = prev_obj_draw_option
		
		'Invalid_string_refer_to_original_code
		SelectedTargetForEvent = prev_selected_target
		
		Exit Sub
		
ErrorHandler: 
		
		If Len(EventErrorMessage) > 0 Then
			DisplayEventErrorMessage(CurrentLineNum, EventErrorMessage)
			EventErrorMessage = ""
		Else
			DisplayEventErrorMessage(CurrentLineNum, "")
		End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	' MOD START MARGE
	'Public Function IsAnimationDefined(main_situation As String, _
	''    Optional sub_situation As String) As Boolean
	Public Function IsAnimationDefined(ByRef main_situation As String, Optional ByRef sub_situation As String = "", Optional ByVal ext_anime_only As Boolean = False) As Boolean
		' MOD END MARGE
		Dim anime As String
		
		' MOD START MARGE
		'    anime = AnimationData(main_situation, sub_situation)
		anime = AnimationData(main_situation, sub_situation, ext_anime_only)
		' MOD END MARGE
		
		If Len(anime) > 0 Then
			IsAnimationDefined = True
		Else
			IsAnimationDefined = False
		End If
	End Function
	
	
	
	'繝ｦ繝九ャ繝医ｒ(new_x,new_y)縺ｫ驟咲ｽｮ
	Public Sub StandBy(ByVal new_x As Short, ByVal new_y As Short, Optional ByVal smode As String = "")
		Dim j, i, k As Short
		Dim u As Unit
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		For i = 0 To 20
			For j = MaxLng(new_x - i, 1) To MinLng(new_x + i, MapWidth)
				For k = MaxLng(new_y - i, 1) To MinLng(new_y + i, MapHeight)
					If System.Math.Abs(new_x - j) + System.Math.Abs(new_y - k) = i Then
						If MapDataForUnit(j, k) Is Nothing Then
							x = j
							y = k
							GoTo DefaultPositionDefined
						End If
					End If
				Next 
			Next 
		Next 
DefaultPositionDefined: 
		
		'Invalid_string_refer_to_original_code
		For i = 0 To 20
			'Invalid_string_refer_to_original_code
			' MOD START MARGE
			'Invalid_string_refer_to_original_code
			If InStr(smode, "Invalid_string_refer_to_original_code") > 0 Then
				' MOD END MARGE
				If i Mod 2 <> 0 Then
					GoTo NextDistance
				End If
			End If
			'Invalid_string_refer_to_original_code
			For j = MaxLng(new_x - i, 1) To MinLng(new_x + i, MapWidth)
				For k = MaxLng(new_y - i, 1) To MinLng(new_y + i, MapHeight)
					If System.Math.Abs(new_x - j) + System.Math.Abs(new_y - k) <> i Then
						GoTo NextLoop
					End If
					
					'Invalid_string_refer_to_original_code
					If Not MapDataForUnit(j, k) Is Nothing Then
						GoTo NextLoop
					End If
					
					'Invalid_string_refer_to_original_code
					If TerrainMoveCost(j, k) > 100 Then
						GoTo NextLoop
					End If
					Select Case TerrainClass(j, k)
						Case "遨ｺ"
							If Not IsTransAvailable("遨ｺ") Then
								GoTo NextLoop
							End If
						Case "豌ｴ"
							'Invalid_string_refer_to_original_code_
							'And Not IsTransAvailable("遨ｺ") _
							'And Adaption(3) = 0 _
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							GoTo NextLoop
							'End If
						Case "豺ｱ豌ｴ"
							'Invalid_string_refer_to_original_code_
							'And Not IsTransAvailable("遨ｺ") _
							'And Not IsTransAvailable("豌ｴ") _
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							GoTo NextLoop
							'End If
					End Select
					
					'Invalid_string_refer_to_original_code
					x = j
					y = k
					GoTo ExitFor
NextLoop: 
				Next 
			Next 
NextDistance: 
		Next 
ExitFor: 
		
		'Invalid_string_refer_to_original_code
		If x = 0 And y = 0 Then
			Status_Renamed = "Invalid_string_refer_to_original_code"
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountOtherForm
			With OtherForm(i)
				.x = x
				.y = y
			End With
		Next 
		For i = 1 To CountUnitOnBoard
			With UnitOnBoard(i)
				.x = x
				.y = y
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		For	Each u In UList
			With u
				For i = 1 To .CountUnitOnBoard
					If ID = .UnitOnBoard(i).ID Then
						.UnloadUnit(ID)
						GoTo EndLoop
					End If
				Next 
			End With
		Next u
EndLoop: 
		'End If
		
		'Status繧呈峩譁ｰ
		Status_Renamed = "Invalid_string_refer_to_original_code"
		For i = 1 To CountOtherForm
			OtherForm(i).Status_Renamed = "Invalid_string_refer_to_original_code"
		Next 
		
		'Invalid_string_refer_to_original_code
		Select Case TerrainClass(x, y)
			Case "遨ｺ"
				Area = "遨ｺ荳ｭ"
			Case "髯ｸ"
				If IsTransAvailable("蝨ｰ荳ｭ") And Area = "蝨ｰ荳ｭ" Then
					Area = "蝨ｰ荳ｭ"
				ElseIf IsTransAvailable("遨ｺ") And Adaption(1) >= Adaption(2) Then 
					Area = "遨ｺ荳ｭ"
				ElseIf IsTransAvailable("髯ｸ") Then 
					Area = "Invalid_string_refer_to_original_code"
				Else
					Area = "遨ｺ荳ｭ"
				End If
			Case "Invalid_string_refer_to_original_code"
				If IsTransAvailable("遨ｺ") And Adaption(1) >= Adaption(2) Then
					Area = "遨ｺ荳ｭ"
				ElseIf IsTransAvailable("髯ｸ") Then 
					Area = "Invalid_string_refer_to_original_code"
				Else
					Area = "遨ｺ荳ｭ"
				End If
			Case "譛磯擇"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Area = "Invalid_string_refer_to_original_code"
				IsTransAvailable("髯ｸ")
				Area = "Invalid_string_refer_to_original_code"
				Area = "Invalid_string_refer_to_original_code"
				'End If
			Case "豌ｴ", "豺ｱ豌ｴ"
				If IsTransAvailable("遨ｺ") And Adaption(1) >= Adaption(2) Then
					Area = "遨ｺ荳ｭ"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Area = "Invalid_string_refer_to_original_code"
				Else
					Area = "豌ｴ荳ｭ"
				End If
			Case "Invalid_string_refer_to_original_code"
				Area = "Invalid_string_refer_to_original_code"
			Case Else
				Area = "Invalid_string_refer_to_original_code"
		End Select
		
		'繝槭ャ繝励↓逋ｻ骭ｲ
		MapDataForUnit(x, y) = Me
		
		'Invalid_string_refer_to_original_code
		If BitmapID = 0 Then
			BitmapID = MakeUnitBitmap(Me)
		End If
		
		'逋ｻ蝣ｴ譎ゅい繝九Γ繧定｡ｨ遉ｺ
		' MOD START MARGE
		'Invalid_string_refer_to_original_code_
		''        And MainForm.Visible _
		''        And Not IsPictureVisible _
		''        And Not IsRButtonPressed() _
		''        And BitmapID > 0 _
		''    Then
		'Invalid_string_refer_to_original_code_
		'And MainForm.Visible _
		'And Not IsPictureVisible _
		'And Not IsRButtonPressed() _
		'And BitmapID > 0 _
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		' MOD END MARGE
		Dim fname As String
		Dim start_time, current_time As Integer
		
		'Invalid_string_refer_to_original_code
		PlayWave("UnitOn.wav")
		
		'Invalid_string_refer_to_original_code
		Select Case Party0
			Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
				fname = "Bitmap\Event\AUnitOn0"
			Case "謨ｵ"
				fname = "Bitmap\Event\EUnitOn0"
			Case "Invalid_string_refer_to_original_code"
				fname = "Bitmap\Event\NUnitOn0"
		End Select
		
		If FileExists(AppPath & fname & "1.bmp") Then
			'繧｢繝九Γ陦ｨ遉ｺ髢句ｧ区凾蛻ｻ繧定ｨ倬鹸
			start_time = timeGetTime()
			
			For i = 1 To 4
				'逕ｻ蜒上ｒ騾城℃陦ｨ遉ｺ
				If DrawPicture(fname & VB6.Format(i) & ".bmp", MapToPixelX(x), MapToPixelY(y), 32, 32, 0, 0, 0, 0, "騾城℃") = False Then
					Exit For
				End If
				'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
				MainForm.picMain(0).Refresh()
				
				'Invalid_string_refer_to_original_code
				Do 
					System.Windows.Forms.Application.DoEvents()
					current_time = timeGetTime()
				Loop While current_time < start_time + 15
				start_time = current_time
				
				'逕ｻ蜒上ｒ豸亥悉
				ClearPicture()
			Next 
			
			'Invalid_string_refer_to_original_code
			IsPictureVisible = False
		End If
		'End If
		
		'繝ｦ繝九ャ繝育判蜒上ｒ繝槭ャ繝励↓謠冗判
		If Not IsPictureVisible And MapFileName <> "" Then
			' MOD START MARGE
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			' MOD END MARGE
			PaintUnitBitmap(Me, "Invalid_string_refer_to_original_code")
		Else
			PaintUnitBitmap(Me)
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("蛻ｶ蠕｡荳榊庄") Then
			AddCondition("證ｴ襍ｰ", -1)
		End If
		
		Update()
		
		PList.UpdateSupportMod(Me)
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub Move(ByVal new_x As Short, ByVal new_y As Short, Optional ByVal without_en_consumption As Boolean = False, Optional ByVal by_cancel As Boolean = False, Optional ByVal by_teleport_or_jump As Boolean = False)
		Dim prev_x, prev_y As Short
		Dim i As Short
		
		'繝ｦ繝九ャ繝医ｒ繝槭ャ繝励°繧峨＞縺｣縺溘ｓ蜑企勁
		If MapDataForUnit(x, y) Is Me Then
			'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			MapDataForUnit(x, y) = Nothing
		End If
		If IsPictureVisible Then
			EraseUnitBitmap(x, y, False)
		Else
			EraseUnitBitmap(x, y, False)
		End If
		PList.UpdateSupportMod(Me)
		
		'繝ｦ繝九ャ繝井ｽ咲ｽｮ繧呈欠螳壹＆繧後◆蠎ｧ讓吶↓
		prev_x = x
		prev_y = y
		x = new_x
		y = new_y
		For i = 1 To CountOtherForm
			With OtherForm(i)
				.x = x
				.y = y
			End With
		Next 
		For i = 1 To CountUnitOnBoard
			With UnitOnBoard(i)
				.x = x
				.y = y
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		If Not MapDataForUnit(x, y) Is Nothing Then
			With MapDataForUnit(x, y)
				'Invalid_string_refer_to_original_code
				For i = 1 To .CountFeature
					'Invalid_string_refer_to_original_code_
					'And LLength(.FeatureData(i)) = 3 _
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If UList.IsDefined(LIndex(.FeatureData(i), 3)) Then
						If UList.Item(LIndex(.FeatureData(i), 3)).CurrentForm Is Me Then
							Combine()
							Exit Sub
						End If
					End If
				Next 
			End With
		End If
		'Next
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: Move に変換されていないステートメントがあります。ソース コードを確認してください。
		'End With
		
		'Invalid_string_refer_to_original_code
		Land(MapDataForUnit(x, y), by_cancel)
		Exit Sub
		'End If
		
		'Invalid_string_refer_to_original_code
		Select Case TerrainClass(x, y)
			Case "遨ｺ"
				Area = "遨ｺ荳ｭ"
			Case "髯ｸ", "Invalid_string_refer_to_original_code"
				Select Case Area
					Case "豌ｴ荳ｭ", "Invalid_string_refer_to_original_code"
						Area = "Invalid_string_refer_to_original_code"
					Case "Invalid_string_refer_to_original_code"
						If IsTransAvailable("遨ｺ") And Adaption(1) >= Adaption(2) Then
							Area = "遨ｺ荳ｭ"
						ElseIf IsTransAvailable("髯ｸ") Then 
							Area = "Invalid_string_refer_to_original_code"
						Else
							Area = "遨ｺ荳ｭ"
						End If
				End Select
			Case "譛磯擇"
				Select Case Area
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
					Case Else
						'Invalid_string_refer_to_original_code_
						'And Adaption(4) >= Adaption(2) _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						Area = "Invalid_string_refer_to_original_code"
						IsTransAvailable("髯ｸ")
						Area = "Invalid_string_refer_to_original_code"
						Area = "Invalid_string_refer_to_original_code"
						'End If
				End Select
			Case "豌ｴ", "豺ｱ豌ｴ"
				Select Case Area
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						Area = "Invalid_string_refer_to_original_code"
						Area = "豌ｴ荳ｭ"
						'End If
					Case "Invalid_string_refer_to_original_code"
						Area = "豌ｴ荳ｭ"
				End Select
			Case "Invalid_string_refer_to_original_code"
				Area = "Invalid_string_refer_to_original_code"
		End Select
		
		'繝槭ャ繝励↓繝ｦ繝九ャ繝医ｒ逋ｻ骭ｲ
		MapDataForUnit(x, y) = Me
		
		'繝ｦ繝九ャ繝域緒逕ｻ
		If Not IsPictureVisible Then
			If MoveAnimation And Not by_cancel And Not by_teleport_or_jump Then
				MoveUnitBitmap2(Me, 20)
			Else
				PaintUnitBitmap(Me)
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		If Not without_en_consumption Then
			Select Case Area
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					EN = EN - 5
			End Select
		End If
		'UPGRADE_WARNING: Move に変換されていないステートメントがあります。ソース コードを確認してください。
		'Case "遨ｺ荳ｭ", "Invalid_string_refer_to_original_code"
			'EN = EN - 5
			''UPGRADE_WARNING: Move に変換されていないステートメントがあります。ソース コードを確認してください。
			'Case "蝨ｰ荳ｭ"
				'EN = EN - 10
				'End Select
				'End If
				'
				'Invalid_string_refer_to_original_code
				'Update()
				'PList.UpdateSupportMod(Me)
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub Jump(ByVal new_x As Short, ByVal new_y As Short, Optional ByVal do_refresh As Boolean = True)
		Dim j, i, k As Short
		
		'繝ｦ繝九ャ繝医ｒ荳譌ｦ繝槭ャ繝励°繧牙炎髯､
		'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		MapDataForUnit(x, y) = Nothing
		EraseUnitBitmap(x, y, do_refresh)
		PList.UpdateSupportMod(Me)
		
		'遨ｺ縺堺ｽ咲ｽｮ繧呈､懃ｴ｢
		For i = 0 To 10
			For j = MaxLng(new_x - i, 1) To MinLng(new_x + i, MapWidth)
				For k = MaxLng(new_y - i, 1) To MinLng(new_y + i, MapHeight)
					If System.Math.Abs(new_x - j) + System.Math.Abs(new_y - k) <> i Then
						GoTo NextLoop
					End If
					If Not MapDataForUnit(j, k) Is Nothing Then
						GoTo NextLoop
					End If
					If TerrainMoveCost(j, k) > 100 Then
						GoTo NextLoop
					End If
					Select Case TerrainClass(j, k)
						Case "遨ｺ"
							If Not IsTransAvailable("遨ｺ") Then
								GoTo NextLoop
							End If
						Case "豌ｴ", "豺ｱ豌ｴ"
							'Invalid_string_refer_to_original_code_
							'And Not IsTransAvailable("遨ｺ") _
							'And Adaption(3) = 0 _
							'Then
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							GoTo NextLoop
							'End If
					End Select
					
					x = j
					y = k
					
					GoTo ExitFor
NextLoop: 
				Next 
			Next 
		Next 
ExitFor: 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountOtherForm
			With OtherForm(i)
				.x = x
				.y = y
			End With
		Next 
		For i = 1 To CountUnitOnBoard
			With UnitOnBoard(i)
				.x = x
				.y = y
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		Select Case TerrainClass(x, y)
			Case "遨ｺ"
				Area = "遨ｺ荳ｭ"
			Case "髯ｸ", "Invalid_string_refer_to_original_code"
				Select Case Area
					Case "豌ｴ荳ｭ", "Invalid_string_refer_to_original_code"
						Area = "Invalid_string_refer_to_original_code"
					Case "Invalid_string_refer_to_original_code"
						If IsTransAvailable("遨ｺ") And Adaption(1) >= Adaption(2) Then
							Area = "遨ｺ荳ｭ"
						ElseIf IsTransAvailable("髯ｸ") Then 
							Area = "Invalid_string_refer_to_original_code"
						Else
							Area = "遨ｺ荳ｭ"
						End If
				End Select
			Case "譛磯擇"
				Select Case Area
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
					Case Else
						'Invalid_string_refer_to_original_code_
						'And Adaption(4) >= Adaption(2) _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						Area = "Invalid_string_refer_to_original_code"
						IsTransAvailable("髯ｸ")
						Area = "Invalid_string_refer_to_original_code"
						Area = "Invalid_string_refer_to_original_code"
						'End If
				End Select
			Case "豌ｴ", "豺ｱ豌ｴ"
				Select Case Area
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						Area = "Invalid_string_refer_to_original_code"
						Area = "豌ｴ荳ｭ"
						'End If
					Case "Invalid_string_refer_to_original_code"
						Area = "豌ｴ荳ｭ"
				End Select
			Case "Invalid_string_refer_to_original_code"
				Area = "Invalid_string_refer_to_original_code"
		End Select
		
		'繝槭ャ繝励↓繝ｦ繝九ャ繝医ｒ逋ｻ骭ｲ
		MapDataForUnit(x, y) = Me
		
		'Invalid_string_refer_to_original_code
		Update()
		PList.UpdateSupportMod(Me)
		
		'繝ｦ繝九ャ繝域緒逕ｻ
		If do_refresh Then
			PaintUnitBitmap(Me)
		End If
	End Sub
	
	'繝槭ャ繝嶺ｸ翫°繧芽┳蜃ｺ
	Public Sub Escape(Optional ByVal smode As String = "")
		Dim u As Unit
		Dim i, j As Short
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		For	Each u In UList
			With u
				For i = 1 To .CountUnitOnBoard
					If ID = .UnitOnBoard(i).ID Then
						.UnloadUnit(ID)
						GoTo EndLoop
					End If
				Next 
			End With
		Next u
EndLoop: 
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If MapDataForUnit(x, y) Is Me Then
			'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			MapDataForUnit(x, y) = Nothing
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			EraseUnitBitmap(x, y, False)
		Else
			EraseUnitBitmap(x, y, True)
		End If
		PList.UpdateSupportMod(Me)
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Status_Renamed = "Invalid_string_refer_to_original_code"
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("遐ｴ螢翫く繝｣繝ｳ繧ｻ繝ｫ") Then
			DeleteCondition("遐ｴ螢翫く繝｣繝ｳ繧ｻ繝ｫ")
		End If
		
		'Invalid_string_refer_to_original_code
		For	Each u In colUnitOnBoard
			With u
				.Status_Renamed = "Invalid_string_refer_to_original_code"
				colUnitOnBoard.Remove(.ID)
			End With
		Next u
		
		'蜿ｬ蝟壹＠縺溘Θ繝九ャ繝医ｒ隗｣謾ｾ
		DismissServant()
		
		'Invalid_string_refer_to_original_code
		DismissSlave()
		
		'Invalid_string_refer_to_original_code
		If Me Is DisplayedUnit Then
			ClearUnitStatus()
		End If
	End Sub
	
	'豈崎襖 u 縺ｫ逹濶ｦ
	Public Sub Land(ByRef u As Unit, Optional ByVal by_cancel As Boolean = False, Optional ByVal is_event As Boolean = False)
		Dim tclass As String
		Dim i As Short
		
		'Invalid_string_refer_to_original_code
		If is_event Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Escape()
		End If
		Select Case tclass
			Case "遨ｺ"
				Area = "遨ｺ荳ｭ"
			Case "髯ｸ", "Invalid_string_refer_to_original_code"
				If IsTransAvailable("遨ｺ") And Mid(strAdaption, 1, 1) = "A" Then
					Area = "遨ｺ荳ｭ"
				ElseIf IsTransAvailable("髯ｸ") Then 
					Area = "Invalid_string_refer_to_original_code"
				Else
					Area = "遨ｺ荳ｭ"
				End If
			Case "譛磯擇"
				'Invalid_string_refer_to_original_code_
				'And Mid$(strAdaption, 4, 1) = "A" _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Area = "Invalid_string_refer_to_original_code"
				IsTransAvailable("髯ｸ")
				Area = "Invalid_string_refer_to_original_code"
				Area = "Invalid_string_refer_to_original_code"
				'End If
			Case "豌ｴ", "豺ｱ豌ｴ"
				If IsTransAvailable("遨ｺ") Then
					Area = "遨ｺ荳ｭ"
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Area = "Invalid_string_refer_to_original_code"
				Else
					Area = "豌ｴ荳ｭ"
				End If
			Case "Invalid_string_refer_to_original_code"
				Area = "Invalid_string_refer_to_original_code"
		End Select
		
		'陦悟虚蝗樊焚遲峨ｒ蝗槫ｾｩ
		UsedAction = 0
		UsedSupportAttack = 0
		UsedSupportGuard = 0
		UsedSyncAttack = 0
		UsedCounterAttack = 0
		
		If BitmapID = 0 Then
			With UList.Item(Name)
				If .Party0 = Party0 And .BitmapID <> 0 And .Bitmap = Bitmap Then
					BitmapID = .BitmapID
				Else
					BitmapID = MakeUnitBitmap(Me)
				End If
			End With
		End If
		
		If IsFeatureAvailable("蛻ｶ蠕｡荳榊庄") Then
			AddCondition("證ｴ襍ｰ", -1)
		End If
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		u.LoadUnit(Me)
		
		'蠎ｧ讓吶ｒ豈崎襖縺ｫ蜷医ｏ縺帙ｋ
		x = u.x
		y = u.y
		
		Status_Renamed = "Invalid_string_refer_to_original_code"
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Area = "Invalid_string_refer_to_original_code"
		'End If
		
		'Invalid_string_refer_to_original_code
		If Not by_cancel Then
			With MainPilot
				If .Personality <> "讖滓｢ｰ" Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					.Morale = MinLng(.Morale, MaxLng(.Morale - 5, 100))
				Else
					.Morale = .Morale - 5
				End If
			End With
		End If
		'End With
		For i = 1 To CountPilot
			With Pilot(i)
				If MainPilot.ID <> .ID And .Personality <> "讖滓｢ｰ" Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					.Morale = MinLng(.Morale, MaxLng(.Morale - 5, 100))
				Else
					.Morale = .Morale - 5
				End If
				'End If
			End With
		Next 
		For i = 1 To CountSupport
			With Support(i)
				If .Personality <> "讖滓｢ｰ" Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					.Morale = MinLng(.Morale, MaxLng(.Morale - 5, 100))
				Else
					.Morale = .Morale - 5
				End If
				'End If
			End With
		Next 
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		With AdditionalSupport
			If .Personality <> "讖滓｢ｰ" Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.Morale = MinLng(.Morale, MaxLng(.Morale - 5, 100))
			Else
				.Morale = .Morale - 5
			End If
			'End If
		End With
		'End If
		'End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub Transform(ByRef new_form As String)
		Dim list As String
		Dim i, idx, idx2, j As Short
		Dim u As Unit
		Dim wname() As String
		Dim wbullet() As Short
		Dim wmaxbullet() As Short
		Dim aname() As String
		Dim astock() As Short
		Dim amaxstock() As Short
		Dim hp_ratio, en_ratio As Double
		Dim prev_x, prev_y As Short
		Dim buf As String
		
		hp_ratio = 100 * HP / MaxHP
		en_ratio = 100 * EN / MaxEN
		
		u = OtherForm(new_form)
		u.Status_Renamed = Status_Renamed
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Status_Renamed = "Invalid_string_refer_to_original_code"
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("蛻ｶ蠕｡荳榊庄") Then
			If IsConditionSatisfied("證ｴ襍ｰ") Then
				DeleteCondition("證ｴ襍ｰ")
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
			'Invalid_string_refer_to_original_code
			If MapFileName <> "" Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'UPGRADE_WARNING: Transform に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case "Invalid_string_refer_to_original_code"
					'AddCondition("Invalid_string_refer_to_original_code")
					''UPGRADE_WARNING: Transform に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case "Invalid_string_refer_to_original_code"
						'IncreaseMorale(-10)
						'End Select
						'Next
			End If
			
			DeleteCondition("Invalid_string_refer_to_original_code")
			
			If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
				DeleteCondition("Invalid_string_refer_to_original_code")
				DeleteCondition("Invalid_string_refer_to_original_code")
				DeleteCondition("Invalid_string_refer_to_original_code")
			End If
		Else
			'Invalid_string_refer_to_original_code
			If MapFileName <> "" Then
				AddCondition("Invalid_string_refer_to_original_code")
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'UPGRADE_WARNING: Transform に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case "Invalid_string_refer_to_original_code"
					'DeleteCondition("Invalid_string_refer_to_original_code")
					''UPGRADE_WARNING: Transform に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case "Invalid_string_refer_to_original_code"
						'IncreaseMorale(-10)
						'End Select
						'Next
			End If
		End If
		
		If IsConditionSatisfied("谿九ｊ譎る俣") Then
			DeleteCondition("谿九ｊ譎る俣")
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		DeleteCondition("Invalid_string_refer_to_original_code")
		BitmapID = MakeUnitBitmap(Me)
		'End If
		If IsConditionSatisfied("髱櫁｡ｨ遉ｺ莉伜刈") Then
			DeleteCondition("髱櫁｡ｨ遉ｺ莉伜刈")
			BitmapID = MakeUnitBitmap(Me)
		End If
		
		Dim eu As Unit
		Dim counter As Short
		With u
			'繝代Λ繝｡繝ｼ繧ｿ蜿励¢邯吶℃
			.BossRank = BossRank
			.Rank = Rank
			.Mode = Mode
			.Area = Area
			.UsedSupportAttack = UsedSupportAttack
			.UsedSupportGuard = UsedSupportGuard
			.UsedSyncAttack = UsedSyncAttack
			.UsedCounterAttack = UsedCounterAttack
			
			.Master = Master
			'UPGRADE_NOTE: オブジェクト Master をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			Master = Nothing
			.Summoner = Summoner
			'UPGRADE_NOTE: オブジェクト Summoner をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			Summoner = Nothing
			
			'Invalid_string_refer_to_original_code
			For i = 1 To CountItem
				.AddItem0(Item(i))
			Next 
			
			'Invalid_string_refer_to_original_code
			CopySpecialPowerInEffect(u)
			RemoveAllSpecialPowerInEffect()
			
			'Invalid_string_refer_to_original_code
			For i = 1 To .CountCondition
				.DeleteCondition0(1)
			Next 
			For i = 1 To CountCondition
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.AddCondition(Condition(i), ConditionLifetime(i), ConditionLevel(i), ConditionData(i))
				'End If
			Next 
			For i = 1 To CountCondition
				DeleteCondition0(1)
			Next 
			
			'Invalid_string_refer_to_original_code
			list = FeatureData("螟牙ｽ｢")
			If LLength(list) > 0 And Data.PilotNum = -LLength(list) And CountPilot = LLength(list) Then
				'Invalid_string_refer_to_original_code
				For idx = 2 To LLength(list)
					If .Name = LIndex(list, idx) Then
						Exit For
					End If
				Next 
				If idx <= LLength(list) Then
					list = .FeatureData("螟牙ｽ｢")
					For idx2 = 2 To LLength(list)
						buf = LIndex(list, idx2)
						If Name = buf Then
							Exit For
						End If
					Next 
					j = 2
					For i = 1 To CountPilot
						Select Case i
							Case 1
								.AddPilot(Pilot(idx))
							Case idx2
								.AddPilot(Pilot(1))
							Case Else
								If idx = j Then
									j = j + 1
								End If
								.AddPilot(Pilot(j))
								j = j + 1
						End Select
					Next 
				Else
					For i = 1 To CountPilot
						.AddPilot(Pilot(i))
					Next 
				End If
			Else
				For i = 1 To CountPilot
					.AddPilot(Pilot(i))
				Next 
			End If
			For i = 1 To CountSupport
				.AddSupport(Support(i))
			Next 
			For i = 1 To CountUnitOnBoard
				.LoadUnit(UnitOnBoard(i))
			Next 
			For i = 1 To CountServant
				.AddServant(Servant(i))
			Next 
			For i = 1 To CountSlave
				.AddSlave(Slave(i))
			Next 
			
			For i = 1 To CountPilot
				DeletePilot(1)
			Next 
			For i = 1 To CountSupport
				DeleteSupport(1)
			Next 
			For i = 1 To CountUnitOnBoard
				UnloadUnit(1)
			Next 
			For i = 1 To CountServant
				DeleteServant(1)
			Next 
			For i = 1 To CountSlave
				DeleteSlave(1)
			Next 
			
			For i = 1 To .CountPilot
				.Pilot(i).Unit_Renamed = u
			Next 
			For i = 1 To .CountSupport
				.Support(i).Unit_Renamed = u
				If .Support(i).SupportIndex > 0 Then
					If IsFeatureAvailable("Invalid_string_refer_to_original_code") And .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						For j = 2 To LLength(.FeatureData("Invalid_string_refer_to_original_code"))
							If LIndex(FeatureData("Invalid_string_refer_to_original_code"), .Support(i).SupportIndex + 1) = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), j) Then
								.Support(i).SupportIndex = j - 1
								Exit For
							End If
						Next 
					End If
				End If
			Next 
			
			.Update()
			
			'Invalid_string_refer_to_original_code
			ReDim wname(CountWeapon)
			ReDim wbullet(CountWeapon)
			ReDim wmaxbullet(CountWeapon)
			For i = 1 To CountWeapon
				wname(i) = Weapon(i).Name
				wbullet(i) = Bullet(i)
				wmaxbullet(i) = MaxBullet(i)
			Next 
			
			ReDim aname(CountAbility)
			ReDim astock(CountAbility)
			ReDim amaxstock(CountAbility)
			For i = 1 To CountAbility
				aname(i) = Ability(i).Name
				astock(i) = Stock(i)
				amaxstock(i) = MaxStock(i)
			Next 
			
			'蠑ｾ謨ｰ縺ｮ蜿励¢邯吶℃
			idx = 1
			For i = 1 To .CountWeapon
				counter = idx
				For j = counter To UBound(wname)
					If .Weapon(i).Name = wname(j) And .MaxBullet(i) > 0 And wmaxbullet(j) > 0 Then
						.SetBullet(i, wbullet(j) * .MaxBullet(i) \ wmaxbullet(j))
						idx = j + 1
						Exit For
					End If
				Next 
			Next 
			
			idx = 1
			For i = 1 To .CountAbility
				counter = idx
				For j = counter To UBound(aname)
					If .Ability(i).Name = aname(j) And .MaxStock(i) > 0 And amaxstock(j) > 0 Then
						.SetStock(i, astock(j) * .MaxStock(i) \ amaxstock(j))
						idx = j + 1
						Exit For
					End If
				Next 
			Next 
			
			'Invalid_string_refer_to_original_code
			.SyncBullet()
			
			'Invalid_string_refer_to_original_code
			For i = 1 To CountItem
				DeleteItem(1)
			Next 
			
			.Update()
			
			'Invalid_string_refer_to_original_code
			If new_form = LIndex(FeatureData("Invalid_string_refer_to_original_code"), 2) Then
				.HP = .MaxHP
			Else
				.HP = .MaxHP * hp_ratio / 100
			End If
			.EN = .MaxEN * en_ratio / 100
			
			'Invalid_string_refer_to_original_code
			If Not .IsConditionSatisfied("谿九ｊ譎る俣") Then
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If .IsConditionSatisfied("谿九ｊ譎る俣") Then
					.DeleteCondition("谿九ｊ譎る俣")
				End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'End If
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			.DeleteCondition("谿九ｊ譎る俣")
			'End If
			
			Select Case .Status_Renamed
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
					MapDataForUnit(x, y) = Nothing
					prev_x = x
					prev_y = y
					.UsedAction = UsedAction
					.StandBy(x, y)
					If .x <> prev_x Or .y <> prev_y Then
						EraseUnitBitmap(prev_x, prev_y, False)
					End If
				Case "Invalid_string_refer_to_original_code"
					'Invalid_string_refer_to_original_code
					For	Each eu In UList
						With eu
							For j = 1 To .CountUnitOnBoard
								If ID = .UnitOnBoard(j).ID Then
									.UnloadUnit(ID)
									.LoadUnit(u)
									GoTo EndLoop
								End If
							Next 
						End With
					Next eu
EndLoop: 
			End Select
		End With
		
		If MapFileName = "" Then
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If LIndex(buf, 1) = new_form Then
			For i = 2 To LLength(buf)
				Select Case LIndex(buf, i)
					Case "Invalid_string_refer_to_original_code"
						AddCondition("Invalid_string_refer_to_original_code", -1)
				End Select
			Next 
		End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub Combine(Optional ByRef uname As String = "", Optional ByVal is_event As Boolean = False)
		Dim k, i, j, l As Short
		Dim u As Unit
		Dim rarray() As Unit
		Dim prev_status As String
		Dim hp_ratio, en_ratio As Double
		Dim fdata As String
		
		prev_status = Status_Renamed
		
		If uname = "" Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			u = Nothing
			For i = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				fdata = FeatureData(i)
				If LLength(fdata) = 3 And MapDataForUnit(x, y).Name = LIndex(fdata, 3) And UList.IsDefined(LIndex(fdata, 2)) Then
					u = UList.Item(LIndex(FeatureData(i), 2)).CurrentForm
					Exit For
				End If
			Next 
		End If
		'Next
		If u Is Nothing Then
			For i = 1 To CountFeature
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				fdata = FeatureData(i)
				If LLength(fdata) = 3 And MapDataForUnit(x, y).IsEqual(LIndex(fdata, 3)) And UList.IsDefined(LIndex(fdata, 2)) Then
					u = UList.Item(LIndex(fdata, 2)).CurrentForm
					Exit For
				End If
			Next 
		End If
		'Next
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To u.CountFeature
			If u.Feature(i) = "Invalid_string_refer_to_original_code" And LLength(u.FeatureData(i)) = 3 And ((IsEqual(LIndex(u.FeatureData(i), 2)) And MapDataForUnit(x, y).IsEqual(LIndex(u.FeatureData(i), 3))) Or (IsEqual(LIndex(u.FeatureData(i), 3)) And MapDataForUnit(x, y).IsEqual(LIndex(u.FeatureData(i), 2)))) Then
				Exit For
			End If
		Next 
		Dim BGM As String
		Dim eu As Unit
		'Invalid_string_refer_to_original_code
		If Not UList.IsDefined(uname) Then
			ErrorMessage(uname & "Invalid_string_refer_to_original_code")
			ExitGame()
		End If
		
		u = UList.Item(uname).CurrentForm
		
		'Invalid_string_refer_to_original_code
		For i = 1 To u.CountFeature
			If u.Feature(i) = "Invalid_string_refer_to_original_code" And LLength(u.FeatureData(i)) > 2 Then
				Exit For
			End If
		Next 
		'End If
		
		'Invalid_string_refer_to_original_code
		If i > u.CountFeature Then
			ErrorMessage(u.Name & "Invalid_string_refer_to_original_code" & Name & "Invalid_string_refer_to_original_code")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Sub
		End If
		ReDim rarray(LLength(u.FeatureData(i)) - 1)
		For j = 1 To UBound(rarray)
			If Not UList.IsDefined(LIndex(u.FeatureData(i), j + 1)) Then
				ErrorMessage(LIndex(u.FeatureData(i), j + 1) & "Invalid_string_refer_to_original_code")
				Exit Sub
			End If
			rarray(j) = UList.Item(LIndex(u.FeatureData(i), j + 1))
		Next 
		
		If Not is_event Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			If u.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				If Not PList.IsDefined(u.FeatureData("Invalid_string_refer_to_original_code")) Then
					If Not PDList.IsDefined(u.FeatureData("Invalid_string_refer_to_original_code")) Then
						ErrorMessage(u.Name & "Invalid_string_refer_to_original_code")
						u.FeatureData(("Invalid_string_refer_to_original_code") & "Invalid_string_refer_to_original_code")
						TerminateSRC()
					End If
					PList.Add(u.FeatureData("Invalid_string_refer_to_original_code"), MainPilot.Level, Party0)
				End If
			End If
			
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				For i = 1 To CountFeature
					If Feature(i) = "Invalid_string_refer_to_original_code" And LIndex(FeatureData(i), 1) = u.Name Then
						BGM = SearchMidiFile(Mid(FeatureData(i), InStr(FeatureData(i), " ") + 1))
						If Len(BGM) > 0 Then
							ChangeBGM(BGM)
							Sleep(500)
						End If
						Exit For
					End If
				Next 
			End If
			
			OpenMessageForm()
			If IsMessageDefined("Invalid_string_refer_to_original_code" & u.Name & ")") Then
				PilotMessage("Invalid_string_refer_to_original_code" & u.Name & ")")
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				PilotMessage("Invalid_string_refer_to_original_code" & FeatureName("Invalid_string_refer_to_original_code"))
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Else
				PilotMessage("Invalid_string_refer_to_original_code")
			End If
			CloseMessageForm()
		End If
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		For i = 1 To u.CountWeapon
			For j = 1 To UBound(rarray)
				With rarray(j).CurrentForm
					For k = 1 To .CountWeapon
						If u.Weapon(i).Name = .Weapon(k).Name Then
							u.SetBullet(i, 0)
							Exit For
						End If
					Next 
				End With
			Next 
		Next 
		'Invalid_string_refer_to_original_code
		For i = 1 To u.CountAbility
			For j = 1 To UBound(rarray)
				With rarray(j).CurrentForm
					For k = 1 To .CountAbility
						If u.Ability(i).Name = .Ability(k).Name Then
							u.SetStock(i, 0)
							Exit For
						End If
					Next 
				End With
			Next 
		Next 
		
		'Invalid_string_refer_to_original_code
		With rarray(1).CurrentForm
			.CopySpecialPowerInEffect(u)
			.RemoveAllSpecialPowerInEffect()
			
			For i = 1 To .CountItem
				u.AddItem(.Item(i))
			Next 
			
			u.Master = .Master
			'UPGRADE_NOTE: オブジェクト rarray().CurrentForm.Master をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			.Master = Nothing
			u.Summoner = .Summoner
			'UPGRADE_NOTE: オブジェクト rarray().CurrentForm.Summoner をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			.Summoner = Nothing
			
			u.UsedSupportAttack = .UsedSupportAttack
			u.UsedSupportGuard = .UsedSupportGuard
			u.UsedSyncAttack = .UsedSyncAttack
			u.UsedCounterAttack = .UsedCounterAttack
			
			For i = 1 To .CountServant
				u.AddServant(.Servant(i))
			Next 
			For i = 1 To .CountServant
				.DeleteServant(1)
			Next 
			For i = 1 To .CountSlave
				u.AddSlave(.Slave(i))
			Next 
			For i = 1 To .CountSlave
				.DeleteSlave(1)
			Next 
		End With
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(rarray)
			'Invalid_string_refer_to_original_code
			With rarray(i).CurrentForm
				Select Case .Status_Renamed
					Case "Invalid_string_refer_to_original_code"
						.Status_Renamed = "Invalid_string_refer_to_original_code"
						'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
						MapDataForUnit(.x, .y) = Nothing
						EraseUnitBitmap(.x, .y)
					Case "Invalid_string_refer_to_original_code"
						.Status_Renamed = "Invalid_string_refer_to_original_code"
						For	Each eu In UList
							For j = 1 To eu.CountUnitOnBoard
								If .ID = eu.UnitOnBoard(j).ID Then
									eu.UnloadUnit(.ID)
									GoTo EndLoop
								End If
							Next 
						Next eu
EndLoop: 
				End Select
			End With
			
			'Invalid_string_refer_to_original_code
			If Not rarray(i).CurrentForm Is rarray(i) Then
				rarray(i).CurrentForm.Transform((rarray(i).Name))
			End If
			
			With rarray(i)
				If i = 1 Then
					.Status_Renamed = "Invalid_string_refer_to_original_code"
				Else
					.Status_Renamed = "Invalid_string_refer_to_original_code"
				End If
				
				hp_ratio = hp_ratio + 100 * .HP / .MaxHP
				en_ratio = en_ratio + 100 * .EN / .MaxEN
				
				If .Rank > u.Rank Then
					u.Rank = .Rank
				End If
				If .BossRank > u.BossRank Then
					u.BossRank = .BossRank
					u.FullRecover()
				End If
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				If InStr(.MainPilot.Name, "(繧ｶ繧ｳ)") > 0 Or InStr(.MainPilot.Name, "(豎守畑)") > 0 Then
					'Invalid_string_refer_to_original_code
					.MainPilot.Alive = False
				End If
				'Invalid_string_refer_to_original_code
				For j = 1 To .CountPilot
					.Pilot(j).Ride(u)
				Next 
				For j = 1 To .CountPilot
					.DeletePilot(1)
				Next 
				
				'Invalid_string_refer_to_original_code
				For j = 1 To .CountSupport
					.Support(j).Ride(u, True)
					.Support(j).SupportIndex = i
				Next 
				For j = 1 To .CountSupport
					.DeleteSupport(1)
				Next 
				'End If
				
				'Invalid_string_refer_to_original_code
				For j = 1 To .CountUnitOnBoard
					u.LoadUnit(.UnitOnBoard(j))
				Next 
				For j = 1 To u.CountUnitOnBoard
					.UnloadUnit(1)
				Next 
				
				'Invalid_string_refer_to_original_code
				For j = 1 To u.CountWeapon
					For k = 1 To .CountWeapon
						If u.Weapon(j).Name = .Weapon(k).Name Then
							u.SetBullet(j, 0)
							Exit For
						End If
					Next 
					For k = 1 To .CountOtherForm
						With .OtherForm(k)
							For l = 1 To .CountWeapon
								If u.Weapon(j).Name = .Weapon(l).Name Then
									u.SetBullet(j, 0)
									Exit For
								End If
							Next 
						End With
					Next 
				Next 
				
				'Invalid_string_refer_to_original_code
				For j = 1 To u.CountAbility
					For k = 1 To .CountAbility
						If u.Ability(j).Name = .Ability(k).Name Then
							u.SetStock(j, 0)
							Exit For
						End If
					Next 
					For k = 1 To .CountOtherForm
						With .OtherForm(k)
							For l = 1 To .CountAbility
								If u.Ability(j).Name = .Ability(l).Name Then
									u.SetStock(j, 0)
									Exit For
								End If
							Next 
						End With
					Next 
				Next 
				
				'繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ縺ｮ蜉ｹ譫懊ｒ豸亥悉
				.RemoveAllSpecialPowerInEffect()
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(rarray)
			With rarray(i)
				'Invalid_string_refer_to_original_code
				For j = 1 To u.CountWeapon
					For k = 1 To .CountWeapon
						If u.Weapon(j).Name = .Weapon(k).Name Then
							u.SetBullet(j, u.Bullet(j) + .Bullet(k))
							GoTo NextWeapon
						End If
					Next 
					For k = 1 To .CountOtherForm
						With .OtherForm(k)
							For l = 1 To .CountWeapon
								If u.Weapon(j).Name = .Weapon(l).Name Then
									u.SetBullet(j, u.Bullet(j) + .Bullet(l))
									GoTo NextWeapon
								End If
							Next 
						End With
					Next 
NextWeapon: 
				Next 
				
				'Invalid_string_refer_to_original_code
				For j = 1 To u.CountAbility
					For k = 1 To .CountAbility
						If u.Ability(j).Name = .Ability(k).Name Then
							u.SetStock(j, u.Stock(j) + .Stock(k))
							GoTo NextAbility
						End If
					Next 
					For k = 1 To .CountOtherForm
						With .OtherForm(k)
							For l = 1 To .CountAbility
								If u.Ability(j).Name = .Ability(l).Name Then
									u.SetStock(j, u.Stock(j) + .Stock(l))
									GoTo NextAbility
								End If
							Next 
						End With
					Next 
NextAbility: 
				Next 
			End With
		Next 
		
		'Invalid_string_refer_to_original_code
		With rarray(1)
			For i = 1 To .CountItem
				.DeleteItem(1)
			Next 
		End With
		
		'Invalid_string_refer_to_original_code
		With u
			.Update()
			
			.Party = Party0
			For i = 1 To .CountOtherForm
				.OtherForm(i).Party = Party0
			Next 
			For i = 1 To .CountPilot
				.Pilot(i).Party = Party0
			Next 
			For i = 1 To .CountSupport
				.Support(i).Party = Party0
			Next 
			
			.HP = .MaxHP * hp_ratio / 100 / UBound(rarray)
			.EN = 1 * .MaxEN * en_ratio / 100 / UBound(rarray)
			
			'Invalid_string_refer_to_original_code
			.SyncBullet()
			
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			.StandBy(x, y)
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If .IsConditionSatisfied("谿九ｊ譎る俣") Then
				.DeleteCondition("谿九ｊ譎る俣")
			End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'End If
			.Status_Renamed = prev_status
			'End If
		End With
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(rarray)
			With rarray(i).CurrentForm
				.x = u.x
				.y = u.y
			End With
		Next 
	End Sub
	
	'Invalid_string_refer_to_original_code
	'UPGRADE_NOTE: Split は Split_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
	Public Sub Split_Renamed()
		Dim k, i, j, l As Short
		Dim idx, n As Short
		Dim buf As String
		Dim u As Unit
		Dim uarray() As Unit
		Dim hp_ratio, en_ratio As Double
		Dim pname As String
		Dim p As Pilot
		
		hp_ratio = 100 * HP / MaxHP
		en_ratio = 100 * EN / MaxEN
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		MapDataForUnit(x, y) = Nothing
		EraseUnitBitmap(x, y)
		'End If
		
		'Invalid_string_refer_to_original_code
		buf = FeatureData("Invalid_string_refer_to_original_code")
		ReDim uarray(LLength(buf) - 1)
		For i = 2 To LLength(buf)
			uarray(i - 1) = UList.Item(LIndex(buf, i))
			If uarray(i - 1) Is Nothing Then
				ErrorMessage(LIndex(buf, i - 1) & "縺悟ｭ伜惠縺励∪縺帙ｓ")
				Exit Sub
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To UBound(uarray)
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit For
			'End If
		Next 
		If i > UBound(uarray) Then
			i = 1
		End If
		
		'Invalid_string_refer_to_original_code
		CopySpecialPowerInEffect(uarray(i))
		RemoveAllSpecialPowerInEffect()
		With uarray(i)
			For j = 1 To CountItem
				.AddItem(Item(j))
			Next 
			For j = 1 To CountItem
				DeleteItem(1)
			Next 
			
			.Master = Master
			'UPGRADE_NOTE: オブジェクト Master をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			Master = Nothing
			.Summoner = Summoner
			'UPGRADE_NOTE: オブジェクト Summoner をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			Summoner = Nothing
			
			.UsedSupportAttack = UsedSupportAttack
			.UsedSupportGuard = UsedSupportGuard
			.UsedSyncAttack = UsedSyncAttack
			.UsedCounterAttack = UsedCounterAttack
			
			For j = 1 To CountServant
				.AddServant(Servant(j))
			Next 
			For j = 1 To CountServant
				DeleteServant(1)
			Next 
			For j = 1 To CountSlave
				.AddSlave(Slave(j))
			Next 
			For j = 1 To CountSlave
				DeleteSlave(1)
			Next 
		End With
		
		'Invalid_string_refer_to_original_code
		n = 1
		For i = 1 To UBound(uarray)
			With uarray(i)
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				.Party = Party0
				'End If
				
				'Invalid_string_refer_to_original_code
				If CountPilot > 0 Then
					For j = 1 To System.Math.Abs(.Data.PilotNum)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						pname = .FeatureData("Invalid_string_refer_to_original_code")
						If InStr(PDList.Item(pname).Name, "(繧ｶ繧ｳ)") > 0 Or InStr(PDList.Item(pname).Name, "(豎守畑)") > 0 Then
							p = PList.Add(pname, MainPilot.Level, Party)
							p.FullRecover()
						Else
							If Not PList.IsDefined(pname) Then
								p = PList.Add(pname, MainPilot.Level, Party)
								p.FullRecover()
							Else
								p = PList.Item(pname)
							End If
						End If
						p.Ride(uarray(i))
					Next 
				End If
				If n <= CountPilot Then
					Pilot(n).Ride(uarray(i))
					n = n + 1
				ElseIf Not .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then 
					If CountSupport > 0 Then
						Support(1).Ride(uarray(i))
						DeleteSupport(1)
					Else
						ErrorMessage(Name & "Invalid_string_refer_to_original_code")
						'Invalid_string_refer_to_original_code_
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						TerminateSRC()
					End If
				End If
				'End If
			End With
		Next 
		'End If
		
		'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		
		'Invalid_string_refer_to_original_code
		idx = 1
		Dim counter As Short
		For j = 1 To CountWeapon
			counter = idx
			'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		Next 
		'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		
		'Invalid_string_refer_to_original_code
		idx = 1
		Dim counter As Short
		For j = 1 To CountAbility
			counter = idx
			'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		Next 
		'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		Dim eu As Unit
		Select Case Status_Renamed
			Case "Invalid_string_refer_to_original_code"
				If i = 1 Then
					'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
				Else
					'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
					'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
					'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
					'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
					'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
				End If
				'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
			Case "Invalid_string_refer_to_original_code"
				For	Each eu In UList
					With eu
						For j = 1 To .CountOtherForm
							If ID = .UnitOnBoard(j).ID Then
								.LoadUnit(uarray(i))
								GoTo EndLoop
							End If
						Next 
					End With
				Next eu
EndLoop: 
		End Select
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'UPGRADE_WARNING: Split に変換されていないステートメントがあります。ソース コードを確認してください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		'End With
		'Next
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountPilot
			DeletePilot(1)
		Next 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountSupport
			With Support(i)
				If .SupportIndex = 0 Then
					.Ride(UList.Item(LIndex(buf, 2)))
				Else
					.Ride(uarray(.SupportIndex))
				End If
			End With
		Next 
		For i = 1 To CountSupport
			DeleteSupport(1)
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		For	Each u In UList
			With u
				For j = 1 To .CountUnitOnBoard
					If ID = .UnitOnBoard(j).ID Then
						.UnloadUnit(ID)
						GoTo EndLoop2
					End If
				Next 
			End With
		Next u
EndLoop2: 
		'End If
		
		Status_Renamed = "Invalid_string_refer_to_original_code"
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		If MapFileName = "" Then
			Exit Sub
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		AddCondition("Invalid_string_refer_to_original_code", -1)
		'End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Function GetExp(ByRef t As Unit, ByRef exp_situation As String, Optional ByRef exp_mode As String = "") As Integer
		Dim xp As Integer
		Dim j, i, n As Short
		Dim prev_level As Short
		Dim prev_stype() As String
		Dim prev_sname() As String
		Dim prev_slevel() As Double
		Dim prev_special_power() As String
		Dim stype, sname As String
		Dim p As Pilot
		Dim msg As String
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		With MainPilot
			prev_level = .Level
			ReDim prev_special_power(.CountSpecialPower)
			For i = 1 To .CountSpecialPower
				prev_special_power(i) = .SpecialPower(i)
			Next 
			ReDim prev_stype(.CountSkill)
			ReDim prev_sname(.CountSkill)
			ReDim prev_slevel(.CountSkill)
			For i = 1 To .CountSkill
				prev_stype(i) = .Skill(i)
				prev_sname(i) = .SkillName(i)
				prev_slevel(i) = .SkillLevel(i, "蝓ｺ譛ｬ蛟､")
			Next 
		End With
		
		'Invalid_string_refer_to_original_code
		If t Is Nothing Then
			t = Me
		End If
		
		'Invalid_string_refer_to_original_code
		If t.CountPilot = 0 Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		n = CountPilot + CountSupport
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		n = n + 1
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To n
			If i <= CountPilot Then
				p = Pilot(i)
			ElseIf i <= CountPilot + CountSupport Then 
				p = Support(i - CountPilot)
			Else
				p = AdditionalSupport
			End If
			
			Select Case exp_situation
				Case "Invalid_string_refer_to_original_code"
					xp = t.ExpValue + t.MainPilot.ExpValue
					If IsUnderSpecialPowerEffect("迯ｲ蠕礼ｵ碁ｨ灘､蠅怜刈") And exp_mode <> "Invalid_string_refer_to_original_code" Then
						xp = xp * (1 + 0.1 * SpecialPowerEffectLevel("迯ｲ蠕礼ｵ碁ｨ灘､蠅怜刈"))
					End If
				Case "Invalid_string_refer_to_original_code"
					xp = (t.ExpValue + t.MainPilot.ExpValue) \ 10
					If IsUnderSpecialPowerEffect("迯ｲ蠕礼ｵ碁ｨ灘､蠅怜刈") And exp_mode <> "Invalid_string_refer_to_original_code" Then
						xp = xp * (1 + 0.1 * SpecialPowerEffectLevel("迯ｲ蠕礼ｵ碁ｨ灘､蠅怜刈"))
					End If
				Case "Invalid_string_refer_to_original_code"
					If t Is Me Then
						xp = 50
					Else
						xp = 100
					End If
				Case "Invalid_string_refer_to_original_code"
					xp = 100
				Case "陬懃ｵｦ"
					xp = 150
			End Select
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			If p.IsSkillAvailable("邏雉ｪ") Then
				If p.IsSkillLevelSpecified("邏雉ｪ") Then
					xp = xp * (10 + p.SkillLevel("邏雉ｪ")) \ 10
				Else
					xp = 1.5 * xp
				End If
			End If
			'End If
			If p.IsSkillAvailable("Invalid_string_refer_to_original_code") Then
				xp = xp \ 2
			End If
			
			'Invalid_string_refer_to_original_code
			Select Case t.MainPilot.Level - p.Level
				Case Is > 7
					xp = 5 * xp
				Case 7
					xp = 4.5 * xp
				Case 6
					xp = 4 * xp
				Case 5
					xp = 3.5 * xp
				Case 4
					xp = 3 * xp
				Case 3
					xp = 2.5 * xp
				Case 2
					xp = 2 * xp
				Case 1
					xp = 1.5 * xp
				Case 0
				Case -1
					xp = xp \ 2
				Case -2
					xp = xp \ 4
				Case -3
					xp = xp \ 6
				Case -4
					xp = xp \ 8
				Case -5
					xp = xp \ 10
				Case Is < -5
					xp = xp \ 12
			End Select
			p.Exp = p.Exp + xp
			
			'Invalid_string_refer_to_original_code
			If i = 1 Then
				GetExp = xp
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		If Not MainPilot Is Pilot(1) Then
			MainPilot.Level = Pilot(1).Level
			MainPilot.Exp = Pilot(1).Exp
		End If
		
		'Invalid_string_refer_to_original_code
		If Not Summoner Is Nothing Then
			Summoner.CurrentForm.GetExp(t, exp_situation, "Invalid_string_refer_to_original_code")
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		With MainPilot
			If .Level > prev_level Then
				'Invalid_string_refer_to_original_code
				
				If IsAnimationDefined("Invalid_string_refer_to_original_code") Then
					PlayAnimation("Invalid_string_refer_to_original_code")
				ElseIf IsSpecialEffectDefined("Invalid_string_refer_to_original_code") Then 
					SpecialEffect("Invalid_string_refer_to_original_code")
				End If
				If IsMessageDefined("Invalid_string_refer_to_original_code") Then
					PilotMessage("Invalid_string_refer_to_original_code")
				End If
				
				msg = .Nickname & "縺ｯ邨碁ｨ灘､[" & VB6.Format(GetExp) & "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				
				'Invalid_string_refer_to_original_code
				For i = 1 To .CountSkill
					stype = .Skill(i)
					sname = .SkillName(i)
					If InStr(sname, "髱櫁｡ｨ遉ｺ") = 0 Then
						Select Case stype
							Case "Invalid_string_refer_to_original_code"
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							Case "Invalid_string_refer_to_original_code"
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								For j = 1 To UBound(prev_stype)
									If stype = prev_stype(j) Then
										If sname = prev_sname(j) Then
											Exit For
										End If
									End If
								Next 
								If j > UBound(prev_stype) Then
									msg = msg & ";" & sname & "Invalid_string_refer_to_original_code"
								End If
							Case Else
								For j = 1 To UBound(prev_stype)
									If stype = prev_stype(j) Then
										Exit For
									End If
								Next 
								If j > UBound(prev_stype) Then
									msg = msg & ";" & sname & "Invalid_string_refer_to_original_code"
								ElseIf .SkillLevel(i, "蝓ｺ譛ｬ蛟､") > prev_slevel(j) Then 
									msg = msg & ";" & prev_sname(j) & " => " & sname & "Invalid_string_refer_to_original_code"
								End If
						End Select
					End If
				Next 
				
				'Invalid_string_refer_to_original_code
				If .CountSpecialPower > UBound(prev_special_power) Then
					msg = msg & ";" & Term("繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ", Me)
					For i = 1 To .CountSpecialPower
						sname = .SpecialPower(i)
						For j = 1 To UBound(prev_special_power)
							If sname = prev_special_power(j) Then
								Exit For
							End If
						Next 
						If j > UBound(prev_special_power) Then
							msg = msg & "Invalid_string_refer_to_original_code"
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						End If
					Next 
					msg = msg & "Invalid_string_refer_to_original_code"
				End If
				
				DisplaySysMessage(msg)
				If MessageWait < 10000 Then
					Sleep(MessageWait)
				End If
				
				HandleEvent("Invalid_string_refer_to_original_code", .ID)
				
				PList.UpdateSupportMod(Me)
			ElseIf GetExp > 0 Then 
				DisplaySysMessage(.Nickname & "縺ｯ" & VB6.Format(GetExp) & "Invalid_string_refer_to_original_code")
			End If
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Sub ChangeParty(ByRef new_party As String)
		Dim i As Short
		
		'髯｣蝟ｶ繧貞､画峩
		Party = new_party
		
		'Invalid_string_refer_to_original_code
		BitmapID = MakeUnitBitmap(Me)
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountPilot
			Pilot(i).Party = new_party
		Next 
		For i = 1 To CountSupport
			Support(i).Party = new_party
		Next 
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		AdditionalSupport.Party = new_party
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountOtherForm
			OtherForm(i).Party = new_party
			OtherForm(i).BitmapID = 0
		Next 
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		If Party = Stage Then
			Rest()
		End If
		'Invalid_string_refer_to_original_code
		PaintUnitBitmap(Me)
		'End If
		
		PList.UpdateSupportMod(Me)
		
		'Invalid_string_refer_to_original_code
		Mode = "騾壼ｸｸ"
	End Sub
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Sub IncreaseMorale(ByVal num As Short, Optional ByVal is_event As Boolean = False)
		Dim p As Pilot
		
		If CountPilot = 0 Then
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		With MainPilot
			If .Personality <> "讖滓｢ｰ" Or is_event Then
				.Morale = .Morale + num
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		For	Each p In colPilot
			With p
				If MainPilot.ID <> .ID And (.Personality <> "讖滓｢ｰ" Or is_event) Then
					.Morale = .Morale + num
				End If
			End With
		Next p
		
		'Invalid_string_refer_to_original_code
		For	Each p In colSupport
			With p
				If .Personality <> "讖滓｢ｰ" Or is_event Then
					.Morale = .Morale + num
				End If
			End With
		Next p
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		With AdditionalSupport
			If .Personality <> "讖滓｢ｰ" Or is_event Then
				.Morale = .Morale + num
			End If
		End With
		'End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub Die(Optional ByVal without_update As Boolean = False)
		Dim i, j As Short
		Dim pname As String
		Dim p As Pilot
		
		HP = 0
		Status_Renamed = "Invalid_string_refer_to_original_code"
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("遐ｴ螢翫く繝｣繝ｳ繧ｻ繝ｫ") Then
			DeleteCondition("遐ｴ螢翫く繝｣繝ｳ繧ｻ繝ｫ")
			GoTo SkipExplode
		End If
		
		'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		MapDataForUnit(x, y) = Nothing
		
		'Invalid_string_refer_to_original_code
		ClearPicture()
		If IsAnimationDefined("閼ｱ蜃ｺ") Then
			EraseUnitBitmap(x, y, False)
			PlayAnimation("閼ｱ蜃ｺ")
		ElseIf IsSpecialEffectDefined("閼ｱ蜃ｺ") Then 
			EraseUnitBitmap(x, y, False)
			SpecialEffect("閼ｱ蜃ｺ")
		Else
			DieAnimation(Me)
		End If
		
SkipExplode: 
		
		'蜿ｬ蝟壹＠縺溘Θ繝九ャ繝医ｒ隗｣謾ｾ
		DismissServant()
		
		'Invalid_string_refer_to_original_code
		DismissSlave()
		
		If Not Master Is Nothing Then
			Master.CurrentForm.DeleteSlave(ID)
			'UPGRADE_NOTE: オブジェクト Master をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			Master = Nothing
		End If
		
		If Not Summoner Is Nothing Then
			Summoner.CurrentForm.DeleteServant(ID)
			'UPGRADE_NOTE: オブジェクト Summoner をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			Summoner = Nothing
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		For	Each p In PList
			With p
				If .Name = pname Or .Nickname = pname Then
					If Not .Unit_Renamed Is Nothing Then
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.Unit_Renamed.Die(True)
					End If
				End If
				'End If
			End With
		Next p
		'Next
		'End If
		
		'Invalid_string_refer_to_original_code
		If Not without_update Then
			PList.UpdateSupportMod(Me)
		End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub SuicidalExplosion(Optional ByVal is_event As Boolean = False)
		Dim i, j As Short
		Dim prev_hp As Integer
		Dim u, t As Unit
		Dim dmg, tdmg As Integer
		Dim uname, fname As String
		
		PilotMessage("Invalid_string_refer_to_original_code")
		DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
		
		'Invalid_string_refer_to_original_code
		dmg = HP
		
		'Invalid_string_refer_to_original_code
		AreaInRange(x, y, 1, 1, "")
		MaskData(x, y) = True
		
		'Invalid_string_refer_to_original_code
		EraseUnitBitmap(x, y)
		ExplodeAnimation(Size, x, y)
		
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			uname = LIndex(FeatureData("Invalid_string_refer_to_original_code"), 2)
			If OtherForm(uname).IsAbleToEnter(x, y) Then
				Transform(uname)
				MapDataForUnit(x, y).HP = MapDataForUnit(x, y).MaxHP
				fname = FeatureName("Invalid_string_refer_to_original_code")
				If IsSysMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then
					SysMessage("Invalid_string_refer_to_original_code" & Name & ")")
				ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
					SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
				ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
					SysMessage("Invalid_string_refer_to_original_code")
				ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then 
					SysMessage("Invalid_string_refer_to_original_code" & Name & ")")
				ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
					SysMessage("Invalid_string_refer_to_original_code" & fname & ")")
				ElseIf IsSysMessageDefined("Invalid_string_refer_to_original_code") Then 
					SysMessage("Invalid_string_refer_to_original_code")
				Else
					DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
				End If
				GoTo SkipSuicide
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		HP = 0
		UpdateMessageForm(Me)
		'Invalid_string_refer_to_original_code
		AddCondition("遐ｴ螢翫く繝｣繝ｳ繧ｻ繝ｫ", 1)
		'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		MapDataForUnit(x, y) = Nothing
		Die()
		If Not is_event Then
			u = SelectedUnit
			SelectedUnit = Me
			HandleEvent("Invalid_string_refer_to_original_code")
			SelectedUnit = u
			If IsScenarioFinished Then
				IsScenarioFinished = False
				Exit Sub
			End If
		End If
		
SkipSuicide: 
		
		'Invalid_string_refer_to_original_code
		For i = 1 To MapWidth
			For j = 1 To MapHeight
				If MaskData(i, j) Then
					GoTo NextLoop
				End If
				
				t = MapDataForUnit(i, j)
				
				If t Is Nothing Then
					GoTo NextLoop
				End If
				
				With t
					ClearMessageForm()
					If CurrentForm.Party = "蜻ｳ譁ｹ" Or CurrentForm.Party = "Invalid_string_refer_to_original_code" Then
						UpdateMessageForm(t, CurrentForm)
					Else
						UpdateMessageForm(CurrentForm, t)
					End If
					
					'繝繝｡繝ｼ繧ｸ縺ｮ驕ｩ逕ｨ
					prev_hp = .HP
					If .IsConditionSatisfied("辟｡謨ｵ") Then
						tdmg = 0
					ElseIf .IsConditionSatisfied("荳肴ｭｻ霄ｫ") Then 
						.HP = MaxLng(.HP - dmg, 10)
						tdmg = prev_hp - .HP
					Else
						.HP = .HP - dmg
						tdmg = prev_hp - .HP
					End If
					
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If .HP <= .MaxHP \ 4 And Not .IsConditionSatisfied("證ｴ襍ｰ") Then
						.AddCondition("證ｴ襍ｰ", -1)
						.Update()
					End If
					'End If
					
					'繝繝｡繝ｼ繧ｸ繧貞女縺代ｌ縺ｰ逵繧翫°繧峨＆繧√ｋ
					If .IsConditionSatisfied("逹｡逵") Then
						.DeleteCondition("逹｡逵")
					End If
					
					If CurrentForm.Party = "蜻ｳ譁ｹ" Or CurrentForm.Party = "Invalid_string_refer_to_original_code" Then
						UpdateMessageForm(t, CurrentForm)
					Else
						UpdateMessageForm(CurrentForm, t)
					End If
					If .HP > 0 Then
						DrawSysString(.x, .y, VB6.Format(tdmg))
						'UPGRADE_ISSUE: Control picMain は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
						MainForm.picMain(0).Refresh()
					End If
					
					If .HP = 0 Then
						If .IsUnderSpecialPowerEffect("蠕ｩ豢ｻ") Then
							.HP = .MaxHP
							.RemoveSpecialPowerInEffect("Invalid_string_refer_to_original_code")
							DisplaySysMessage(.Nickname & "Invalid_string_refer_to_original_code")
							GoTo NextLoop
						End If
						
						If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
							uname = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), 2)
							If .OtherForm(uname).IsAbleToEnter(.x, .y) Then
								.Transform(uname)
								With .CurrentForm
									.HP = .MaxHP
									.UsedAction = .MaxAction
								End With
								DisplaySysMessage(.Nickname & "Invalid_string_refer_to_original_code")
								GoTo NextLoop
							End If
						End If
						
						.Die()
					End If
					
					If Not is_event Then
						u = SelectedUnit
						SelectedUnit = .CurrentForm
						SelectedTarget = Me
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						DisplaySysMessage(.Nickname & "縺ｯ遐ｴ螢翫＆繧後◆")
						HandleEvent("Invalid_string_refer_to_original_code")
					Else
						DisplaySysMessage(.Nickname & "縺ｯ" & tdmg & "Invalid_string_refer_to_original_code" & "Invalid_string_refer_to_original_code" & VB6.Format(.HP) & "Invalid_string_refer_to_original_code" & 100 * (.MaxHP - .HP) \ .MaxHP & "Invalid_string_refer_to_original_code")
						HandleEvent("Invalid_string_refer_to_original_code")
					End If
					SelectedUnit = u
					If IsScenarioFinished Then
						IsScenarioFinished = False
						Exit Sub
					End If
					'End If
				End With
NextLoop: 
			Next 
		Next 
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Sub FullRecover()
		Dim i, j As Short
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountPilot
			Pilot(i).FullRecover()
		Next 
		For i = 1 To CountSupport
			Support(i).FullRecover()
		Next 
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			If PList.IsDefined(FeatureData("Invalid_string_refer_to_original_code")) Then
				PList.Item(FeatureData("Invalid_string_refer_to_original_code")).FullRecover()
			End If
		End If
		
		With CurrentForm
			'Invalid_string_refer_to_original_code
			.HP = .MaxHP
			
			'Invalid_string_refer_to_original_code
			.FullSupply()
			
			'Invalid_string_refer_to_original_code
			i = 1
			Do While i <= .CountCondition
				'Invalid_string_refer_to_original_code_
				'Or Right$(.Condition(i), 2) = "莉伜刈" _
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				i = i + 1
				.DeleteCondition(i)
				'End If
			Loop 
			
			'Invalid_string_refer_to_original_code
			.UsedSupportAttack = 0
			.UsedSupportGuard = 0
			.UsedSyncAttack = 0
			.UsedCounterAttack = 0
			
			.Mode = "騾壼ｸｸ"
			
			'莉門ｽ｢諷九ｂ蝗槫ｾｩ
			For i = 1 To .CountOtherForm
				With .OtherForm(i)
					.HP = .MaxHP
					.EN = .MaxEN
					For j = 1 To .CountWeapon
						.SetBullet(j, .MaxBullet(j))
					Next 
					For j = 1 To .CountAbility
						.SetStock(j, .MaxStock(j))
					Next 
				End With
			Next 
		End With
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub FullSupply()
		Dim i, j As Short
		
		'Invalid_string_refer_to_original_code
		EN = MaxEN
		
		'蠑ｾ謨ｰ蝗槫ｾｩ
		For i = 1 To CountWeapon
			dblBullet(i) = 1
		Next 
		For i = 1 To CountAbility
			dblStock(i) = 1
		Next 
		
		'莉門ｽ｢諷九ｂ蝗槫ｾｩ
		For i = 1 To CountOtherForm
			With OtherForm(i)
				.EN = .MaxEN
				For j = 1 To .CountWeapon
					.SetBullet(j, .MaxBullet(j))
				Next 
				For j = 1 To .CountAbility
					.SetStock(j, .MaxStock(j))
				Next 
			End With
		Next 
	End Sub
	
	'蠑ｾ謨ｰ縺ｮ縺ｿ繧貞屓蠕ｩ
	Public Sub BulletSupply()
		Dim i, j As Short
		
		For i = 1 To CountWeapon
			dblBullet(i) = 1
		Next 
		
		'莉門ｽ｢諷九ｂ蝗槫ｾｩ
		For i = 1 To CountOtherForm
			With OtherForm(i)
				For j = 1 To .CountWeapon
					.SetBullet(j, .MaxBullet(j))
				Next 
			End With
		Next 
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub RecoverHP(ByVal percent As Double)
		HP = HP + MaxHP * percent / 100
		If HP <= 0 Then
			HP = 1
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If HP <= MaxHP \ 4 And Not IsConditionSatisfied("證ｴ襍ｰ") Then
			AddCondition("證ｴ襍ｰ", -1)
		End If
		'End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub RecoverEN(ByVal percent As Double)
		EN = EN + MaxEN * percent / 100
		If EN <= 0 Then
			EN = 0
		End If
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub Rest()
		Dim hp_recovery, en_recovery As Integer
		Dim hp_up, en_up As Integer
		Dim hp_ratio, en_ratio As Double
		Dim spname, buf As String
		Dim i, j As Short
		Dim u As Unit
		Dim td As TerrainData
		Dim cname As String
		Dim is_time_limit As Boolean
		Dim next_form As String
		' ADD START MARGE
		Dim is_terrain_effective As Boolean
		Dim is_immune_to_terrain_effect As Boolean
		' ADD END MARGE
		
		'Invalid_string_refer_to_original_code
		If Stage = "蜻ｳ譁ｹ" And Turn = 1 Then
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		Update()
		
		'Invalid_string_refer_to_original_code
		u = Me
		
		With MainPilot
			'髴雁鴨蝗槫ｾｩ
			If .MaxPlana > 0 Then
				hp_ratio = 100 * HP / MaxHP
				en_ratio = 100 * EN / MaxEN
				
				.Plana = .Plana + .MaxPlana \ 16 + .MaxPlana * FeatureLevel("髴雁鴨蝗槫ｾｩ") \ 10 - .MaxPlana * FeatureLevel("髴雁鴨豸郁ｲｻ") \ 10
				
				HP = MaxHP * hp_ratio \ 100
				EN = MaxEN * en_ratio \ 100
			End If
			
			'Invalid_string_refer_to_original_code
			If .IsSkillAvailable("Invalid_string_refer_to_original_code") Then
				.SP = .SP + .Level \ 8 + 5
			End If
			If .IsSkillAvailable("邊ｾ逾樒ｵｱ荳") Then
				If .SP < .MaxSP \ 5 Then
					.SP = .SP + .MaxSP \ 10
				End If
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		For i = 2 To CountPilot
			With Pilot(i)
				If .IsSkillAvailable("Invalid_string_refer_to_original_code") Then
					.SP = .SP + .Level \ 8 + 5
				End If
				If .IsSkillAvailable("邊ｾ逾樒ｵｱ荳") Then
					If .SP < .MaxSP \ 5 Then
						.SP = .SP + .MaxSP \ 10
					End If
				End If
			End With
		Next 
		For i = 1 To CountSupport
			With Support(i)
				If .IsSkillAvailable("Invalid_string_refer_to_original_code") Then
					.SP = .SP + .Level \ 8 + 5
				End If
				If .IsSkillAvailable("邊ｾ逾樒ｵｱ荳") Then
					If .SP < .MaxSP \ 5 Then
						.SP = .SP + .MaxSP \ 10
					End If
				End If
			End With
		Next 
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		With AdditionalSupport()
			If .IsSkillAvailable("Invalid_string_refer_to_original_code") Then
				.SP = .SP + .Level \ 8 + 5
			End If
			If .IsSkillAvailable("邊ｾ逾樒ｵｱ荳") Then
				If .SP < .MaxSP \ 5 Then
					.SP = .SP + .MaxSP \ 10
				End If
			End If
		End With
		'End If
		
		'陦悟虚蝗樊焚
		UsedAction = 0
		
		'繧ｹ繝壹す繝｣繝ｫ繝代Ρ繝ｼ蜉ｹ譫懊ｒ隗｣髯､
		RemoveSpecialPowerInEffect("繧ｿ繝ｼ繝ｳ")
		
		'Invalid_string_refer_to_original_code
		With MainPilot
			For i = 1 To .CountSkill
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				spname = LIndex(.SkillData(i), 2)
				If .Morale >= StrToLng(LIndex(.SkillData(i), 3)) And Not IsSpecialPowerInEffect(spname) Then
					Center(x, y)
					.UseSpecialPower(spname, 0)
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Exit Sub
				End If
				'End If
				'End If
			Next 
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code_
			'And Not IsSpecialPowerInEffect(spname) _
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Center(x, y)
			.UseSpecialPower(spname, 0)
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			Exit Sub
			'End If
			'End If
			'End If
		End With
		For i = 2 To CountPilot
			With Pilot(i)
				For j = 1 To .CountSkill
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					spname = LIndex(.SkillData(j), 2)
					If .Morale >= StrToLng(LIndex(.SkillData(j), 3)) And Not IsSpecialPowerInEffect(spname) Then
						Center(x, y)
						.UseSpecialPower(spname, 0)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						Exit Sub
					End If
					'End If
					'End If
				Next 
			End With
		Next 
		For i = 1 To CountSupport
			With Support(i)
				For j = 1 To .CountSkill
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					spname = LIndex(.SkillData(j), 2)
					If .Morale >= StrToLng(LIndex(.SkillData(j), 3)) And Not IsSpecialPowerInEffect(spname) Then
						Center(x, y)
						.UseSpecialPower(spname, 0)
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						Exit Sub
					End If
					'End If
					'End If
				Next 
			End With
		Next 
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		With AdditionalSupport
			For i = 1 To .CountSkill
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				spname = LIndex(.SkillData(i), 2)
				If .Morale >= StrToLng(LIndex(.SkillData(i), 3)) And Not IsSpecialPowerInEffect(spname) Then
					Center(x, y)
					.UseSpecialPower(spname, 0)
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Exit Sub
				End If
				'End If
				'End If
			Next 
		End With
		'End If
		
		'襍ｷ豁ｻ蝗樒函
		With MainPilot
			If .IsSkillAvailable("襍ｷ豁ｻ蝗樒函") And .SP <= .MaxSP \ 5 And HP <= MaxHP \ 5 And EN <= MaxEN \ 5 Then
				.SP = .MaxSP
				HP = MaxHP
				EN = MaxEN
				If SpecialPowerAnimation Then
					Center(x, y)
					If SPDList.IsDefined("繝画ｹ諤ｧ") Then
						SPDList.Item("繝画ｹ諤ｧ").PlayAnimation()
					End If
				End If
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		' MOD START MARGE
		'Invalid_string_refer_to_original_code
		If Not IsConditionSatisfied("Invalid_string_refer_to_original_code") And Not IsSpecialPowerInEffect("Invalid_string_refer_to_original_code") Then
			' MOD END MARGE
			If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				hp_recovery = 10 * FeatureLevel("Invalid_string_refer_to_original_code")
			End If
			If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				en_recovery = 10 * FeatureLevel("Invalid_string_refer_to_original_code")
			End If
		End If
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			hp_recovery = hp_recovery - 10 * FeatureLevel("Invalid_string_refer_to_original_code")
		End If
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			en_recovery = en_recovery - 10 * FeatureLevel("Invalid_string_refer_to_original_code")
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Dim plv As Short
		
		If IsOptionDefined("豈貞柑譫懷､ｧ") And BossRank < 0 Then
			plv = 25
		Else
			plv = 10
		End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		plv = 2 * plv
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		plv = 0
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		plv = plv \ 2
		'End If
		
		hp_recovery = hp_recovery - plv
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Center(x, y)
		Escape()
		OpenMessageForm()
		DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
		CloseMessageForm()
		HandleEvent("Invalid_string_refer_to_original_code")
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		hp_recovery = hp_recovery - 1000
		'End If
		
		'谿九ｊ譎る俣
		If ConditionLifetime("谿九ｊ譎る俣") = 1 Then
			is_time_limit = True
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		hp_ratio = 100 * HP / MaxHP
		en_ratio = 100 * EN / MaxEN
		UpdateCondition(True)
		HP = MaxHP * hp_ratio \ 100
		EN = MaxEN * en_ratio \ 100
		
		'Invalid_string_refer_to_original_code
		UsedSupportAttack = 0
		UsedSupportGuard = 0
		
		'Invalid_string_refer_to_original_code
		UsedSyncAttack = 0
		
		'Invalid_string_refer_to_original_code
		UsedCounterAttack = 0
		
		'Invalid_string_refer_to_original_code
		If ConditionLifetime("繝√Ε繝ｼ繧ｸ") = 0 Then
			AddCondition("Invalid_string_refer_to_original_code")
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Select Case Area
			Case "遨ｺ荳ｭ"
				If Not IsTransAvailable("遨ｺ") Then
					If Not IsAbleToEnter(x, y) Then
						Center(x, y)
						Escape()
						OpenMessageForm()
						DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
						CloseMessageForm()
						HandleEvent("Invalid_string_refer_to_original_code")
						Exit Sub
					End If
					'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
					MapDataForUnit(x, y) = Nothing
					EraseUnitBitmap(x, y)
					StandBy(x, y)
				End If
			Case "Invalid_string_refer_to_original_code"
				If Not IsTransAvailable("髯ｸ") Then
					If Not IsAbleToEnter(x, y) Then
						Center(x, y)
						Escape()
						OpenMessageForm()
						DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
						CloseMessageForm()
						HandleEvent("Invalid_string_refer_to_original_code")
						Exit Sub
					End If
					'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
					MapDataForUnit(x, y) = Nothing
					EraseUnitBitmap(x, y)
					StandBy(x, y)
				End If
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If Not IsAbleToEnter(x, y) Then
					Center(x, y)
					Escape()
					OpenMessageForm()
					DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
					CloseMessageForm()
					HandleEvent("Invalid_string_refer_to_original_code")
					Exit Sub
				End If
				'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
				MapDataForUnit(x, y) = Nothing
				EraseUnitBitmap(x, y)
				StandBy(x, y)
				'End If
			Case "豌ｴ荳ｭ"
				If Adaption(3) = 0 Then
					If Not IsAbleToEnter(x, y) Then
						Center(x, y)
						Escape()
						OpenMessageForm()
						DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
						CloseMessageForm()
						HandleEvent("Invalid_string_refer_to_original_code")
						Exit Sub
					End If
					'UPGRADE_NOTE: オブジェクト MapDataForUnit() をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
					MapDataForUnit(x, y) = Nothing
					EraseUnitBitmap(x, y)
					StandBy(x, y)
				End If
		End Select
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		' MOD START MARGE
		'Invalid_string_refer_to_original_code
		If Not IsConditionSatisfied("Invalid_string_refer_to_original_code") And Not IsSpecialPowerInEffect("Invalid_string_refer_to_original_code") Then
			' MOD END MARGE
			hp_recovery = hp_recovery + 50
			en_recovery = en_recovery + 50
		End If
		
		'蠑ｾ謨ｰ蝗槫ｾｩ
		For i = 1 To CountWeapon
			dblBullet(i) = 1
		Next 
		For i = 1 To CountAbility
			dblStock(i) = 1
		Next 
		' MOD START MARGE
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'            hp_recovery = hp_recovery + TerrainEffectForHPRecover(X, Y)
		'            en_recovery = en_recovery + TerrainEffectForENRecover(X, Y)
		'        End If
		'
		'Invalid_string_refer_to_original_code
		'        Set td = TDList.Item(MapData(X, Y, 0))
		'        With td
		'            For i = 1 To .CountFeature
		'                Select Case .Feature(i)
		'Invalid_string_refer_to_original_code
		'                        If Weakness(.FeatureData(i)) Then
		'                            hp_recovery = hp_recovery - 20 * .FeatureLevel(i)
		'                        ElseIf Effective(.FeatureData(i)) Then
		'                            hp_recovery = hp_recovery - 10 * .FeatureLevel(i)
		'                        ElseIf Not Immune(.FeatureData(i)) Then
		'                            If Absorb(.FeatureData(i)) Then
		'                                hp_recovery = hp_recovery + 10 * .FeatureLevel(i)
		'                            ElseIf Resist(.FeatureData(i)) Then
		'                                hp_recovery = hp_recovery - 5 * .FeatureLevel(i)
		'                            Else
		'                                hp_recovery = hp_recovery - 10 * .FeatureLevel(i)
		'                            End If
		'                        End If
		'
		'Invalid_string_refer_to_original_code
		'                        If Weakness(.FeatureData(i)) Then
		'                            en_recovery = en_recovery - 20 * .FeatureLevel(i)
		'                        ElseIf Effective(.FeatureData(i)) Then
		'                            en_recovery = en_recovery - 10 * .FeatureLevel(i)
		'                        ElseIf Not Immune(.FeatureData(i)) Then
		'                            If Absorb(.FeatureData(i)) Then
		'                                en_recovery = en_recovery + 10 * .FeatureLevel(i)
		'                            ElseIf Resist(.FeatureData(i)) Then
		'                                en_recovery = en_recovery - 5 * .FeatureLevel(i)
		'                            Else
		'                                en_recovery = en_recovery - 10 * .FeatureLevel(i)
		'                            End If
		'                        End If
		'
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'                            hp_up = hp_up + 1000 * .FeatureLevel(i)
		'                        End If
		'
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'                            en_up = en_up + 10 * .FeatureLevel(i)
		'                        End If
		'
		'Invalid_string_refer_to_original_code
		'                        If Weakness(.FeatureData(i)) Then
		'                            hp_up = hp_up - 2000 * .FeatureLevel(i)
		'                        ElseIf Effective(.FeatureData(i)) Then
		'                            hp_up = hp_up - 1000 * .FeatureLevel(i)
		'                        ElseIf Not Immune(.FeatureData(i)) Then
		'                            If Absorb(.FeatureData(i)) Then
		'                                hp_up = hp_up + 1000 * .FeatureLevel(i)
		'                            ElseIf Resist(.FeatureData(i)) Then
		'                                hp_up = hp_up - 500 * .FeatureLevel(i)
		'                            Else
		'                                hp_up = hp_up - 1000 * .FeatureLevel(i)
		'                            End If
		'                        End If
		'
		'Invalid_string_refer_to_original_code
		'                        If Weakness(.FeatureData(i)) Then
		'                            en_up = en_up - 20 * .FeatureLevel(i)
		'                        ElseIf Effective(.FeatureData(i)) Then
		'                            en_up = en_up - 10 * .FeatureLevel(i)
		'                        ElseIf Not Immune(.FeatureData(i)) Then
		'                            If Absorb(.FeatureData(i)) Then
		'                                en_up = en_up + 10 * .FeatureLevel(i)
		'                            ElseIf Resist(.FeatureData(i)) Then
		'                                en_up = en_up - 5 * .FeatureLevel(i)
		'                            Else
		'                                en_up = en_up - 10 * .FeatureLevel(i)
		'                            End If
		'                        End If
		'
		'                    Case "迥ｶ諷倶ｻ伜刈"
		'                        cname = .FeatureData(i)
		'
		'Invalid_string_refer_to_original_code
		'                        Select Case cname
		'Invalid_string_refer_to_original_code
		'                                If SpecialEffectImmune("蜉｣") Then
		'                                    cname = ""
		'                                End If
		'                            Case "豺ｷ荵ｱ"
		'                                If SpecialEffectImmune("荵ｱ") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'                                    cname = ""
		'                                End If
		'                            Case "雕翫ｊ"
		'Invalid_string_refer_to_original_code
		'                                    cname = ""
		'                                End If
		'                            Case "迢よ姶螢ｫ"
		'Invalid_string_refer_to_original_code
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'                                If SpecialEffectImmune("繧ｾ") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'                                If SpecialEffectImmune("螳ｳ") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'                                If SpecialEffectImmune("遏ｳ") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'                                    cname = ""
		'                                End If
		'                            Case "鮗ｻ逞ｺ"
		'                                If SpecialEffectImmune("逞ｺ") Then
		'                                    cname = ""
		'                                End If
		'                            Case "逹｡逵"
		'                                If SpecialEffectImmune("逵") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'                                    cname = ""
		'                                End If
		'                            Case "逶ｲ逶ｮ"
		'                                If SpecialEffectImmune("逶ｲ") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'                                If SpecialEffectImmune("蜑九が") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'                                If SpecialEffectImmune("蜑九す") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'                                If SpecialEffectImmune("蜑九し") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'                                If SpecialEffectImmune("蜑九し") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'                                If SpecialEffectImmune("蜑矩怺") Then
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'                                    cname = ""
		'                                End If
		'Invalid_string_refer_to_original_code
		'                                If SpecialEffectImmune("蜑区橿") Then
		'                                    cname = ""
		'                                End If
		'                            Case Else
		'                                If Len(cname) > 6 Then
		'                                    If Right$(cname, 6) = "螻樊ｧ蠑ｱ轤ｹ莉伜刈" Then
		'                                        If SpecialEffectImmune("蠑ｱ" & Left$(cname, Len(cname) - 6)) _
		''                                            Or Absorb(Left$(cname, Len(cname) - 6)) _
		''                                            Or Immune(Left$(cname, Len(cname) - 6)) _
		''                                        Then
		'                                            cname = ""
		'                                        End If
		'                                    ElseIf Right$(cname, 6) = "螻樊ｧ譛牙柑莉伜刈" Then
		'Invalid_string_refer_to_original_code_
		''                                            Or Absorb(Left$(cname, Len(cname) - 6)) _
		''                                            Or Immune(Left$(cname, Len(cname) - 6)) _
		''                                        Then
		'                                            cname = ""
		'                                        End If
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'                                            cname = ""
		'                                        End If
		'                                    End If
		'                                End If
		'                        End Select
		'
		'                        If cname <> "" Then
		'                            If .IsFeatureLevelSpecified(i) Then
		'                                AddCondition cname, .FeatureLevel(i)
		'                            Else
		'                                AddCondition cname, 10000
		'                            End If
		'                        End If
		'                End Select
		'            Next
		'        End With
		'Invalid_string_refer_to_original_code
		'MOD START 240a
		'        Set td = TDList.Item(MapData(X, Y, 0))
		'繝ｬ繧､繝､繝ｼ縺ｮ迥ｶ諷九↓蠢懊§縺ｦ荳雁ｱ､荳句ｱ､縺ｩ縺｡繧峨ｒ蜿門ｾ励☆繧九°蛻､蛻･
		Select Case MapData(x, y, Map.MapDataIndex.BoxType)
			Case Map.BoxTypes.Under, Map.BoxTypes.UpperBmpOnly
				td = TDList.Item(MapData(x, y, Map.MapDataIndex.TerrainType))
			Case Else
				td = TDList.Item(MapData(x, y, Map.MapDataIndex.LayerType))
		End Select
		'MOD START 240a
		With td
			'Invalid_string_refer_to_original_code
			If .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
				For i = 1 To LLength(.FeatureData("Invalid_string_refer_to_original_code"))
					If Area = LIndex(.FeatureData("Invalid_string_refer_to_original_code"), i) Then
						is_terrain_effective = True
						Exit For
					End If
				Next 
			Else
				is_terrain_effective = True
			End If
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			is_immune_to_terrain_effect = True
			Exit For
			'End If
			'Next
			is_immune_to_terrain_effect = True
			'End If
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			is_immune_to_terrain_effect = True
			'End If
			
			'蝨ｰ蠖｢蜉ｹ譫懊ｒ驕ｩ逕ｨ
			If is_terrain_effective Then
				For i = 1 To .CountFeature
					If Not IsConditionSatisfied("Invalid_string_refer_to_original_code") And Not IsSpecialPowerInEffect("Invalid_string_refer_to_original_code") Then
						Select Case .Feature(i)
							Case "Invalid_string_refer_to_original_code"
								hp_recovery = hp_recovery + 10 * .FeatureLevel(i)
							Case "Invalid_string_refer_to_original_code"
								en_recovery = en_recovery + 10 * .FeatureLevel(i)
							Case "Invalid_string_refer_to_original_code"
								hp_up = hp_up + 1000 * .FeatureLevel(i)
							Case "Invalid_string_refer_to_original_code"
								en_up = en_up + 10 * .FeatureLevel(i)
						End Select
					End If
					
					If Not is_immune_to_terrain_effect Then
						Select Case .Feature(i)
							Case "Invalid_string_refer_to_original_code"
								If Weakness(.FeatureData(i)) Then
									hp_recovery = hp_recovery - 20 * .FeatureLevel(i)
								ElseIf Effective(.FeatureData(i)) Then 
									hp_recovery = hp_recovery - 10 * .FeatureLevel(i)
								ElseIf Absorb(.FeatureData(i)) Then 
									hp_recovery = hp_recovery + 10 * .FeatureLevel(i)
								ElseIf Resist(.FeatureData(i)) Then 
									hp_recovery = hp_recovery - 5 * .FeatureLevel(i)
								ElseIf Not Immune(.FeatureData(i)) Then 
									hp_recovery = hp_recovery - 10 * .FeatureLevel(i)
								End If
								
							Case "Invalid_string_refer_to_original_code"
								If Weakness(.FeatureData(i)) Then
									en_recovery = en_recovery - 20 * .FeatureLevel(i)
								ElseIf Effective(.FeatureData(i)) Then 
									en_recovery = en_recovery - 10 * .FeatureLevel(i)
								ElseIf Absorb(.FeatureData(i)) Then 
									en_recovery = en_recovery + 10 * .FeatureLevel(i)
								ElseIf Resist(.FeatureData(i)) Then 
									en_recovery = en_recovery - 5 * .FeatureLevel(i)
								ElseIf Not Immune(.FeatureData(i)) Then 
									en_recovery = en_recovery - 10 * .FeatureLevel(i)
								End If
								
							Case "Invalid_string_refer_to_original_code"
								If Weakness(.FeatureData(i)) Then
									hp_up = hp_up - 2000 * .FeatureLevel(i)
								ElseIf Effective(.FeatureData(i)) Then 
									hp_up = hp_up - 1000 * .FeatureLevel(i)
								ElseIf Absorb(.FeatureData(i)) Then 
									hp_up = hp_up + 1000 * .FeatureLevel(i)
								ElseIf Resist(.FeatureData(i)) Then 
									hp_up = hp_up - 500 * .FeatureLevel(i)
								ElseIf Not Immune(.FeatureData(i)) Then 
									hp_up = hp_up - 1000 * .FeatureLevel(i)
								End If
								
							Case "Invalid_string_refer_to_original_code"
								If Weakness(.FeatureData(i)) Then
									en_up = en_up - 20 * .FeatureLevel(i)
								ElseIf Effective(.FeatureData(i)) Then 
									en_up = en_up - 10 * .FeatureLevel(i)
								ElseIf Absorb(.FeatureData(i)) Then 
									en_up = en_up + 10 * .FeatureLevel(i)
								ElseIf Resist(.FeatureData(i)) Then 
									en_up = en_up - 5 * .FeatureLevel(i)
								ElseIf Not Immune(.FeatureData(i)) Then 
									en_up = en_up - 10 * .FeatureLevel(i)
								End If
								
							Case "迥ｶ諷倶ｻ伜刈"
								cname = .FeatureData(i)
								
								'Invalid_string_refer_to_original_code
								Select Case cname
									Case "Invalid_string_refer_to_original_code"
										If SpecialEffectImmune("蜉｣") Then
											cname = ""
										End If
									Case "豺ｷ荵ｱ"
										If SpecialEffectImmune("荵ｱ") Then
											cname = ""
										End If
									Case "Invalid_string_refer_to_original_code"
										'Invalid_string_refer_to_original_code
										'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
										cname = ""
								End Select
						End Select
					End If
					'UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case "雕翫ｊ"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'cname = ""
				Next 
			End If
			'UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
			'Case "迢よ姶螢ｫ"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'cname = ""
				'End If
				''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
				'Case "Invalid_string_refer_to_original_code"
					'If SpecialEffectImmune("繧ｾ") Then
						'cname = ""
					'End If
					''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
					'Case "Invalid_string_refer_to_original_code"
						'If SpecialEffectImmune("螳ｳ") Then
							'cname = ""
						'End If
						''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
						'Case "Invalid_string_refer_to_original_code"
							'If SpecialEffectImmune("遏ｳ") Then
								'cname = ""
							'End If
							''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
							'Case "Invalid_string_refer_to_original_code"
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								'cname = ""
								'End If
								''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
								'Case "鮗ｻ逞ｺ"
									'If SpecialEffectImmune("逞ｺ") Then
										'cname = ""
									'End If
									''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
									'Case "逹｡逵"
										'If SpecialEffectImmune("逵") Then
											'cname = ""
										'End If
										''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
										'Case "Invalid_string_refer_to_original_code"
											'Invalid_string_refer_to_original_code
											'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
											'cname = ""
											'End If
											''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
											'Case "逶ｲ逶ｮ"
												'If SpecialEffectImmune("逶ｲ") Then
													'cname = ""
												'End If
												''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
												'Case "Invalid_string_refer_to_original_code"
													'Invalid_string_refer_to_original_code
													'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
													'cname = ""
													'End If
													'Invalid_string_refer_to_original_code
													''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
													'Case "Invalid_string_refer_to_original_code"
														'If SpecialEffectImmune("蜑九が") Then
															'cname = ""
														'End If
														''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
														'Case "Invalid_string_refer_to_original_code"
															'Invalid_string_refer_to_original_code
															'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
															'cname = ""
															'End If
															''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
															'Case "Invalid_string_refer_to_original_code"
																'If SpecialEffectImmune("蜑九す") Then
																	'cname = ""
																'End If
																''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
																'Case "Invalid_string_refer_to_original_code"
																	'If SpecialEffectImmune("蜑九し") Then
																		'cname = ""
																	'End If
																	''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
																	'Case "Invalid_string_refer_to_original_code"
																		'If SpecialEffectImmune("蜑九し") Then
																			'cname = ""
																		'End If
																		''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
																		'Case "Invalid_string_refer_to_original_code"
																			'If SpecialEffectImmune("蜑矩怺") Then
																				'cname = ""
																			'End If
																			''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
																			'Case "Invalid_string_refer_to_original_code"
																				'Invalid_string_refer_to_original_code
																				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
																				'cname = ""
																				'End If
																				''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
																				'Case "Invalid_string_refer_to_original_code"
																					'If SpecialEffectImmune("蜑区橿") Then
																						'cname = ""
																					'End If
																					''UPGRADE_WARNING: Rest に変換されていないステートメントがあります。ソース コードを確認してください。
		End With
		' MOD END MARGE
		'End If
		
		'Invalid_string_refer_to_original_code
		' MOD START MARGE
		'Invalid_string_refer_to_original_code_
		'Invalid_string_refer_to_original_code_
		''    Then
		If Not IsConditionSatisfied("Invalid_string_refer_to_original_code") And Not IsSpecialPowerInEffect("Invalid_string_refer_to_original_code") And Not IsOptionDefined("Invalid_string_refer_to_original_code") Then
			' MOD END MARGE
			EN = EN + 5
		End If
		
		'Invalid_string_refer_to_original_code
		HP = HP + MaxHP * hp_recovery \ 100 + hp_up
		If HP <= 0 Then
			HP = 1
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If HP <= MaxHP \ 4 And Not IsConditionSatisfied("證ｴ襍ｰ") Then
			AddCondition("證ｴ襍ｰ", -1)
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		If EN + MaxEN * en_recovery \ 100 + en_up > 0 Then
			EN = EN + MaxEN * en_recovery \ 100 + en_up
		End If
		IsFeatureAvailable("螟牙ｽ｢")
		'螟牙ｽ｢縺ｧ縺阪ｌ縺ｰ螟牙ｽ｢
		buf = FeatureData("螟牙ｽ｢")
		For i = 2 To LLength(buf)
			With OtherForm(LIndex(buf, i))
				If .IsAbleToEnter(x, y) And Not .IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
					Transform(LIndex(buf, i))
					Exit For
				End If
			End With
		Next 
		If i > LLength(buf) Then
			EN = 0
		End If
		EN = 0
		'End If
		'End If
		
		'Invalid_string_refer_to_original_code
		Update()
		
		'Invalid_string_refer_to_original_code
		If is_time_limit Then
			If next_form <> "" Then
				'Invalid_string_refer_to_original_code
				u = OtherForm(next_form)
				If u.IsAbleToEnter(x, y) Then
					'Invalid_string_refer_to_original_code
					If u.IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						If Not PList.IsDefined(u.FeatureData("Invalid_string_refer_to_original_code")) Then
							PList.Add(u.FeatureData("Invalid_string_refer_to_original_code"), MainPilot.Level, Party0)
						End If
					End If
					
					'Invalid_string_refer_to_original_code
					If IsMessageDefined("Invalid_string_refer_to_original_code" & Name & "=>" & u.Name & ")") Then
						OpenMessageForm()
						PilotMessage("Invalid_string_refer_to_original_code" & Name & "=>" & u.Name & ")")
						CloseMessageForm()
					ElseIf IsMessageDefined("Invalid_string_refer_to_original_code" & u.Name & ")") Then 
						OpenMessageForm()
						PilotMessage("Invalid_string_refer_to_original_code" & u.Name & ")")
						CloseMessageForm()
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						OpenMessageForm()
						PilotMessage("Invalid_string_refer_to_original_code")
						CloseMessageForm()
					End If
					'Invalid_string_refer_to_original_code
					If IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & Name & "=>" & u.Name & ")") Then
						SpecialEffect("Invalid_string_refer_to_original_code" & Name & "=>" & u.Name & ")")
					ElseIf IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & u.Name & ")") Then 
						SpecialEffect("Invalid_string_refer_to_original_code" & u.Name & ")")
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						SpecialEffect("Invalid_string_refer_to_original_code")
					End If
					
					'螟牙ｽ｢
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Else
					'Invalid_string_refer_to_original_code
					Center(x, y)
					Escape()
					OpenMessageForm()
					DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
					CloseMessageForm()
					HandleEvent("Invalid_string_refer_to_original_code")
					Exit Sub
				End If
			ElseIf IsFeatureAvailable("Invalid_string_refer_to_original_code") Then 
				'Invalid_string_refer_to_original_code
				
				'Invalid_string_refer_to_original_code
				If IsMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Or IsMessageDefined("Invalid_string_refer_to_original_code" & FeatureName("Invalid_string_refer_to_original_code") & ")") Or IsMessageDefined("Invalid_string_refer_to_original_code") Then
					If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
						StartBGM(FeatureData("Invalid_string_refer_to_original_code"))
						Sleep(500)
					ElseIf MainPilot.BGM <> "-" Then 
						StartBGM(MainPilot.BGM)
						Sleep(500)
					End If
					Center(x, y)
					RefreshScreen()
					
					OpenMessageForm()
					If IsMessageDefined("Invalid_string_refer_to_original_code" & Name & ")") Then
						PilotMessage("Invalid_string_refer_to_original_code" & Name & ")")
					ElseIf IsMessageDefined("Invalid_string_refer_to_original_code" & FeatureName("Invalid_string_refer_to_original_code") & ")") Then 
						PilotMessage("Invalid_string_refer_to_original_code" & FeatureName("Invalid_string_refer_to_original_code") & ")")
					Else
						PilotMessage("Invalid_string_refer_to_original_code")
					End If
					CloseMessageForm()
				End If
				'Invalid_string_refer_to_original_code
				If IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & Name & ")") Then
					SpecialEffect("Invalid_string_refer_to_original_code" & Name & ")")
				ElseIf IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & FeatureName("Invalid_string_refer_to_original_code") & ")") Then 
					SpecialEffect("Invalid_string_refer_to_original_code" & FeatureName("Invalid_string_refer_to_original_code") & ")")
				Else
					SpecialEffect("Invalid_string_refer_to_original_code")
				End If
				
				'Invalid_string_refer_to_original_code
				Split_Renamed()
			Else
				'Invalid_string_refer_to_original_code
				Center(x, y)
				RefreshScreen()
				OpenMessageForm()
				DisplaySysMessage(Nickname & "Invalid_string_refer_to_original_code")
				CloseMessageForm()
				Escape()
				HandleEvent("Invalid_string_refer_to_original_code")
				Exit Sub
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		CurrentForm.CheckAutoHyperMode()
		CurrentForm.CheckAutoNormalMode()
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub CheckAutoHyperMode()
		Dim is_available, message_window_visible As Boolean
		Dim fname, fdata As String
		Dim flevel As Double
		Dim uname As String
		Dim i As Short
		
		'Invalid_string_refer_to_original_code
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Sub
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Sub
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Sub
		'End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Sub
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		uname = LIndex(fdata, 2)
		is_available = False
		With OtherForm(uname)
			Select Case TerrainClass(x, y)
				Case "遨ｺ"
					If .IsTransAvailable("遨ｺ") Then
						is_available = True
					End If
				Case "豺ｱ豌ｴ"
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					is_available = True
					'End If
				Case Else
					is_available = True
			End Select
			
			If Not .IsAbleToEnter(x, y) Then
				is_available = False
			End If
		End With
		
		'Invalid_string_refer_to_original_code
		If Not is_available Then
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		If UDList.IsDefined(uname) Then
			With UDList.Item(uname)
				If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
					If Not PList.IsDefined(FeatureData("Invalid_string_refer_to_original_code")) Then
						PList.Add(FeatureData("Invalid_string_refer_to_original_code"), MainPilot.Level, Party0)
					End If
				End If
			End With
		End If
		
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			For i = 1 To CountFeature
				If Feature(i) = "Invalid_string_refer_to_original_code" And LIndex(FeatureData(i), 1) = uname Then
					StartBGM(Mid(FeatureData(i), InStr(FeatureData(i), " ") + 1))
					Sleep(500)
					Exit For
				End If
			Next 
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Center(x, y)
		RefreshScreen()
		
		If Not message_window_visible Then
			OpenMessageForm()
		Else
			message_window_visible = True
		End If
		
		'Invalid_string_refer_to_original_code
		If IsMessageDefined("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")") Then
			PilotMessage("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")")
		ElseIf IsMessageDefined("Invalid_string_refer_to_original_code" & uname & ")") Then 
			PilotMessage("Invalid_string_refer_to_original_code" & uname & ")")
		ElseIf IsMessageDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
			PilotMessage("Invalid_string_refer_to_original_code" & fname & ")")
		Else
			PilotMessage("Invalid_string_refer_to_original_code")
		End If
		
		If Not message_window_visible Then
			CloseMessageForm()
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		SaveSelections()
		SelectedUnit = Me
		SelectedUnitForEvent = Me
		'UPGRADE_NOTE: オブジェクト SelectedTarget をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SelectedTarget = Nothing
		'UPGRADE_NOTE: オブジェクト SelectedTargetForEvent をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SelectedTargetForEvent = Nothing
		If IsAnimationDefined("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")") Then
			PlayAnimation("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")")
		ElseIf IsAnimationDefined("Invalid_string_refer_to_original_code" & uname & ")") Then 
			PlayAnimation("Invalid_string_refer_to_original_code" & uname & ")")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			PlayAnimation("Invalid_string_refer_to_original_code" & FeatureName("Invalid_string_refer_to_original_code"))
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			PlayAnimation("Invalid_string_refer_to_original_code")
		ElseIf IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")") Then 
			SpecialEffect("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")")
		ElseIf IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & uname & ")") Then 
			SpecialEffect("Invalid_string_refer_to_original_code" & uname & ")")
		ElseIf IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & fname & ")") Then 
			SpecialEffect("Invalid_string_refer_to_original_code" & fname & ")")
		Else
			SpecialEffect("Invalid_string_refer_to_original_code")
		End If
		RestoreSelections()
		
		'Invalid_string_refer_to_original_code
		Transform(uname)
		
		'Invalid_string_refer_to_original_code
		If Not SelectedUnit Is Nothing Then
			If ID = SelectedUnit.ID Then
				SelectedUnit = CurrentForm
			End If
		End If
		If Not SelectedUnitForEvent Is Nothing Then
			If ID = SelectedUnitForEvent.ID Then
				SelectedUnitForEvent = CurrentForm
			End If
		End If
		If Not SelectedTarget Is Nothing Then
			If ID = SelectedTarget.ID Then
				SelectedTarget = CurrentForm
			End If
		End If
		If Not SelectedTargetForEvent Is Nothing Then
			If ID = SelectedTargetForEvent.ID Then
				SelectedTargetForEvent = CurrentForm
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		With CurrentForm
			HandleEvent("螟牙ｽ｢", .MainPilot.ID, .Name)
		End With
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function CheckAutoNormalMode(Optional ByVal without_redraw As Boolean = False) As Boolean
		Dim message_window_visible As Boolean
		Dim uname As String
		Dim i As Short
		
		'Invalid_string_refer_to_original_code
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If IsAbleToEnter(x, y) Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If Not OtherForm(uname).IsAbleToEnter(x, y) Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If UDList.IsDefined(uname) Then
			With UDList.Item(uname)
				If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
					If Not PList.IsDefined(FeatureData("Invalid_string_refer_to_original_code")) Then
						PList.Add(FeatureData("Invalid_string_refer_to_original_code"), MainPilot.Level, Party0)
					End If
				End If
			End With
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code_
		'Then
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			For i = 1 To CountFeature
				If Feature(i) = "Invalid_string_refer_to_original_code" And LIndex(FeatureData(i), 1) = uname Then
					StartBGM(Mid(FeatureData(i), InStr(FeatureData(i), " ") + 1))
					Sleep(500)
					Exit For
				End If
			Next 
		End If
		
		Center(x, y)
		RefreshScreen()
		
		If Not message_window_visible Then
			OpenMessageForm()
		Else
			message_window_visible = True
		End If
		
		'Invalid_string_refer_to_original_code
		If IsMessageDefined("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")") Then
			PilotMessage("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")")
		ElseIf IsMessageDefined("Invalid_string_refer_to_original_code" & uname & ")") Then 
			PilotMessage("Invalid_string_refer_to_original_code" & uname & ")")
		Else
			PilotMessage("Invalid_string_refer_to_original_code")
		End If
		
		If Not message_window_visible Then
			CloseMessageForm()
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		SaveSelections()
		SelectedUnit = Me
		SelectedUnitForEvent = Me
		'UPGRADE_NOTE: オブジェクト SelectedTarget をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SelectedTarget = Nothing
		'UPGRADE_NOTE: オブジェクト SelectedTargetForEvent をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		SelectedTargetForEvent = Nothing
		If IsAnimationDefined("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")") Then
			PlayAnimation("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")")
		ElseIf IsAnimationDefined("Invalid_string_refer_to_original_code" & uname & ")") Then 
			PlayAnimation("Invalid_string_refer_to_original_code" & uname & ")")
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			PlayAnimation("Invalid_string_refer_to_original_code")
		ElseIf IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")") Then 
			SpecialEffect("Invalid_string_refer_to_original_code" & Name & "=>" & uname & ")")
		ElseIf IsSpecialEffectDefined("Invalid_string_refer_to_original_code" & uname & ")") Then 
			SpecialEffect("Invalid_string_refer_to_original_code" & uname & ")")
		Else
			SpecialEffect("Invalid_string_refer_to_original_code")
		End If
		RestoreSelections()
		
		'Invalid_string_refer_to_original_code
		Transform(uname)
		
		'Invalid_string_refer_to_original_code
		If Not SelectedUnit Is Nothing Then
			If ID = SelectedUnit.ID Then
				SelectedUnit = CurrentForm
			End If
		End If
		If Not SelectedUnitForEvent Is Nothing Then
			If ID = SelectedUnitForEvent.ID Then
				SelectedUnitForEvent = CurrentForm
			End If
		End If
		If Not SelectedTarget Is Nothing Then
			If ID = SelectedTarget.ID Then
				SelectedTarget = CurrentForm
			End If
		End If
		If Not SelectedTargetForEvent Is Nothing Then
			If ID = SelectedTargetForEvent.ID Then
				SelectedTargetForEvent = CurrentForm
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		CheckAutoNormalMode = True
		If Not without_redraw Then
			RedrawScreen()
		End If
		'End If
		
		'Invalid_string_refer_to_original_code
		With CurrentForm
			HandleEvent("螟牙ｽ｢", .MainPilot.ID, .Name)
		End With
	End Function
	
	
	'Invalid_string_refer_to_original_code
	'UPGRADE_NOTE: Reset は Reset_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
	Public Sub Reset_Renamed()
		Dim i As Short
		Dim pname As String
		
		For i = 1 To CountCondition
			DeleteCondition0(1)
		Next 
		RemoveAllSpecialPowerInEffect()
		
		Update()
		
		For i = 1 To CountPilot
			Pilot(i).FullRecover()
		Next 
		For i = 1 To CountSupport
			Support(i).FullRecover()
		Next 
		If IsFeatureAvailable("Invalid_string_refer_to_original_code") Then
			pname = FeatureData("Invalid_string_refer_to_original_code")
			If PList.IsDefined(pname) Then
				PList.Item(pname).FullRecover()
			End If
		End If
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If PList.IsDefined(pname) Then
			PList.Item(pname).FullRecover()
		End If
		'End If
		
		HP = MaxHP
		FullSupply()
		Mode = "騾壼ｸｸ"
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function IsEnemy(ByRef t As Unit, Optional ByVal for_move As Boolean = False) As Boolean
		Dim myparty, tparty As String
		
		'Invalid_string_refer_to_original_code
		If t Is Me Then
			IsEnemy = False
			Exit Function
		End If
		
		'證ｴ襍ｰ縺励◆繝ｦ繝九ャ繝医↓縺ｨ縺｣縺ｦ縺ｯ縺吶∋縺ｦ縺梧雰
		If IsConditionSatisfied("證ｴ襍ｰ") Then
			IsEnemy = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("豺ｷ荵ｱ") Then
			If for_move Then
				IsEnemy = True
			ElseIf Dice(2) = 1 Then 
				IsEnemy = True
			Else
				IsEnemy = False
			End If
			Exit Function
		End If
		
		With t
			myparty = Party
			tparty = .Party
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			If myparty = "蜻ｳ譁ｹ" And tparty = "Invalid_string_refer_to_original_code" Then
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsEnemy = True
				Exit Function
			End If
			'End If
			
			If myparty <> "蜻ｳ譁ｹ" Then
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				
				'Invalid_string_refer_to_original_code
				Select Case Mode
					Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
						Select Case tparty
							Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
								IsEnemy = True
							Case Else
								IsEnemy = False
						End Select
						Exit Function
					Case "謨ｵ", "Invalid_string_refer_to_original_code"
						If tparty = Mode Then
							IsEnemy = True
						Else
							IsEnemy = False
						End If
						Exit Function
				End Select
				
				'Invalid_string_refer_to_original_code
				Select Case .Mode
					Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
						Select Case myparty
							Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
								IsEnemy = True
							Case Else
								IsEnemy = False
						End Select
						Exit Function
					Case "謨ｵ", "Invalid_string_refer_to_original_code"
						If myparty = .Mode Then
							IsEnemy = True
						Else
							IsEnemy = False
						End If
						Exit Function
				End Select
			End If
			
			'Invalid_string_refer_to_original_code
			Select Case myparty
				Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
					Select Case tparty
						Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
							IsEnemy = False
						Case Else
							IsEnemy = True
					End Select
				Case Else
					If myparty = tparty Then
						IsEnemy = False
					Else
						IsEnemy = True
					End If
			End Select
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAlly(ByRef t As Unit) As Boolean
		'Invalid_string_refer_to_original_code
		If t Is Me Then
			IsAlly = True
			Exit Function
		End If
		
		'證ｴ襍ｰ縺励◆繝ｦ繝九ャ繝医↓縺ｨ縺｣縺ｦ縺ｯ縺吶∋縺ｦ縺梧雰
		If IsConditionSatisfied("證ｴ襍ｰ") Then
			IsAlly = False
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("豺ｷ荵ｱ") Then
			If Dice(2) = 1 Then
				IsAlly = True
			Else
				IsAlly = False
			End If
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		Select Case Party
			Case "蜻ｳ譁ｹ", "Invalid_string_refer_to_original_code"
				If t.Party = "蜻ｳ譁ｹ" Or t.Party = "Invalid_string_refer_to_original_code" Then
					IsAlly = True
				Else
					IsAlly = False
				End If
			Case Else
				If Party = t.Party Then
					IsAlly = True
				Else
					IsAlly = False
				End If
		End Select
	End Function
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Sub LoadUnit(ByRef u As Unit)
		colUnitOnBoard.Add(u, u.ID)
	End Sub
	
	'謳ｭ霈峨＠縺溘Θ繝九ャ繝医ｒ蜑企勁
	Public Sub UnloadUnit(ByRef Index As Object)
		Dim i As Short
		
		On Error GoTo ErrorHandler
		colUnitOnBoard.Remove(Index)
		Exit Sub
		
ErrorHandler: 
		For i = 1 To colUnitOnBoard.Count()
			'UPGRADE_WARNING: オブジェクト colUnitOnBoard(i).Name の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			If colUnitOnBoard.Item(i).Name = Index Then
				colUnitOnBoard.Remove(i)
				Exit Sub
			End If
		Next 
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function CountUnitOnBoard() As Short
		CountUnitOnBoard = colUnitOnBoard.Count()
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function UnitOnBoard(ByRef Index As Object) As Unit
		Dim u As Unit
		
		On Error GoTo ErrorHandler
		UnitOnBoard = colUnitOnBoard.Item(Index)
		Exit Function
		
ErrorHandler: 
		For	Each u In colUnitOnBoard
			'UPGRADE_WARNING: オブジェクト Index の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			If u.Name = Index Then
				UnitOnBoard = u
				Exit Function
			End If
		Next u
	End Function
	
	
	'Invalid_string_refer_to_original_code
	
	'蜿ｬ蝟壹Θ繝九ャ繝医ｒ霑ｽ蜉
	Public Sub AddServant(ByRef u As Unit)
		'Invalid_string_refer_to_original_code
		If Not Servant((u.ID)) Is Nothing Then
			Exit Sub
		End If
		
		colServant.Add(u, u.ID)
	End Sub
	
	'蜿ｬ蝟壹Θ繝九ャ繝医ｒ蜑企勁
	Public Sub DeleteServant(ByRef Index As Object)
		Dim i As Short
		
		On Error GoTo ErrorHandler
		colServant.Remove(Index)
		Exit Sub
		
ErrorHandler: 
		For i = 1 To colServant.Count()
			'UPGRADE_WARNING: オブジェクト colServant(i).Name の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			If colServant.Item(i).Name = Index Then
				colServant.Remove(i)
				Exit Sub
			End If
		Next 
	End Sub
	
	'蜿ｬ蝟壹Θ繝九ャ繝育ｷ乗焚
	Public Function CountServant() As Short
		CountServant = colServant.Count()
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Servant(ByRef Index As Object) As Unit
		Dim u As Unit
		
		On Error GoTo ErrorHandler
		Servant = colServant.Item(Index)
		Exit Function
		
ErrorHandler: 
		For	Each u In colServant
			'UPGRADE_WARNING: オブジェクト Index の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			If u.Name = Index Then
				Servant = u
				Exit Function
			End If
		Next u
	End Function
	
	'蜿ｬ蝟壹Θ繝九ャ繝医ｒ隗｣謾ｾ縺吶ｋ
	Public Sub DismissServant()
		Dim i, j As Short
		Dim uname As String
		
		For i = 1 To CountServant
			With Servant(1).CurrentForm
				Select Case .Status_Renamed
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						.Escape()
						.Status_Renamed = "Invalid_string_refer_to_original_code"
					Case "Invalid_string_refer_to_original_code"
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						For j = 1 To .CountFeature
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							uname = LIndex(.FeatureData(j), 2)
							If UList.IsDefined(uname) Then
								UList.Item(uname).CurrentForm.Split_Renamed()
							End If
							'End If
						Next 
						With .CurrentForm
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							.Escape()
							.Status_Renamed = "Invalid_string_refer_to_original_code"
							'End If
						End With
				End Select
			End With
			DeleteServant(1)
		Next 
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	
	'髫ｷ螻槭Θ繝九ャ繝医ｒ霑ｽ蜉
	Public Sub AddSlave(ByRef u As Unit)
		colSlave.Add(u, u.ID)
	End Sub
	
	'髫ｷ螻槭Θ繝九ャ繝医ｒ蜑企勁
	Public Sub DeleteSlave(ByRef Index As Object)
		Dim i As Short
		
		On Error GoTo ErrorHandler
		colSlave.Remove(Index)
		Exit Sub
		
ErrorHandler: 
		For i = 1 To colSlave.Count()
			'UPGRADE_WARNING: オブジェクト colSlave(i).Name の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			If colSlave.Item(i).Name = Index Then
				colSlave.Remove(i)
				Exit Sub
			End If
		Next 
	End Sub
	
	'髫ｷ螻槭Θ繝九ャ繝育ｷ乗焚
	Public Function CountSlave() As Short
		CountSlave = colSlave.Count()
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function Slave(ByRef Index As Object) As Unit
		Dim u As Unit
		
		On Error GoTo ErrorHandler
		Slave = colSlave.Item(Index)
		Exit Function
		
ErrorHandler: 
		For	Each u In colSlave
			'UPGRADE_WARNING: オブジェクト Index の既定プロパティを解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"' をクリックしてください。
			If u.Name = Index Then
				Slave = u
				Exit Function
			End If
		Next u
	End Function
	
	'髫ｷ螻槭Θ繝九ャ繝医ｒ隗｣謾ｾ縺吶ｋ
	Public Sub DismissSlave()
		Dim i As Short
		
		For i = 1 To CountSlave
			With Slave(1).CurrentForm
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If .Master.CurrentForm Is Me Then
					.DeleteCondition("Invalid_string_refer_to_original_code")
					'UPGRADE_NOTE: オブジェクト Slave().CurrentForm.Master をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
					.Master = Nothing
				End If
				'End If
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If .Master.CurrentForm Is Me Then
					.DeleteCondition("Invalid_string_refer_to_original_code")
					'UPGRADE_NOTE: オブジェクト Slave().CurrentForm.Master をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
					.Master = Nothing
				End If
				'End If
			End With
			DeleteSlave(1)
		Next 
	End Sub
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Sub Dump()
		Dim cnd As Condition
		Dim i As Short
		
		WriteLine(SaveDataFileNumber, Name, ID, Party0)
		WriteLine(SaveDataFileNumber, Rank, BossRank, x, y)
		WriteLine(SaveDataFileNumber, Area, UsedAction, Mode, Status_Renamed)
		
		If Not Master Is Nothing Then
			WriteLine(SaveDataFileNumber, Master.ID)
		Else
			WriteLine(SaveDataFileNumber, "-")
		End If
		If Not Summoner Is Nothing Then
			WriteLine(SaveDataFileNumber, Summoner.ID)
		Else
			WriteLine(SaveDataFileNumber, "-")
		End If
		
		WriteLine(SaveDataFileNumber, UsedSupportAttack, UsedSupportGuard)
		WriteLine(SaveDataFileNumber, UsedSyncAttack, UsedCounterAttack)
		
		WriteLine(SaveDataFileNumber, CountOtherForm)
		For i = 1 To CountOtherForm
			WriteLine(SaveDataFileNumber, OtherForm(i).ID)
		Next 
		
		WriteLine(SaveDataFileNumber, CountUnitOnBoard)
		For i = 1 To CountUnitOnBoard
			WriteLine(SaveDataFileNumber, UnitOnBoard(i).ID)
		Next 
		
		WriteLine(SaveDataFileNumber, CountPilot)
		For i = 1 To CountPilot
			WriteLine(SaveDataFileNumber, Pilot(i).ID)
		Next 
		
		WriteLine(SaveDataFileNumber, CountSupport)
		For i = 1 To CountSupport
			WriteLine(SaveDataFileNumber, Support(i).ID)
		Next 
		
		If AdditionalSupport Is Nothing Then
			WriteLine(SaveDataFileNumber, "")
		Else
			WriteLine(SaveDataFileNumber, AdditionalSupport.ID)
		End If
		
		WriteLine(SaveDataFileNumber, CountServant)
		For i = 1 To CountServant
			WriteLine(SaveDataFileNumber, Servant(i).ID)
		Next 
		
		WriteLine(SaveDataFileNumber, CountItem)
		For i = 1 To CountItem
			WriteLine(SaveDataFileNumber, Item(i).ID)
		Next 
		
		WriteLine(SaveDataFileNumber, colSpecialPowerInEffect.Count())
		For	Each cnd In colSpecialPowerInEffect
			With cnd
				WriteLine(SaveDataFileNumber, .Name, .StrData)
			End With
		Next cnd
		
		WriteLine(SaveDataFileNumber, colCondition.Count())
		For	Each cnd In colCondition
			With cnd
				WriteLine(SaveDataFileNumber, .Name, .Lifetime, .Level, .StrData)
			End With
		Next cnd
		
		WriteLine(SaveDataFileNumber, CountWeapon)
		For i = 1 To CountWeapon
			WriteLine(SaveDataFileNumber, Bullet(i))
		Next 
		
		WriteLine(SaveDataFileNumber, CountAbility)
		For i = 1 To CountAbility
			WriteLine(SaveDataFileNumber, Stock(i))
		Next 
		
		WriteLine(SaveDataFileNumber, HP, EN)
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub Restore()
		Dim sbuf As String
		Dim ibuf As Short
		Dim lbuf As Integer
		'UPGRADE_NOTE: ctype は ctype_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
		Dim ctype_Renamed, cdata As String
		Dim cltime As Short
		Dim clevel As Double
		Dim num, i, ret As Short
		
		'Name, ID, Party
		Input(SaveDataFileNumber, sbuf)
		strName = sbuf
		Data = UDList.Item(sbuf)
		Input(SaveDataFileNumber, sbuf)
		ID = sbuf
		Input(SaveDataFileNumber, sbuf)
		strParty = sbuf
		
		'Rank, BossRank, X, Y
		Input(SaveDataFileNumber, ibuf)
		intRank = ibuf
		Input(SaveDataFileNumber, ibuf)
		intBossRank = ibuf
		Input(SaveDataFileNumber, ibuf)
		x = ibuf
		Input(SaveDataFileNumber, ibuf)
		y = ibuf
		
		'Area, Action, Mode, Status
		Input(SaveDataFileNumber, sbuf)
		Area = sbuf
		Input(SaveDataFileNumber, ibuf)
		UsedAction = ibuf
		Input(SaveDataFileNumber, sbuf)
		strMode = sbuf
		Input(SaveDataFileNumber, sbuf)
		Status_Renamed = sbuf
		
		'Master, Summoner
		Input(SaveDataFileNumber, sbuf)
		Input(SaveDataFileNumber, sbuf)
		
		'UsedSupportAttack, UsedSupportGuard
		Input(SaveDataFileNumber, ibuf)
		UsedSupportAttack = ibuf
		Input(SaveDataFileNumber, ibuf)
		UsedSupportGuard = ibuf
		
		'UsedSyncAttack, UsedCounterAttack
		Input(SaveDataFileNumber, ibuf)
		UsedSyncAttack = ibuf
		Input(SaveDataFileNumber, ibuf)
		UsedCounterAttack = ibuf
		
		'OtherForm
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'UnitOnBoard
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Pilot
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			Input(SaveDataFileNumber, sbuf)
			AddPilot(PList.Item(sbuf))
		Next 
		
		'Support
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			Input(SaveDataFileNumber, sbuf)
			AddSupport(PList.Item(sbuf))
		Next 
		
		'AdditionalSupport
		If SaveDataVersion >= 20210 Then
			Input(SaveDataFileNumber, sbuf)
			If sbuf <> "" Then
				pltAdditionalSupport = PList.Item(sbuf)
				pltAdditionalSupport.Unit_Renamed = Me
				pltAdditionalSupport.IsAdditionalSupport = True
			End If
		End If
		
		'Servant
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Item
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'SpecialPowerInEffect
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			Input(SaveDataFileNumber, ctype_Renamed)
			Input(SaveDataFileNumber, cdata)
			MakeSpecialPowerInEffect(ctype_Renamed, cdata)
		Next 
		
		'Condition
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
			
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code
			
			ret = InStr(sbuf, ",")
			ctype_Renamed = Left(sbuf, ret - 1)
			If Left(ctype_Renamed, 1) = """" Then
				ctype_Renamed = Mid(ctype_Renamed, 2, Len(ctype_Renamed) - 2)
			End If
			sbuf = Mid(sbuf, ret + 1)
			
			ret = InStr(sbuf, ",")
			cltime = StrToLng(Left(sbuf, ret - 1))
			sbuf = Mid(sbuf, ret + 1)
			
			ret = InStr(sbuf, ",")
			clevel = StrToLng(Left(sbuf, ret - 1))
			sbuf = Mid(sbuf, ret + 1)
			
			cdata = sbuf
			If Left(cdata, 1) = """" Then
				cdata = Mid(cdata, 2, Len(cdata) - 2)
			End If
			
			If SaveDataVersion < 10741 Then
				If InStr(cdata, "Invalid_string_refer_to_original_code") > 0 Then
					GoTo NextCondition
				End If
				If InStr(cdata, "Invalid_string_refer_to_original_code") > 0 Then
					GoTo NextCondition
				End If
			End If
			
			AddCondition(ctype_Renamed, cltime, clevel, cdata)
NextCondition: 
		Next 
		
		'Weapon
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Ability
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'HP, EN
		Input(SaveDataFileNumber, lbuf)
		Input(SaveDataFileNumber, ibuf)
		HP = lbuf
		EN = ibuf
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub RestoreLinkInfo()
		Dim sbuf As String
		Dim ibuf As Short
		Dim lbuf As Integer
		Dim dbuf As Double
		Dim i, num As Short
		Dim itm As Item
		
		'Name, ID, Party
		sbuf = LineInput(SaveDataFileNumber)
		
		'Rank, BossRank, X, Y
		sbuf = LineInput(SaveDataFileNumber)
		
		'Area, Action, Mode, Status
		sbuf = LineInput(SaveDataFileNumber)
		
		'Master, Summoner
		Input(SaveDataFileNumber, sbuf)
		Master = UList.Item(sbuf)
		Input(SaveDataFileNumber, sbuf)
		Summoner = UList.Item(sbuf)
		
		'SupportAttackStock, SupportGuardStock
		sbuf = LineInput(SaveDataFileNumber)
		'UsedSyncAttack, UsedCounterAttack
		sbuf = LineInput(SaveDataFileNumber)
		
		'OtherForm
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			Input(SaveDataFileNumber, sbuf)
			AddOtherForm(UList.Item(sbuf))
		Next 
		
		'UnitOnBoard
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			Input(SaveDataFileNumber, sbuf)
			LoadUnit(UList.Item(sbuf))
		Next 
		
		'Pilot
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Support
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'AdditionalSupport
		If SaveDataVersion >= 20210 Then
			sbuf = LineInput(SaveDataFileNumber)
		End If
		
		'Servant
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			Input(SaveDataFileNumber, sbuf)
			AddServant(UList.Item(sbuf))
		Next 
		
		'Item
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			Input(SaveDataFileNumber, sbuf)
			AddItem0(IList.Item(sbuf))
		Next 
		
		'SpecialPowerInEffect
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Condition
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		Update(True)
		
		'Weapon
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			Input(SaveDataFileNumber, ibuf)
			If i <= CountWeapon() Then
				SetBullet(i, ibuf)
			End If
		Next 
		
		'Ability
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			Input(SaveDataFileNumber, ibuf)
			If i <= CountAbility() Then
				SetStock(i, ibuf)
			End If
		Next 
		
		'HP, EN
		Input(SaveDataFileNumber, lbuf)
		Input(SaveDataFileNumber, ibuf)
		HP = lbuf
		EN = ibuf
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Sub RestoreParameter()
		Dim sbuf As String
		Dim ibuf As Short
		Dim lbuf As Integer
		Dim dbuf As Double
		Dim i, num As Short
		
		'Name, ID, Party
		sbuf = LineInput(SaveDataFileNumber)
		
		'Rank, BossRank, X, Y
		sbuf = LineInput(SaveDataFileNumber)
		
		'Area, Action, Mode, Status
		sbuf = LineInput(SaveDataFileNumber)
		
		'Master
		sbuf = LineInput(SaveDataFileNumber)
		'Summoner
		sbuf = LineInput(SaveDataFileNumber)
		
		'SupportAttackStock, SupportGuardStock
		sbuf = LineInput(SaveDataFileNumber)
		'UsedSyncAttack, UsedCounterAttack
		sbuf = LineInput(SaveDataFileNumber)
		
		'OtherForm
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'UnitOnBoard
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Pilot
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Support
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'AdditionalSupport
		If SaveDataVersion >= 20210 Then
			sbuf = LineInput(SaveDataFileNumber)
		End If
		
		'Servant
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Item
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'SpecialPowerInEffect
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Condition
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Weapon
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'Ability
		Input(SaveDataFileNumber, num)
		For i = 1 To num
			sbuf = LineInput(SaveDataFileNumber)
		Next 
		
		'HP, EN
		Input(SaveDataFileNumber, lbuf)
		Input(SaveDataFileNumber, ibuf)
		HP = lbuf
		EN = ibuf
		
		Update()
	End Sub
	
	
	'Invalid_string_refer_to_original_code
	
	'Invalid_string_refer_to_original_code
	Public Function IsOperational() As Boolean
		Dim i As Short
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		IsOperational = True
		Exit Function
		'End If
		
		For i = 1 To CountOtherForm
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			IsOperational = True
			Exit Function
			'End If
		Next 
		
		IsOperational = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsEqual(ByVal nm As String) As Boolean
		Dim i As Short
		
		If Name = nm Then
			IsEqual = True
			Exit Function
		End If
		
		For i = 1 To CountOtherForm
			If OtherForm(i).Name = nm Then
				IsEqual = True
				Exit Function
			End If
		Next 
		
		IsEqual = False
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function CurrentForm() As Unit
		Dim i As Short
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		For i = 1 To CountOtherForm
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			CurrentForm = OtherForm(i)
			Exit Function
			'End If
		Next 
		'End If
		
		CurrentForm = Me
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsHero() As Boolean
		With Data
			If Left(.Class_Renamed, 1) = "(" Then
				IsHero = True
			Else
				IsHero = False
			End If
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function LookForAttackHelp(ByVal tx As Short, ByVal ty As Short) As Unit
		Dim u As Unit
		Dim i As Short
		
		For i = 1 To 4
			'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			u = Nothing
			Select Case i
				Case 1
					If tx > 1 Then
						u = MapDataForUnit(tx - 1, ty)
					End If
				Case 2
					If tx < MapWidth Then
						u = MapDataForUnit(tx + 1, ty)
					End If
				Case 3
					If ty > 1 Then
						u = MapDataForUnit(tx, ty - 1)
					End If
				Case 4
					If ty < MapHeight Then
						u = MapDataForUnit(tx, ty + 1)
					End If
			End Select
			
			'Invalid_string_refer_to_original_code
			If u Is Nothing Then
				GoTo NextLoop
			End If
			
			'Invalid_string_refer_to_original_code
			If IsEnemy(u) Then
				GoTo NextLoop
			End If
			
			With u
				'Invalid_string_refer_to_original_code
				If Dice(10) > .MainPilot.Relation(MainPilot) Then
					GoTo NextLoop
				End If
				
				'Invalid_string_refer_to_original_code
				If .MaxAction = 0 Then
					GoTo NextLoop
				End If
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Or .IsConditionSatisfied("迢よ姶螢ｫ") _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				GoTo NextLoop
				'End If
				
				'Invalid_string_refer_to_original_code
				If Not IsMessageDefined("Invalid_string_refer_to_original_code" & .MainPilot.Name & ")", True) And Not IsMessageDefined("Invalid_string_refer_to_original_code" & .MainPilot.Nickname & ")", True) Then
					GoTo NextLoop
				End If
			End With
			
			'Invalid_string_refer_to_original_code
			LookForAttackHelp = u
			Exit Function
NextLoop: 
		Next 
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_NOTE: オブジェクト LookForAttackHelp をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		LookForAttackHelp = Nothing
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function LookForGuardHelp(ByRef t As Unit, ByVal tw As Short, ByVal is_critical As Boolean) As Unit
		Dim u As Unit
		Dim i As Short
		Dim dmg As Integer
		Dim ratio As Double
		Dim ux, uy As Short
		Dim uarea As String
		
		For i = 1 To 4
			'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			u = Nothing
			Select Case i
				Case 1
					If x > 1 Then
						u = MapDataForUnit(x - 1, y)
					End If
				Case 2
					If x < MapWidth Then
						u = MapDataForUnit(x + 1, y)
					End If
				Case 3
					If y > 1 Then
						u = MapDataForUnit(x, y - 1)
					End If
				Case 4
					If y < MapHeight Then
						u = MapDataForUnit(x, y + 1)
					End If
			End Select
			
			'Invalid_string_refer_to_original_code
			If u Is Nothing Then
				GoTo NextLoop
			End If
			
			'Invalid_string_refer_to_original_code
			If IsEnemy(u) Then
				GoTo NextLoop
			End If
			
			With u
				'Invalid_string_refer_to_original_code
				If Dice(10) > .MainPilot.Relation(MainPilot) Then
					GoTo NextLoop
				End If
				
				'Invalid_string_refer_to_original_code
				If .MaxAction = 0 Then
					GoTo NextLoop
				End If
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Or .IsConditionSatisfied("迢よ姶螢ｫ") _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				GoTo NextLoop
				'End If
				
				'Invalid_string_refer_to_original_code
				If Not .IsMessageDefined("Invalid_string_refer_to_original_code" & MainPilot.Name & ")", True) And Not .IsMessageDefined("Invalid_string_refer_to_original_code" & MainPilot.Nickname & ")", True) Then
					GoTo NextLoop
				End If
				
				'Invalid_string_refer_to_original_code
				If Area <> .Area Then
					Select Case Area
						Case "遨ｺ荳ｭ"
							If .Adaption(1) = 0 Then
								GoTo NextLoop
							End If
						Case "Invalid_string_refer_to_original_code"
							If .Adaption(2) = 0 Then
								GoTo NextLoop
							End If
						Case "豌ｴ荳ｭ", "Invalid_string_refer_to_original_code"
							If .Adaption(3) = 0 Then
								GoTo NextLoop
							End If
						Case "Invalid_string_refer_to_original_code"
							If TerrainClass(x, y) = "譛磯擇" Then
								'Invalid_string_refer_to_original_code_
								'Then
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								GoTo NextLoop
							End If
					End Select
				ElseIf .Adaption(4) = 0 Then 
					GoTo NextLoop
				End If
				'End Select
				'End If
				
				'Invalid_string_refer_to_original_code
				If .IsFeatureAvailable("髦ｲ蠕｡荳榊庄") Or t.IsWeaponClassifiedAs(tw, "谿ｺ") Then
					ratio = 1#
				Else
					ratio = 0.5
				End If
				If is_critical Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					ratio = 1.2 * ratio
				Else
					ratio = 1.5 * ratio
				End If
				'End If
				ux = .x
				uy = .y
				uarea = .Area
				.x = x
				.y = y
				.Area = Area
				dmg = t.ExpDamage(tw, u, True, ratio)
				.x = ux
				.y = uy
				.Area = uarea
				
				'Invalid_string_refer_to_original_code
				If dmg >= .HP Then
					GoTo NextLoop
				End If
			End With
			
			'Invalid_string_refer_to_original_code
			LookForGuardHelp = u
			Exit Function
NextLoop: 
		Next 
		
		'Invalid_string_refer_to_original_code
		'UPGRADE_NOTE: オブジェクト LookForGuardHelp をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
		LookForGuardHelp = Nothing
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function MaxSupportAttack() As Short
		With MainPilot
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function MaxSupportGuard() As Short
		With MainPilot
			MaxSupportGuard = MaxLng(.SkillLevel("謠ｴ隴ｷ髦ｲ蠕｡"), .SkillLevel("謠ｴ隴ｷ"))
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function MaxSyncAttack() As Short
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function MaxCounterAttack() As Short
		With MainPilot
			MaxCounterAttack = .SkillLevel("繧ｫ繧ｦ繝ｳ繧ｿ繝ｼ")
			
			If .IsSkillAvailable("Invalid_string_refer_to_original_code") Then
				If LLength(.SkillData("Invalid_string_refer_to_original_code")) = 2 Then
					If .Morale >= StrToLng(LIndex(.SkillData("Invalid_string_refer_to_original_code"), 2)) Then
						MaxCounterAttack = 1000
					End If
				Else
					If .Morale >= 120 Then
						MaxCounterAttack = 1000
					End If
				End If
			End If
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function LookForSupportAttack(ByRef t As Unit) As Unit
		Dim u As Unit
		Dim i, w As Short
		Dim max_wpower As Integer
		Dim team, uteam As String
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("豺ｷ荵ｱ") Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Not t Is Nothing Then
			If Party = t.Party Then
				Exit Function
			End If
		End If
		
		team = MainPilot.SkillData("Invalid_string_refer_to_original_code")
		
		max_wpower = -1
		For i = 1 To 4
			'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			u = Nothing
			Select Case i
				Case 1
					If x > 1 Then
						u = MapDataForUnit(x - 1, y)
					End If
				Case 2
					If x < MapWidth Then
						u = MapDataForUnit(x + 1, y)
					End If
				Case 3
					If y > 1 Then
						u = MapDataForUnit(x, y - 1)
					End If
				Case 4
					If y < MapHeight Then
						u = MapDataForUnit(x, y + 1)
					End If
			End Select
			
			If u Is Nothing Then
				GoTo NextUnit
			End If
			
			With u
				'Invalid_string_refer_to_original_code
				If .MaxSupportAttack <= .UsedSupportAttack Then
					GoTo NextUnit
				End If
				
				'Invalid_string_refer_to_original_code
				If .Action = 0 Then
					GoTo NextUnit
				End If
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Or .IsConditionSatisfied("迢よ姶螢ｫ") _
				'Or .IsConditionSatisfied("雕翫ｊ") _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				GoTo NextUnit
				'End If
				
				'Invalid_string_refer_to_original_code
				Select Case .Party
					Case "Invalid_string_refer_to_original_code"
						Select Case Party
							Case "謨ｵ", "Invalid_string_refer_to_original_code"
								GoTo NextUnit
						End Select
					Case Else
						If .Party <> Party Then
							GoTo NextUnit
						End If
				End Select
				
				'Invalid_string_refer_to_original_code
				uteam = .MainPilot.SkillData("Invalid_string_refer_to_original_code")
				If team <> uteam And uteam <> "" Then
					GoTo NextUnit
				End If
				
				'Invalid_string_refer_to_original_code
				If t Is Nothing Then
					LookForSupportAttack = u
					Exit Function
				End If
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				w = .CountWeapon
				Do While w > 0
					'Invalid_string_refer_to_original_code
					If .WeaponPower(w, (t.Area)) <= max_wpower Then
						GoTo NextWeapon
					End If
					
					'Invalid_string_refer_to_original_code
					If .IsWeaponClassifiedAs(w, "Invalid_string_refer_to_original_code") Then
						GoTo NextWeapon
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					GoTo NextWeapon
					'End If
					If Not .IsWeaponAvailable(w, "遘ｻ蜍募燕") Then
						GoTo NextWeapon
					End If
					If Not .IsTargetWithinRange(w, t) Then
						GoTo NextWeapon
					End If
					
					If .Party = "蜻ｳ譁ｹ" And .Party0 = "蜻ｳ譁ｹ" Then
						'Invalid_string_refer_to_original_code
						If .IsWeaponClassifiedAs(w, "閾ｪ") Then
							GoTo NextWeapon
						End If
						
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: Control mnuMapCommandItem は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
						If MainForm.mnuMapCommandItem(AutoDefenseCmdID).Checked Then
							If Not .IsWeaponClassifiedAs(w, "豌ｸ") Then
								If .Bullet(w) = 1 Or .MaxBullet(w) = 2 Or .MaxBullet(w) = 3 Then
									GoTo NextWeapon
								End If
							End If
							If .WeaponENConsumption(w) > 0 Then
								If .WeaponENConsumption(w) >= .EN \ 2 Or .WeaponENConsumption(w) >= .MaxEN \ 4 Then
									GoTo NextWeapon
								End If
							End If
							If .IsWeaponClassifiedAs(w, "蟆ｽ") Then
								GoTo NextWeapon
							End If
						End If
					End If
					
					'Invalid_string_refer_to_original_code
					max_wpower = .WeaponPower(w, (t.Area))
					LookForSupportAttack = u
					
NextWeapon: 
					w = w - 1
				Loop 
			End With
NextUnit: 
		Next 
	End Function
	
	'Invalid_string_refer_to_original_code
	'Invalid_string_refer_to_original_code
	Public Function LookForSupportGuard(ByRef t As Unit, ByVal tw As Short) As Unit
		Dim u As Unit
		Dim i As Short
		Dim my_dmg, dmg As Integer
		Dim ratio As Double
		Dim ux, uy As Short
		Dim uarea As String
		Dim team, uteam As String
		
		'Invalid_string_refer_to_original_code
		If t.IsWeaponClassifiedAs(tw, "Invalid_string_refer_to_original_code") Then
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		Exit Function
		'End If
		
		'Invalid_string_refer_to_original_code
		If Party = t.Party Or (Party = "Invalid_string_refer_to_original_code" And t.Party = "蜻ｳ譁ｹ") Then
			If Party <> Party0 Then
				Exit Function
			End If
			If IsConditionSatisfied("證ｴ襍ｰ") Then
				Exit Function
			End If
		End If
		
		'Invalid_string_refer_to_original_code
		my_dmg = t.ExpDamage(tw, Me, True)
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: Control mnuMapCommandItem は、汎用名前空間 Form 内にあるため、解決できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="084D22AD-ECB1-400F-B4C7-418ECEC5E36E"' をクリックしてください。
		If Party <> "蜻ｳ譁ｹ" Or MainForm.mnuMapCommandItem(AutoDefenseCmdID).Checked Then
			If t.IsNormalWeapon(tw) Then
				If my_dmg < MaxHP \ 20 And my_dmg < HP \ 5 Then
					Exit Function
				End If
			Else
				If t.CriticalProbability(tw, Me) > 0 Then
					Exit Function
				End If
			End If
		End If
		
		team = MainPilot.SkillData("Invalid_string_refer_to_original_code")
		
		For i = 1 To 4
			'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			u = Nothing
			Select Case i
				Case 1
					If x > 1 Then
						u = MapDataForUnit(x - 1, y)
					End If
				Case 2
					If x < MapWidth Then
						u = MapDataForUnit(x + 1, y)
					End If
				Case 3
					If y > 1 Then
						u = MapDataForUnit(x, y - 1)
					End If
				Case 4
					If y < MapHeight Then
						u = MapDataForUnit(x, y + 1)
					End If
			End Select
			
			If u Is Nothing Then
				GoTo NextUnit
			End If
			If u Is t Then
				GoTo NextUnit
			End If
			
			With u
				'Invalid_string_refer_to_original_code
				If .MaxSupportGuard <= .UsedSupportGuard Then
					GoTo NextUnit
				End If
				
				'Invalid_string_refer_to_original_code
				If .MaxAction = 0 Then
					GoTo NextUnit
				End If
				
				'Invalid_string_refer_to_original_code
				If .IsUnderSpecialPowerEffect("Invalid_string_refer_to_original_code") Then
					GoTo NextUnit
				End If
				
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Or .IsConditionSatisfied("迢よ姶螢ｫ") _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				GoTo NextUnit
				'End If
				
				'Invalid_string_refer_to_original_code
				If Not LookForSupportGuard Is Nothing Then
					If LookForSupportGuard.HP >= .HP Then
						GoTo NextUnit
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				Select Case .Party
					Case "蜻ｳ譁ｹ"
						If IsOptionDefined("Invalid_string_refer_to_original_code") Then
							If .Party <> Party Then
								GoTo NextUnit
							End If
						Else
							Select Case Party
								Case "謨ｵ", "Invalid_string_refer_to_original_code"
									GoTo NextUnit
							End Select
						End If
					Case "Invalid_string_refer_to_original_code"
						Select Case Party
							Case "謨ｵ", "Invalid_string_refer_to_original_code"
								GoTo NextUnit
						End Select
					Case Else
						If .Party <> Party Then
							GoTo NextUnit
						End If
				End Select
				
				'Invalid_string_refer_to_original_code
				uteam = .MainPilot.SkillData("Invalid_string_refer_to_original_code")
				If team <> uteam And uteam <> "" Then
					GoTo NextUnit
				End If
				
				'Invalid_string_refer_to_original_code
				If Area <> .Area Then
					Select Case Area
						Case "遨ｺ荳ｭ"
							If Not .IsTransAvailable("遨ｺ") Then
								GoTo NextUnit
							End If
						Case "Invalid_string_refer_to_original_code"
							If .Adaption(2) = 0 Then
								GoTo NextUnit
							End If
						Case "豌ｴ荳ｭ", "Invalid_string_refer_to_original_code"
							If .Adaption(3) = 0 Then
								GoTo NextUnit
							End If
						Case "Invalid_string_refer_to_original_code"
							If .Adaption(4) = 0 Then
								GoTo NextUnit
							End If
					End Select
				End If
				
				'Invalid_string_refer_to_original_code
				If MainPilot.Personality = "讖滓｢ｰ" Then
					If .MainPilot.Personality <> "讖滓｢ｰ" Then
						GoTo NextUnit
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				If .IsFeatureAvailable("髦ｲ蠕｡荳榊庄") Or t.IsWeaponClassifiedAs(tw, "谿ｺ") Then
					ratio = 1#
				Else
					ratio = 0.5
				End If
				If t.IsNormalWeapon(tw) Then
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					ratio = 1.2 * ratio
				Else
					ratio = 1.5 * ratio
				End If
				'End If
				ux = .x
				uy = .y
				uarea = .Area
				.x = x
				.y = y
				.Area = Area
				dmg = t.ExpDamage(tw, u, True, ratio)
				.x = ux
				.y = uy
				.Area = uarea
				
				'Invalid_string_refer_to_original_code
				If .BossRank > BossRank Then
					'Invalid_string_refer_to_original_code
					If dmg >= .MaxHP \ 20 Or dmg >= .HP \ 5 Then
						GoTo NextUnit
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				If dmg >= .HP Then
					'繝懊せ縺ｯ萓句､問ｦ窶ｦ
					If .BossRank >= BossRank Then
						GoTo NextUnit
					End If
				End If
			End With
			
			LookForSupportGuard = u
NextUnit: 
		Next 
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function LookForSupport(ByVal tx As Short, ByVal ty As Short, Optional ByVal for_attack As Boolean = False) As Short
		Dim u As Unit
		Dim i As Short
		Dim do_support As Boolean
		Dim team, uteam As String
		
		With MainPilot
			'Invalid_string_refer_to_original_code
			'Invalid_string_refer_to_original_code_
			'Or .IsSkillAvailable("謠ｴ隴ｷ髦ｲ蠕｡") _
			'Invalid_string_refer_to_original_code_
			'Invalid_string_refer_to_original_code_
			'Then
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			do_support = True
			'End If
			
			team = .SkillData("Invalid_string_refer_to_original_code")
		End With
		
		For i = 1 To 4
			'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
			u = Nothing
			Select Case i
				Case 1
					If tx > 1 Then
						u = MapDataForUnit(tx - 1, ty)
					End If
				Case 2
					If tx < MapWidth Then
						u = MapDataForUnit(tx + 1, ty)
					End If
				Case 3
					If ty > 1 Then
						u = MapDataForUnit(tx, ty - 1)
					End If
				Case 4
					If ty < MapHeight Then
						u = MapDataForUnit(tx, ty + 1)
					End If
			End Select
			
			If u Is Nothing Then
				GoTo NextUnit
			End If
			If u Is Me Then
				GoTo NextUnit
			End If
			
			With u
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code_
				'Or .IsConditionSatisfied("迢よ姶螢ｫ") _
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				GoTo NextUnit
				'End If
				
				'Invalid_string_refer_to_original_code
				If IsEnemy(u) Or .IsEnemy(Me) Then
					GoTo NextUnit
				End If
				
				'Invalid_string_refer_to_original_code
				uteam = .MainPilot.SkillData("Invalid_string_refer_to_original_code")
				If team <> uteam And team <> "" And uteam <> "" Then
					GoTo NextUnit
				End If
				
				'Invalid_string_refer_to_original_code
				If Not for_attack Then
					If .Action > 0 Then
						GoTo NextUnit
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				If do_support Then
					LookForSupport = LookForSupport + 1
				End If
				
				'Invalid_string_refer_to_original_code
				With .MainPilot
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					LookForSupport = LookForSupport + 1
					'Invalid_string_refer_to_original_code
					If for_attack Then
						If u.Action > 0 Then
							LookForSupport = LookForSupport + 1
							'Invalid_string_refer_to_original_code
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							LookForSupport = LookForSupport + 1
						End If
					End If
					'End If
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					LookForSupport = LookForSupport + 1
					'End If
				End With
			End With
NextUnit: 
		Next 
	End Function
	
	'Invalid_string_refer_to_original_code
	'UPGRADE_NOTE: ctype は ctype_Renamed にアップグレードされました。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"' をクリックしてください。
	Public Sub CombinationPartner(ByRef ctype_Renamed As String, ByVal w As Short, ByRef partners() As Unit, Optional ByVal tx As Short = 0, Optional ByVal ty As Short = 0, Optional ByVal check_formation As Boolean = False)
		Dim u As Unit
		Dim uname As String
		Dim j, i, k As Short
		Dim clevel, cnum As Short
		Dim clist As String
		Dim cname As String
		Dim cmorale, cen, cplana As Short
		Dim crange, loop_limit As Short
		
		'Invalid_string_refer_to_original_code
		If IsConditionSatisfied("豺ｷ荵ｱ") Then
			ReDim partners(0)
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		cname = Weapon(w).Name
		cen = WeaponENConsumption(w)
		cmorale = Weapon(w).NecessaryMorale
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		crange = WeaponMaxRange(w)
		cname = Ability(w).Name
		cen = AbilityENConsumption(w)
		cmorale = Ability(w).NecessaryMorale
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'End If
		crange = AbilityMaxRange(w)
		'End If
		
		'Invalid_string_refer_to_original_code
		For i = 1 To CountFeature
			If Feature(i) = "蜷井ｽ捺橿" Then
				If LIndex(FeatureData(i), 1) = cname Then
					If IsFeatureLevelSpecified(i) Then
						clevel = FeatureLevel(i)
					Else
						clevel = 0
					End If
					clist = ListTail(FeatureData(i), 2)
					cnum = LLength(clist)
					Exit For
				End If
			End If
		Next 
		If i > CountFeature Then
			ReDim partners(0)
			Exit Sub
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		For i = 1 To cnum
			uname = LIndex(clist, i)
			
			'Invalid_string_refer_to_original_code
			If UList.IsDefined(uname) Then
				With UList.Item(uname)
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					GoTo NextPartner
				End With
			End If
			'End With
			'End If
			
			'Invalid_string_refer_to_original_code
			If PList.IsDefined(uname) Then
				If Not PList.Item(uname).Unit_Renamed Is Nothing Then
					With PList.Item(uname).Unit_Renamed
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						GoTo NextPartner
					End With
				End If
				'End With
			End If
			'End If
			
			'Invalid_string_refer_to_original_code
			ReDim partners(0)
			Exit Sub
NextPartner: 
		Next 
		'Invalid_string_refer_to_original_code
		ReDim partners(cnum)
		Exit Sub
		'End If
		
		'Invalid_string_refer_to_original_code
		If tx = 0 Then
			tx = x
		End If
		If ty = 0 Then
			ty = y
		End If
		
		'Invalid_string_refer_to_original_code
		
		If crange = 1 Then
			If cnum >= 8 Then
				'Invalid_string_refer_to_original_code
				loop_limit = 12
			ElseIf cnum >= 4 Then 
				'Invalid_string_refer_to_original_code
				loop_limit = 8
			Else
				'Invalid_string_refer_to_original_code
				loop_limit = 4
			End If
		Else
			If cnum >= 9 Then
				'Invalid_string_refer_to_original_code
				loop_limit = 12
			ElseIf cnum >= 5 Then 
				'Invalid_string_refer_to_original_code
				loop_limit = 8
			Else
				'Invalid_string_refer_to_original_code
				loop_limit = 4
			End If
		End If
		
		'蜷井ｽ捺橿譁懊ａ髫｣謗･蜿ｯ繧ｪ繝励す繝ｧ繝ｳ
		If IsOptionDefined("蜷井ｽ捺橿譁懊ａ髫｣謗･蜿ｯ") Then
			If loop_limit = 4 Then
				loop_limit = 8
			End If
		End If
		
		ReDim partners(0)
		For i = 1 To cnum
			'Invalid_string_refer_to_original_code
			uname = LIndex(clist, i)
			
			For j = 1 To loop_limit
				'Invalid_string_refer_to_original_code
				'UPGRADE_NOTE: オブジェクト u をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
				u = Nothing
				Select Case j
					Case 1
						If tx > 1 Then
							u = MapDataForUnit(tx - 1, ty)
						End If
					Case 2
						If tx < MapWidth Then
							u = MapDataForUnit(tx + 1, ty)
						End If
					Case 3
						If ty > 1 Then
							u = MapDataForUnit(tx, ty - 1)
						End If
					Case 4
						If ty < MapHeight Then
							u = MapDataForUnit(tx, ty + 1)
						End If
					Case 5
						If tx > 1 And ty > 1 Then
							u = MapDataForUnit(tx - 1, ty - 1)
						End If
					Case 6
						If tx < MapWidth And ty < MapHeight Then
							u = MapDataForUnit(tx + 1, ty + 1)
						End If
					Case 7
						If tx > 1 And ty < MapHeight Then
							u = MapDataForUnit(tx - 1, ty + 1)
						End If
					Case 8
						If tx < MapWidth And ty > 1 Then
							u = MapDataForUnit(tx + 1, ty - 1)
						End If
					Case 9
						If tx > 2 Then
							u = MapDataForUnit(tx - 2, ty)
						End If
					Case 10
						If tx < MapWidth - 1 Then
							u = MapDataForUnit(tx + 2, ty)
						End If
					Case 11
						If ty > 2 Then
							u = MapDataForUnit(tx, ty - 2)
						End If
					Case 12
						If ty < MapHeight - 1 Then
							u = MapDataForUnit(tx, ty + 2)
						End If
				End Select
				
				'Invalid_string_refer_to_original_code
				If u Is Nothing Then
					GoTo NextNeighbor
				End If
				
				With u
					'Invalid_string_refer_to_original_code
					If .Name <> uname Then
						'Invalid_string_refer_to_original_code
						If .MainPilot.Name <> uname Then
							GoTo NextNeighbor
						End If
					End If
					
					'Invalid_string_refer_to_original_code
					If u Is Me Then
						GoTo NextNeighbor
					End If
					
					'Invalid_string_refer_to_original_code
					For k = 1 To UBound(partners)
						If u Is partners(k) Then
							GoTo NextNeighbor
						End If
					Next 
					
					'Invalid_string_refer_to_original_code
					If IsEnemy(u) Then
						GoTo NextNeighbor
					End If
					
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code_
					'Invalid_string_refer_to_original_code_
					'Then
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					GoTo NextNeighbor
					'End If
					
					'Invalid_string_refer_to_original_code
					If clevel > 0 Then
						If MainPilot.Relation(.MainPilot) < clevel Or .MainPilot.Relation(MainPilot) < clevel Then
							GoTo NextNeighbor
						End If
					End If
					
					'Invalid_string_refer_to_original_code
					If Not check_formation Then
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'蜷井ｽ捺橿縺ｨ蜷悟錐縺ｮ豁ｦ蝎ｨ繧呈､懃ｴ｢
						For k = 1 To .CountWeapon
							If .Weapon(k).Name = cname Then
								Exit For
							End If
						Next 
						
						If k <= .CountWeapon Then
							'Invalid_string_refer_to_original_code
							If Not .IsWeaponMastered(k) Then
								GoTo NextNeighbor
							End If
							If .Weapon(k).NecessaryMorale > 0 Then
								If .MainPilot.Morale < .Weapon(k).NecessaryMorale Then
									GoTo NextNeighbor
								End If
							End If
							If .WeaponENConsumption(k) > 0 Then
								If .EN < .WeaponENConsumption(k) Then
									GoTo NextNeighbor
								End If
							End If
							If .Weapon(k).Bullet > 0 Then
								If .Bullet(k) = 0 Then
									GoTo NextNeighbor
								End If
							End If
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							GoTo NextNeighbor
						End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						GoTo NextNeighbor
					End If
					'End If
					'Invalid_string_refer_to_original_code
					If cmorale > 0 Then
						If .MainPilot.Morale < cmorale Then
							GoTo NextNeighbor
						End If
					End If
					If cen > 0 Then
						If .EN < cen Then
							GoTo NextNeighbor
						End If
					End If
					If cplana > 0 Then
						If .MainPilot.Plana < cplana Then
							GoTo NextNeighbor
						End If
					End If
					'End If
					'Invalid_string_refer_to_original_code
					For k = 1 To .CountAbility
						If .Ability(k).Name = cname Then
							Exit For
						End If
					Next 
					
					If k <= .CountAbility Then
						'Invalid_string_refer_to_original_code
						If Not .IsAbilityMastered(k) Then
							GoTo NextNeighbor
						End If
						If .Ability(k).NecessaryMorale > 0 Then
							If .MainPilot.Morale < .Ability(k).NecessaryMorale Then
								GoTo NextNeighbor
							End If
						End If
						If .AbilityENConsumption(k) > 0 Then
							If .EN < .AbilityENConsumption(k) Then
								GoTo NextNeighbor
							End If
						End If
						If .Ability(k).Stock > 0 Then
							If .Stock(k) = 0 Then
								GoTo NextNeighbor
							End If
						End If
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						GoTo NextNeighbor
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					GoTo NextNeighbor
					'End If
					'End If
					'Invalid_string_refer_to_original_code
					If cmorale > 0 Then
						If .MainPilot.Morale < cmorale Then
							GoTo NextNeighbor
						End If
					End If
					If cen > 0 Then
						If .EN < cen Then
							GoTo NextNeighbor
						End If
					End If
					If cplana > 0 Then
						If .MainPilot.Plana < cplana Then
							GoTo NextNeighbor
						End If
					End If
					'End If
					'End If
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					For k = 1 To .CountWeapon
						If .Weapon(k).Name = cname Then
							Exit For
						End If
					Next 
					
					If k <= .CountWeapon Then
						If Not .IsWeaponMastered(k) Then
							GoTo NextNeighbor
						End If
					End If
					For k = 1 To .CountAbility
						If .Ability(k).Name = cname Then
							Exit For
						End If
					Next 
					
					If k <= .CountAbility Then
						If Not .IsAbilityMastered(k) Then
							GoTo NextNeighbor
						End If
					End If
					'End If
					'End If
				End With
				
				'隕九▽縺九▲縺溘ヱ繝ｼ繝医リ繝ｼ繧定ｨ倬鹸
				ReDim Preserve partners(i)
				partners(i) = u
				Exit For
NextNeighbor: 
			Next 
			
			'Invalid_string_refer_to_original_code
			If j > loop_limit Then
				ReDim partners(0)
				Exit Sub
			End If
		Next 
		
		'Invalid_string_refer_to_original_code
		ReDim SelectedPartners(UBound(partners))
		For i = 1 To UBound(partners)
			SelectedPartners(i) = partners(i)
		Next 
	End Sub
	
	'Invalid_string_refer_to_original_code
	Public Function IsCombinationAttackAvailable(ByVal w As Short, Optional ByVal check_formation As Boolean = False) As Boolean
		Dim partners() As Unit
		
		ReDim partners(0)
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		CombinationPartner("Invalid_string_refer_to_original_code")
		'UPGRADE_WARNING: IsCombinationAttackAvailable に変換されていないステートメントがあります。ソース コードを確認してください。
		'Invalid_string_refer_to_original_code
		If x > 1 Then
			If Not MapDataForUnit(x - 1, y) Is Nothing Then
				If IsEnemy(MapDataForUnit(x - 1, y)) Then
					CombinationPartner("Invalid_string_refer_to_original_code")
				End If
			End If
		End If
		If UBound(partners) = 0 Then
			If x < MapWidth Then
				If Not MapDataForUnit(x + 1, y) Is Nothing Then
					If IsEnemy(MapDataForUnit(x + 1, y)) Then
						CombinationPartner("Invalid_string_refer_to_original_code")
					End If
				End If
			End If
		End If
		If UBound(partners) = 0 Then
			If y > 1 Then
				If Not MapDataForUnit(x, y - 1) Is Nothing Then
					If IsEnemy(MapDataForUnit(x, y - 1)) Then
						CombinationPartner("Invalid_string_refer_to_original_code")
					End If
				End If
			End If
		End If
		If UBound(partners) = 0 Then
			If y < MapHeight Then
				If Not MapDataForUnit(x, y + 1) Is Nothing Then
					If IsEnemy(MapDataForUnit(x, y + 1)) Then
						CombinationPartner("Invalid_string_refer_to_original_code")
					End If
				End If
			End If
		End If
		'Invalid_string_refer_to_original_code
		CombinationPartner("Invalid_string_refer_to_original_code")
		'End If
		
		'Invalid_string_refer_to_original_code
		If UBound(partners) > 0 Then
			IsCombinationAttackAvailable = True
		Else
			IsCombinationAttackAvailable = False
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsCombinationAbilityAvailable(ByVal a As Short, Optional ByVal check_formation As Boolean = False) As Boolean
		Dim partners() As Unit
		
		ReDim partners(0)
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		'Invalid_string_refer_to_original_code
		CombinationPartner("Invalid_string_refer_to_original_code", a, partners, x, y)
		'UPGRADE_WARNING: IsCombinationAbilityAvailable に変換されていないステートメントがあります。ソース コードを確認してください。
		'Invalid_string_refer_to_original_code
		If x > 1 Then
			If Not MapDataForUnit(x - 1, y) Is Nothing Then
				If IsAlly(MapDataForUnit(x - 1, y)) Then
					CombinationPartner("Invalid_string_refer_to_original_code", a, partners, x - 1, y, check_formation)
				End If
			End If
		End If
		If UBound(partners) = 0 Then
			If x < MapWidth Then
				If Not MapDataForUnit(x + 1, y) Is Nothing Then
					If IsAlly(MapDataForUnit(x + 1, y)) Then
						CombinationPartner("Invalid_string_refer_to_original_code", a, partners, x + 1, y, check_formation)
					End If
				End If
			End If
		End If
		If UBound(partners) = 0 Then
			If y > 1 Then
				If Not MapDataForUnit(x, y - 1) Is Nothing Then
					If IsAlly(MapDataForUnit(x, y - 1)) Then
						CombinationPartner("Invalid_string_refer_to_original_code", a, partners, x, y - 1, check_formation)
					End If
				End If
			End If
		End If
		If UBound(partners) = 0 Then
			If y > MapHeight Then
				If Not MapDataForUnit(x, y + 1) Is Nothing Then
					If IsAlly(MapDataForUnit(x, y + 1)) Then
						CombinationPartner("Invalid_string_refer_to_original_code", a, partners, x, y + 1, check_formation)
					End If
				End If
			End If
		End If
		'Invalid_string_refer_to_original_code
		CombinationPartner("Invalid_string_refer_to_original_code", a, partners, x, y, check_formation)
		'End If
		
		'Invalid_string_refer_to_original_code
		If UBound(partners) > 0 Then
			IsCombinationAbilityAvailable = True
		Else
			IsCombinationAbilityAvailable = False
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAbleToEnter(ByVal tx As Short, ByVal ty As Short) As Boolean
		Dim ignore_move_cost As Boolean
		
		'Invalid_string_refer_to_original_code
		If Not IsAvailable() Then
			IsAbleToEnter = False
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If MapFileName = "" Then
			IsAbleToEnter = True
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If tx < 1 Or MapWidth < tx Or ty < 1 Or MapHeight < ty Then
			IsAbleToEnter = False
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		Select Case TerrainClass(tx, ty)
			Case "遨ｺ"
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsAbleToEnter = False
				Exit Function
				'End If
			Case "豌ｴ"
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsAbleToEnter = True
				Exit Function
				'End If
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsAbleToEnter = False
				Exit Function
				'End If
			Case "豺ｱ豌ｴ"
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsAbleToEnter = True
				Exit Function
				'End If
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsAbleToEnter = False
				Exit Function
				'End If
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsAbleToEnter = False
				Exit Function
				'End If
			Case "譛磯擇"
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsAbleToEnter = True
				Exit Function
				'End If
			Case Else
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsAbleToEnter = True
				Exit Function
				'End If
				'Invalid_string_refer_to_original_code_
				'Then
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				IsAbleToEnter = False
				Exit Function
				'End If
		End Select
		
		'Invalid_string_refer_to_original_code
		If TerrainMoveCost(tx, ty) >= 1000 Then
			IsAbleToEnter = False
			Exit Function
		End If
		
		IsAbleToEnter = True
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsAvailable() As Boolean
		Dim i As Short
		
		IsAvailable = True
		
		'Invalid_string_refer_to_original_code
		If IsDisabled(Name) Then
			IsAvailable = False
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		'Invalid_string_refer_to_original_code
		'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
		If IsConditionSatisfied("Invalid_string_refer_to_original_code") Then
			IsAvailable = False
			Exit Function
		End If
		'End If
		
		With CurrentForm
			'Invalid_string_refer_to_original_code
			If .CountPilot = 0 Or (Not IsFeatureAvailable("Invalid_string_refer_to_original_code") And Not IsFeatureAvailable("Invalid_string_refer_to_original_code")) Then
				Exit Function
			End If
			
			'Invalid_string_refer_to_original_code
			For i = 1 To CountFeature
				Select Case Feature(i)
					Case "Invalid_string_refer_to_original_code"
						If Not .IsNecessarySkillSatisfied(FeatureData(i)) Then
							IsAvailable = False
							Exit Function
						End If
					Case "Invalid_string_refer_to_original_code"
						If .IsNecessarySkillSatisfied(FeatureData(i)) Then
							IsAvailable = False
							Exit Function
						End If
				End Select
			Next 
		End With
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsNecessarySkillSatisfied(ByRef nabilities As String, Optional ByRef p As Pilot = Nothing) As Boolean
		Dim i, num As Short
		Dim nskill_list(100) As String
		
		If Len(nabilities) = 0 Then
			IsNecessarySkillSatisfied = True
			Exit Function
		End If
		
		num = LLength(nabilities)
		For i = 1 To MinLng(num, 100)
			nskill_list(i) = LIndex(nabilities, i)
		Next 
		
		'Invalid_string_refer_to_original_code
		i = 1
		Do While i <= MinLng(num, 100)
			If IsNecessarySkillSatisfied2(nskill_list(i), p) Then
				'Invalid_string_refer_to_original_code
				If i <= num - 2 Then
					Do While LCase(nskill_list(i + 1)) = "or"
						i = i + 2
						'Invalid_string_refer_to_original_code
						If i = num Then
							IsNecessarySkillSatisfied = True
							Exit Function
						ElseIf i > num Then 
							'Invalid_string_refer_to_original_code
							ErrorMessage(Name & "Invalid_string_refer_to_original_code")
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							TerminateSRC()
						End If
					Loop 
				End If
			Else
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				If i > num - 2 Then
					Exit Function
				End If
				i = i + 1
				If LCase(nskill_list(i)) <> "or" Then
					Exit Function
				End If
			End If
			i = i + 1
		Loop 
		
		IsNecessarySkillSatisfied = True
	End Function
	
	Public Function IsNecessarySkillSatisfied2(ByRef ndata As String, ByRef p As Pilot) As Boolean
		Dim stype2, stype, sname As String
		Dim slevel As Double
		Dim nlevel As Double
		Dim mp As Pilot
		Dim i, j As Short
		
		'Invalid_string_refer_to_original_code
		If Left(ndata, 1) = "+" Then
			'Invalid_string_refer_to_original_code
			'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
			IsNecessarySkillSatisfied2 = True
			Exit Function
		End If
		ndata = Mid(ndata, 2)
		'End If
		
		'Invalid_string_refer_to_original_code
		If Left(ndata, 1) = "*" Then
			If Summoner Is Nothing Then
				Exit Function
			End If
			IsNecessarySkillSatisfied2 = Summoner.IsNecessarySkillSatisfied2(Mid(ndata, 2), Nothing)
			Exit Function
		End If
		
		i = InStr(ndata, "Lv")
		If i > 0 Then
			sname = Left(ndata, i - 1)
			nlevel = StrToDbl(Mid(ndata, i + 2))
		Else
			sname = ndata
			nlevel = 1
		End If
		
		'Invalid_string_refer_to_original_code
		If Left(sname, 1) = "!" Then
			IsNecessarySkillSatisfied2 = Not IsNecessarySkillSatisfied2(Mid(ndata, 2), p)
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If p Is Nothing Then
			If CountPilot > 0 Then
				mp = MainPilot
			Else
				With CurrentForm
					If .CountPilot > 0 Then
						mp = .MainPilot
					End If
				End With
			End If
		Else
			mp = p
		End If
		
		'Invalid_string_refer_to_original_code
		If Not mp Is Nothing Then
			If mp.Nickname0 = "Invalid_string_refer_to_original_code" Then
				'UPGRADE_NOTE: オブジェクト mp をガベージ コレクトするまでこのオブジェクトを破棄することはできません。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"' をクリックしてください。
				mp = Nothing
			End If
		End If
		
		slevel = -10000
		
		'Invalid_string_refer_to_original_code
		Select Case sname
			Case "繝ｬ繝吶Ν"
				If Not mp Is Nothing Then
					slevel = mp.Level
				Else
					slevel = 0
				End If
			Case "Invalid_string_refer_to_original_code"
				If Not mp Is Nothing Then
					slevel = mp.InfightBase
				Else
					slevel = 0
				End If
			Case "Invalid_string_refer_to_original_code"
				slevel = 0
				If Not mp Is Nothing Then
					If Not mp.HasMana() Then
						slevel = mp.ShootingBase
					End If
				End If
			Case "鬲泌鴨"
				slevel = 0
				If Not mp Is Nothing Then
					If mp.HasMana() Then
						slevel = mp.ShootingBase
					End If
				End If
			Case "蜻ｽ荳ｭ"
				If Not mp Is Nothing Then
					slevel = mp.HitBase
				Else
					slevel = 0
				End If
			Case "蝗樣∩"
				If Not mp Is Nothing Then
					slevel = mp.DodgeBase
				Else
					slevel = 0
				End If
			Case "Invalid_string_refer_to_original_code"
				If Not mp Is Nothing Then
					slevel = mp.TechniqueBase
				Else
					slevel = 0
				End If
			Case "Invalid_string_refer_to_original_code"
				If Not mp Is Nothing Then
					slevel = mp.IntuitionBase
				Else
					slevel = 0
				End If
			Case "Invalid_string_refer_to_original_code"
				slevel = 0
				If Not mp Is Nothing Then
					With mp
						If IsOptionDefined("Invalid_string_refer_to_original_code") Then
							slevel = .InfightBase - .Level \ 2
						Else
							slevel = .InfightBase - .Level
						End If
					End With
				End If
			Case "Invalid_string_refer_to_original_code"
				slevel = 0
				If Not mp Is Nothing Then
					With mp
						If Not .HasMana() Then
							If IsOptionDefined("Invalid_string_refer_to_original_code") Then
								slevel = .ShootingBase - .Level \ 2
							Else
								slevel = .ShootingBase - .Level
							End If
						End If
					End With
				End If
			Case "鬲泌鴨蛻晄悄蛟､"
				slevel = 0
				If Not mp Is Nothing Then
					With mp
						If .HasMana() Then
							If IsOptionDefined("Invalid_string_refer_to_original_code") Then
								slevel = .ShootingBase - .Level \ 2
							Else
								slevel = .ShootingBase - .Level
							End If
						End If
					End With
				End If
			Case "蜻ｽ荳ｭ蛻晄悄蛟､"
				slevel = 0
				If Not mp Is Nothing Then
					With mp
						slevel = .HitBase - .Level
					End With
				End If
			Case "蝗樣∩蛻晄悄蛟､"
				slevel = 0
				If Not mp Is Nothing Then
					With mp
						slevel = .DodgeBase - .Level
					End With
				End If
			Case "Invalid_string_refer_to_original_code"
				slevel = 0
				If Not mp Is Nothing Then
					With mp
						slevel = .TechniqueBase - .Level
					End With
				End If
			Case "Invalid_string_refer_to_original_code"
				slevel = 0
				If Not mp Is Nothing Then
					With mp
						slevel = .IntuitionBase - .Level
					End With
				End If
			Case "逕ｷ諤ｧ"
				slevel = 0
				If Not mp Is Nothing Then
					If mp.Sex = "逕ｷ諤ｧ" Then
						slevel = 1
					End If
					If Data.PilotNum > 1 Then
						For i = 1 To CountPilot
							If Pilot(i).Sex = "逕ｷ諤ｧ" Then
								slevel = 1
							End If
						Next 
					End If
					For i = 1 To CountSupport
						If Support(i).Sex = "逕ｷ諤ｧ" Then
							slevel = 1
						End If
					Next 
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If AdditionalSupport.Sex = "逕ｷ諤ｧ" Then
						slevel = 1
					End If
				End If
				'End If
			Case "螂ｳ諤ｧ"
				slevel = 0
				If Not mp Is Nothing Then
					If mp.Sex = "螂ｳ諤ｧ" Then
						slevel = 1
					End If
					If Data.PilotNum > 1 Then
						For i = 1 To CountPilot
							If Pilot(i).Sex = "螂ｳ諤ｧ" Then
								slevel = 1
							End If
						Next 
					End If
					For i = 1 To CountSupport
						If Support(i).Sex = "螂ｳ諤ｧ" Then
							slevel = 1
						End If
					Next 
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If AdditionalSupport.Sex = "螂ｳ諤ｧ" Then
						slevel = 1
					End If
				End If
				'End If
			Case "逕溯ｺｫ"
				If IsHero Then
					slevel = 1
				Else
					slevel = 0
				End If
			Case "轢墓ｭｻ"
				If HP <= MaxHP \ 4 Then
					slevel = 1
				Else
					slevel = 0
				End If
			Case "Invalid_string_refer_to_original_code"
				slevel = 10# * HP / MaxHP
			Case "Invalid_string_refer_to_original_code"
				slevel = 10# * EN / MaxEN
			Case "豌怜鴨"
				If Not mp Is Nothing Then
					slevel = CDbl(mp.Morale - 100#)
					slevel = CDbl(slevel / 10#)
				Else
					slevel = 0
				End If
			Case "繝ｩ繝ｳ繧ｯ"
				slevel = Rank
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				slevel = 0
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If sname = Area Then
					slevel = 1
				End If
				'End If
			Case "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				slevel = 1
			Case "蠖薙※霄ｫ謚", "Invalid_string_refer_to_original_code"
				'Invalid_string_refer_to_original_code
				'Invalid_string_refer_to_original_code
				Exit Function
		End Select
		
		'Invalid_string_refer_to_original_code
		If slevel <> -10000 Then
			'Invalid_string_refer_to_original_code
			If slevel >= nlevel Then
				IsNecessarySkillSatisfied2 = True
			End If
			Exit Function
		End If
		
		'Invalid_string_refer_to_original_code
		If Not mp Is Nothing Then
			stype = mp.SkillType(sname)
		Else
			stype = sname
		End If
		
		'Invalid_string_refer_to_original_code
		Dim iname As String
		Dim uname As String
		Dim u As Unit
		Dim max_range As Short
		Select Case stype
			Case "Invalid_string_refer_to_original_code"
				If Not p Is Nothing Then
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If stype <> sname Then
						If p.SkillNameForNS(stype) <> sname Then
							slevel = 0
						End If
					End If
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				ElseIf Not mp Is Nothing Then 
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If Data.PilotNum > 1 Then
						For i = 2 To CountPilot
							With Pilot(i)
								'Invalid_string_refer_to_original_code
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								slevel = MaxDbl(slevel, .SkillLevel(sname))
							End With
						Next 
					End If
					For i = 1 To CountSupport
						With Support(i)
							'Invalid_string_refer_to_original_code
							'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
							slevel = MaxDbl(slevel, .SkillLevel(sname))
						End With
					Next 
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					With AdditionalSupport
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						slevel = MaxDbl(slevel, .SkillLevel(sname))
					End With
				End If
				
				If stype <> sname Then
					If mp.SkillNameForNS(stype) <> sname Then
						slevel = 0
					End If
				End If
				
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				If Data.PilotNum > 1 Then
					For i = 2 To CountPilot
						'Invalid_string_refer_to_original_code
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					Next 
				End If
				For i = 1 To CountSupport
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				Next 
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'End If
				'End If
			Case "Invalid_string_refer_to_original_code"
				If Not p Is Nothing Then
					slevel = p.SynchroRate
				ElseIf Not mp Is Nothing Then 
					slevel = mp.SynchroRate
					If Data.PilotNum > 1 Then
						For i = 2 To CountPilot
							slevel = MaxDbl(slevel, Pilot(i).SynchroRate)
						Next 
					End If
					For i = 1 To CountSupport
						slevel = MaxDbl(slevel, Support(i).SynchroRate)
					Next 
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					slevel = MaxDbl(slevel, AdditionalSupport.SynchroRate)
				End If
				'End If
				If stype <> sname Then
					If mp.SkillNameForNS(stype) <> sname Then
						slevel = 0
					End If
				End If
			Case "繧ｪ繝ｼ繝ｩ"
				If Not p Is Nothing Then
					slevel = p.SkillLevel("繧ｪ繝ｼ繝ｩ")
				ElseIf Not mp Is Nothing Then 
					slevel = AuraLevel()
				End If
				If stype <> sname Then
					If mp.SkillNameForNS(stype) <> sname Then
						slevel = 0
					End If
				End If
			Case "髴雁鴨"
				If Not p Is Nothing Then
					slevel = p.Plana
				ElseIf Not mp Is Nothing Then 
					slevel = mp.Plana
				End If
				If stype <> sname Then
					If mp.SkillNameForNS(stype) <> sname Then
						slevel = 0
					End If
				End If
			Case Else
				'Invalid_string_refer_to_original_code
				
				If Not mp Is Nothing Then
					With mp
						'Invalid_string_refer_to_original_code
						If sname = .Name Or sname = .Nickname Then
							slevel = 1
						ElseIf stype = sname Then 
							slevel = .SkillLevel(stype)
						ElseIf .SkillNameForNS(stype) = sname Then 
							slevel = .SkillLevel(stype)
						End If
					End With
					
					'Invalid_string_refer_to_original_code
					If Data.PilotNum > 1 Then
						'Invalid_string_refer_to_original_code
						For i = 2 To CountPilot
							With Pilot(i)
								If sname = .Name Or sname = .Nickname Then
									slevel = 1
									Exit For
								End If
								
								stype2 = .SkillType(sname)
								If stype2 = sname Then
									slevel = MaxDbl(slevel, .SkillLevel(stype2))
								ElseIf .SkillNameForNS(stype2) = sname Then 
									slevel = MaxDbl(slevel, .SkillLevel(stype2))
								End If
							End With
						Next 
					End If
					
					'Invalid_string_refer_to_original_code
					For i = 1 To CountSupport
						With Support(i)
							If sname = .Name Or sname = .Nickname Then
								slevel = 1
								Exit For
							End If
							stype2 = .SkillType(sname)
							If stype2 = sname Then
								slevel = MaxDbl(slevel, .SkillLevel(stype2))
							ElseIf .SkillNameForNS(stype2) = sname Then 
								slevel = MaxDbl(slevel, .SkillLevel(stype2))
							End If
						End With
					Next 
					
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					With AdditionalSupport
						If sname = .Name Or sname = .Nickname Then
							slevel = 1
						Else
							stype2 = .SkillType(sname)
							If stype2 = sname Then
								slevel = MaxDbl(slevel, .SkillLevel(stype2))
							ElseIf .SkillNameForNS(stype2) = sname Then 
								slevel = MaxDbl(slevel, .SkillLevel(stype2))
							End If
						End If
					End With
				End If
				'End If
				
				If slevel = 0 Then
					'Invalid_string_refer_to_original_code
					If sname = Name Or sname = Nickname0 Or sname = Class0 Then
						slevel = 1
					End If
				End If
				
				If slevel = 0 Then
					If Left(sname, 1) = "@" Then
						'Invalid_string_refer_to_original_code
						'Invalid_string_refer_to_original_code_
						'And 1 <= x And x <= MapWidth _
						'And 1 <= y And y <= MapHeight _
						'Then
						'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
						If Mid(sname, 2) = TerrainName(x, y) Then
							slevel = 1
						End If
					End If
				ElseIf Right(sname, 2) = "Invalid_string_refer_to_original_code" Then 
					'Invalid_string_refer_to_original_code
					iname = Left(sname, Len(sname) - 2)
					For i = 1 To CountItem
						With Item(i)
							If .Activated Then
								If iname = .Name Or iname = .Class0 Then
									slevel = 1
									Exit For
								End If
							End If
						End With
					Next 
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					'Invalid_string_refer_to_original_code
					'Invalid_string_refer_to_original_code
					'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
					If Right(sname, 2) = "髫｣謗･" Then
						uname = Left(sname, Len(sname) - 2)
						max_range = 1
					Else
						uname = Left(sname, Len(sname) - 5)
						max_range = StrToLng(Mid(sname, Len(sname) - 4, 1))
					End If
					
					For i = MaxLng(x - max_range, 1) To MinLng(x + max_range, MapWidth)
						For j = MaxLng(y - max_range, 1) To MinLng(y + max_range, MapHeight)
							u = MapDataForUnit(i, j)
							
							'Invalid_string_refer_to_original_code
							If System.Math.Abs(x - i) + System.Math.Abs(y - j) > max_range Then
								GoTo NextNeighbor
							End If
							
							'Invalid_string_refer_to_original_code
							If u Is Nothing Then
								GoTo NextNeighbor
							End If
							
							'Invalid_string_refer_to_original_code
							If u Is Me Or (x = i And y = j) Then
								GoTo NextNeighbor
							End If
							
							'Invalid_string_refer_to_original_code
							If IsEnemy(u) Then
								GoTo NextNeighbor
							End If
							
							With u
								'Invalid_string_refer_to_original_code
								If uname = "豈崎襖" Then
									If Not .IsFeatureAvailable("豈崎襖") Then
										GoTo NextNeighbor
									End If
								Else
									If .Name <> uname And .MainPilot.Name <> uname Then
										GoTo NextNeighbor
									End If
								End If
								
								'Invalid_string_refer_to_original_code
								'Invalid_string_refer_to_original_code_
								'Invalid_string_refer_to_original_code_
								'Then
								'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
								GoTo NextNeighbor
							End With
						Next 
					Next 
				End If
				'End With
				
				'Invalid_string_refer_to_original_code
				IsNecessarySkillSatisfied2 = True
				Exit Function
NextNeighbor: 
				'Next
				'Next
				'End If
				'Invalid_string_refer_to_original_code
				'UPGRADE_ISSUE: 前の行を解析できませんでした。 詳細については、'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="82EBB1AE-1FCB-4FEF-9E6C-8736A316F8A7"' をクリックしてください。
				'Invalid_string_refer_to_original_code
				If IsConditionSatisfied(Left(sname, Len(sname) - 2)) Then
					slevel = 1
				End If
				'End If
				'End If
		End Select
		
		'Invalid_string_refer_to_original_code
		If slevel >= nlevel Then
			IsNecessarySkillSatisfied2 = True
		End If
	End Function
	
	'Invalid_string_refer_to_original_code
	Public Function IsDisabled(ByRef fname As String) As Boolean
		If Len(fname) = 0 Then
			IsDisabled = False
			Exit Function
		End If
		
		If IsGlobalVariableDefined("Disable(" & fname & ")") Then
			IsDisabled = True
			Exit Function
		End If
		
		If IsGlobalVariableDefined("Disable(" & Name & "," & fname & ")") Then
			IsDisabled = True
			Exit Function
		End If
		
		IsDisabled = False
	End Function
	
	
	'Invalid_string_refer_to_original_code
	Public Function IsDefense() As Boolean
		If Party = Stage Then
			IsDefense = False
		Else
			IsDefense = True
		End If
	End Function
End Class