**ForEachコマンド**

特定グループのユニットや配列の要素に対して特定のイベントコマンドを実行

**書式１**

**ForEach** *group* [*status*]

*commands*

**Next**

**書式２**

**ForEach** *variable* **In** *array*

*commands*

**Next**

**書式３**

**ForEach** *variable* **In** パイロット一覧(*mode*)

*commands*

**Next**

**書式４**

**ForEach** *variable* **In** ユニット一覧(*mode*)

*commands*

**Next**

**指定項目説明**

*group*コマンドの対象となるユニット集団

「全」、[陣営名](陣営名)または[グループＩＤ](グループＩＤ)で指定

*status*対象となるユニットの状態（出撃、待機、格納、破壊、離脱、全て）

全体を括弧で囲み複数指定可能 （**例** (出撃 格納 離脱)）

省略時には「出撃 格納」が指定されたものと見なされる

*variable*ループのインデックスになる変数名

*array*ループの対象になる配列名

*mode*パイロット・ユニットを選択する順番の基準となるステータス

*commands*実行するイベントコマンド。複数行指定可能

**解説**

指定したユニット集団*group* の各ユニットや配列の各要素に対してイベントコマンド列*commands* を実行します。

**書式１**の場合は選択されたユニットはデフォルトユニットに設定され、コマンドの引数を省略したときにはそのユニットに対してコマンドが実行されたとみなされます。逆に選択ユニットを引数に指定すると同じ名前のパイロットが複数いる場合は意図した通りの処理が行われません。注意して下さい。

*status* を指定した場合は *group* のユニットのうちで特定の状態にあるユニットに対してのみ*commands* が実行されます。指定できる状態は

**出撃**マップ上に存在

**待機**出撃していない

**格納**母艦に収納されている

**破壊**破壊されている

**離脱**Leaveコマンドで離脱している

**全て**状態に関係なく選択される

の６通りです。状態を指定しなかった場合には**(出撃 格納)**が指定されているとみなされます。

**書式２**の場合、配列*array* の各要素に対してイベントコマンド列*commands* が実行されます。この際、インデックス用の変数*variable* に要素名が代入されます。例えば A[1], A[2], A[3] の３要素からなる配列に対して**ForEach**コマンドを実行した場合、*commands* は3回実行され、それぞれの実行の際の *variable* の値は 1, 2, 3 になります。

なお、配列*array* にEval関数を使うことで配列の変数の指定に式を使うことが出来ます。

**書式３**の場合、各パイロット名に対してイベントコマンド列*commands* が実行されます。この際、インデックス用の変数*variable* にそれぞれのパイロット名が代入されます。パイロットが選択される順番は*mode*の指定で決まります。*mode*には次の設定が可能です。

**レベル**

**ＳＰ**

**格闘**

**射撃**

**命中**

**回避**

**技量**

**反応**

**名称**

パイロットは*mode*に指定されたステータスが高いものから選択されます。

**名称**が選択された場合、順番はパイロットの愛称で決まりますが、Windowsの機能的な制限のため順番は必ずしも読みに一致しません。

**書式４**の場合、各ユニットに対してイベントコマンド列*commands* が実行されます。書式１と違って*mode*で指定したステータスの高い順にユニットを選択することができますが、書式１よりもかなり速度が遅くなるので並べ替えが必要な場合以外は書式１を使ってください。インデックス用の変数*variable* にはそれぞれのユニットの[ユニットＩＤ](ユニットＩＤ)が代入されます。選択する順序を決める*mode*には次の設定が可能です。

**ランク**

**ＨＰ**

**ＥＮ**

**装甲**

**運動性**

**移動力**

**最大攻撃力**

**最長射程**

**名称**

*mode* に指定したステータスが高いユニットから選択されます。

*commands* 中には**ForEach**コマンドは使用できません。つまり**ForEach**のループ内で**ForEach**コマンドを使うことはできません。**ForEach**のループ内から呼び出したサブルーチンの中から使うことはできませんので注意して下さい。

[**Do**コマンド](Doコマンド)や[**For**コマンド](Forコマンド)と同様、[**Skip**コマンド](Skipコマンド)や[**Break**コマンド](Breakコマンド)を使って実行の流れを変えることができます。

![](../images/bm0.gif)イベントファイルが見やすいように*commands* にはインデントをつけるようにして下さい。

**例**

Talk 瞬

クッ、クッ、クッ…… さて、これはいかがですか？

End

#全ての味方ユニットを行動不能にする

ForEach 味方

SetStatus 行動不能 -1

Next

Talk 正人

く、体が重い…… 瞬！ てめえなにをしやがった！！

Talk 瞬

ふっ……ほんの少しあなたがたのユニットへの重力係数を増加させただけですよ

……お楽しみはこれからです

End
