** 内容はSRC2.2.33のものです **
**Openコマンド**

ファイルを開く

**書式**

**Open** *file* For *mode* As *var*

**指定項目説明**

*file*ファイル名

*mode*ファイルの入出力モード

*var*ファイルハンドルを格納する変数名

**解説**

ファイル*file* を開いて入出力モード*mode* でのデータの入出力を可能にし、*var* にファイルへのアクセスを管理するためのファイルハンドルを格納します。

*file*はシナリオがあるフォルダから検索されます。例えばシナリオが

C:\WINDOWS\ﾃﾞｽｸﾄｯﾌﾟ\Scenario

にある場合、*file* に指定したファイル名と**Open**コマンドで開くファイルの対応は下のようになります。

***file*開かれるファイル**

ひみつ日記.txtC:\WINDOWS\ﾃﾞｽｸﾄｯﾌﾟ\Scenario\ひみつ日記.txt

Data\ひみつ日記.txtC:\WINDOWS\ﾃﾞｽｸﾄｯﾌﾟ\Scenario\Data\ひみつ日記.txt

*file* には絶対パスは指定できません。また、アクセスできるファイルはシナリオがあるフォルダの下にあるファイルに限られます。これは関係のないフォルダにアクセスし、データが破壊されることを防ぐためです。また、存在しないフォルダを指定することは出来ません。新規のフォルダにファイルを作成するする場合はあらかじめ[CreateFolderコマンド](CreateFolderコマンド.md)でフォルダを作成してください。

**Open**コマンドで開いたファイルにどのようなファイル処理コマンドが使えるかは指定した*mode* に依存します。下に*mode* の種類と使用できるコマンドの対応を示します。

***mode*使えるコマンド**

**出力**[**Print**コマンド](Printコマンド.md)

**追加出力**[**Print**コマンド](Printコマンド.md)

**入力**[**LineRead**コマンド](LineReadコマンド.md)

**出力**と**追加出力**はどちらもファイルにデータを出力するためのモードですが、出力の場合は**Open**コマンドを使うたびにファイルを新規に作成し、元のファイルを上書きします。追加出力の場合は*file* が存在すれば*file*の末尾にデータを追加して書きこみます。

**Open**コマンドで開いたファイルに対してファイル処理コマンドを使うには、**Open**コマンドで開いたファイルのうちのどのファイルにコマンドを使用するかを指定する必要があります。このために使うのがファイルハンドルです。ファイルハンドルは1以上の整数になっており、ファイルを開くと同時に変数*var* に格納されます。ファイルが存在しなかったり、指定したパスのフォルダがなかったりしてファイルを開くことに失敗した場合、*var* には0が格納されます。

開いたファイルへの操作が終了したときは必ず[**Close**コマンド](Closeコマンド.md)を使ってファイルを閉じてください。ファイルを開いたままSRCを終了するとデータの書き込みが正しく行えないことがあります。

**例**

#ファイルハンドル用変数

Local F

#ファイル「クレアのひみつ日記.txt」を追加出力モードで開く

Open クレアのひみつ日記.txt For 追加出力 As F

#ファイルの最後にメッセージを追加

Print F

Print F ６月３日

Print F 今日はやっとお兄ちゃんに会えた！ ほんと今までなにやってたんだか……

Print F お兄ちゃんったら地上は久しぶりだから迷った、なんて言ってたけど\_

宇宙でもいっつも迷子になってたのにね。ほんとに私がついてないとだめなんだから。

Print F でも、ピンチにさっそうと現れたお兄ちゃんの姿はやっぱりかっこよかったな～

If Status(クレア) = 破壊 Then

Print F クレアもがんばったんだけど今日はやられちゃった。;

あ～あ、お兄ちゃんにいいとこ見せたかったのに。

Else

Print F クレアも今日はがんばったよ！ お兄ちゃんもよくやったなって誉めてくれたし。えへへ。

EndIf

Print F 明日からはお兄ちゃんと一緒にもっともっとがんばろ～っと。

#ファイルを閉じる

Close F
