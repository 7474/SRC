---
layout: default
title: ファイル処理関数
---
** 内容はSRC2.2.33のものです **

**ファイル処理関数**

**Dir(ファイルパス[,ファイル属性])**

指定したパターンやファイル属性と一致するファイル名またはフォルダ名を返します。ファイルが存在しなければ空文字列""が返ります。

「\*」を使って複数のファイルを指定することができます。例えば「\*.txt」を使えばテキストファイルを検索することができます。パターンに一致するファイルが複数ある場合、Dir関数を引数なしで連続して実行するとパターンに一致するファイル名が順に返ります。

ファイルパスはシナリオのフォルダを起点として検索されます。システム変数AppPath、ExtDataPathを使えばシナリオのフォルダ以外のフォルダのファイルを検索することができます。

検索するファイル属性を指定して検索することもできます。指定可能な属性は「ファイル」と「フォルダ」です。

**例**
```sh
If Dir(ScenarioPath & "\" & "セーブデータ", フォルダ) <> "" Then
で「セーブデータ」というフォルダがシナリオのあるフォルダ内に作成されているかどうか分かります。
```

**EOF(ファイルハンドル)**

指定したファイルハンドルのファイルの読み出しがファイルの末尾に達している場合に 1、そうでなければ 0 を返します。

**LoadFileDialog(ファイルタイプ,拡張子[,デフォルトファイル,相対パス])**

「ファイルを開く」のダイアログを開き、ユーザーが選択したファイルへのパスを返します。ファイルパスはシナリオのあるフォルダを起点として計算されるのでそのまま[**Open**コマンド](Openコマンド.md)等の引数に使うことができます。

ユーザーがキャンセルしたり、シナリオのフォルダの中にないファイルを指定すると空文字列""を返します。

ファイルタイプに読みこむデータの種類を(単なる名称なので自由に設定して下さい)、拡張子にその拡張子を指定して下さい。

デフォルトファイル、相対パスを設定するとダイアログを開いた時にダイアログに表示されているファイル名とパス名を変更することができます。

**例** fname = LoadFileDialog("データファイル", "dat")

**SaveFileDialog(ファイルタイプ,拡張子[,デフォルトファイル,相対パス])**

「ファイル名を付けて保存」のダイアログを開き、ユーザーが選択したファイルへのパスを返します。ファイルパスはシナリオのあるフォルダを起点として計算されるのでそのまま[**Open**コマンド](Openコマンド.md)等の引数に使うことができます。

ユーザーがキャンセルしたり、シナリオのフォルダの中にないファイルを指定すると空文字列""を返します。

ファイルタイプに読みこむデータの種類を(単なる名称なので自由に設定して下さい)、拡張子にその拡張子を指定して下さい。

デフォルトファイル、相対パスを設定するとダイアログを開いた時にダイアログに表示されているファイル名とパス名を変更することができます。

**例** fname = SaveFileDialog("データファイル", "dat","セーブデータ","Save")
